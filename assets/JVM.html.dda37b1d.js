import{_ as o}from"./plugin-vue_export-helper.21dcd24c.js";import{r as p,o as l,c as i,a,b as t,d as n,e as s}from"./app.95807bc9.js";const r={},c=a("blockquote",null,[a("p",null,"\u5411\u4E0B\u624E\u6DF1\uFF0C\u5411\u4E0A\u6269\u5C55")],-1),d=a("h1",{id:"\u65B0\u5B66\u56DB\u95EE",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#\u65B0\u5B66\u56DB\u95EE","aria-hidden":"true"},"#"),n(" \u65B0\u5B66\u56DB\u95EE")],-1),u=a("strong",null,"WHY\u3010\u4E0E\u524D\u4EE3\u4F18\u5316\u4E86\u4EC0\u4E48\uFF0C\u5F25\u8865\u4E86\u4EC0\u4E48\u7A7A\u767D\u3011",-1),m=n("\uFF1A\u4E86\u89E3\u5E95\u5C42\uFF0C\u4F18\u5316\uFF0C\u9762\u8BD5\uFF0C\u89E3\u51B3\u5E95\u5C42BUG"),k=a("br",null,null,-1),h=a("strong",null,"WHAT\u3010\u6846\u67B6\uFF0C\u601D\u7EF4\u5BFC\u56FE\uFF0C\u4E3B\u9898\u6846\u67B6\u3011",-1),g=n("\uFF1A\u7ED3\u6784\uFF0C"),v=a("br",null,null,-1),b=a("strong",null,"HOW\u3010\u5982\u4F55\u8BB0\u5FC6\uFF0C\u5B66\u4E60\u8D44\u6E90\u3011",-1),f=n("\uFF1A\u5B66\u4E60\u8D44\u6E90\uFF1A\u5C1A\u7845\u8C37JVM\uFF0CANKI\u8BB0\u5FC6\uFF0C"),C={href:"https://docs.oracle.com/en/java/javase/17/vm/java-virtual-machine-technology-overview.html",target:"_blank",rel:"noopener noreferrer"},S=n("\u6587\u6863"),M=a("br",null,null,-1),w=a("strong",null,"LEVEL\u3010\u4E0D\u662F\u6BCF\u4E2A\u90FD\u5B66\u7CBE\u3011",-1),J=n("\uFF1A\u4E86\u89E3"),x=s('<h1 id="\u8FDB\u5EA6-\u4E0A\u7BC7-\u3010\u5B8C12-19\u3011" tabindex="-1"><a class="header-anchor" href="#\u8FDB\u5EA6-\u4E0A\u7BC7-\u3010\u5B8C12-19\u3011" aria-hidden="true">#</a> \u8FDB\u5EA6\uFF1A\u4E0A\u7BC7 \u3010\u5B8C12.19\u3011</h1><h1 id="\u7EFC\u5408\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u7EFC\u5408\u95EE\u9898" aria-hidden="true">#</a> \u7EFC\u5408\u95EE\u9898</h1><h2 id="\u7C7B\u52A0\u8F7D\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u7C7B\u52A0\u8F7D\u8FC7\u7A0B" aria-hidden="true">#</a> \u7C7B\u52A0\u8F7D\u8FC7\u7A0B</h2><h2 id="\u6574\u4F53\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u6574\u4F53\u7ED3\u6784" aria-hidden="true">#</a> \u6574\u4F53\u7ED3\u6784</h2><h2 id="\u5982\u4F55\u5224\u65AD\u4E00\u4E2A\u5BF9\u8C61\u662F\u5426\u5B58\u6D3B" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u5224\u65AD\u4E00\u4E2A\u5BF9\u8C61\u662F\u5426\u5B58\u6D3B" aria-hidden="true">#</a> \u5982\u4F55\u5224\u65AD\u4E00\u4E2A\u5BF9\u8C61\u662F\u5426\u5B58\u6D3B</h2><h2 id="\u5783\u573E\u56DE\u6536\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u56DE\u6536\u7B97\u6CD5" aria-hidden="true">#</a> \u5783\u573E\u56DE\u6536\u7B97\u6CD5</h2><h2 id="\u5783\u573E\u56DE\u6536\u5668" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u56DE\u6536\u5668" aria-hidden="true">#</a> \u5783\u573E\u56DE\u6536\u5668</h2><h2 id="\u6DF1\u62F7\u8D1D\u6D45\u62F7\u8D1D" tabindex="-1"><a class="header-anchor" href="#\u6DF1\u62F7\u8D1D\u6D45\u62F7\u8D1D" aria-hidden="true">#</a> \u6DF1\u62F7\u8D1D\u6D45\u62F7\u8D1D</h2><h2 id="\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236" aria-hidden="true">#</a> \u53CC\u4EB2\u59D4\u6D3E\u673A\u5236</h2><h2 id="stringtable" tabindex="-1"><a class="header-anchor" href="#stringtable" aria-hidden="true">#</a> StringTable</h2><h2 id="\u4F18\u5316\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u4F18\u5316\u65B9\u6CD5" aria-hidden="true">#</a> \u4F18\u5316\u65B9\u6CD5</h2><h1 id="\u4E0A\u7BC7-\u5185\u5B58\u4E0E\u5783\u573E\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#\u4E0A\u7BC7-\u5185\u5B58\u4E0E\u5783\u573E\u56DE\u6536" aria-hidden="true">#</a> \u4E0A\u7BC7\uFF1A<mark>\u5185\u5B58\u4E0E\u5783\u573E\u56DE\u6536</mark></h1><h1 id="\u901F\u67E5" tabindex="-1"><a class="header-anchor" href="#\u901F\u67E5" aria-hidden="true">#</a> \u901F\u67E5</h1>',13),y={id:"xx\u9009\u9879\u8868",tabindex:"-1"},G=a("a",{class:"header-anchor",href:"#xx\u9009\u9879\u8868","aria-hidden":"true"},"#",-1),_=n(),j={href:"https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html",target:"_blank",rel:"noopener noreferrer"},q=n("-XX\u9009\u9879\u8868"),X=s('<h3 id="\u5806" tabindex="-1"><a class="header-anchor" href="#\u5806" aria-hidden="true">#</a> \u5806</h3><table><thead><tr><th>\u9009\u9879\u540D</th><th>\u9009\u9879\u4F5C\u7528</th><th>\u9ED8\u8BA4\u503C</th><th>\u5907\u6CE8</th></tr></thead><tbody><tr><td>-XX: +PrintFlagsInitial</td><td>\u67E5\u770B\u6240\u6709\u7684\u53C2\u6570\u7684\u9ED8\u8BA4\u521D\u59CB\u503C</td><td></td><td></td></tr><tr><td>-XX: +PrintFlagsFinal</td><td>\u67E5\u770B\u6240\u6709\u7684\u53C2\u6570\u7684\u6700\u7EC8\u503C\uFF08\u53EF\u80FD\u4F1A\u5B58\u5728\u4FEE\u6539\uFF0C\u4E0D\u518D\u662F\u521D\u59CB\u503C)</td><td></td><td></td></tr><tr><td>jps</td><td>\u67E5\u770B\u5F53\u524D\u8FD0\u884C\u4E2D\u7684\u8FDB\u7A0B</td><td></td><td></td></tr><tr><td>jinfo -flag \u53C2\u6570\u540D \u8FDB\u7A0Bid</td><td>\u5F53\u524D\u8FDB\u7A0B\u4E2D\u53C2\u6570\u503C</td><td></td><td></td></tr><tr><td>-Xms</td><td>\u521D\u59CB\u96C4\u7A7A\u5411\u5185\u5B58</td><td>\u7269\u7406\u5185\u5B58\u76841/64</td><td></td></tr><tr><td>-Xmx</td><td>:\u6700\u5927\u96C4\u7A7A\u95F4\u5185\u5B58</td><td>\u7269\u7406\u5185\u5B58\u76841/4</td><td></td></tr><tr><td>-Xmn</td><td>:\u8BBE\u7F6E\u65B0\u751F\u4EE3\u7684\u5927\u5C0F\u3002\uFF08\u521D\u59CB\u503C\u53CA\u6700\u5927\u503C\uFF09</td><td></td><td></td></tr><tr><td>-XX: NewRatio</td><td>:\u914D\u7F6E\u65B0\u751F\u4EE3\u4E0E\u8001\u5E74\u4EE3\u5728\u5806\u7ED3\u6784\u7684\u5360\u6BD4</td><td>\u65B0\u8001\u6BD4\uFF1A1:2</td><td></td></tr><tr><td>-XX: SurvivorRatio</td><td>:\u8BBE\u7F6E\u65B0\u751F\u4EE3\u4E2DEden\u548CS0/S1\u7A7A\u95F4\u6BD4\u4F8B</td><td>8</td><td></td></tr><tr><td>-XX: MaxTenuringThreshold</td><td>:\u8BBE\u7F6E\u65B0\u751F\u4EE3\u5783\u6271\u7684\u6700\u5927\u5E74\u9F84</td><td></td><td></td></tr><tr><td>-XX: +PrintGCdetails</td><td>:\u8F93\u51FA\u8BE6\u7EC6GC\u5904\u7406\u65E5\u5FD7</td><td></td><td></td></tr><tr><td>\u{1F31E} -XX: +PrintGC \u{1F31E} - verbose:GC</td><td>:\u6253\u5370\u7B52\u8981\u4FE1\u606F</td><td></td><td></td></tr><tr><td>-XX: HandlePromotionFailure</td><td>:\u662F\u5426\u8BBE\u7F6E\u7A7A\u95EE\u5206\u914D\u62C5\u4FDD</td><td></td><td></td></tr><tr><td>-XX: Doescapeanalysis</td><td>\u663E\u5F0F\u5F00\u542F\u9003\u9038\u5206\u6790</td><td>JDK 6u23\u540E\u9ED8\u8BA4\u5F00\u542F</td><td></td></tr><tr><td>-XX: Printescapeanalysis</td><td>\u67E5\u770B\u9003\u9038\u5206\u6790\u7684\u7B5B\u9009\u7ED3\u679C</td><td></td><td></td></tr><tr><td>-XX:+EliminateAllocations</td><td>:\u5F00\u542F\u6807\u91CF\u66FF\u6362\uFF0C\u5141\u8BB8\u5C06\u5BF9\u8C61\u6253\u6563\u5206\u914D\u5728\u6808\u4E0A\u3002</td><td>\u9ED8\u8BA4\u6253\u5F00</td><td></td></tr></tbody></table><h3 id="\u65B9\u6CD5\u533A" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6CD5\u533A" aria-hidden="true">#</a> <strong>\u65B9\u6CD5\u533A</strong></h3><table><thead><tr><th>\u9009\u9879\u540D</th><th>\u9009\u9879\u4F5C\u7528</th><th>\u9ED8\u8BA4\u503C</th><th>\u5907\u6CE8</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td></tr></tbody></table><h3 id="\u5783\u573E\u56DE\u6536\u5668-1" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u56DE\u6536\u5668-1" aria-hidden="true">#</a> \u5783\u573E\u56DE\u6536\u5668</h3><table><thead><tr><th>\u9009\u9879\u540D</th><th>\u9009\u9879\u4F5C\u7528</th><th>\u9ED8\u8BA4\u503C</th><th>\u5907\u6CE8</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td></tr></tbody></table><h1 id="\u4E00\u3001jvm\u4E0Ejava\u4F53\u7CFB\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001jvm\u4E0Ejava\u4F53\u7CFB\u7ED3\u6784" aria-hidden="true">#</a> \u4E00\u3001JVM\u4E0EJAVA\u4F53\u7CFB\u7ED3\u6784</h1><h2 id="_1-java\u4E0Ejvm" tabindex="-1"><a class="header-anchor" href="#_1-java\u4E0Ejvm" aria-hidden="true">#</a> 1.JAVA\u4E0EJVM</h2><h3 id="java\u5927\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#java\u5927\u4E8B\u4EF6" aria-hidden="true">#</a> Java\u5927\u4E8B\u4EF6</h3><ul><li>1990\u5E74\uFF0C\u5728sun\u516C\u53F8\u4E2D\uFF0C\u7531Patrick naughton\u3001mikesheridan\u4EE5\u53CAjames Gosling\u9886\u5BFC\u7684\u5C0F\u7EC4Green Team\uFF0C\u5F00\u53D1\u51FA\u65B0\u7684\u7A0B\u5E8F\u8BED\u8A00\uFF0C\u547D\u540D\u4E3AOAK\uFF0C\u540E\u671F\u66F4\u540D\u4E3AJava</li><li>1995\u5E74\uFF0Csun\u6B63\u5F0F\u53D1\u5E03Java\u548ChotJAVA\u4EA7\u54C1\uFF0CJava\u9996\u6B21\u516C\u5F00\u4EAE\u76F8\u3002</li><li>1996\u5E741\u670823\u65E5sun Microsystems\u53D1\u5E03\u4E86JDK1.0.</li><li>1998\u5E74\uFF0CJDK1.2\u7248\u672C\u53D1\u5E03\u3002\u540C\u65F6\uFF0Csun\u53D1\u5E03\u4E86JSP/Servlet\u3001EJB\u89C4\u8303\uFF0C\u4EE5\u53CA\u5C06Java\u5206\u6210\u4E86J2EE\u3001J2SE\u548CJ2ME\u3002\u8FD9\u8868\u660EJava\u5F00\u59CB\u5411\u4F01\u4E1A\u3001\u684C\u9762\u5E94\u7528\u548C\u79FB\u52A8\u8BBE\u5907\u5E94\u75283\u5927\u9886\u57DF\u633A\u8FDB\u3002</li><li>2000\u5E74\uFF0CJDK1.3\u53D1\u5E03\uFF0CJava HotSpot Virtual Machine\u6B63\u5F0F\u53D1\u5E03\uFF0C\u6210\u4E3AJava\u9ED8\u8BA4\u7684\u865A\u62DF\u673A\u3002</li><li>2002\u5E74\uFF0CJDK 1.4\u53D1\u5E03\uFF0C\u53E4\u8001\u7684classic\u865A\u62DF\u673A\u9000\u51FA\u5386\u53F2\u821E\u53F0\u3002</li><li>2003\u5E74\u5E95\uFF0CJava\u5E73\u53F0\u7684scala\u6B63\u5F0F\u53D1\u5E03\uFF0C\u540C\u5E74Groovy\u4E5F\u52A0\u5165\u4E86Java\u9635\u8425\u3002</li><li>2004\u5E74\uFF0CJDK1.5\u53D1\u5E03\uFF0C\u540C\u65F6JDK1.5\u6539\u540D\u4E3AJavaSE5.0.</li><li>2006\u5E74\uFF0CJDK 6\u53D1\u5E03\uFF0C\u540C\u5E74Java\u5F00\u6E90\u5E76\u5EFA\u7ACB\u4E86openJDK\uFF0C\u987A\u7406\u6210\u7AE0\uFF0CHotspot\u865A\u62DF\u673A\u6210\u4E3A\u4E86OpenJDK\u4E2D\u9ED8\u8BA4\u7684\u865A\u62DF\u673A\u3002</li><li>2007\u5E74\uFF0CJava\u5E73\u53F0\u8FCE\u6765\u4E86\u65B0\u4F19\u4F34Clojure\u3002</li><li>2008\u5E74\uFF0COracle\u6536\u8D2D\u4E86BEA\uFF0C\u5F97\u5230\u4E86JRockit\u865A\u62DF\u673A\u3002</li><li>2009\u5E74\uFF0CTwitter\u5BA3\u5E03\u5C06\u540E\u53F0\u5927\u90E8\u5206\u7A0B\u5E8F\u4ECEruby\u8FC1\u79FB\u5230Scala\uFF0C\u8FD9\u662FJava\u5E73\u53F0\u7684\u6709\u4E00\u6B21\u5927\u89C4\u6A21\u5E94\u7528\u3002</li><li>2010\u5E74\uFF0COracle\u6536\u8D2D\u4E86sun\uFF0C\u83B7\u5F97Java\u5546\u6807\u548C\u6700\u5177\u4EF7\u503C\u7684hotspot\u865A\u62DF\u673A\u3002\u6B64\u65F6Oracle\u62E5\u6709\u5E02\u573A\u5360\u7528\u7387\u6700\u9AD8\u7684\u4E24\u6B3E\u865A\u62DF\u673Ahotspot\u548CJRockit\uFF0C\u5E76\u4E14\u8BA1\u5212\u672A\u6765\u8FDB\u884C\u6574\u5408\uFF1AHotRockit\u3002</li><li>2011\u5E74\uFF0CJDK7\u53D1\u5E03\uFF0C\u5728JDK\uFF11.7\uFF554\u4E2D\uFF0C\u6B63\u5F0F\u542F\u7528\u4E86\u65B0\u7684\u5783\u573E\u56DE\u6536\u5668G1.</li><li>2017\u5E74\uFF0CJDK9\u53D1\u5E03\uFF0C\u5C06G1\u8BBE\u7F6E\u4E3A\u9ED8\u8BA4GC\uFF0C\u66FF\u4EE3CMS\u3002</li><li>2017\u540C\u5E74\uFF0CIBM\u7684J9\u5F00\u6E90\uFF0C\u5F62\u6210\u4E86\u73B0\u5728\u7684open J9\u793E\u533A\u3002</li><li>2018\u5E74\uFF0CAndroid\u7684Java\u4FB5\u6743\u6848\u5224\u51B3\uFF0CGoogle\u516C\u53F8\u8D54\u507FOracle\u603B\u8BA188\u4EBF\u7F8E\u5143\u3002</li><li>2018\u540C\u5E74\uFF0COracle\u5BA3\u5E03JavaEE\u6210\u4E3A\u5386\u53F2\u540D\u8BCD\uFF0CJDBC\u3001JMS\u3001Servlet\u8D60\u4E0EEclipse\u57FA\u91D1\u4F1A\u3002</li><li>2018\u540C\u5E74\uFF0CJDK11\u53D1\u5E03\uFF0CLTS\u7248\u672C\u7684JDK\uFF0C\u53D1\u5E03\u9769\u547D\u6027\u7684ZGC\uFF0C\u8C03\u6574JDK\u6388\u6743\u8BB8\u53EF\u3002</li><li>2019\u5E74\uFF0CJDK12\u53D1\u5E03\uFF0C\u52A0\u5165RedHat\u9886\u5BFC\u5F00\u53D1\u7684shenandoah GC\u3002</li><li>\u5728JDK11\u4E4B\u524D\uFF0COracleJDK\u8FD8\u4F1A\u5B58\u5728\u4E00\u4E9BopenJDK\u4E2D\u6CA1\u6709\u7684\u3001\u95ED\u6E90\u7684\u529F\u80FD\u3002\u4F46\u5728JDK11\u4E2D\uFF0CopenJDK\u548COracleJDK\u4EE3\u7801\u5B9E\u8D28\u4E0A\u5DF2\u7ECF\u8FBE\u5230\u5B8C\u5168\u4E00\u81F4\u7684\u7A0B\u5EA6\u3002</li></ul><h3 id="jvm\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#jvm\u4ECB\u7ECD" aria-hidden="true">#</a> JVM\u4ECB\u7ECD</h3><p>\u200B \u6240\u8C13\u865A\u62DF\u673A(Virtual Machine)\uFF0C\u5C31\u662F\u4E00\u53F0\u865A\u62DF\u7684\u8BA1\u7B97\u673A\u3002\u5B83\u662F\u4E00\u6B3E\u8F6F\u4EF6\uFF0C\u7528\u6765\u6267\u884C\u4E00\u7CFB\u5217\u865A\u62DF\u8BA1\u7B97\u673A\u6307\u4EE4\u3002\u5927\u4F53\u4E0A\uFF0C\u865A\u62DF\u673A\u53EF\u4EE5\u5206\u4E3A<strong>\u7CFB\u7EDF\u865A\u62DF\u673A</strong>\u548C<strong>\u7A0B\u5E8F\u865A\u62DF\u673A</strong>\u3002\u5927\u540D\u9F0E\u9F0E\u7684Visual Box,VMware\u5C31\u5C5E\u4E8E\u7CFB\u7EDF\u865A\u62DF\u673A\uFF0C\u5B83\u4EEC\u5B8C\u5168\u662F\u5BF9\u7269\u7406\u8BA1\u7B97\u673A\u7684\u4EFF\u771F\uFF0C\u63D0\u4F9B\u4E86\u4E00\u4E2A\u53EF\u8FD0\u884C\u5B8C\u6574\u64CD\u4F5C\u7CFB\u7EDF\u7684\u8F6F\u4EF6\u5E73\u53F0\u3002\u7A0B\u5E8F\u865A\u62DF\u673A\u7684\u5178\u578B\u4EE3\u8868\u5C31\u662FJava\u865A\u62DF\u673A\uFF0C\u5B83\u4E13\u95E8\u4E3A\u6267\u884C\u5355\u4E2A\u8BA1\u7B97\u673A\u7A0B\u5E8F\u800C\u8BBE\u8BA1\uFF0C\u5728Java\u865A\u62DF\u673A\u4E2D\u6267\u884C\u7684\u6307\u4EE4\u6211\u4EEC\u79F0\u4E3AJava\u5B57\u8282\u7801\u6307\u4EE4\u3002\u65E0\u8BBA\u662F\u7CFB\u7EDF\u865A\u62DF\u673A\u8FD8\u662F\u7A0B\u5E8F\u865A\u62DF\u673A\uFF0C\u5728\u4E0A\u9762\u8FD0\u884C\u7684\u8F6F\u4EF6\u90FD\u88AB\u9650\u5236\u4E8E\u865A\u62DF\u673A\u63D0\u4F9B\u7684\u8D44\u6E90\u4E2D\u3002</p><p>\u200B Java\u865A\u62DF\u673A\u662F\u4E00\u53F0\u6267\u884CJava\u5B57\u8282\u7801\u7684\u865A\u62DF\u8BA1\u7B97\u673A\uFF0C\u5B83\u62E5\u6709\u72EC\u7ACB\u7684\u8FD0\u884C\u673A\u5236,\u5176\u8FD0\u884C\u7684Java\u5B57\u8282\u7801\u4E5F\u672A\u5FC5\u7531Java\u8BED\u8A00\u7F16\u8BD1\u800C\u6210\u3002JVM\u5E73\u53F0\u7684\u5404\u79CD\u8BED\u8A00\u53EF\u4EE5\u5171\u4EABJava\u865A\u62DF\u673A\u5E26\u6765\u7684\u8DE8\u5E73\u53F0\u6027\u3001\u4F18\u79C0\u7684\u5783\u573E\u56DE\u5668\uFF0C\u4EE5\u53CA\u53EF\u9760\u7684\u5373\u65F6\u7F16\u8BD1\u5668\u3002Java\u6280\u672F\u7684\u6838\u5FC3\u5C31\u662FJava\u865A\u62DF\u673A\uFF08JVM\uFF0CJava Virtual Machine) ,\u56E0\u4E3A\u6240\u6709\u7684Java\u7A0B\u5E8F\u90FD\u8FD0\u884C\u5728Java\u865A\u62DF\u673A\u5185\u90E8\u3002</p><p>**\u4F5C\u7528\uFF1A**Java\u865A\u62DF\u673A\u5C31\u662F\u4E8C\u8FDB\u5236\u5B57\u8282\u7801\u7684\u8FD0\u884C\u73AF\u5883\uFF0C\u8D1F\u8D23\u88C5\u8F7D\u5B57\u8282\u7801\u5230\u5176\u5185\u90E8\uFF0C\u89E3\u91CA/\u7F16\u8BD1\u4E3A\u5BF9\u5E94\u5E73\u53F0\u4E0A\u7684\u673A\u5668\u6307\u4EE4\u6267\u884C\u3002\u6BCF\u4E00\u6761Java\u6307\u4EE4\uFF0CJava\u865A\u62DF\u673A\u89C4\u8303\u90FD\u6709\u8BE6\u7EC6\u5B9A\u4E49\uFF0C\u5982\u600E\u4E48\u53D6\u64CD\u4F5C\u6570\uFF0C\u600E\u4E48\u5904\u7406\u64CD\u4F5C\u6570\uFF0C\u5904\u7406\u7ED3\u679C\u653E\u5728\u54EA\u91CC\u3002 **\u7279\u70B9\uFF1A**\u4E00\u6B21\u7F16\u8BD1\uFF0C\u5230\u5904\u8FD0\u884C\uFF1B\u81EA\u52A8\u5185\u5B58\u7BA1\u7406\uFF1B\u81EA\u52A8\u5783\u573E\u56DE\u6536\u529F\u80FD</p><img src="http://qnimg.gisfsde.com/work/\u7B2C01\u7AE0_JVM\u8DE8\u8BED\u8A00\u7684\u5E73\u53F0.jpg" alt="\u7B2C01\u7AE0_JVM\u8DE8\u8BED\u8A00\u7684\u5E73\u53F0" style="zoom:50%;"><p><strong>\u4F4D\u7F6E\uFF1A</strong></p><img src="http://qnimg.gisfsde.com/work/\u7B2C01\u7AE0_JVM\u6240\u5904\u4F4D\u7F6E.jpg" alt="\u7B2C01\u7AE0_JVM\u6240\u5904\u4F4D\u7F6E" style="zoom:50%;"><img src="http://qnimg.gisfsde.com/work/image-20211111191323311.png" alt="image-20211111191323311" style="zoom:80%;"><h2 id="jvm\u6574\u4F53\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#jvm\u6574\u4F53\u7ED3\u6784" aria-hidden="true">#</a> JVM\u6574\u4F53\u7ED3\u6784</h2><img src="http://qnimg.gisfsde.com/work/\u7B2C02\u7AE0_JVM\u67B6\u6784-\u7B80\u56FE.jpg" alt="\u7B2C02\u7AE0_JVM\u67B6\u6784-\u7B80\u56FE" style="zoom:50%;"><img src="http://qnimg.gisfsde.com/work/\u7B2C02\u7AE0_JVM\u67B6\u6784-\u4E2D.jpg" alt="\u7B2C02\u7AE0_JVM\u67B6\u6784-\u4E2D" style="zoom:50%;"><img src="http://qnimg.gisfsde.com/work/\u7B2C02\u7AE0_JVM\u67B6\u6784-\u82F1.jpg" alt="\u7B2C02\u7AE0_JVM\u67B6\u6784-\u82F1" style="zoom:50%;"><h2 id="java\u4EE3\u7801\u6267\u884C\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#java\u4EE3\u7801\u6267\u884C\u6D41\u7A0B" aria-hidden="true">#</a> Java\u4EE3\u7801\u6267\u884C\u6D41\u7A0B</h2><p>\u200B <img src="http://qnimg.gisfsde.com/work/image-20211111192234413.png" alt="image-20211111192234413" loading="lazy"></p><h2 id="jvm\u67B6\u6784\u6A21\u578B" tabindex="-1"><a class="header-anchor" href="#jvm\u67B6\u6784\u6A21\u578B" aria-hidden="true">#</a> JVM\u67B6\u6784\u6A21\u578B</h2><p>Java\u7F16\u8BD1\u5668\u8F93\u5165\u7684\u6307\u4EE4\u6D41\u57FA\u672C\u4E0A\u662F\u4E00\u79CD<strong>\u57FA\u4E8E\u6808\u7684\u6307\u4EE4\u96C6\u67B6\u6784</strong>\uFF0C\u53E6\u5916\u4E00\u79CD\u6307\u4EE4\u96C6\u67B6\u6784\u5219\u662F\u57FA\u4E8E\u5BC4\u5B58\u5668\u7684\u6307\u4EE4\u96C6\u67B6\u6784\u3002</p><p><strong>\u533A\u522B:</strong></p><p><strong>\xB7\u57FA\u4E8E\u6808\u5F0F\u67B6\u6784\u7684\u7279\u70B9</strong> \u8BBE\u8BA1\u548C\u5B9E\u73B0\u66F4\u7B80\u5355\uFF0C\u9002\u7528\u4E8E\u8D44\u6E90\u53D7\u9650\u7684\u7CFB\u7EDF; \u907F\u5F00\u4E86\u5BC4\u5B58\u5668\u7684\u5206\u914D\u96BE\u9898:\u4F7F\u7528\u96F6\u5730\u5740\u6307\u4EE4\u65B9\u5F0F\u5206\u914D\u3002 \u6307\u4EE4\u6D41\u4E2D\u7684\u6307\u4EE4\u5927\u90E8\u5206\u662F\u96F6\u5730\u5740\u6307\u4EE4\uFF0C\u5176\u6267\u884C\u8FC7\u7A0B\u4F9D\u8D56\u4E8E\u64CD\u4F5C\u6808\u3002\u6307\u4EE4\u96C6\u66F4\u5C0F\uFF0C\u7F16\u8BD1\u5668\u5BB9\u6613\u5B9E\u73B0\u3002 \u4E0D\u9700\u8981\u786C\u4EF6\u652F\u6301\uFF0C\u53EF\u79FB\u690D\u6027\u66F4\u597D\uFF0C\u66F4\u597D\u5B9E\u73B0\u8DE8\u5E73\u53F0</p><p><strong>\u57FA\u4E8E\u5BC4\u5B58\u5668\u67B6\u6784\u7684\u7279\u70B9</strong> \u5178\u578B\u7684\u5E94\u7528\u662Fx86\u7684\u4E8C\u8FDB\u5236\u6307\u4EE4\u96C6:\u6BD4\u5982\u4F20\u7EDF\u7684PC\u4EE5\u53CAAndroid\u7684Davlik\u865A\u62DF\u673A\u3002 \u6307\u4EE4\u96C6\u67B6\u6784\u5219\u5B8C\u5168\u4F9D\u8D56\u786C\u4EF6,\u53EF\u79FB\u690D\u6027\u5DEE \u6027\u80FD\u4F18\u79C0\u548C\u6267\u884C\u66F4\u9AD8\u6548; \u82B1\u8D39\u66F4\u5C11\u7684\u6307\u4EE4\u53BB\u5B8C\u6210\u4E00\u9879\u64CD\u4F5C\u3002 \u5728\u5927\u90E8\u5206\u60C5\u51B5\u4E0B\uFF0C\u57FA\u4E8E\u5BC4\u5B58\u5668\u67B6\u6784\u7684\u6307\u4EE4\u96C6\u5F80\u5F80\u90FD\u4EE5\u4E00\u5730\u5740\u6307\u4EE4\u3001\u4E8C\u5730\u5740\u6307\u4EE4\u548C\u4E09\u5730\u5740\u6307\u4EE4\u4E3A\u4E3B\uFF0C\u800C\u57FA\u4E8E\u6808\u5F0F\u67B6\u6784\u7684\u6307\u4EE4\u96C6\u5374\u662F\u4EE5\u96F6\u5730\u5740\u6307\u4EE4\u4E3A\u4E3B\u3002</p><p><strong>\u603B\u7ED3:</strong> \u7531\u4E8E\u8DE8\u5E73\u53F0\u6027\u7684\u8BBE\u8BA1\uFF0CJava\u7684\u6307\u4EE4\u90FD\u662F\u6839\u636E\u6808\u6765\u8BBE\u8BA1\u7684\u3002\u4E0D\u540C\u5E73\u53F0CPU\u67B6\u6784\u4E0D\u540C\uFF0C\u6240\u4EE5\u4E0D\u80FD\u8BBE\u8BA1\u4E3A\u57FA\u4E8E\u5BC4\u5B58\u5668\u7684\u3002\u4F18\u70B9\u662F\u8DE8\u5E73\u53F0\uFF0C\u6307\u4EE4\u96C6\u5C0F\uFF0C\u7F16\u8BD1\u5668\u5BB9\u6613\u5B9E\u73B0\uFF0C\u7F3A\u70B9\u662F\u6027\u80FD\u4E0B\u964D\uFF0C\u5B9E\u73B0\u540C\u6837\u7684\u529F\u80FD\u9700\u8981\u66F4\u591A\u7684\u6307\u4EE4\u3002\u65F6\u81F3\u4ECA\u65E5\uFF0C\u5C3D\u7BA1\u5D4C\u5165\u5F0F\u5E73\u53F0\u5DF2\u7ECF\u4E0D\u662FJava\u7A0B\u5E8F\u7684\u4E3B\u6D41\u8FD0\u884C\u5E73\u53F0\u4E86\uFF08\u51C6\u786E\u7684\u6765\u8BF4HotSpotVM\u7684\u5BBF\u4E3B\u73AF\u5883\u5DF2\u7ECF\u4E0D\u5C40\u9650\u4E8E\u5D4C\u5165\u5F0F\u5E73\u53F0\u4E86)\uFF0C\u90A3\u4E48\u4E3A\u4EC0\u4E48\u4E0D\u5C06\u67B6\u6784\u66F4\u6362\u4E3A\u57FA\u4E8E\u5BC4\u5B58\u5668\u7684\u67B6\u6784\u5462? \u6808: \u8DE8\u5E73\u53F0\u6027\u3001\u6307\u4EE4\u96C6\u5C0F\u3001\u6307\u4EE4\u591A;\u6267\u884C\u6027\u80FD\u6BD4\u5BC4\u5B58\u5668\u5DEE</p><h2 id="jvm\u751F\u547D\u5468\u671F" tabindex="-1"><a class="header-anchor" href="#jvm\u751F\u547D\u5468\u671F" aria-hidden="true">#</a> JVM\u751F\u547D\u5468\u671F</h2><h3 id="\u542F\u52A8" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8" aria-hidden="true">#</a> \u542F\u52A8</h3><p>Java\u865A\u62DF\u673A\u7684\u542F\u52A8\u662F\u901A\u8FC7<strong>\u5F15\u5BFC\u7C7B\u52A0\u8F7D\u5668(bootstrap class loader)<strong>\u521B\u5EFA\u4E00\u4E2A</strong>\u521D\u59CB\u7C7B</strong>(initial class)\u6765\u5B8C\u6210\u7684\uFF0C\u8FD9\u4E2A\u7C7B\u662F\u7531\u865A\u62DF\u673A\u7684\u5177\u4F53\u5B9E\u73B0\u6307\u5B9A\u7684</p><h3 id="\u6267\u884C" tabindex="-1"><a class="header-anchor" href="#\u6267\u884C" aria-hidden="true">#</a> \u6267\u884C</h3><p>\u4E00\u4E2A\u8FD0\u884C\u4E2D\u7684Java\u865A\u62DF\u673A\u6709\u7740\u4E00\u4E2A\u6E05\u6670\u7684\u4EFB\u52A1:\u6267\u884CJava\u7A0B\u5E8F\u3002 \u7A0B\u5E8F\u5F00\u59CB\u6267\u884C\u65F6\u4ED6\u624D\u8FD0\u884C\uFF0C\u7A0B\u5E8F\u7ED3\u675F\u65F6\u4ED6\u5C31\u505C\u6B62\u3002 \u6267\u884C\u4E00\u4E2A\u6240\u8C13\u7684Java\u7A0B\u5E8F\u7684\u65F6\u5019\uFF0C\u771F\u771F\u6B63\u6B63\u5728\u6267\u884C\u7684\u662F\u4E00\u4E2A\u53EB\u505A<strong>Java\u865A\u62DF\u673A\u7684\u8FDB\u7A0B</strong>\u3002</p><h3 id="\u9000\u51FA" tabindex="-1"><a class="header-anchor" href="#\u9000\u51FA" aria-hidden="true">#</a> \u9000\u51FA</h3><p>\u6709\u5982\u4E0B\u7684\u51E0\u79CD\u60C5\u51B5:\u3002\u7A0B\u5E8F\u6B63\u5E38\u6267\u884C\u7ED3\u675F \xB7\u7A0B\u5E8F\u5728\u6267\u884C\u8FC7\u7A0B\u4E2D\u9047\u5230\u4E86\u5F02\u5E38\u6216\u9519\u8BEF\u800C\u5F02\u5E38\u7EC8\u6B62\xB7\u7531\u4E8E\u64CD\u4F5C\u7CFB\u7EDF\u51FA\u73B0\u9519\u8BEF\u800C\u5BFC\u81F4Java\u865A\u62DF\u673A\u8FDB\u7A0B\u7EC8\u6B62 \xB7\u67D0\u7EBF\u7A0B\u8C03\u7528Runtime\u7C7B\u6216system\u7C7B\u7684exit\u65B9\u6CD5\uFF0C\u6216Runtime\u7C7B\u7684halt\u65B9\u6CD5\uFF0C\u5E76\u4E14Java\u5B89\u5168\u7BA1\u7406\u5668\u4E5F\u5141\u8BB8\u8FD9\u6B21exit\u6216halt\u64CD\u4F5C\u3002 \xB7\u9664\u6B64\u4E4B\u5916\uFF0CJNI ( Java Native Interface)\u89C4\u8303\u63CF\u8FF0\u4E86\u7528JNI Invocation API\u6765\u52A0\u8F7D\u6216\u5378\u8F7DJava\u865A\u62DF\u673A\u65F6\uFF0CJava\u865A\u62DF\u673A\u7684\u9000\u51FA\u60C5\u51B5\u3002</p><h2 id="jvm\u53D1\u5C55\u5386\u7A0B" tabindex="-1"><a class="header-anchor" href="#jvm\u53D1\u5C55\u5386\u7A0B" aria-hidden="true">#</a> JVM\u53D1\u5C55\u5386\u7A0B</h2><h3 id="sun-classic-vm" tabindex="-1"><a class="header-anchor" href="#sun-classic-vm" aria-hidden="true">#</a> SUN Classic VM</h3><p>\xB7\u65E9\u57281996\u5E74Java1.0\u7248\u672C\u7684\u65F6\u5019\uFF0Csun\u516C\u53F8\u53D1\u5E03\u4E86\u4E00\u6B3E\u540D\u4E3ASun Classic VM\u7684Java\u865A\u62DF\u673A\uFF0C\u5B83\u540C\u65F6\u4E5F\u662F\u4E16\u754C\u4E0A\u7B2C\u4E00\u6B3E\u5546\u7528Java\u865A\u62DF\u673A\uFF0CJDK1.4\u65F6\u5B8C\u5168\u88AB\u6DD8\u6C70\u3002 \xB7\u8FD9\u6B3E\u865A\u62DF\u673A\u5185\u90E8\u53EA\u63D0\u4F9B\u89E3\u91CA\u5668\u3002 \xB7\u5982\u679C\u4F7F\u7528JIT\u7F16\u8BD1\u5668\uFF0C\u5C31\u9700\u8981\u8FDB\u884C\u5916\u6302\u3002\u4F46\u662F\u4E00\u65E6\u4F7F\u7528\u4E86JIT\u7F16\u8BD1\u5668JIT\u5C31\u4F1A\u63A5\u7BA1\u865A\u62DF\u673A\u7684\u6267\u884C\u7CFB\u7EDF\u3002\u89E3\u91CA\u5668\u5C31\u4E0D\u518D\u5DE5\u4F5C\u3002\u89E3\u91CA\u5668\u548C\u7F16\u8BD1\u5668\u4E0D\u80FD\u914D\u5408\u5DE5\u4F5C\u3002 \xB7\u73B0\u5728hotspot\u5185\u7F6E\u4E86\u6B64\u865A\u62DF\u673A\u3002</p><h3 id="exact-vm" tabindex="-1"><a class="header-anchor" href="#exact-vm" aria-hidden="true">#</a> Exact VM</h3><p>\xB7\u4E3A\u4E86\u89E3\u51B3\u4E0A\u4E00\u4E2A\u865A\u62DF\u673A\u95EE\u9898\uFF0Cjdk1.2\u65F6\uFF0Csun\u63D0\u4F9B\u4E86\u6B64\u865A\u62DF\u673A\u3002 Exact Memory Management:\u51C6\u786E\u5F0F\u5185\u5B58\u7BA1\u7406 \xB7\u4E5F\u53EF\u4EE5\u53EBNon-conservative/Accurate Memory Management\uFF1A\u865A\u62DF\u673A\u53EF\u4EE5\u77E5\u9053\u5185\u5B58\u4E2D\u67D0\u4E2A\u4F4D\u7F6E\u7684\u6570\u636E\u5177\u4F53\u662F\u4EC0\u4E48\u7C7B\u578B\u3002 \u5177\u5907\u73B0\u4EE3\u9AD8\u6027\u80FD\u865A\u62DF\u673A\u7684\u96CF\u5F62 \xB7\u70ED\u70B9\u63A2\u6D4B \xB7\u7F16\u8BD1\u5668\u4E0E\u89E3\u91CA\u5668\u6DF7\u5408\u5DE5\u4F5C\u6A21\u5F0FI \u53EA\u5728solaris\u5E73\u53F0\u77ED\u6682\u4F7F\u7528\uFF0C\u5176\u4ED6\u5E73\u53F0\u4E0A\u8FD8\u662Fclassic vm \xB7\u82F1\u96C4\u6C14\u77ED\uFF0C\u7EC8\u88ABHotspot\u865A\u62DF\u673A\u66FF\u6362</p><h3 id="sun\u516C\u53F8\u7684-hotspot-vm" tabindex="-1"><a class="header-anchor" href="#sun\u516C\u53F8\u7684-hotspot-vm" aria-hidden="true">#</a> <strong>SUN\u516C\u53F8\u7684 HotSpot VM</strong></h3><h4 id="hotspot\u5386\u53F2" tabindex="-1"><a class="header-anchor" href="#hotspot\u5386\u53F2" aria-hidden="true">#</a> HotSpot\u5386\u53F2</h4><p>\xB7\u6700\u521D\u7531\u4E00\u5BB6\u540D\u4E3A\u201CLongview Technologies&quot;\u7684\u5C0F\u516C\u53F8\u8BBE\u8BA11997\u5E74\uFF0C\u6B64\u516C\u53F8\u88ABsun\u6536\u8D2D;2009\u5E74\uFF0Csun\u516C\u53F8\u88AB\u7532\u9AA8\u6587\u6536\u8D2D\u3002 \xB7JDK1.3\u65F6\uFF0CHotSpot VM\u6210\u4E3A\u9ED8\u8BA4\u865A\u62DF\u673A \xB7\u76EE\u524DHotspot\u5360\u6709\u7EDD\u5BF9\u7684\u5E02\u573A\u5730\u4F4D\uFF0C\u79F0\u9738\u6B66\u6797\u3002 \u4E0D\u7BA1\u662F\u73B0\u5728\u4ECD\u5728\u5E7F\u6CDB\u4F7F\u7528\u7684JDK6\uFF0C\u8FD8\u662F\u4F7F\u7528\u6BD4\u4F8B\u8F83\u591A\u7684JDK8\u4E2D\uFF0C\u9ED8\u8BA4\u7684\u865A\u62DF\u673A\u90FD\u662FHotSpot sun/ oracle JDK \u548C OpenJDK\u7684\u9ED8\u8BA4\u865A\u62DF\u673A \u56E0\u6B64\u672C\u8BFE\u7A0B\u4E2D\u9ED8\u8BA4\u4ECB\u7ECD\u7684\u865A\u62DF\u673A\u90FD\u662FHotSpot\uFF0C\u76F8\u5173\u673A\u5236\u4E5F\u4E3B\u8981\u662F\u6307HotSpot\u7684GC\u673A\u5236\u3002(\u6BD4\u5982\u5176\u4ED6\u4E24\u4E2A\u5546\u7528\u865A\u62DF\u673A\u90FD\u6CA1\u6709\u65B9\u6CD5\u533A\u7684\u6982\u5FF5) \xB7\u4ECE\u670D\u52A1\u5668\u3001\u684C\u9762\u5230\u79FB\u52A8\u7AEF\u3001\u5D4C\u5165\u5F0F\u90FD\u6709\u5E94\u7528\u3002 \xB7\u540D\u79F0\u4E2D\u7684HotSpot\u6307\u7684\u5C31\u662F\u5B83\u7684\u70ED\u70B9\u4EE3\u7801\u63A2\u6D4B\u6280\u672F\u3002 \u901A\u8FC7\u8BA1\u6570\u5668\u627E\u5230\u6700\u5177\u7F16\u8BD1\u4EF7\u503C\u4EE3\u7801\uFF0C\u89E6\u53D1\u5373\u65F6\u7F16\u8BD1\u6216\u6808\u4E0A\u66FF\u6362 \u901A\u8FC7\u7F16\u8BD1\u5668\u4E0E\u89E3\u91CA\u5668\u534F\u540C\u5DE5\u4F5C\uFF0C\u5728\u6700\u4F18\u5316\u7684\u7A0B\u5E8F\u54CD\u5E94\u65F6\u95F4\u4E0E\u6700\u4F73\u6267\u884C\u6027\u80FD\u4E2D\u53D6\u5F97\u5E73\u8861</p><h3 id="bea-\u7684jrockit" tabindex="-1"><a class="header-anchor" href="#bea-\u7684jrockit" aria-hidden="true">#</a> BEA \u7684JRockit</h3><p>\xB7\u4E13\u6CE8\u4E8E\u670D\u52A1\u5668\u7AEF\u5E94\u7528 \u5B83\u53EF\u4EE5\u4E0D\u592A\u5173\u6CE8\u7A0B\u5E8F\u542F\u52A8\u901F\u5EA6\uFF0C\u56E0\u6B64JRockit\u5185\u90E8\u4E0D\u5305\u542B\u89E3\u6790\u5668\u5B9E\u73B0\uFF0C\u5168\u90E8\u4EE3\u7801\u90FD\u9760\u5373\u65F6\u7F16\u8BD1\u5668\u7F16\u8BD1\u540E\u6267\u884C\u3002 \xB7\u5927\u91CF\u7684\u884C\u4E1A\u57FA\u51C6\u6D4B\u8BD5\u663E\u793A\uFF0CJRockit JVM\u662F\u4E16\u754C\u4E0A\u6700\u5FEB\u7684JVM\u3002 \u4F7F\u7528JRockit\u4EA7\u54C1\uFF0C\u5BA2\u6237\u5DF2\u7ECF\u4F53\u9A8C\u5230\u4E86\u663E\u8457\u7684\u6027\u80FD\u63D0\u9AD8\uFF08\u4E00\u4E9B\u8D85\u8FC7\u4E8670% \uFF09\u548C\u786C\u4EF6\u6210\u672C\u7684\u51CF\u5C11(\u8FBE50%\uFF09\u3002 \xB7\u4F18\u52BF:\u5168\u9762\u7684Java\u8FD0\u884C\u65F6\u89E3\u51B3\u65B9\u6848\u7EC4\u5408 JRockit\u9762\u5411\u5EF6\u8FDF\u654F\u611F\u578B\u5E94\u7528\u7684\u89E3\u51B3\u65B9\u6848JRockit Real Time\u63D0\u4F9B\u4EE5\u6BEB\u79D2\u6216\u5FAE\u79D2\u7EA7\u7684JVM\u54CD\u5E94\u65F6\u95F4\uFF0C\u9002\u5408\u8D22\u52A1\u3001\u519B\u4E8B\u6307\u6325\u3001\u7535\u4FE1\u7F51\u7EDC\u7684\u9700\u8981MissionControl\u670D\u52A1\u5957\u4EF6\uFF0C\u5B83\u662F\u4E00\u7EC4\u4EE5\u6781\u4F4E\u7684\u5F00\u9500\u6765\u76D1\u63A7\u3001\u7BA1\u7406\u548C\u5206\u6790\u751F\u4EA7\u73AF\u5883\u4E2D\u7684\u5E94\u7528\u7A0B\u5E8F\u7684\u5DE5\u5177\u3002 2008\u5E74\uFF0CBEA\u88ABoracle\u6536\u8D2D\u3002 oracle\u8868\u8FBE\u4E86\u6574\u5408\u4E24\u5927\u4F18\u79C0\u865A\u62DF\u673A\u7684\u5DE5\u4F5C\uFF0C\u5927\u81F4\u5728JDK 8\u4E2D\u5B8C\u6210\u3002\u6574\u5408\u7684\u65B9\u5F0F\u662F\u5728HotSpot\u7684\u57FA\u7840\u4E0A\uFF0C\u79FB\u690DJRockit\u7684\u4F18\u79C0\u7279\u6027\u3002 \xB7\u9AD8\u65AF\u6797:\u76EE\u524D\u5C31\u804C\u4E8E\u8C37\u6B4C\uFF0C\u7814\u7A76\u4EBA\u5DE5\u667A\u80FD\u548C\u6C34\u4E0B\u673A\u5668\u4EBA</p><h3 id="ibm-\u7684j9" tabindex="-1"><a class="header-anchor" href="#ibm-\u7684j9" aria-hidden="true">#</a> IBM \u7684J9</h3><p>\u5168\u79F0:IBM Technology for Java virtual Machine\uFF0C\u7B80\u79F0IT4J\uFF0C\u5185\u90E8\u4EE3\u53F7:J9 \xB7\u5E02\u573A\u5B9A\u4F4D\u4E0EHotSpot\u63A5\u8FD1\uFF0C\u670D\u52A1\u5668\u7AEF\u3001\u684C\u9762\u5E94\u7528\u3001\u5D4C\u5165\u5F0F\u7B49\u591A\u7528\u9014VM\u3002 \xB7\u5E7F\u6CDB\u7528\u4E8EIBM\u7684\u5404\u79CDJava\u4EA7\u54C1\u3002 \xB7\u76EE\u524D\uFF0C\u6709\u5F71\u54CD\u529B\u7684\u4E09\u5927\u5546\u7528\u865A\u62DF\u673A\u4E4B\u4E00\uFF0C\u4E5F\u53F7\u79F0\u662F\u4E16\u754C\u4E0A\u6700\u5FEB\u7684Java\u865A\u62DF\u673A\u3002 \xB72017\u5E74\u5DE6\u53F3\uFF0CIBM\u53D1\u5E03\u4E86\u5F00\u6E90J9 VM\uFF0C\u547D\u540D\u4E3AopenJ9\uFF0C\u4EA4\u7ED9Eclipse\u57FA\u91D1\u4F1A\u7BA1\u7406\uFF0C\u4E5F\u79F0\u4E3AEclipse OpenJ9</p><h3 id="kvm\u548Ccdc-cl-dc-hotspot" tabindex="-1"><a class="header-anchor" href="#kvm\u548Ccdc-cl-dc-hotspot" aria-hidden="true">#</a> KVM\u548CcDC/CL.DC Hotspot</h3><p>oracle\u5728Java ME\u4EA7\u54C1\u7EBF\u4E0A\u7684\u4E24\u6B3E\u865A\u62DF\u673A\u4E3A:CDC/CLDC HotSpot Implementation VM KVM (Kilobyte\uFF09\u662FCLDC-HI\u65E9\u671F\u4EA7\u54C1 \xB7\u76EE\u524D\u79FB\u52A8\u9886\u57DF\u5730\u4F4D\u5C34\u5C2C\uFF0C\u667A\u80FD\u624B\u673A\u88ABAndroid\u548CioS\u4E8C\u5206\u5929\u4E0B\u3002 .KVM\u7B80\u5355\u3001\u8F7B\u91CF\u3001\u9AD8\u5EA6\u53EF\u79FB\u690D\uFF0C\u9762\u5411\u66F4\u4F4E\u7AEF\u7684\u8BBE\u5907\u4E0A\u8FD8\u7EF4\u6301\u81EA\u5DF1\u7684\u4E00\u7247\u5E02\u573A \u667A\u80FD\u63A7\u5236\u5668\u3001\u4F20\u611F\u5668\u8001\u4EBA\u624B\u673A\u3001\u7ECF\u6D4E\u6B20\u53D1\u8FBE\u5730\u533A\u7684\u529F\u80FD\u624B\u673A .\u6240\u6709\u7684\u865A\u62DF\u673A\u7684\u539F\u5219:\u4E00\u6B21\u7F16\u8BD1\uFF0C\u5230\u5904\u8FD0\u884C\u3002</p><h3 id="azul-vm" tabindex="-1"><a class="header-anchor" href="#azul-vm" aria-hidden="true">#</a> Azul VM</h3><p>\xB7\u524D\u9762\u4E09\u5927\u201C\u9AD8\u6027\u80FDJava\u865A\u62DF\u673A\u201D\u4F7F\u7528\u5728\u901A\u7528\u786C\u4EF6\u5E73\u53F0\u4E0A \xB7\u8FD9\u91CCAzul VM\u548CBEA Liquid VM\u662F\u4E0E\u7279\u5B9A\u786C\u4EF6\u5E73\u53F0\u7ED1\u5B9A\u3001\u8F6F\u786C\u4EF6\u914D\u5408\u7684\u4E13\u6709\u865A\u62DF\u673A \u9AD8\u6027\u80FDJava\u865A\u62DF\u673A\u4E2D\u7684\u6218\u6597\u673A\u3002 Azul VM\u662FAzul systems\u516C\u53F8\u5728HotSpot\u57FA\u7840\u4E0A\u8FDB\u884C\u5927\u91CF\u6539\u8FDB\uFF0C\u8FD0\u884C\u4E8EAzul systems\u516C\u53F8\u7684\u4E13\u6709\u786C\u4EF6vega\u7CFB\u7EDF\u4E0A\u7684Java\u865A\u62DF\u673A\u3002 \xB7\u6BCF\u4E2AAzul VM\u5B9E\u4F8B\u90FD\u53EF\u4EE5\u7BA1\u7406\u81F3\u5C11\u6570\u5341\u4E2ACPU\u548C\u6570\u767EGB\u5185\u5B58\u7684\u786C\u4EF6\u8D44\u6E90\uFF0C\u5E76\u63D0\u4F9B\u5728\u5DE8\u5927\u5185\u5B58\u8303\u56F4\u5185\u5B9E\u73B0\u53EF\u63A7\u7684GC\u65F6\u95F4\u7684\u5783\u573E\u6536\u96C6\u5668\u3001\u4E13\u6709\u786C\u4EF6\u4F18\u5316\u7684\u7EBF\u7A0B\u8C03\u5EA6\u7B49\u4F18\u79C0\u7279\u6027\u3002 2010\u5E74\uFF0CAzul systems\u516C\u53F8\u5F00\u59CB\u4ECE\u786C\u4EF6\u8F6C\u5411\u8F6F\u4EF6\uFF0C\u53D1\u5E03\u4E86\u81EA\u5DF1\u7684ZingJVM\uFF0C\u53EF\u4EE5\u5728\u901A\u7528x86\u5E73\u53F0\u4E0A\u63D0\u4F9B\u63A5\u8FD1\u4E8EVega\u7CFB\u7EDF\u7684\u7279\u6027\u3002</p><h3 id="liquid-vm" tabindex="-1"><a class="header-anchor" href="#liquid-vm" aria-hidden="true">#</a> Liquid VM</h3><p>\xB7\u9AD8\u6027\u80FDJava\u865A\u62DF\u673A\u4E2D\u7684\u6218\u6597\u673A\u3002 \xB7BEA\u516C\u53F8\u5F00\u53D1\u7684\uFF0C\u76F4\u63A5\u8FD0\u884C\u5728\u81EA\u5BB6Hypervisor\u7CFB\u7EDF\u4E0A \xB7Liquid VM\u5373\u662F\u73B0\u5728\u7684JRockit VE(Virtual Edition\uFF09 ,LiquidVM\u4E0D\u9700\u8981\u64CD\u4F5C\u7CFB\u7EDF\u7684\u652F\u6301\uFF0C\u6216\u8005\u8BF4\u5B83\u81EA\u5DF1\u672C\u8EAB\u5B9E\u73B0\u4E86\u4E00\u4E2A\u4E13\u7528\u64CD\u4F5C\u7CFB\u7EDF\u7684\u5FC5\u8981\u529F\u80FD\uFF0C\u5982\u7EBF\u7A0B\u8C03\u5EA6\u3001\u6587\u4EF6\u7CFB\u7EDF\u3001\u7F51\u7EDC\u652F\u6301\u7B49\u3002 \xB7\u968F\u7740JRockit\u865A\u62DF\u673A\u7EC8\u6B62\u5F00\u53D1\uFF0CLiquid VM\u9879\u76EE\u4E5F\u505C\u6B62\u4E86\u3002</p><h3 id="apache-harmony" tabindex="-1"><a class="header-anchor" href="#apache-harmony" aria-hidden="true">#</a> Apache Harmony</h3><p>Apache\u4E5F\u66FE\u7ECF\u63A8\u51FA\u8FC7\u4E0EJDK 1.5\u548CJDK 1.6\u517C\u5BB9\u7684Java\u8FD0\u884C\u5E73\u53F0Apache Harmony\u3002 \xB7\u5B83\u662FIBM\u548CIntel\u8054\u5408\u5F00\u53D1\u7684\u5F00\u6E90JVM\uFF0C\u53D7\u5230\u540C\u6837\u5F00\u6E90\u7684openJDK\u7684\u538B\u5236\uFF0Csun\u575A\u51B3\u4E0D\u8BA9Harmony\u83B7\u5F97JCP\u8BA4\u8BC1\uFF0C\u6700\u7EC8\u4E8E2011\u5E74\u9000\u5F79\uFF0CIBM\u8F6C\u800C\u53C2\u4E0EOpenJDK \xB7\u867D\u7136\u76EE\u524D\u5E76\u6CA1\u6709Apache Harmony\u88AB\u5927\u89C4\u6A21\u5546\u7528\u7684\u6848\u4F8B\uFF0C\u4F46\u662F\u5B83\u7684Java\u7C7B\u5E93\u4EE3\u7801\u5438\u7EB3\u8FDB\u4E86Android SDK\u3002</p><h3 id="microsoft-jvm" tabindex="-1"><a class="header-anchor" href="#microsoft-jvm" aria-hidden="true">#</a> Microsoft JVM</h3><p>\xB7\u5FAE\u8F6F\u4E3A\u4E86\u5728IE3\u6D4F\u89C8\u5668\u4E2D\u652F\u6301Java Applets\uFF0C\u5F00\u53D1\u4E86Microsoft JVM\u3002\xB7\u53EA\u80FD\u5728window\u5E73\u53F0\u4E0B\u8FD0\u884C\u3002\u4F46\u786E\u662F\u5F53\u65F6windows\u4E0B\u6027\u80FD\u6700\u597D\u7684Java VM.. 1997\u5E74\uFF0Csun\u4EE5\u4FB5\u72AF\u5546\u6807\u3001\u4E0D\u6B63\u5F53\u7ADE\u4E89\u7F6A\u540D\u6307\u63A7\u5FAE\u8F6F\u6210\u529F\uFF0C\u8D54\u4E86sun\u5F88\u591A\u94B1\u3002\u5FAE\u8F6F\u5728windowsXP SP3\u4E2D\u62B9\u6389\u4E86\u5176VM\u3002\u73B0\u5728windows\u4E0A\u5B89\u88C5\u7684jdk\u90FD\u662FHotSpot\u3002</p><h3 id="taobaojvm" tabindex="-1"><a class="header-anchor" href="#taobaojvm" aria-hidden="true">#</a> TaobaoJVM</h3><p>\xB7\u7531AliJVM\u56E2\u961F\u53D1\u5E03\u3002\u963F\u91CC\uFF0C\u56FD\u5185\u4F7F\u7528Java\u6700\u5F3A\u5927\u7684\u516C\u53F8\uFF0C\u8986\u76D6\u4E91\u8BA1\u7B97\u3001\u91D1\u96F7\u751F\u5207\u4E00\u7535\u5546\u7B49\u4F17\u591A\u9886\u57DF\uFF0C\u9700\u8981\u89E3\u51B3\u9AD8\u5E76\u53D1\u3001\u9AD8\u53EF\u7528\u3001\u5206\u5E03\u5F0F\u7684\u590D\u5408\u95EE\u9898\u3002\u6709\u5927\u91CD\u7684\u5F00\u6E90\u5E7F\u7684\u3002 \xB7\u57FA\u4E8EopenJDK\u5F00\u53D1\u4E86\u81EA\u5DF1\u7684\u5B9A\u5236\u7248\u672CAlibabaJDK\uFF0C\u7B80\u79F0AJDK\u3002\u662F\u6574\u4E2A\u963F\u91CCJava\u4F53\u7CFB\u7684\u57FA\u77F3\u3002 \xB7\u57FA\u4E8EopenJDK HotSpot VM \u53D1\u5E03\u7684\u56FD\u5185\u7B2C\u4E00\u4E2A\u4F18\u5316\u3001\u6DF1\u5EA6\u5B9A\u5236\u4E14\u5F00\u6E90\u7684\u9AD8\u6027\u80FD\u670D\u52A1\u5668\u7248Java\u865A\u62DF\u673A\u3002 \u521B\u65B0\u7684GCIH (GC invisible heap \uFF09\u6280\u672F\u5B9E\u73B0\u4E86off-heap \uFF0C\u5373\u5C06\u751F\u547D\u5468\u671F\u8F83\u957F\u7684Java\u5BF9\u8C61\u4ECEheap\u4E2D\u79FB\u5230heap\u4E4B\u5916\uFF0C\u5E76\u4E14GC\u4E0D\u80FD\u7BA1\u7406GCIH\u5185\u90E8\u7684Java \u5BF9\u8C61\uFF0C\u4EE5\u6B64\u8FBE\u5230\u964D\u4F4EGC\u7684\u56DE\u6536\u9891\u7387\u548C\u63D0\u5347GC \u7684\u56DE\u6536\u6548\u7387\u7684\u76EE\u7684\u3002 GCIH \u4E2D\u7684\u5BF9\u8C61\u8FD8\u80FD\u591F\u5728\u591A\u4E2AJava\u865A\u62DF\u673A\u8FDB\u7A0B\u4E2D\u5B9E\u73B0\u5171\u4EAB \u4F7F\u7528crc32\u6307\u4EE4\u5B9E\u73B0JVM intrinsic\u964D\u4F4EJNI \u7684\u8C03\u7528\u5F00\u9500 PMU hardware \u7684Java profiling tool\u548C\u8BCA\u65AD\u534F\u52A9\u529F\u80FD \u9488\u5BF9\u5927\u6570\u636E\u573A\u666F\u7684ZenGC . taobao vm\u5E94\u7528\u5728\u963F\u91CC\u4EA7\u54C1\u4E0A\u6027\u80FD\u9AD8\uFF0C\u786C\u4EF6\u4E25\u91CD\u4F9D\u8D56intel\u7684cpu\uFF0C\u635F\u5931\u4E86\u517C\u5BB9\u6027\uFF0C\u4F46\u63D0\u9AD8\u4E86\u6027\u80FD \u76EE\u524D\u5DF2\u7ECF\u5728\u6DD8\u5B9D\u3001\u5929\u732B\u4E0A\u7EBF\uFF0C\u628Aoracle \u5B98\u65B9JVM\u7248\u672C\u5168\u90E8\u66FF\u6362\u4E86\u3002</p><h3 id="dalvik-vm" tabindex="-1"><a class="header-anchor" href="#dalvik-vm" aria-hidden="true">#</a> Dalvik VM :</h3><p>\xB7\u8C37\u6B4C\u5F00\u53D1\u7684\uFF0C\u5E94\u7528\u4E8EAndroid\u7CFB\u7EDF\uFF0C\u5E76\u5728Android2.2\u4E2D\u63D0\u4F9B\u4E86JIT\uFF0C\u53D1\u5C55\u8FC5\u731B\u3002.Dalvik VM\u53EA\u80FD\u79F0\u4F5C\u865A\u62DF\u673A\uFF0C\u800C\u4E0D\u80FD\u79F0\u4F5C\u201CJava\u865A\u62DF\u673A\u201D\uFF0C\u5B83\u6CA1\u6709\u9075\u5FAA Java\u865A\u62DF\u673A\u89C4\u8303 \xB7\u4E0D\u80FD\u76F4\u63A5\u6267\u884CJava \u7684class \u6587\u4EF6\xB7\u57FA\u4E8E\u5BC4\u5B58\u5668\u67B6\u6784\uFF0C\u4E0D\u662Fjvm\u7684\u6808\u67B6\u6784\u3002 \xB7\u6267\u884C\u7684\u662F\u7F16\u8BD1\u4EE5\u540E\u7684dex(Dalvik Executable\uFF09\u6587\u4EF6\u3002\u6267\u884C\u6548\u7387\u6BD4\u8F83\u9AD8 \u5B83\u6267\u884C\u7684dex (Dalvik Executable\uFF09\u6587\u4EF6\u53EF\u4EE5\u901A\u8FC7class\u6587\u4EF6\u8F6C\u5316\u800C\u6765\uFF0C\u4F7F\u7528Java\u8BED\u6CD5\u7F16\u5199\u5E94\u7528\u7A0B\u5E8F\uFF0C\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u5927\u90E8\u5206\u7684Java API\u7B49\u3002 \xB7Android 5.0\u4F7F\u7528\u652F\u6301\u63D0\u524D\u7F16\u8BD1(Ahead of Time Compilation\uFF0CAOT\uFF09\u7684ARTVM\u66FF\u6362Dalvik VM\u3002</p><h3 id="graal-vm" tabindex="-1"><a class="header-anchor" href="#graal-vm" aria-hidden="true">#</a> Graal VM</h3><p>. 2018\u5E744\u6708\uFF0Coracle Labs\u516C\u5F00\u4E86Graal VM\uFF0C\u53F7\u79F0&quot;Run Programs Faster Anywhere&quot;\uFF0C\u52C3\u52C3\u91CE\u5FC3\u3002\u4E0E1995\u5E74java\u7684\u201Dwrite once\uFF0Crun anywhere&quot;\u9065\u76F8\u547C\u5E94\u3002 Graal VM\u5728HotSpot VM\u57FA\u7840\u4E0A\u589E\u5F3A\u800C\u6210\u7684\u8DE8\u8BED\u8A00\u5168\u6808\u865A\u62DF\u673A\uFF0C\u53EF\u4EE5\u4F5C\u4E3A\u201C\u4EFB\u4F55\u8BED\u8A00\u201D\u7684\u8FD0\u884C\u5E73\u53F0\u4F7F\u7528\u3002\u8BED\u8A00\u5305\u62EC: Java\u3001Scala\u3001Groovy\u3001Kotlin;C\u3001C++ Javascript\u3001Ruby\u3001Python\u3001R\u7B49 \xB7\u652F\u6301\u4E0D\u540C\u8BED\u8A00\u4E2D\u6DF7\u7528\u5BF9\u65B9\u7684\u63A5\u53E3\u548C\u5BF9\u8C61\uFF0C\u652F\u6301\u8FD9\u4E9B\u8BED\u8A00\u4F7F\u7528\u5DF2\u7ECF\u7F16\u5199\u597D\u7684\u672C\u5730\u5E93\u6587\u4EF6\u5DE5\u4F5C\u539F\u7406\u662F\u5C06\u8FD9\u4E9B\u8BED\u8A00\u7684\u6E90\u4EE3\u7801\u6216\u6E90\u4EE3\u7801\u7F16\u8BD1\u540E\u7684\u4E2D\u95F4\u683C\u5F0F\uFF0C\u901A\u8FC7\u89E3\u91CA\u5668\u8F6C\u6362\u4E3A\u80FD\u88ABGraal VM\u63A5\u53D7\u7684\u4E2D\u95F4\u8868\u793A\u3002Graal VM\u63D0\u4F9BTruffle\u5DE5\u5177\u96C6\u5FEB\u901F\u6784\u5EFA\u9762\u5411\u4E00\u79CD\u65B0\u8BED\u8A00\u7684\u89E3\u91CA\u5668\u3002\u5728\u8FD0\u884C\u65F6\u8FD8\u80FD\u8FDB\u884C\u5373\u65F6\u7F16\u8BD1\u4F18\u5316\uFF0C\u83B7\u5F97\u6BD4\u539F\u751F\u7F16\u8BD1\u5668\u66F4\u4F18\u79C0\u7684\u6267\u884C\u6548\u7387\u3002 \u5982\u679C\u8BF4HotSpot\u6709\u4E00\u5929\u771F\u7684\u88AB\u53D6\u4EE3\uFF0CGraal VM\u5E0C\u671B\u6700\u5927\u3002\u4F46\u662FJava\u7684\u8F6F\u4EF6\u751F\u6001\u6CA1\u6709\u4E1D\u6BEB\u53D8\u5316\u3002</p><h1 id="\u4E8C\u3001\u7C7B\u52A0\u8F7D\u5B50\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u7C7B\u52A0\u8F7D\u5B50\u7CFB\u7EDF" aria-hidden="true">#</a> \u4E8C\u3001\u7C7B\u52A0\u8F7D\u5B50\u7CFB\u7EDF</h1><h2 id="_1-\u5185\u5B58\u7B80\u56FE" tabindex="-1"><a class="header-anchor" href="#_1-\u5185\u5B58\u7B80\u56FE" aria-hidden="true">#</a> 1.\u5185\u5B58\u7B80\u56FE</h2><img src="http://qnimg.gisfsde.com/work/\u7B2C02\u7AE0_JVM\u67B6\u6784-\u7B80\u56FE.jpg" style="zoom:50%;"><img src="http://qnimg.gisfsde.com/work/\u7B2C02\u7AE0_JVM\u67B6\u6784-\u82F1.jpg" style="zoom:50%;"><img src="http://qnimg.gisfsde.com/work/\u7B2C02\u7AE0_JVM\u67B6\u6784-\u4E2D.jpg" style="zoom:50%;"><h2 id="_2-\u7C7B\u52A0\u8F7D\u5668" tabindex="-1"><a class="header-anchor" href="#_2-\u7C7B\u52A0\u8F7D\u5668" aria-hidden="true">#</a> 2.\u7C7B\u52A0\u8F7D\u5668</h2><p>\u200B \u7C7B\u52A0\u8F7D\u5668\u5B50\u7CFB\u7EDF\u8D1F\u8D23\u4ECE\u6587\u4EF6\u7CFB\u7EDF\u6216\u8005\u7F51\u7EDC\u4E2D\u52A0\u8F7Dclass\u6587\u4EF6\uFF0Cclass\u6587\u4EF6\u5728\u6587\u4EF6\u5F00\u5934\u6709\u7279\u5B9A\u7684\u6587\u4EF6\u6807\u8BC6\u3002 ClassLoader\u53EA\u8D1F\u8D23class\u6587\u4EF6\u7684\u52A0\u8F7D\uFF0C\u81F3\u4E8E\u5B83\u662F\u5426\u53EF\u4EE5\u8FD0\u884C\uFF0C\u5219\u7531ExecutionEngine\u51B3\u5B9A\u3002 \u52A0\u8F7D\u7684\u7C7B\u4FE1\u606F\u5B58\u653E\u4E8E\u4E00\u5757\u79F0\u4E3A\u65B9\u6CD5\u533A\u7684\u5185\u5B58\u7A7A\u95F4\u3002\u9664\u4E86\u7C7B\u7684\u4FE1\u606F\u5916\uFF0C\u65B9\u6CD5\u533A\u4E2D\u8FD8\u4F1A\u5B58\u653E\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u4FE1\u606F\uFF0C\u53EF\u80FD\u8FD8\u5305\u62EC\u5B57\u7B26\u4E32\u5B57\u9762\u91CF\u548C\u6570\u5B57\u5E38\u91CF\uFF08\u8FD9\u90E8\u5206\u5E38\u91CF\u4FE1\u606F\u662FClass\u6587\u4EF6\u4E2D\u5E38\u91CF\u6C60\u90E8\u5206\u7684\u5185\u5B58\u6620\u5C04)</p><p><img src="http://qnimg.gisfsde.com/work/image-20211115193632367.png" alt="image-20211115193632367" loading="lazy"></p><h2 id="_3-\u7C7B\u52A0\u8F7D\u5668classloader\u89D2\u8272" tabindex="-1"><a class="header-anchor" href="#_3-\u7C7B\u52A0\u8F7D\u5668classloader\u89D2\u8272" aria-hidden="true">#</a> 3.\u7C7B\u52A0\u8F7D\u5668ClassLoader\u89D2\u8272</h2><ol><li>class file \u5B58\u5728\u4E8E\u672C\u5730\u786C\u76D8\u4E0A\uFF0C\u53EF\u4EE5\u7406\u89E3\u4E3A\u8BBE\u8BA1\u5E08\u753B\u5728\u7EB8\u4E0A\u7684\u6A21\u677F\uFF0C\u800C\u6700\u7EC8\u8FD9\u4E2A\u6A21\u677F\u5728\u6267\u884C\u7684\u65F6\u5019\u662F\u8981\u52A0\u8F7D\u5230JVM\u5F53\u4E2D\u6765\uFF0C\u6839\u636E\u8FD9\u4E2A\u6587\u4EF6\u5B9E\u4F8B\u5316\u51FAn\u4E2A\u4E00\u6A21\u4E00\u6837\u7684\u5B9E\u4F8B\u3002</li><li>class file \u52A0\u8F7D\u5230JVM\u4E2D\uFF0C\u88AB\u79F0\u4E3A<strong>DNA\u5143\u6570\u636E\u6A21\u677F</strong>\uFF0C\u653E\u5728<strong>\u65B9\u6CD5\u533A</strong>\u3002</li><li>\u5728.class\u6587\u4EF6-&gt; JVM -&gt;\u6700\u7EC8\u6210\u4E3A\u5143\u6570\u636E\u6A21\u677F\uFF0C\u6B64\u8FC7\u7A0B\u5C31\u8981\u4E00\u4E2A<strong>\u8FD0\u8F93\u5DE5\u5177(\u7C7B\u88C5\u8F7D\u5668class Loader)</strong>\uFF0C\u626E\u6F14\u4E00\u4E2A\u5FEB\u9012\u5458\u7684\u89D2\u8272\u3002</li></ol><p><img src="http://qnimg.gisfsde.com/work/image-20211115194329061.png" alt="image-20211115194329061" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211116140445121.png" alt="image-20211116140445121" loading="lazy"></p><h3 id="\u83B7\u53D6classloader\u9014\u7ECF" tabindex="-1"><a class="header-anchor" href="#\u83B7\u53D6classloader\u9014\u7ECF" aria-hidden="true">#</a> \u83B7\u53D6ClassLoader\u9014\u7ECF</h3><p><img src="http://qnimg.gisfsde.com/work/image-20211116140425056.png" alt="image-20211116140425056" loading="lazy"></p><h2 id="_4-\u7C7B\u52A0\u8F7D\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#_4-\u7C7B\u52A0\u8F7D\u8FC7\u7A0B" aria-hidden="true">#</a> 4.\u7C7B\u52A0\u8F7D\u8FC7\u7A0B</h2><img src="http://qnimg.gisfsde.com/work/\u7B2C02\u7AE0_\u7C7B\u7684\u52A0\u8F7D\u8FC7\u7A0B.jpg" alt="image-20211115194329061" style="zoom:50%;"><img src="http://qnimg.gisfsde.com/work/image-20211115194822559.png" alt="image-20211115194329061" style="zoom:80%;"><h3 id="\u52A0\u8F7D-loading" tabindex="-1"><a class="header-anchor" href="#\u52A0\u8F7D-loading" aria-hidden="true">#</a> \u52A0\u8F7D(Loading):</h3><p>1\uFF0E\u901A\u8FC7\u4E00\u4E2A\u7C7B\u7684\u5168\u9650\u5B9A\u540D\u83B7\u53D6\u5B9A\u4E49\u6B64\u7C7B\u7684\u4E8C\u8FDB\u5236\u5B57\u8282\u6D41 2\uFF0E\u5C06\u8FD9\u4E2A\u5B57\u8282\u6D41\u6240\u4EE3\u8868\u7684\u9759\u6001\u5B58\u50A8\u7ED3\u6784\u8F6C\u5316\u4E3A\u65B9\u6CD5\u533A\u7684\u8FD0\u884C\u65F6\u6570\u636E\u7ED3\u6784 3\uFF0E\u5728\u5185\u5B58\u4E2D\u751F\u6210\u4E00\u4E2A\u4EE3\u8868\u8FD9\u4E2A\u7C7B\u7684 <strong>java.lang.Class</strong> \u5BF9\u8C61\uFF0C\u4F5C\u4E3A\u65B9\u6CD5\u533A\u8FD9\u4E2A\u7C7B\u7684\u5404\u79CD\u6570\u636E\u7684\u8BBF\u95EE\u5165\u53E3 \u8865\u5145:\u52A0\u8F7D.class\u6587\u4EF6\u7684\u65B9\u5F0F \xB7\u4ECE\u672C\u5730\u7CFB\u7EDF\u4E2D\u76F4\u63A5\u52A0\u8F7D \xB7\u901A\u8FC7\u7F51\u7EDC\u83B7\u53D6\uFF0C\u5178\u578B\u573A\u666F: web Applet \xB7\u4ECEzip\u538B\u7F29\u5305\u4E2D\u8BFB\u53D6\uFF0C\u6210\u4E3A\u65E5\u540Ejar\u3001 war\u683C\u5F0F\u7684\u57FA\u7840\xB7\u8FD0\u884C\u65F6\u8BA1\u7B97\u751F\u6210\uFF0C\u4F7F\u7528\u6700\u591A\u7684\u662F:\u52A8\u6001\u4EE3\u7406\u6280\u672F \xB7\u7531\u5176\u4ED6\u6587\u4EF6\u751F\u6210\uFF0C\u5178\u578B\u573A\u666F:JSP\u5E94\u7528 \xB7\u4ECE\u4E13\u6709\u6570\u636E\u5E93\u4E2D\u63D0\u53D6.class\u6587\u4EF6,\u6BD4\u8F83\u5C11\u89C1 \xB7\u4ECE\u52A0\u5BC6\u6587\u4EF6\u4E2D\u83B7\u53D6\uFF0C\u5178\u578B\u7684\u9632class\u6587\u4EF6\u88AB\u53CD\u7F16\u8BD1\u7684\u4FDD\u62A4\u63AA\u65BD</p><h3 id="\u94FE\u63A5" tabindex="-1"><a class="header-anchor" href="#\u94FE\u63A5" aria-hidden="true">#</a> \u94FE\u63A5</h3><h4 id="\u9A8C\u8BC1-verify" tabindex="-1"><a class="header-anchor" href="#\u9A8C\u8BC1-verify" aria-hidden="true">#</a> \u9A8C\u8BC1(Verify):</h4><p>\xB7\u76EE\u7684\u5728\u4E8E<strong>\u786E\u4FDDclass\u6587\u4EF6\u7684\u5B57\u8282\u6D41\u4E2D\u5305\u542B\u4FE1\u606F\u7B26\u5408\u5F53\u524D\u865A\u62DF\u673A\u8981\u6C42</strong>\uFF0C\u4FDD\u8BC1\u88AB\u52A0\u8F7D\u7C7B\u7684\u6B63\u786E\u6027\uFF0C\u4E0D\u4F1A\u5371\u5BB3\u865A\u62DF\u673A\u81EA\u8EAB\u5B89\u5168\u3002 \xB7\u4E3B\u8981\u5305\u62EC\u56DB\u79CD\u9A8C\u8BC1\uFF0C\u6587\u4EF6\u683C\u5F0F\u9A8C\u8BC1\uFF0C\u5143\u6570\u636E\u9A8C\u8BC1\uFF0C\u5B57\u8282\u7801\u9A8C\u8BC1\uFF0C\u7B26\u53F7\u5F15\u7528\u9A8C\u8BC1\u3002</p><h4 id="\u51C6\u5907-prepare" tabindex="-1"><a class="header-anchor" href="#\u51C6\u5907-prepare" aria-hidden="true">#</a> \u51C6\u5907(Prepare):</h4><p>\xB7\u4E3A\u7C7B\u53D8\u91CF<strong>\u5206\u914D</strong>\u5185\u5B58\u5E76\u4E14\u8BBE\u7F6E\u8BE5\u7C7B\u53D8\u91CF\u7684<strong>\u9ED8\u8BA4\u521D\u59CB\u503C</strong>\uFF0C\u5373\u96F6\u503C\u3002 \u8FD9\u91CC\u4E0D\u5305\u542B\u7528final\u4FEE\u9970\u7684static\uFF0C\u56E0\u4E3Afinal\u5728\u7F16\u8BD1\u7684\u65F6\u5019\u5C31\u4F1A\u5206\u914D\u4E86\uFF0C\u51C6\u5907\u9636\u6BB5\u4F1A\u663E\u5F0F\u94FE\u521D\u59CB\u5316; \xB7\u8FD9\u91CC\u4E0D\u4F1A\u4E3A\u5B9E\u4F8B\u53D8\u91CF\u5206\u914D\u521D\u59CB\u5316\uFF0C\u7C7B\u53D8\u91CF\u4F1A\u5206\u914D\u5728\u65B9\u6CD5\u533A\u4E2D\uFF0C\u800C\u5B9E\u4F8B\u53D8\u91CF\u662F\u4F1A\u968F\u7740\u5BF9\u8C61\u4E00\u8D77\u5206\u914D\u5230Java\u5806\u4E2D\u3002</p><h4 id="\u89E3\u6790-resolve" tabindex="-1"><a class="header-anchor" href="#\u89E3\u6790-resolve" aria-hidden="true">#</a> \u89E3\u6790(Resolve) :</h4><p>\xB7<strong>\u5C06\u5E38\u91CF\u6C60\u5185\u7684\u7B26\u53F7\u5F15\u7528\u8F6C\u6362\u4E3A\u76F4\u63A5\u5F15\u7528\u7684\u8FC7\u7A0B\u3002</strong> \xB7\u4E8B\u5B9E\u4E0A\uFF0C\u89E3\u6790\u64CD\u4F5C\u5F80\u5F80\u4F1A\u4F34\u968F\u7740JVM\u5728\u6267\u884C\u5B8C\u521D\u59CB\u5316\u4E4B\u540E\u518D\u6267\u884C\u3002 \xB7<strong>\u7B26\u53F7\u5F15\u7528</strong>\u5C31\u662F\u4E00\u7EC4\u7B26\u53F7\u6765\u63CF\u8FF0\u6240\u5F15\u7528\u7684\u76EE\u6807\u3002\u7B26\u53F7\u5F15\u7528\u7684\u5B57\u9762\u91CF\u5F62\u5F0F\u660E\u786E\u5B9A\u4E49\u5728\u300Ajava\u865A\u62DF\u673A\u89C4\u8303\u300B\u7684class\u6587\u4EF6\u683C\u5F0F\u4E2D\u3002<strong>\u76F4\u63A5\u5F15\u7528</strong>\u5C31\u662F\u76F4\u63A5\u6307\u5411\u76EE\u6807\u7684\u6307\u9488\u3001\u76F8\u5BF9\u504F\u79FB\u91CF\u6216\u4E00\u4E2A\u95F4\u63A5\u5B9A\u4F4D\u5230\u76EE\u6807\u7684\u53E5\u67C4\u3002 \xB7\u89E3\u6790\u52A8\u4F5C\u4E3B\u8981\u9488\u5BF9\u7C7B\u6216\u63A5\u53E3\u3001\u5B57\u6BB5\u3001\u7C7B\u65B9\u6CD5\u3001\u63A5\u53E3\u65B9\u6CD5\u3001\u65B9\u6CD5\u7C7B\u578B\u7B49\u3002\u5BF9\u5E94\u5E38\u91CF\u6C60\u4E2D\u7684 CONSTANT Class info\u3001CONSTANT Fieldref_info\u3001CONSTANT _Methodref_info\u7B49.\u3002</p><h3 id="\u521D\u59CB\u5316" tabindex="-1"><a class="header-anchor" href="#\u521D\u59CB\u5316" aria-hidden="true">#</a> \u521D\u59CB\u5316:</h3><p>\xB7\u521D\u59CB\u5316\u9636\u6BB5\u5C31\u662F<strong>\u6267\u884C\u7C7B\u6784\u9020\u5668\u65B9\u6CD5&lt;clinit&gt; ()\u7684\u8FC7\u7A0B</strong>\u3002 \xB7\u6B64\u65B9\u6CD5\u4E0D\u9700\u5B9A\u4E49\uFF0C\u662Fjavac\u7F16\u8BD1\u5668\u81EA\u52A8\u6536\u96C6\u7C7B\u4E2D\u7684\u6240\u6709\u7C7B\u53D8\u91CF\u7684\u8D4B\u503C\u52A8\u4F5C\u548C\u9759\u6001\u4EE3\u7801\u5757\u4E2D\u7684\u8BED\u53E5\u5408\u5E76\u800C\u6765\u3002 \xB7\u6784\u9020\u5668\u65B9\u6CD5\u4E2D\u6307\u4EE4\u6309\u8BED\u53E5\u5728\u6E90\u6587\u4EF6\u4E2D\u51FA\u73B0\u7684\u987A\u5E8F\u6267\u884C\u3002 . &lt;clinit&gt; ()\u4E0D\u540C\u4E8E\u7C7B\u7684\u6784\u9020\u5668\u3002(\u5173\u8054:\u6784\u9020\u5668\u662F\u865A\u62DF\u673A\u89C6\u89D2\u4E0B\u7684&lt;init&gt;( ))\xB7\u82E5\u8BE5\u7C7B\u5177\u6709\u7236\u7C7B\uFF0CJVM\u4F1A\u4FDD\u8BC1\u5B50\u7C7B\u7684&lt;clinit&gt;()\u6267\u884C\u524D\uFF0C\u7236\u7C7B\u7684&lt;clinit&gt; ()\u5DF2\u7ECF\u6267\u884C\u5B8C\u6BD5\u3002 \xB7\u865A\u62DF\u673A\u5FC5\u987B\u4FDD\u8BC1\u4E00\u4E2A\u7C7B\u7684&lt;clinit&gt; ()\u65B9\u6CD5\u5728\u591A\u7EBF\u7A0B\u4E0B\u88AB\u540C\u6B65\u52A0\u9501\u3002</p><h2 id="_5-\u7C7B\u52A0\u8F7D\u5668\u5206\u7C7B" tabindex="-1"><a class="header-anchor" href="#_5-\u7C7B\u52A0\u8F7D\u5668\u5206\u7C7B" aria-hidden="true">#</a> 5.\u7C7B\u52A0\u8F7D\u5668\u5206\u7C7B</h2><p>JVM\u652F\u6301\u4E24\u79CD\u7C7B\u578B\u7684\u7C7B\u52A0\u8F7D\u5668\uFF0C\u5206\u522B\u4E3A<strong>\u5F15\u5BFC\u7C7B\u52A0\u8F7D\u5668</strong>\uFF08Bootstrap ClassLoader\uFF09\u548C<strong>\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668</strong>(User-Defined ClassLoader)\u3002 \xB7\u4ECE\u6982\u5FF5\u4E0A\u6765\u8BB2\uFF0C\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u4E00\u822C\u6307\u7684\u662F\u7A0B\u5E8F\u4E2D\u7531\u5F00\u53D1\u4EBA\u5458\u81EA\u5B9A\u4E49\u7684\u4E00\u7C7B\u7C7B\u52A0\u8F7D\u5668\uFF0C\u4F46\u662FJava\u865A\u62DF\u673A\u89C4\u8303\u5374\u6CA1\u6709\u8FD9\u4E48\u5B9A\u4E49\uFF0C\u800C\u662F\u5C06\u6240\u6709\u6D3E\u751F\u4E8E\u62BD\u8C61\u7C7BClassLoader\u7684\u7C7B\u52A0\u8F7D\u5668\u90FD\u5212\u5206\u4E3A\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u3002 \xB7\u65E0\u8BBA\u7C7B\u52A0\u8F7D\u5668\u7684\u7C7B\u578B\u5982\u4F55\u5212\u5206\uFF0C\u5728\u7A0B\u5E8F\u4E2D\u6211\u4EEC\u6700\u5E38\u89C1\u7684\u7C7B\u52A0\u8F7D\u5668\u59CB\u7EC8\u53EA\u67093\u4E2A\uFF0C\u5982\u4E0B\u6240\u793A:</p><p><img src="http://qnimg.gisfsde.com/work/image-20211116133613669.png" alt="image-20211116133613669" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211116133718130.png" alt="image-20211116133718130" loading="lazy"></p><p>\u865A\u62DF\u673A\u81EA\u5E26\u7684\u52A0\u8F7D\u5668</p><h3 id="\xB7\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668-\u5F15\u5BFC\u7C7B\u52A0\u8F7D\u5668-bootstrap-classloader" tabindex="-1"><a class="header-anchor" href="#\xB7\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668-\u5F15\u5BFC\u7C7B\u52A0\u8F7D\u5668-bootstrap-classloader" aria-hidden="true">#</a> \xB7\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668\uFF08\u5F15\u5BFC\u7C7B\u52A0\u8F7D\u5668\uFF0CBootstrap classLoader)</h3><ul><li><p>\u8FD9\u4E2A\u7C7B\u52A0\u8F7D\u4F7F\u7528**C/C++**\u8BED\u8A00\u5B9E\u73B0\u7684\uFF0C\u5D4C\u5957\u5728JVM\u5185\u90E8\u3002</p></li><li><p>\u5B83\u7528\u6765\u52A0\u8F7DJava\u7684<strong>\u6838\u5FC3\u5E93</strong>\uFF08JAVA HOME/jre/lib/rt.jar\u3001resources.jar\u6216sun.boot.class.path\u8DEF\u5F84\u4E0B\u7684\u5185\u5BB9\uFF09\uFF0C\u7528\u4E8E\u63D0\u4F9BJVM\u81EA\u8EAB\u9700\u8981\u7684\u7C7B</p></li><li><p>\u5E76\u4E0D\u7EE7\u627F\u81EAjava.lang.classLoader\uFF0C\u6CA1\u6709\u7236\u52A0\u8F7D\u5668\u3002\u52A0\u8F7D\u6269\u5C55\u7C7B\u548C\u5E94\u7528\u7A0B\u5E8F\u7C7B\u52A0\u8F7D\u5668\uFF0C\u5E76\u6307\u5B9A\u4E3A\u4ED6\u4EEC\u7684\u7236\u7C7B\u52A0\u8F7D\u5668\u3002</p></li><li><p>\u51FA\u4E8E\u5B89\u5168\u8003\u8651\uFF0CBootstrap\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668\u53EA\u52A0\u8F7D\u5305\u540D\u4E3A<strong>java\u3001javax\u3001sun</strong>\u7B49\u5F00\u5934\u7684\u7C7B</p></li></ul><h3 id="\xB7\u6269\u5C55\u7C7B\u52A0\u8F7D\u5668-extension-classloader" tabindex="-1"><a class="header-anchor" href="#\xB7\u6269\u5C55\u7C7B\u52A0\u8F7D\u5668-extension-classloader" aria-hidden="true">#</a> \xB7\u6269\u5C55\u7C7B\u52A0\u8F7D\u5668\uFF08Extension ClassLoader)</h3><p>Java\u8BED\u8A00\u7F16\u5199\uFF0C\u7531sun.misc.Launcher$ExtClassLoader\u5B9E\u73B0\u3002\u6D3E\u751F\u4E8EclassLoader\u7C7B \u7236\u7C7B\u52A0\u8F7D\u5668\u4E3A\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668 \u4ECEjava.ext.dirs\u7CFB\u7EDF\u5C5E\u6027\u6240\u6307\u5B9A\u7684\u76EE\u5F55\u4E2D\u52A0\u8F7D\u7C7B\u5E93\uFF0C\u6216\u4ECEJDK\u7684\u5B89\u88C5\u76EE\u5F55\u7684<strong>jre/lib/ext</strong>\u5B50\u76EE\u5F55\uFF08\u6269\u5C55\u76EE\u5F55)\u4E0B\u52A0\u8F7D\u7C7B\u5E93\u3002\u5982\u679C\u7528\u6237\u521B\u5EFA\u7684JAR\u653E\u5728\u6B64\u76EE\u5F55\u4E0B\uFF0C\u4E5F\u4F1A\u81EA\u52A8\u7531\u6269\u5C55\u7C7B\u52A0\u8F7D\u5668\u52A0\u8F7D\u3002</p><h3 id="\xB7\u5E94\u7528\u7A0B\u5E8F\u7C7B\u52A0\u8F7D\u5668-\u7CFB\u7EDF\u7C7B\u52A0\u8F7D\u5668-appclassloader" tabindex="-1"><a class="header-anchor" href="#\xB7\u5E94\u7528\u7A0B\u5E8F\u7C7B\u52A0\u8F7D\u5668-\u7CFB\u7EDF\u7C7B\u52A0\u8F7D\u5668-appclassloader" aria-hidden="true">#</a> \xB7\u5E94\u7528\u7A0B\u5E8F\u7C7B\u52A0\u8F7D\u5668\uFF08\u7CFB\u7EDF\u7C7B\u52A0\u8F7D\u5668\uFF0CAppClassLoader)</h3><p>java\u8BED\u8A00\u7F16\u5199\uFF0C\u7531sun.misc.Launcher$AppclassLoader\u5B9E\u73B0&gt;\u6D3E\u751F\u4E8EclassLoader\u7C7B \u7236\u7C7B\u52A0\u8F7D\u5668\u4E3A\u6269\u5C55\u7C7B\u52A0\u8F7D\u5668 \u5B83\u8D1F\u8D23\u52A0\u8F7D\u73AF\u5883\u53D8\u91CFclasspath\u6216\u7CFB\u7EDF\u5C5E\u6027java.class.<strong>path</strong>\u6307\u5B9A\u8DEF\u5F84\u4E0B\u7684\u7C7B\u5E93 \u8BE5\u7C7B\u52A0\u8F7D\u662F\u7A0B\u5E8F\u4E2D<strong>\u9ED8\u8BA4\u7684\u7C7B\u52A0\u8F7D\u5668</strong>\uFF0C\u4E00\u822C\u6765\u8BF4\uFF0CJava\u5E94\u7528\u7684\u7C7B\u90FD\u662F\u7531\u5B83\u6765\u5B8C\u6210\u52A0\u8F7D \u901A\u8FC7classLoader#getSystemClassLoader ()\u65B9\u6CD5\u53EF\u4EE5\u83B7\u53D6\u5230\u8BE5\u7C7B\u52A0\u8F7D\u5668</p><h4 id="\u7528\u6237\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668" tabindex="-1"><a class="header-anchor" href="#\u7528\u6237\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668" aria-hidden="true">#</a> <strong>\u7528\u6237\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668</strong></h4><p>\xB7\u5728Java\u7684\u65E5\u5E38\u5E94\u7528\u7A0B\u5E8F\u5F00\u53D1\u4E2D\uFF0C\u7C7B\u7684\u52A0\u8F7D\u51E0\u4E4E\u662F\u7531\u4E0A\u8FF03\u79CD\u7C7B\u52A0\u8F7D\u5668\u76F8\u4E92\u914D\u5408\u6267\u884C\u7684\uFF0C\u5728\u5FC5\u8981\u65F6\uFF0C\u6211\u4EEC\u8FD8\u53EF\u4EE5\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\uFF0C\u6765\u5B9A\u5236\u7C7B\u7684\u52A0\u8F7D\u65B9\u5F0F\u3002 .\u4E3A\u4EC0\u4E48\u8981\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668? \u9694\u79BB\u52A0\u8F7D\u7C7B \u4FEE\u6539\u7C7B\u52A0\u8F7D\u7684\u65B9\u5F0F \u6269\u5C55\u52A0\u8F7D\u6E90 \u9632\u6B62\u6E90\u7801\u6CC4\u6F0F</p><h4 id="\u7528\u6237\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u5B9E\u73B0\u6B65\u9AA4" tabindex="-1"><a class="header-anchor" href="#\u7528\u6237\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u5B9E\u73B0\u6B65\u9AA4" aria-hidden="true">#</a> <strong>\u7528\u6237\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u5B9E\u73B0\u6B65\u9AA4:</strong></h4><p>1.\u5F00\u53D1\u4EBA\u5458\u53EF\u4EE5\u901A\u8FC7\u7EE7\u627F\u62BD\u8C61\u7C7Bjava.lang.classLoader\u7C7B\u7684\u65B9\u5F0F\uFF0C\u5B9E\u73B0\u81EA\u5DF1\u7684\u7C7B\u52A0\u8F7D\u5668\uFF0C\u4EE5\u6EE1\u8DB3\u4E00\u4E9B\u7279\u6B8A\u7684\u9700\u6C42 2.\u5728JDK1.2\u4E4B\u524D\uFF0C\u5728\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u65F6\uFF0C\u603B\u4F1A\u53BB\u7EE7\u627FclassLoader\u7C7B\u5E76\u91CD\u5199loadClass ()\u65B9\u6CD5\uFF0C\u4ECE\u800C\u5B9E\u73B0\u81EA\u5B9A\u4E49\u7684\u7C7B\u52A0\u8F7D\u7C7B\uFF0C\u4F46\u662F\u5728JDK1.2\u4E4B\u540E\u5DF2\u4E0D\u518D\u5EFA\u8BAE\u7528\u6237\u53BB\u8986\u76D6loadclass ()\u65B9\u6CD5\uFF0C\u800C\u662F\u5EFA\u8BAE\u628A\u81EA\u5B9A\u4E49\u7684\u7C7B\u52A0\u8F7D\u903B\u8F91\u5199\u5728findclass ()\u65B9\u6CD5\u4E2D 3\uFF0E\u5728\u7F16\u5199\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u65F6\uFF0C\u5982\u679C\u6CA1\u6709\u592A\u8FC7\u4E8E\u590D\u6742\u7684\u9700\u6C42\uFF0C\u53EF\u4EE5\u76F4\u63A5\u7EE7\u627FURLClassLoader\u7C7B\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u907F\u514D\u81EA\u5DF1\u53BB\u7F16\u5199findclass ()\u65B9\u6CD5\u53CA\u5176\u83B7\u53D6\u5B57\u8282\u7801\u6D41\u7684\u65B9\u5F0F\uFF0C\u4F7F\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u7F16\u5199\u66F4\u52A0\u7B80\u6D01\u3002</p><h2 id="_6-\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#_6-\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236" aria-hidden="true">#</a> 6.\u53CC\u4EB2\u59D4\u6D3E\u673A\u5236</h2><p>\u200B Java\u865A\u62DF\u673A\u5BF9class\u6587\u4EF6\u91C7\u7528\u7684\u662F<strong>\u6309\u9700\u52A0\u8F7D</strong>\u7684\u65B9\u5F0F\uFF0C\u4E5F\u5C31\u662F\u8BF4\u5F53\u9700\u8981\u4F7F\u7528\u8BE5\u7C7B\u65F6\u624D\u4F1A\u5C06\u5B83\u7684class\u6587\u4EF6\u52A0\u8F7D\u5230\u5185\u5B58\u751F\u6210class\u5BF9\u8C61\u3002\u800C\u4E14\u52A0\u8F7D\u67D0\u4E2A\u7C7B\u7684class\u6587\u4EF6\u65F6\uFF0CJava\u865A\u62DF\u673A\u91C7\u7528\u7684\u662F\u53CC\u4EB2\u59D4\u6D3E\u6A21\u5F0F\uFF0C\u5373\u628A\u8BF7\u6C42<strong>\u4EA4\u7531\u7236\u7C7B\u5904\u7406</strong>,\u5B83\u662F\u4E00\u79CD\u4EFB\u52A1\u59D4\u6D3E\u6A21\u5F0F\u3002</p><h3 id="\u5DE5\u4F5C\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u5DE5\u4F5C\u539F\u7406" aria-hidden="true">#</a> <strong>\u5DE5\u4F5C\u539F\u7406</strong></h3><p>1)\u5982\u679C\u4E00\u4E2A\u7C7B\u52A0\u8F7D\u5668\u6536\u5230\u4E86\u7C7B\u52A0\u8F7D\u8BF7\u6C42\uFF0C\u5B83\u5E76\u4E0D\u4F1A\u81EA\u5DF1\u5148\u53BB\u52A0\u8F7D\uFF0C\u800C\u662F\u628A\u8FD9\u4E2A\u8BF7\u6C42<strong>\u59D4\u6258\u7ED9\u7236\u7C7B</strong>\u7684\u52A0\u8F7D\u5668\u53BB\u6267\u884C; 2)\u5982\u679C\u7236\u7C7B\u52A0\u8F7D\u5668\u8FD8\u5B58\u5728\u5176\u7236\u7C7B\u52A0\u8F7D\u5668\uFF0C\u5219\u8FDB\u4E00\u6B65\u5411\u4E0A\u59D4\u6258\uFF0C\u4F9D\u6B21\u9012\u5F52\uFF0C\u8BF7\u6C42\u6700\u7EC8\u5C06\u5230\u8FBE\u9876\u5C42\u7684\u542F\u52A8\u7C7B\u52A0\u8F7D\u5668; 3)\u5982\u679C\u7236\u7C7B\u52A0\u8F7D\u5668\u53EF\u4EE5\u5B8C\u6210\u7C7B\u52A0\u8F7D\u4EFB\u52A1\uFF0C\u5C31\u6210\u529F\u8FD4\u56DE\uFF0C\u5018\u82E5\u7236\u7C7B\u52A0\u8F7D\u5668\u65E0\u6CD5\u5B8C\u6210\u6B64\u52A0\u8F7D\u4EFB\u52A1\uFF0C\u5B50\u52A0\u8F7D\u5668\u624D\u4F1A\u5C1D\u8BD5\u81EA\u5DF1\u53BB\u52A0\u8F7D\uFF0C\u8FD9\u5C31\u662F\u53CC\u4EB2\u59D4\u6D3E\u6A21\u5F0F\u3002</p><p>\u5373<strong>\u5411\u4E0A\u59D4\u6258\uFF0C\u5411\u4E0B\u7529\u9505</strong></p><p><img src="http://qnimg.gisfsde.com/work/image-20211116182608650.png" alt="image-20211116182608650" loading="lazy"></p><h3 id="\u53CC\u4EB2\u59D4\u6D3E\u4F18\u52BF" tabindex="-1"><a class="header-anchor" href="#\u53CC\u4EB2\u59D4\u6D3E\u4F18\u52BF" aria-hidden="true">#</a> <strong>\u53CC\u4EB2\u59D4\u6D3E\u4F18\u52BF</strong></h3><p>\u907F\u514D\u7C7B\u7684\u91CD\u590D\u52A0\u8F7D \u4FDD\u62A4\u7A0B\u5E8F\u5B89\u5168\uFF0C\u9632\u6B62\u6838\u5FC3API\u88AB\u968F\u610F\u7BE1\u6539 \u81EA\u5B9A\u4E49\u7C7B:java. lang. string \u81EA\u5B9A\u4E49\u7C7B: java . lang. shkStart java.lang. securityException: Prohibited package name: java.lang</p><p><img src="http://qnimg.gisfsde.com/work/image-20211116183030909.png" alt="image-20211116183030909" loading="lazy"></p><h3 id="\u6C99\u7BB1\u5B89\u5168\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#\u6C99\u7BB1\u5B89\u5168\u673A\u5236" aria-hidden="true">#</a> \u6C99\u7BB1\u5B89\u5168\u673A\u5236</h3><p>\u200B \u81EA\u5B9A\u4E49string\u7C7B\uFF0C\u4F46\u662F\u5728\u52A0\u8F7D\u81EA\u5B9A\u4E49String\u7C7B\u7684\u65F6\u5019\u4F1A\u7387\u5148\u4F7F\u7528\u5F15\u5BFC\u7C7B\u52A0\u8F7D\u5668\u52A0\u8F7D\uFF0C\u800C\u5F15\u5BFC\u7C7B\u52A0\u8F7D\u5668\u5728\u52A0\u8F7D\u7684\u8FC7\u7A0B\u4E2D\u4F1A\u5148\u52A0\u8F7Djdk\u81EA\u5E26\u7684\u6587\u4EF6(rt.jar\u5305\u4E2Djava\\lang\\String.class)\uFF0C\u62A5\u9519\u4FE1\u606F\u8BF4\u6CA1\u6709main\u65B9\u6CD5\uFF0C\u5C31\u662F\u56E0\u4E3A\u52A0\u8F7D\u7684\u662Frt.jar\u5305\u4E2D\u7684String\u7C7B\u3002\u8FD9\u6837\u53EF\u4EE5\u4FDD\u8BC1\u5BF9java\u6838\u5FC3\u6E90\u4EE3\u7801\u7684\u4FDD\u62A4\uFF0C\u8FD9\u5C31\u662F\u6C99\u7BB1\u5B89\u5168\u673A\u5236\u3002\u5373<strong>\u5148\u7528java\u6838\u5FC3\u6E90\u7801\u518D\u5F80\u5916\u5C42\u7528</strong></p><h2 id="_7-\u5176\u4ED6" tabindex="-1"><a class="header-anchor" href="#_7-\u5176\u4ED6" aria-hidden="true">#</a> 7.\u5176\u4ED6</h2><p>\xB7\u5728JVM\u4E2D\u8868\u793A\u4E24\u4E2Aclass\u5BF9\u8C61\u662F\u5426\u4E3A\u540C\u4E00\u4E2A\u7C7B\u5B58\u5728\u4E24\u4E2A\u5FC5\u8981\u6761\u4EF6: \u7C7B\u7684\u5B8C\u6574\u7C7B\u540D\u5FC5\u987B\u4E00\u81F4\uFF0C\u5305\u62EC\u5305\u540D\u3002 \u52A0\u8F7D\u8FD9\u4E2A\u7C7B\u7684classLoader(\u6307classLoader\u5B9E\u4F8B\u5BF9\u8C61)\u5FC5\u987B\u76F8\u540C\u3002 \xB7\u6362\u53E5\u8BDD\u8BF4\uFF0C\u5728VM\u4E2D\uFF0C\u5373\u4F7F\u8FD9\u4E24\u4E2A\u7C7B\u5BF9\u8C61(class\u5BF9\u8C61)\u6765\u6E90\u540C\u4E00\u4E2Aclass\u6587\u4EF6\uFF0C\u88AB\u540C\u4E00\u4E2A\u865A\u62DF\u673A\u6240\u52A0\u8F7D\uFF0C\u4F46\u53EA\u8981\u52A0\u8F7D\u5B83\u4EEC\u7684ClassLoader\u5B9E\u4F8B\u5BF9\u8C61\u4E0D\u540C\uFF0C\u90A3\u4E48\u8FD9\u4E24\u4E2A\u7C7B\u5BF9\u8C61\u4E5F\u662F\u4E0D\u76F8\u7B49\u7684\u3002</p><h3 id="\u5BF9\u7C7B\u52A0\u8F7D\u5176\u7684\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u7C7B\u52A0\u8F7D\u5176\u7684\u5F15\u7528" aria-hidden="true">#</a> <strong>\u5BF9\u7C7B\u52A0\u8F7D\u5176\u7684\u5F15\u7528</strong></h3><p>JVM\u5FC5\u987B\u77E5\u9053\u4E00\u4E2A\u7C7B\u578B\u662F\u7531\u542F\u52A8\u52A0\u8F7D\u5668\u52A0\u8F7D\u7684\u8FD8\u662F\u7531\u7528\u6237\u7C7B\u52A0\u8F7D\u5668\u52A0\u8F7D\u7684\u3002\u5982\u679C\u4E00\u4E2A\u7C7B\u578B\u662F\u7531\u7528\u6237\u7C7B\u52A0\u8F7D\u5668\u52A0\u8F7D\u7684\uFF0C\u90A3\u4E48JVM\u4F1A\u5C06\u8FD9\u4E2A\u7C7B\u52A0\u8F7D\u5668\u7684\u4E00\u4E2A\u5F15\u7528\u4F5C\u4E3A\u7C7B\u578B\u4FE1\u606F\u7684\u4E00\u90E8\u5206\u4FDD\u5B58\u5728\u65B9\u6CD5\u533A\u4E2D\u3002\u5F53\u89E3\u6790\u4E00\u4E2A\u7C7B\u578B\u5230\u53E6\u4E00\u4E2A\u7C7B\u578B\u7684\u5F15\u7528\u7684\u65F6\u5019\uFF0CJVM\u9700\u8981\u4FDD\u8BC1\u8FD9\u4E24\u4E2A\u7C7B\u578B\u7684\u7C7B\u52A0\u8F7D\u5668\u662F\u76F8\u540C\u7684\u3002</p><h3 id="\u7C7B\u7684\u4E3B\u52A8\u4F7F\u7528\u548C\u88AB\u52A8\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u7C7B\u7684\u4E3B\u52A8\u4F7F\u7528\u548C\u88AB\u52A8\u4F7F\u7528" aria-hidden="true">#</a> \u7C7B\u7684\u4E3B\u52A8\u4F7F\u7528\u548C\u88AB\u52A8\u4F7F\u7528</h3><p>Java\u7A0B\u5E8F\u5BF9\u7C7B\u7684\u4F7F\u7528\u65B9\u5F0F\u5206\u4E3A:\u4E3B\u52A8\u4F7F\u7528\u548C\u88AB\u52A8\u4F7F\u7528\u3002\xB7\u4E3B\u52A8\u4F7F\u7528\uFF0C\u53C8\u5206\u4E3A\u4E03\u79CD\u60C5\u51B5: \xB7\u521B\u5EFA\u7C7B\u7684\u5B9E\u4F8B \xB7\u8BBF\u95EE\u67D0\u4E2A\u7C7B\u6216\u63A5\u53E3\u7684\u9759\u6001\u53D8\u91CF\uFF0C\u6216\u8005\u5BF9\u8BE5\u9759\u6001\u53D8\u91CF\u8D4B\u503C \xB7\u8C03\u7528\u7C7B\u7684\u9759\u6001\u65B9\u6CD5 \xB7\u53CD\u5C04\uFF08\u6BD4\u5982: Class.forName ( &quot;com.atguigu . Test&quot;) )&gt; \xB7\u521D\u59CB\u5316\u4E00\u4E2A\u7C7B\u7684\u5B50\u7C7B \xB7Java\u865A\u62DF\u673A\u542F\u52A8\u65F6\u88AB\u6807\u660E\u4E3A\u542F\u52A8\u7C7B\u7684\u7C7B \xB7JDK 7\u5F00\u59CB\u63D0\u4F9B\u7684\u52A8\u6001\u8BED\u8A00\u652F\u6301:java . lang.invoke.MethodHandle\u5B9E\u4F8B\u7684\u89E3\u6790\u7ED3\u679CREF getstatic\u3001REF putstatic\u3001REF_invokestatic\u53E5\u67C4\u5BF9\u5E94\u7684\u7C7B\u6CA1\u6709\u521D\u59CB\u5316\uFF0C\u5219\u521D\u59CB\u5316 \u9664\u4E86\u4EE5\u4E0A\u4E03\u79CD\u60C5\u51B5\uFF0C\u5176\u4ED6\u4F7F\u7528Java\u7C7B\u7684\u65B9\u5F0F\u90FD\u88AB\u770B\u4F5C\u662F\u5BF9\u7C7B\u7684\u88AB\u52A8\u4F7F\u7528\uFF0C\u90FD\u4E0D\u4F1A\u5BFC\u81F4\u7C7B\u7684\u521D\u59CB\u5316\u3002</p><h1 id="\u4E09\u3001\u8FD0\u884C\u65F6\u6570\u636E\u533A\u6982\u8FF0\u53CA\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u8FD0\u884C\u65F6\u6570\u636E\u533A\u6982\u8FF0\u53CA\u7EBF\u7A0B" aria-hidden="true">#</a> \u4E09\u3001<em>\u8FD0\u884C\u65F6\u6570\u636E\u533A\u6982\u8FF0\u53CA\u7EBF\u7A0B</em></h1><h2 id="_1-\u8FD0\u884C\u65F6\u6570\u636E\u533A\u5185\u90E8\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_1-\u8FD0\u884C\u65F6\u6570\u636E\u533A\u5185\u90E8\u7ED3\u6784" aria-hidden="true">#</a> 1.\u8FD0\u884C\u65F6\u6570\u636E\u533A\u5185\u90E8\u7ED3\u6784</h2><p>\u200B \u5185\u5B58\u662F\u975E\u5E38\u91CD\u8981\u7684\u7CFB\u7EDF\u8D44\u6E90\uFF0C\u662F<strong>\u786C\u76D8\u548CCPU\u7684\u4E2D\u95F4\u4ED3\u5E93\u53CA\u6865\u6881</strong>\uFF0C\u627F\u8F7D\u7740\u64CD\u4F5C\u7CFB\u7EDF\u548C\u5E94\u7528\u7A0B\u5E8F\u7684\u5B9E\u65F6\u8FD0\u884C\u3002JVM\u5185\u5B58\u5E03\u5C40\u89C4\u5B9A\u4E86Java\u5728\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u5185\u5B58\u7533\u8BF7\u3001\u5206\u914D\u3001\u7BA1\u7406\u7684\u7B56\u7565\uFF0C\u4FDD\u8BC1\u4E86JVM\u7684\u9AD8\u6548\u7A33\u5B9A\u8FD0\u884C\u3002\u4E0D\u540C\u7684JVM\u5BF9\u4E8E\u5185\u5B58\u7684\u5212\u5206\u65B9\u5F0F\u548C\u7BA1\u7406\u673A\u5236\u5B58\u5728\u7740\u90E8\u5206\u5DEE\u5F02\u3002\u7ED3\u5408JVM\u865A\u62DF\u673A\u89C4\u8303\uFF0C\u6765\u63A2\u8BA8\u4E00\u4E0B\u7ECF\u5178\u7684JVM\u5185\u5B58\u5E03\u5C40\u3002</p><table><thead><tr><th></th><th>Error</th><th>GC(Garbage Collection)</th><th>OOM(OutOfMemoryError)</th><th>StackOverflowError</th></tr></thead><tbody><tr><td>\u7A0B\u5E8F\u8BA1\u6570\u5668</td><td>\u274C</td><td>\u274C</td><td>\u274C</td><td></td></tr><tr><td>\u672C\u5730\u65B9\u6CD5\u6808</td><td>\u2714\uFE0F</td><td>\u274C</td><td>\u2714\uFE0F</td><td>\u2714\uFE0F</td></tr><tr><td>\u865A\u62DF\u673A\u6808</td><td>\u2714\uFE0F</td><td>\u274C</td><td>\u2714\uFE0F</td><td>\u2714\uFE0F</td></tr><tr><td>\u5806</td><td>\u2714\uFE0F</td><td>\u2714\uFE0F</td><td>\u2714\uFE0F</td><td></td></tr><tr><td>\u65B9\u6CD5\u533A</td><td>\u2714\uFE0F</td><td>\u2714\uFE0F</td><td>\u2714\uFE0F</td><td></td></tr></tbody></table><img src="http://qnimg.gisfsde.com/work/image-20211117173714222.png" alt="image-20211117173714222" style="zoom:67%;"><img src="http://qnimg.gisfsde.com/work/image-20211117173754033.png" alt="image-20211117173754033" style="zoom:67%;"><img src="http://qnimg.gisfsde.com/work/image-20211117174004750.png" alt="image-20211117174004750" style="zoom:67%;"><p>\u200B Java\u865A\u62DF\u673A\u5B9A\u4E49\u4E86\u82E5\u5E72\u79CD\u7A0B\u5E8F\u8FD0\u884C\u671F\u95F4\u4F1A\u4F7F\u7528\u5230\u7684\u8FD0\u884C\u65F6\u6570\u636E\u533A\uFF0C\u5176\u4E2D\u6709\u4E00\u4E9B\u4F1A\u968F\u7740\u865A\u62DF\u673A\u542F\u52A8\u800C\u521B\u5EFA\uFF0C\u968F\u7740\u865A\u62DF\u673A\u9000\u51FA\u800C\u9500\u6BC1\u3002\u53E6\u5916\u4E00\u4E9B\u5219\u662F\u4E0E\u7EBF\u7A0B\u4E00\u4E00\u5BF9\u5E94\u7684\uFF0C\u8FD9\u4E9B\u4E0E\u7EBF\u7A0B\u5BF9\u5E94\u7684\u6570\u636E\u533A\u57DF\u4F1A\u968F\u7740\u7EBF\u7A0B\u5F00\u59CB\u548C\u7ED3\u675F\u800C\u521B\u5EFA\u548C\u9500\u6BC1\u3002\u7070\u8272\u7684\u4E3A\u5355\u72EC\u7EBF\u7A0B\u79C1\u6709\u7684\uFF0C\u7EA2\u8272\u7684\u4E3A\u591A\u4E2A\u7EBF\u7A0B\u5171\u4EAB\u7684\u3002\u5373:<strong>\u6BCF\u4E2A\u7EBF\u7A0B\u72EC\u7ACB\uFF1A\u5305\u62EC\u7A0B\u5E8F\u8BA1\u6570\u5668\u3001\u6808\u3001\u672C\u5730\u6808\u3002\u6BCF\u4E2A\u7EBF\u7A0B\u5171\u4EAB\uFF1A\u5806\u3001\u65B9\u6CD5\u533A</strong></p><img src="http://qnimg.gisfsde.com/work/\u7B2C03\u7AE0_\u7EBF\u7A0B\u5171\u4EAB\u548C\u79C1\u6709\u7684\u7ED3\u6784.jpg" alt="\u7B2C03\u7AE0_\u7EBF\u7A0B\u5171\u4EAB\u548C\u79C1\u6709\u7684\u7ED3\u6784" style="zoom:50%;"><h2 id="_2-\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#_2-\u7EBF\u7A0B" aria-hidden="true">#</a> 2.\u7EBF\u7A0B</h2><p>\u200B \u7EBF\u7A0B\u662F\u4E00\u4E2A\u7A0B\u5E8F\u91CC\u7684\u8FD0\u884C\u5355\u5143\u3002JVM\u5141\u8BB8\u4E00\u4E2A\u5E94\u7528\u6709\u591A\u4E2A\u7EBF\u7A0B\u5E76\u884C\u7684\u6267\u884C\u3002\u5728Hotspot JVM\u91CC\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u4E0E\u64CD\u4F5C\u7CFB\u7EDF\u7684\u672C\u5730\u7EBF\u7A0B\u76F4\u63A5\u6620\u5C04\u3002 \u200B \u5F53\u4E00\u4E2AJava\u7EBF\u7A0B\u51C6\u5907\u597D\u6267\u884C\u4EE5\u540E\uFF0C\u6B64\u65F6\u4E00\u4E2A\u64CD\u4F5C\u7CFB\u7EDF\u7684\u672C\u5730\u7EBF\u7A0B\u4E5F\u540C\u65F6\u521B\u5EFA\u3002Java\u7EBF\u7A0B\u6267\u884C\u7EC8\u6B62\u540E\uFF0C\u672C\u5730\u7EBF\u7A0B\u4E5F\u4F1A\u56DE\u6536\u3002\u64CD\u4F5C\u7CFB\u7EDF\u8D1F\u8D23\u6240\u6709\u7EBF\u7A0B\u7684\u5B89\u6392\u8C03\u5EA6\u5230\u4EFB\u4F55\u4E00\u4E2A\u53EF\u7528\u7684CPU\u4E0A\u3002\u4E00\u65E6\u672C\u5730\u7EBF\u7A0B\u521D\u59CB\u5316\u6210\u529F\uFF0C\u5B83\u5C31\u4F1A\u8C03\u7528Java\u7EBF\u7A0B\u4E2D\u7684run ()\u65B9\u6CD5\u3002</p><p>\u200B \u5982\u679C\u4F60\u4F7F\u7528jconsole\u6216\u8005\u662F\u4EFB\u4F55\u4E00\u4E2A\u8C03\u8BD5\u5DE5\u5177\uFF0C\u90FD\u80FD\u770B\u5230\u5728\u540E\u53F0\u6709\u8BB8\u591A\u7EBF\u7A0B\u5728\u8FD0\u884C\u3002\u8FD9\u4E9B\u540E\u53F0\u7EBF\u7A0B\u4E0D\u5305\u62EC\u8C03\u7528public static void main (string[])\u7684main\u7EBF\u7A0B\u4EE5\u53CA\u6240\u6709\u8FD9\u4E2Amain\u7EBF\u7A0B\u81EA\u5DF1\u521B\u5EFA\u7684\u7EBF\u7A0B\u3002\u8FD9\u4E9B\u4E3B\u8981\u7684\u540E\u53F0\u7CFB\u7EDF\u7EBF\u7A0B\u5728Hotspot JVM\u91CC\u4E3B\u8981\u662F\u4EE5\u4E0B\u51E0\u4E2A:</p><p>**\u865A\u62DF\u673A\u7EBF\u7A0B:**\u8FD9\u79CD\u7EBF\u7A0B\u7684\u64CD\u4F5C\u662F\u9700\u8981JVM\u8FBE\u5230\u5B89\u5168\u70B9\u624D\u4F1A\u51FA\u73B0\u3002\u8FD9\u4E9B\u64CD\u4F5C\u5FC5\u987B\u5728\u4E0D\u540C\u7684\u7EBF\u7A0B\u4E2D\u53D1\u751F\u7684\u539F\u56E0\u662F\u4ED6\u4EEC\u90FD\u9700\u8981JVM\u8FBE\u5230\u5B89\u5168\u70B9\uFF0C\u8FD9\u6837\u5806\u624D\u4E0D\u4F1A\u53D8\u5316\u3002\u8FD9\u79CD \u7EBF\u7A0B\u7684\u6267\u884C\u7C7B\u578B\u5305\u62EC&quot;stop-the-world&quot;\u7684\u5783\u573E\u6536\u96C6\uFF0C\u7EBF\u7A0B\u6808\u6536\u96C6\uFF0C\u7EBF\u7A0B\u6302\u8D77\u4EE5\u53CA\u504F\u5411\u9501\u64A4\u9500\u3002 **\u5468\u671F\u4EFB\u52A1\u7EBF\u7A0B:**\u8FD9\u79CD\u7EBF\u7A0B\u662F\u65F6\u95F4\u5468\u671F\u4E8B\u4EF6\u7684\u4F53\u73B0(\u6BD4\u5982\u4E2D\u65AD)\uFF0C\u4ED6\u4EEC\u4E00\u822C\u7528\u4E8E\u5468\u671F\u6027\u64CD\u4F5C\u7684\u8C03\u5EA6\u6267\u884C\u3002 **GC\u7EBF\u7A0B:**\u8FD9\u79CD\u7EBF\u7A0B\u5BF9\u5728JVM\u91CC\u4E0D\u540C\u79CD\u7C7B\u7684\u5783\u573E\u6536\u96C6\u884C\u4E3A\u63D0\u4F9B\u4E86\u652F\u6301\u3002&gt;\u7F16\u8BD1\u7EBF\u7A0B:\u8FD9\u79CD\u7EBF\u7A0B\u5728\u8FD0\u884C\u65F6\u4F1A\u5C06\u5B57\u8282\u7801\u7F16\u8BD1\u6210\u5230\u672C\u5730\u4EE3\u7801\u3002 **\u4FE1\u53F7\u8C03\u5EA6\u7EBF\u7A0B:**\u8FD9\u79CD\u7EBF\u7A0B\u63A5\u6536\u4FE1\u53F7\u5E76\u53D1\u9001\u7ED9JVM\uFF0C\u5728\u5B83\u5185\u90E8\u901A\u8FC7\u8C03\u7528\u9002\u5F53\u7684\u65B9\u6CD5\u8FDB\u884C\u5904\u7406\u3002</p><p>\xB7\u7EBF\u7A0B\u662F\u4E00\u4E2A\u7A0B\u5E8F\u91CC\u7684\u8FD0\u884C\u5355\u5143\u3002JVM\u5141\u8BB8\u4E00\u4E2A\u5E94\u7528\u6709\u591A\u4E2A\u7EBF\u7A0B\u5E76\u884C\u7684\u6267\u884C\u3002 .\u5728Hotspot JVM\u91CC\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u4E0E\u64CD\u4F5C\u7CFB\u7EDF\u7684\u672C\u5730\u7EBF\u7A0B\u76F4\u63A5\u6620\u5C04\u3002</p><p>\u5F53\u4E00\u4E2AJava\u7EBF\u7A0B\u51C6\u5907\u597D\u6267\u884C\u4EE5\u540E\uFF0C\u6B64\u65F6\u4E00\u4E2A\u64CD\u4F5C\u7CFB\u7EDF\u7684\u672C\u5730\u7EBF\u7A0B\u4E5F\u540C\u65F6\u521B\u5EFA\u3002Java\u7EBF\u7A0B\u6267\u884C\u7EC8\u6B62\u540E\uFF0C\u672C\u5730\u7EBF\u7A0B\u4E5F\u4F1A\u56DE\u6536\u3002 \xB7\u64CD\u4F5C\u7CFB\u7EDF\u8D1F\u8D23\u6240\u6709\u7EBF\u7A0B\u7684\u5B89\u6392\u8C03\u5EA6\u5230\u4EFB\u4F55\u4E00\u4E2A\u53EF\u7528\u7684CPU\u4E0A\u3002\u4E00\u65E6\u672C\u5730\u7EBF\u7A0B\u521D\u59CB\u5316\u6210\u529F\uFF0C\u5B83\u5C31\u4F1A\u8C03\u7528Java\u7EBF\u7A0B\u4E2D\u7684run ()\u65B9\u6CD5\u3002 \u25CF\u5B88\u62A4\u7EBF\u7A0B\u3001\u666E\u901A\u7EBF\u7A0B</p><h1 id="\u56DB\u3001\u7A0B\u5E8F\u8BA1\u6570\u5668" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001\u7A0B\u5E8F\u8BA1\u6570\u5668" aria-hidden="true">#</a> \u56DB\u3001<em>\u7A0B\u5E8F\u8BA1\u6570\u5668</em></h1>',141),P={id:"_1-program-counter-register\u4ECB\u7ECD",tabindex:"-1"},V=a("a",{class:"header-anchor",href:"#_1-program-counter-register\u4ECB\u7ECD","aria-hidden":"true"},"#",-1),T=n(" 1."),A={href:"https://docs.oracle.com/javaselspecs/jvms/se8/html/",target:"_blank",rel:"noopener noreferrer"},O=n("Program Counter Register\u4ECB\u7ECD"),L=s(`<p>\u200B JVM\u4E2D\u7684\u7A0B\u5E8F\u8BA1\u6570\u5BC4\u5B58\u5668(Program counter Register)\u4E2D\uFF0C Register\u7684\u547D\u540D\u6E90\u4E8ECPU\u7684\u5BC4\u5B58\u5668\uFF0C\u5BC4\u5B58\u5668\u5B58\u50A8\u6307\u4EE4\u76F8\u5173\u7684\u73B0\u573A\u4FE1\u606F\u3002CPU\u53EA\u6709\u628A\u6570\u636E\u88C5\u8F7D\u5230\u5BC4\u5B58\u5668\u624D\u80FD\u591F\u8FD0\u884C\u3002\u8FD9\u91CC\uFF0C\u5E76\u975E\u662F\u5E7F\u4E49\u4E0A\u6240\u6307\u7684\u7269\u7406\u5BC4\u5B58\u5668\uFF0C\u6216\u8BB8\u5C06\u5176\u7FFB\u8BD1\u4E3APC\u8BA1\u6570\u5668\uFF08\u6216\u6307\u4EE4\u8BA1\u6570\u5668\uFF09\u4F1A\u66F4\u52A0\u8D34\u5207(\u4E5F\u79F0\u4E3A\u7A0B\u5E8F\u94A9\u5B50)\uFF0C\u5E76\u4E14\u4E5F\u4E0D\u5BB9\u6613\u5F15\u8D77\u4E00\u4E9B\u4E0D\u5FC5\u8981\u7684\u8BEF\u4F1A\u3002JVM\u4E2D\u7684PC\u5BC4\u5B58\u5668\u662F\u5BF9\u7269\u7406PC\u5BC4\u5B58\u5668\u7684\u4E00\u79CD\u62BD\u8C61\u6A21\u62DF\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211117141024972.png" alt="image-20211117141024972" style="zoom:67%;"><p>\u4F5C\u7528: <strong>PC\u5BC4\u5B58\u5668\u7528\u6765\u5B58\u50A8\u6307\u5411\u4E0B\u4E00\u6761\u6307\u4EE4\u7684\u5730\u5740,\u4E5F\u5373\u5C06\u8981\u6267\u884C\u7684\u6307\u4EE4\u4EE3\u7801</strong>\u3002\u7531\u6267\u884C\u5F15\u64CE\u8BFB\u53D6\u4E0B\u4E00\u6761\u6307\u4EE4(\u6307\u4EE4\u4EE3\u7801\u5728java\u6808\u4E2D\u5BF9\u5E94\u7684\u6307\u4EE4)\u3002</p><p><img src="http://qnimg.gisfsde.com/work/image-20211117141325424.png" alt="image-20211117141325424" loading="lazy"></p><p>\u5B83\u662F\u4E00\u5757\u5F88\u5C0F\u7684\u5185\u5B58\u7A7A\u95F4\uFF0C\u51E0\u4E4E\u53EF\u4EE5\u5FFD\u7565\u4E0D\u8BB0\u3002\u4E5F\u662F<strong>\u8FD0\u884C\u901F\u5EA6\u6700\u5FEB\u7684\u5B58\u50A8\u533A\u57DF</strong>\u3002 \u5728JVM\u89C4\u8303\u4E2D\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u6709\u5B83\u81EA\u5DF1\u7684\u7A0B\u5E8F\u8BA1\u6570\u5668\uFF0C\u662F\u7EBF\u7A0B\u79C1\u6709\u7684\uFF0C\u751F\u547D\u5468\u671F\u4E0E\u7EBF\u7A0B\u7684\u751F\u547D\u5468\u671F\u4FDD\u6301\u4E00\u81F4\u3002 \u4EFB\u4F55\u65F6\u95F4\u4E00\u4E2A\u7EBF\u7A0B\u90FD\u53EA\u6709\u4E00\u4E2A\u65B9\u6CD5\u5728\u6267\u884C\uFF0C\u4E5F\u5C31\u662F\u6240\u8C13\u7684\u5F53\u524D\u65B9\u6CD5\u3002\u7A0B\u5E8F\u8BA1\u6570\u5668\u4F1A\u5B58\u50A8\u5F53\u524D\u7EBF\u7A0B\u6B63\u5728\u6267\u884C\u7684Java\u65B9\u6CD5\u7684TVM\u6307\u4EE4\u5730\u5740;\u6216\u8005\uFF0C\u5982\u679C\u662F\u5728\u6267\u884Cnative\u65B9\u6CD5\uFF0C\u5219\u662F\u672A\u6307\u5B9A\u503C\uFF08undefned) \u3002</p><p>\u5B83\u662F\u7A0B\u5E8F\u63A7\u5236\u6D41\u7684\u6307\u793A\u5668\uFF0C\u5206\u652F\u3001\u5FAA\u73AF\u3001\u8DF3\u8F6C\u3001\u5F02\u5E38\u5904\u7406\u3001\u7EBF\u7A0B\u6062\u590D\u7B49\u57FA\u7840\u529F\u80FD\u90FD\u9700\u8981\u4F9D\u8D56\u8FD9\u4E2A\u8BA1\u6570\u5668\u6765\u5B8C\u6210\u3002 \u5B57\u8282\u7801\u89E3\u91CA\u5668\u5DE5\u4F5C\u65F6\u5C31\u662F\u901A\u8FC7\u6539\u53D8\u8FD9\u4E2A\u8BA1\u6570\u5668\u7684\u503C\u6765\u9009\u53D6\u4E0B\u4E00\u6761\u9700\u8981\u6267\u884C\u7684\u5B57\u8282\u7801\u6307\u4EE4\u3002 \u5B83\u662F<strong>\u552F\u4E00\u4E00\u4E2A\u5728Java\u865A\u62DF\u673A\u89C4\u8303\u4E2D\u6CA1\u6709\u89C4\u5B9A\u4EFB\u4F55OutOfMemoryError\u60C5\u51B5\u7684\u533A\u57DF</strong>\u3002</p><h3 id="_2-\u7A0B\u5E8F\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#_2-\u7A0B\u5E8F\u793A\u4F8B" aria-hidden="true">#</a> 2.\u7A0B\u5E8F\u793A\u4F8B</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>javap <span class="token operator">-</span>v<span class="token operator">/</span>verbose \uFF08<span class="token keyword">class</span>\u540D\uFF09 <span class="token comment">//\u53CD\u7F16\u8BD1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-\u4E24\u4E2A\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_3-\u4E24\u4E2A\u95EE\u9898" aria-hidden="true">#</a> 3.\u4E24\u4E2A\u95EE\u9898</h3><h4 id="_1-\u4F7F\u7528pc\u5BC4\u5B58\u5668\u5B58\u50A8\u5B57\u8282\u7801\u6307\u4EE4\u5730\u5740\u6709\u4EC0\u4E48\u7528\u5462-\u4E3A\u4EC0\u4E48\u4F7F\u7528pc\u5BC4\u5B58\u5668\u8BB0\u5F55\u5F53\u524D\u7EBF\u7A0B\u7684\u6267\u884C\u5730\u5740\u5462" tabindex="-1"><a class="header-anchor" href="#_1-\u4F7F\u7528pc\u5BC4\u5B58\u5668\u5B58\u50A8\u5B57\u8282\u7801\u6307\u4EE4\u5730\u5740\u6709\u4EC0\u4E48\u7528\u5462-\u4E3A\u4EC0\u4E48\u4F7F\u7528pc\u5BC4\u5B58\u5668\u8BB0\u5F55\u5F53\u524D\u7EBF\u7A0B\u7684\u6267\u884C\u5730\u5740\u5462" aria-hidden="true">#</a> <strong>\uFF081\uFF09\u4F7F\u7528PC\u5BC4\u5B58\u5668\u5B58\u50A8\u5B57\u8282\u7801\u6307\u4EE4\u5730\u5740\u6709\u4EC0\u4E48\u7528\u5462?\u4E3A\u4EC0\u4E48\u4F7F\u7528PC\u5BC4\u5B58\u5668\u8BB0\u5F55\u5F53\u524D\u7EBF\u7A0B\u7684\u6267\u884C\u5730\u5740\u5462\uFF1F</strong></h4><p>\u56E0\u4E3ACPU\u9700\u8981\u4E0D\u505C\u7684\u5207\u6362\u5404\u4E2A\u7EBF\u7A0B\uFF0C\u8FD9\u65F6\u5019\u5207\u6362\u56DE\u6765\u4EE5\u540E\uFF0C\u5C31\u5F97\u77E5\u9053\u63A5\u7740\u4ECE\u54EA\u5F00\u59CB\u7EE7\u7EED\u6267\u884C\u3002 JVM\u7684\u5B57\u8282\u7801\u89E3\u91CA\u5668\u5C31\u9700\u8981\u901A\u8FC7\u6539\u53D8PC\u5BC4\u5B58\u5668\u7684\u503C\u6765\u660E\u786E\u4E0B\u4E00\u6761\u5E94\u8BE5\u6267\u884C\u4EC0\u4E48\u6837\u7684\u5B57\u8282\u7801\u6307\u4EE4\u3002</p><img src="http://qnimg.gisfsde.com/work/\u7B2C04\u7AE0_PC\u5BC4\u5B58\u5668.jpg" alt="\u7B2C04\u7AE0_PC\u5BC4\u5B58\u5668" style="zoom:50%;"><h4 id="_2-pc\u5BC4\u5B58\u5668\u4E3A\u4EC0\u4E48\u4F1A\u88AB\u8BBE\u5B9A\u4E3A\u7EBF\u7A0B\u79C1\u6709" tabindex="-1"><a class="header-anchor" href="#_2-pc\u5BC4\u5B58\u5668\u4E3A\u4EC0\u4E48\u4F1A\u88AB\u8BBE\u5B9A\u4E3A\u7EBF\u7A0B\u79C1\u6709" aria-hidden="true">#</a> <strong>(2)PC\u5BC4\u5B58\u5668\u4E3A\u4EC0\u4E48\u4F1A\u88AB\u8BBE\u5B9A\u4E3A\u7EBF\u7A0B\u79C1\u6709?</strong></h4><p>\u200B \u6211\u4EEC\u90FD\u77E5\u9053\u6240\u8C13\u7684\u591A\u7EBF\u7A0B\u5728\u4E00\u4E2A\u7279\u5B9A\u7684\u65F6\u95F4\u6BB5\u5185\u53EA\u4F1A\u6267\u884C\u5176\u4E2D\u67D0\u4E00\u4E2A\u7EBF\u7A0B\u7684\u65B9\u6CD5\uFF0CCPU\u4F1A\u4E0D\u505C\u5730\u505A\u4EFB\u52A1\u5207\u6362\uFF0C\u8FD9\u6837\u5FC5\u7136\u5BFC\u81F4\u7ECF\u5E38\u4E2D\u65AD\u6216\u6062\u590D\uFF0C\u5982\u4F55\u4FDD\u8BC1\u5206\u6BEB\u65E0\u5DEE\u5462?\u4E3A\u4E86\u80FD\u591F\u51C6\u786E\u5730\u8BB0\u5F55\u5404\u4E2A\u7EBF\u7A0B\u6B63\u5728\u6267\u884C\u7684\u5F53\u524D\u5B57\u8282\u7801\u6307\u4EE4\u5730\u5740\uFF0C\u6700\u597D\u7684\u529E\u6CD5\u81EA\u7136\u662F\u4E3A\u6BCF\u4E00\u4E2A\u7EBF\u7A0B\u90FD\u5206\u914D\u4E00\u4E2APC\u5BC4\u5B58\u5668\uFF0C\u8FD9\u6837\u4E00\u6765\u5404\u4E2A\u7EBF\u7A0B\u4E4B\u95F4\u4FBF\u53EF\u4EE5\u8FDB\u884C\u72EC\u7ACB\u8BA1\u7B97\uFF0C\u4ECE\u800C\u4E0D\u4F1A\u51FA\u73B0\u76F8\u4E92\u5343\u6270\u7684\u60C5\u51B5\u3002</p><p>\u200B CPU\u65F6\u95F4\u7247\u5373CPU\u5206\u914D\u7ED9\u5404\u4E2A\u7A0B\u5E8F\u7684\u65F6\u95F4\uFF0C\u6BCF\u4E2A\u7EBF\u7A0B\u88AB\u5206\u914D\u4E00\u4E2A\u65F6\u95F4\u6BB5\uFF0C\u79F0\u4F5C\u5B83\u7684\u65F6\u95F4\u7247\u3002\u5728\u5B8F\u89C2\u4E0A:\u6211\u4EEC\u53EF\u4EE5\u540C\u65F6\u6253\u5F00\u591A\u4E2A\u5E94\u7528\u7A0B\u5E8F\uFF0C\u6BCF\u4E2A\u7A0B\u5E8F\u5E76\u884C\u4E0D\u6096\uFF0C\u540C\u65F6\u8FD0\u884C\u3002\u4F46\u5728\u5FAE\u89C2\u4E0A:\u7531\u4E8E\u53EA\u6709\u4E00\u4E2ACPU\uFF0C\u4E00\u6B21\u53EA\u80FD\u5904\u7406\u7A0B\u5E8F\u8981\u6C42\u7684\u4E00\u90E8\u5206\uFF0C\u5982\u4F55\u5904\u7406\u516C\u5E73\uFF0C\u4E00\u79CD\u65B9\u6CD5\u5C31\u662F\u5F15\u5165\u65F6\u95F4\u7247\uFF0C\u6BCF\u4E2A\u7A0B\u5E8F\u8F6E\u6D41\u6267\u884C\u3002</p><h1 id="\u4E94\u3001\u865A\u62DF\u673A\u6808" tabindex="-1"><a class="header-anchor" href="#\u4E94\u3001\u865A\u62DF\u673A\u6808" aria-hidden="true">#</a> \u4E94\u3001\u865A\u62DF\u673A\u6808</h1><h3 id="_1-\u6808\u4E3B\u8981\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#_1-\u6808\u4E3B\u8981\u7279\u70B9" aria-hidden="true">#</a> 1.\u6808\u4E3B\u8981\u7279\u70B9</h3><p>\u200B \u7531\u4E8E\u8DE8\u534A\u53F0\u6027\u7684\u8BBE\u8BA1\uFF0CJava\u7684\u6307\u4EE4\u90FD\u662F\u6839\u636E\u6808\u6765\u8BBE\u8BA1\u7684\u3002\u4E0D\u540C\u5E73\u53F0CPU\u67B6\u6784\u4E0D\u540C\uFF0C\u6240\u4EE5\u4E0D\u80FD\u8BBE\u8BA1\u4E3A\u57FA\u4E8E\u5BC4\u5B58\u5668\u7684\u3002\u4F18\u70B9\u662F\u8DE8\u5E73\u53F0\uFF0C\u6307\u4EE4\u96C6\u5C0F\uFF0C\u7F16\u8BD1\u5668\u5BB9\u6613\u5B9E\u73B0\uFF0C\u7F3A\u70B9\u662F\u6027\u80FD\u4E0B\u964D\uFF0C\u5B9E\u73B0\u540C\u6837\u7684\u529F\u80FD\u9700\u8981\u66F4\u591A\u7684\u6307\u4EE4\u3002**\u6808\u662F\u8FD0\u884C\u65F6\u7684\u5355\u4F4D\uFF0C\u800C\u5806\u662F\u5B58\u50A8\u7684\u5355\u4F4D\u3002**\u5373\uFF1A<strong>\u6808\u89E3\u51B3\u7A0B\u5E8F\u7684\u8FD0\u884C\u95EE\u9898\uFF0C\u5373\u7A0B\u5E8F\u5982\u4F55\u6267\u884C\uFF0C\u6216\u8005\u8BF4\u5982\u4F55\u5904\u7406\u6570\u636E\u3002\u5806\u89E3\u51B3\u7684\u662F\u6570\u636E\u5B58\u50A8\u7684\u95EE\u9898\uFF0C\u5373\u6570\u636E\u600E\u4E48\u653E\u3001\u653E\u5728\u54EA\u513F\u3002</strong></p><h4 id="\u30FBjava\u865A\u62DF\u673A\u6808\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u30FBjava\u865A\u62DF\u673A\u6808\u662F\u4EC0\u4E48" aria-hidden="true">#</a> <strong>\u30FBJava\u865A\u62DF\u673A\u6808\u662F\u4EC0\u4E48\uFF1F</strong></h4><p>Java\u865A\u62DF\u673A\u6808( Java Virtual Machine Stack),\u65E9\u671F\u4E5F\u53EBJava\u6808\u3002\u6BCF\u4E2A\u7EBF\u7A0B\u5728\u521B\u5EFA\u65F6\u90FD\u4F1A\u521B\u5EFA\u4E00\u4E2A\u865A\u62DF\u673A\u6808\uFF0C\u5176\u5185\u90E8\u4FDD\u5B58\u4E00\u4E2A\u4E2A\u7684\u6808\u5E27( Stack Frame),\u5BF9\u5E94\u7740\u4E00\u6B21\u6B21\u7684Java\u65B9\u6CD5\u8C03\u7528\uFF0C<strong>\u662F\u7EBF\u7A0B\u79C1\u6709\u7684\u3002\u751F\u547D\u5468\u671F\u548C\u7EBF\u7A0B\u4E00\u81F4</strong>\u3002</p><h4 id="\u30FB\u4F5C\u7528" tabindex="-1"><a class="header-anchor" href="#\u30FB\u4F5C\u7528" aria-hidden="true">#</a> <strong>\u30FB\u4F5C\u7528</strong></h4><p>\u4E3B\u7BA1Java\u7A0B\u5E8F\u7684\u8FD0\u884C\uFF0C\u5B83<strong>\u4FDD\u5B58\u65B9\u6CD5\u7684\u5C40\u90E8\u53D8\u91CF(8\u79CD\u57FA\u672C\u6570\u636E\u7C7B\u578B\u3001\u5BF9\u8C61\u7684\u5F15\u7528\u5730\u5740)\u3001\u90E8\u5206\u7ED3\u679C\uFF0C\u5E76\u53C2\u4E0E\u65B9\u6CD5\u7684\u8C03\u7528\u548C\u8FD4\u56DE\u3002</strong> \u5C40\u90E8\u53D8\u91CFvs\u6210\u5458\u53D8\u91CF\uFF08\u6216\u5C5E\u6027\uFF09 \u57FA\u672C\u6570\u636E\u53D8\u91CFvs\u5F15\u7528\u7C7B\u578B\u53D8\u91CF(\u7C7B\u3001\u6570\u7EC4\u3001\u63A5\u53E3)</p><h4 id="\u30FB\u6808\u7684\u7279\u70B9-\u4F18\u70B9" tabindex="-1"><a class="header-anchor" href="#\u30FB\u6808\u7684\u7279\u70B9-\u4F18\u70B9" aria-hidden="true">#</a> <strong>\u30FB\u6808\u7684\u7279\u70B9\uFF08\u4F18\u70B9\uFF09</strong></h4><p>\u6808\u662F\u4E00\u79CD\u5FEB\u901F\u6709\u6548\u7684\u5206\u914D\u5B58\u50A8\u65B9\u5F0F\uFF0C<strong>\u8BBF\u95EE\u901F\u5EA6\u4EEA\u6B21\u4E8E\u7A0B\u5E8F\u8BA1\u6570\u5668</strong>\u3002 JVM\u76F4\u63A5\u5BF9Java\u6808\u7684\u64CD\u4F5C\u53EA\u6709\u4E24\u4E2A\uFF1A \u6BCF\u4E2A\u65B9\u6CD5\u6267\u884C\uFF0C\u4F34\u968F\u7740\u8FDB\u6808(\u5165\u6808\u3001\u538B\u6808) \u6267\u884C\u7ED3\u675F\u540E\u7684\u51FA\u6808\u5DE5\u4F5C \u5BF9\u4E8E\u6808\u6765\u8BF4<strong>\u4E0D\u5B58\u5728\u5783\u573E\u56DE\u6536\u95EE\u9898</strong></p><h3 id="_2-\u6808\u4E2D\u53EF\u80FD\u51FA\u73B0\u7684\u5F02\u5E38" tabindex="-1"><a class="header-anchor" href="#_2-\u6808\u4E2D\u53EF\u80FD\u51FA\u73B0\u7684\u5F02\u5E38" aria-hidden="true">#</a> 2.\u6808\u4E2D\u53EF\u80FD\u51FA\u73B0\u7684\u5F02\u5E38</h3><p>\u200B Java\u865A\u62DF\u673A\u89C4\u8303\u5141\u8BB8Java\u6808\u7684\u5927\u5C0F\u662F\u52A8\u6001\u7684\u6216\u8005\u662F\u56FA\u5B9A\u4E0D\u53D8\u7684\u3002 \u200B \u5982\u679C\u91C7\u7528\u56FA\u5B9A\u5927\u5C0F\u7684Java\u865A\u62DF\u673A\u6808\uFF0C\u90A3\u6BCF\u4E00\u4E2A\u7EBF\u7A0B\u7684Java\u865A\u62DF\u673A\u6808\u5BB9\u91CF\u53EF\u4EE5\u5728\u7EBF\u7A0B\u521B\u5EFA\u7684\u65F6\u5019\u72EC\u7ACB\u9009\u5B9A\u3002\u5982\u679C\u7EBF\u7A0B\u8BF7\u6C42\u5206\u914D\u7684\u6808\u5BB9\u91CF\u8D85\u8FC7Java\u865A\u62DF\u673A\u6808\u5141\u8BB8\u7684\u6700\u5927\u5BB9\u91CF\uFF0CJava\u865A\u62DF\u673A\u5C06\u4F1A\u629B\u51FA\u4E00\u4E2A<strong>StackOverflowError</strong>\u5F02\u5E38\u3002</p><p>\u200B \u5982\u679CJava\u865A\u62DF\u673A\u6808\u53EF\u4EE5\u52A8\u6001\u6269\u5C55\uFF0C\u5E76\u4E14\u5728\u5C1D\u8BD5\u6269\u5C55\u7684\u65F6\u5019\u65E0\u6CD5\u4E2D\u8BF7\u5230\u8DB3\u591F\u7684\u5185\u5B58\uFF0C\u6216\u8005\u5728\u521B\u5EFA\u65B0\u7684\u7EBF\u7A0B\u65F6\u6CA1\u6709\u8DB3\u591F\u7684\u5185\u5B58\u53BB\u521B\u5EFA\u5BF9\u5E94\u7684\u865A\u62DF\u673A\u6808\uFF0C\u90A3Java\u865A\u62DF\u673A\u5C06\u4F1A\u629B\u51FA\u4E00\u4E2A <strong>OutOfMemoryError</strong>\u5F02\u5E38\u3002</p><h4 id="\u8BBE\u7F6E\u6808\u5927\u5C0F" tabindex="-1"><a class="header-anchor" href="#\u8BBE\u7F6E\u6808\u5927\u5C0F" aria-hidden="true">#</a> <strong>\u8BBE\u7F6E\u6808\u5927\u5C0F</strong></h4><blockquote><p>Xss size Sets the thread stack size( in bytes). Append the letter k or K to indicate KB, m or M to indicate MB, and g or G to indicate GB. The default value depends on the platform Linux/x64(64-bit): 1024 KB macos(64-bit): 1024 KB Oracle Solaris/x64(64-bit): 1024 KB Windows: The default value depends on virtual memory The following examples set the thread stack size to 1024 KB in different units -Xss1m -Xss1024k Xss1048576</p></blockquote><p><img src="http://qnimg.gisfsde.com/work/image-20211122140441632.png" alt="" loading="lazy"></p><img src="http://qnimg.gisfsde.com/work/image-20211122140406127.png" alt="image-20211122140406127" style="zoom:80%;"><h3 id="_3-\u6808\u5B58\u50A8\u5355\u4F4D" tabindex="-1"><a class="header-anchor" href="#_3-\u6808\u5B58\u50A8\u5355\u4F4D" aria-hidden="true">#</a> 3.\u6808\u5B58\u50A8\u5355\u4F4D</h3><p>\u6808\u4E2D\u5B58\u50A8\u4EC0\u4E48 \u30FB\u6BCF\u4E2A\u7EBF\u7A0B\u90FD\u6709\u81EA\u5DF1\u7684\u6808\uFF0C\u6808\u4E2D\u7684\u6570\u636E\u90FD\u662F\u4EE5\u6808\u5E27( Stack Frame)\u7684\u683C\u5F0F\u5B58\u5728\u3002 \u30FB\u5728\u8FD9\u4E2A\u7EBF\u7A0B\u4E0A\u6B63\u5728\u6267\u884C\u7684\u6808\u5E27( Stack Frame) \u6808\u5E27\u662F\u4E00\u4E2A\u5185\u5B58\u533A\u5757\uFF0C\u662F\u4E00\u4E2A\u6570\u636E\u96C6\uFF0C\u7EF4\u7CFB\u7740\u65B9\u6CD5\u6267\u884C\u8FC7\u7A0B\u4E2D\u7684\u5404\u79CD\u6570\u636E\u4FE1\u606F \u590D\u4E60 \u30FBOOP\u7684\u57FA\u672C\u6982\u5FF5\uFF1A\u7C7B\u3001\u5BF9\u8C61 \u30FB\u7C7B\u4E2D\u57FA\u672C\u7ED3\u6784\uFF1Afield(\u5C5E\u6027\u3001\u5B57\u6BB5\u3001\u57DF)\u3001 method</p><p>JVM\u76F4\u63A5\u5BF9Java\u6808\u7684\u64CD\u4F5C\u53EA\u6709\u4E24\u4E2A\uFF0C\u5C31\u662F\u5BF9\u6808\u5E27\u7684\u6808\u548C\u51FA\u6808\uFF0C\u9075\u5FAA\u201C\u5148\u8FDB\u540E\u51FA\u201D/\u201C\u540E\u8FDB\u5148\u51FA\u201D\u539F\u5219\u3002 \u5728\u4E00\u6761\u6D3B\u52A8\u7EBF\u7A0B\u4E2D\uFF0C\u4E00\u4E2A\u65F6\u95F4\u70B9\u4E0A\uFF0C\u53EA\u4F1A\u6709\u4E00\u4E2A\u6D3B\u52A8\u7684\u6808\u5E27\u3002\u5373\u53EA\u6709\u5F53\u524D\u6B63\u5728\u6267\u884C\u7684\u65B9\u6CD5\u7684\u6808\u5E27\uFF08\u6808\u9876\u6808\u5E27\uFF09\u662F\u6709\u6548\u7684\uFF0C\u8FD9\u4E2A\u6808\u5E27\u88AB\u79F0\u4E3A\u5F53\u524D\u6808\u5E27( Current Frame),\u4E0E\u5F53\u524D\u6808\u5E27\u76F8\u5BF9\u5E94\u7684\u65B9\u6CD5\u5C31\u662F\u5F53\u524D\u65B9\u6CD5\uFF08 Current Method),\u5B9A\u4E49\u8FD9\u4E2A\u65B9\u6CD5\u7684\u7C7B\u5C31\u662F\u5F53\u524D\u7C7B( Current Class). \u6267\u884C\u5F15\u64CE\u8FD0\u884C\u7684\u6240\u6709\u5B57\u8282\u7801\u6307\u4EE4\u53EA\u9488\u5BF9\u5F53\u524D\u6808\u5E27\u8FDB\u884C\u64CD\u4F5C\u3002 \u5982\u679C\u5728\u8BE5\u65B9\u6CD5\u4E2D\u8C03\u7528\u4E86\u5176\u4ED6\u65B9\u6CD5\uFF0C\u5BF9\u5E94\u7684\u65B0\u7684\u6808\u5E27\u4F1A\u88AB\u521B\u5EFA\u51FA\u6765\uFF0C\u653E\u5728\u6808\u7684\u9876\u7AEF\uFF0C\u6210\u4E3A\u65B0\u7684\u5F53\u524D\u5E27\u3002</p><p><img src="http://qnimg.gisfsde.com/work/image-20211122183152431.png" alt="image-20211122183152431" loading="lazy"></p><p>\u30FB\u4E0D\u540C\u7EBF\u7A0B\u4E2D\u6240\u5305\u542B\u7684\u6808\u5E27\u662F\u4E0D\u5141\u8BB8\u5B58\u5728\u76F8\u4E92\u5F15\u7528\u7684\uFF0C\u5373\u4E0D\u53EF\u80FD\u5728\u4E00\u4E2A\u6808\u5E27\u4E4B\u4E2D\u5F15\u7528\u53E6\u5916\u4E00\u4E2A\u7EBF\u7A0B\u7684\u6808\u5E27 \u30FB\u5982\u679C\u5F53\u524D\u65B9\u6CD5\u8C03\u7528\u4E86\u5176\u4ED6\u65B9\u6CD5\uFF0C\u65B9\u6CD5\u8FD4\u56DE\u4E4B\u9645\uFF0C\u5F53\u524D\u6808\u5E27\u4F1A\u4F20\u56DE\u6B64\u65B9\u6CD5\u7684\u6267\u884C\u7ED3\u679C\u7ED9\u524D\u4E00\u4E2A\u6808\u5E27\uFF0C\u63A5\u7740\uFF0C\u865A\u62DF\u673A\u4F1A\u4E22\u5F03\u5F53\u524D\u6808\u5E27\uFF0C\u4F7F\u5F97\u524D\u4E00\u4E2A\u6808\u5E27\u91CD\u65B0\u6210\u4E3A\u5F53\u524D\u6808\u5E27\u3002 \u30FBJava\u65B9\u6CD5\u6709\u4E24\u79CD\u8FD4\u56DE\u51FD\u6570\u7684\u65B9\u5F0F\uFF0C\u4E00\u79CD\u662F\u6B63\u5E38\u7684\u51FD\u6570\u8FD4\u56DE\uFF0C\u4F7F\u7528 return\u6307\u4EE4\uFF1B\u53E6\u5916\u4E00\u79CD\u662F\u629B\u51FA\u5F02\u5E38\u3002\u4E0D\u7BA1\u4F7F\u7528\u54EA\u79CD\u65B9\u5F0F\uFF0C\u90FD\u4F1A\u5BFC\u81F4\u6808\u5E27\u88AB\u5F39\u51FA\u3002</p><h3 id="_4-\u6808\u5E27\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_4-\u6808\u5E27\u7ED3\u6784" aria-hidden="true">#</a> 4.\u6808\u5E27\u7ED3\u6784</h3><p><strong>\u30FB\u5C40\u90E8\u53D8\u91CF\u8868(Local variables)</strong><strong>\u30FB\u64CD\u4F5C\u6570\u6808( Operand Stack)\uFF08\u6216\u8868\u8FBE\u5F0F\u6808\uFF09</strong> \u30FB\u52A8\u6001\u94FE\u63A5( Dynamic Linking)\uFF08\u6216\u6307\u5411\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u7684\u65B9\u6CD5\u5F15\u7528\uFF09 \u30FB\u65B9\u6CD5\u8FD4\u56DE\u5730\u5740( Return Address)\uFF08\u6216\u65B9\u6CD5\u6B63\u5E38\u9000\u51FA\u6216\u8005\u5F02\u5E38\u9000\u51FA\u7684\u5B9A\u4E49\uFF09 \u30FB\u4E00\u4E9B\u9644\u52A0\u4FE1\u606F</p><p><img src="http://qnimg.gisfsde.com/work/\u7B2C05\u7AE0_\u6808\u6862\u5185\u90E8\u7ED3\u6784.jpg" alt="\u7B2C05\u7AE0_\u6808\u6862\u5185\u90E8\u7ED3\u6784" loading="lazy"></p><h4 id="_1-\u5C40\u90E8\u53D8\u91CF\u8868" tabindex="-1"><a class="header-anchor" href="#_1-\u5C40\u90E8\u53D8\u91CF\u8868" aria-hidden="true">#</a> 1.\u5C40\u90E8\u53D8\u91CF\u8868</h4><p>\u30FB\u5C40\u90E8\u53D8\u91CF\u8868\u4E5F\u88AB\u79F0\u4E4B\u4E3A\u5C40\u90E8\u53D8\u91CF\u6570\u7EC4\u6216\u672C\u5730\u53D8\u91CF\u8868 \u30FB\u5B9A\u4E49\u4E3A\u4E00\u4E2A\u6570\u5B57\u6570\u7EC4\uFF0C\u4E3B\u8981\u7528\u4E8E<strong>\u5B58\u50A8\u65B9\u6CD5\u53C2\u6570\u548C\u5B9A\u4E49\u5728\u65B9\u6CD5\u4F53\u5185\u7684\u5C40\u90E8\u53D8\u91CF,\u8FD9\u4E9B\u6570\u636E\u7C7B\u578B\u5305\u62EC\u5404\u7C7B\u57FA\u672C\u6570\u636E\u7C7B\u578B\u3001\u5BF9\u8C61\u5F15\u7528( reference),\u4EE5\u53CAreturnAddress\u7C7B\u578B</strong>\u3002 \u30FB\u7531\u4E8E\u5C40\u90E8\u53D8\u91CF\u8868\u662F\u5EFA\u7ACB\u5728\u7EBF\u7A0B\u7684\u6808\u4E0A\uFF0C\u662F\u7EBF\u7A0B\u7684\u79C1\u6709\u6570\u636E\uFF0C<strong>\u56E0\u6B64\u4E0D\u5B58\u5728\u6570\u636E\u5B89\u5168\u95EE\u9898</strong> \u30FB\u5C40\u90E8\u53D8\u91CF\u8868<strong>\u6240\u9700\u7684\u5BB9\u91CF\u5927\u5C0F\u662F\u5728\u7F16\u8BD1\u671F\u786E\u5B9A</strong>\u4E0B\u6765\u7684\uFF0C\u5E76\u4FDD\u5B58\u5728\u65B9\u6CD5\u7684code\u5C5E\u6027\u7684 maximuim local variables\u6570\u636E\u9879\u4E2D\u3002\u5728\u65B9\u6CD5\u8FD0\u884C\u671F\u95F4\u662F\u4E0D\u4F1A\u6539\u53D8\u5C40\u90E8\u53D8\u91CF\u8868\u7684\u5927\u5C0F\u7684\u3002</p><p>\u30FB\u65B9\u6CD5\u5D4C\u5957\u8C03\u7528\u7684\u6B21\u6570\u7531\u6808\u7684\u5927\u5C0F\u51B3\u5B9A\u3002\u4E00\u822C\u6765\u8BF4\uFF0C\u6808\u8D8A\u5927\uFF0C\u65B9\u6CD5\u5D4C\u5957\u8C03\u7528\u6B21\u6570\u8D8A\u591A\u3002\u5BF9\u4E00\u4E2A\u51FD\u6570\u800C\u8A00\uFF0C\u5B83\u7684\u53C2\u6570\u548C\u5C40\u90E8\u53D8\u91CF\u8D8A\u591A\uFF0C\u4F7F\u5F97\u5C40\u90E8\u53D8\u91CF\u8868\u81A8\u80C0\uFF0C\u5B83\u7684\u6808\u5E27\u5C31\u8D8A\u5927\uFF0C\u4EE5\u6EE1\u8DB3\u65B9\u6CD5\u8C03\u7528\u6240\u9700\u4F20\u9012\u7684\u4FE1\u606F\u5897\u5927\u7684\u9700\u6C42\u3002\u8FDB\u800C\u51FD\u6570\u8C03\u7528\u5C31\u4F1A\u5360\u7528\u66F4\u591A\u7684\u6808\u7A7A\u95F4\uFF0C\u5BFC\u81F4\u5176\u5D4C\u5957\u8C03\u7528\u6B21\u6570\u5C31\u4F1A\u51CF\u5C11\u3002 \u30FB\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u7684\u53D8\u91CF\u53EA\u5728\u5F53\u524D\u65B9\u6CD5\u8C03\u7528\u4E2D\u6709\u6548\u3002\u5728\u65B9\u6CD5\u6267\u884C\u65F6\uFF0C\u865A\u62DF\u673A\u901A\u8FC7\u4F7F\u7528\u5C40\u90E8\u53D8\u91CF\u8868\u5B8C\u6210\u53C2\u6570\u503C\u5230\u53C2\u6570\u53D8\u91CF\u5217\u8868\u7684\u4F20\u9012\u8FC7\u7A0B\u3002\u5F53\u65B9\u6CD5\u8C03\u7528\u7ED3\u675F\u540E\uFF0C\u968F\u7740\u65B9\u6CD5\u6808\u5E27\u7684\u9500\u6BC1\uFF0C\u5C40\u90E8\u53D8\u91CF\u8868\u4E5F\u4F1A\u968F\u4E4B\u9500\u6BC1\u3002</p><h4 id="_2-\u5B57\u8282\u7801\u4E2D\u65B9\u6CD5\u5185\u90E8\u7ED3\u6784\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#_2-\u5B57\u8282\u7801\u4E2D\u65B9\u6CD5\u5185\u90E8\u7ED3\u6784\u89E3\u6790" aria-hidden="true">#</a> 2.\u5B57\u8282\u7801\u4E2D\u65B9\u6CD5\u5185\u90E8\u7ED3\u6784\u89E3\u6790</h4><p><img src="http://qnimg.gisfsde.com/work/image-20211122190700864.png" alt="image-20211122190700864" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211122191003982.png" alt="image-20211122191003982" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211122191207552.png" alt="image-20211122191207552" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211122192009824.png" alt="image-20211122192009824" loading="lazy"></p><h4 id="_3-slot" tabindex="-1"><a class="header-anchor" href="#_3-slot" aria-hidden="true">#</a> 3.Slot</h4><p>\u30FB\u53C2\u6570\u503C\u7684\u5B58\u653E\u603B\u662F\u5728\u5C40\u90E8\u53D8\u91CF\u6570\u7EC4\u7684 index0\u5F00\u59CB\uFF0C\u5230\u6570\u7EC4\u957F\u5EA6-1\u7684\u7D22\u5F15\u7ED3\u675F \u30FB<strong>\u5C40\u90E8\u53D8\u91CF\u8868\uFF0C\u6700\u57FA\u672C\u7684\u5B58\u50A8\u5355\u5143\u662FSlot\uFF08\u53D8\u91CF\u69FD\uFF09</strong> \u30FB\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u5B58\u653E\u7F16\u8BD1\u671F\u53EF\u77E5\u7684\u5404\u79CD\u57FA\u672C\u6570\u636E\u7C7B\u578B(8\u79CD)\uFF0C\u5F15\u7528\u7C7B\u578B( reference), returnAddressa\u7C7B\u578B\u3002 \u30FB\u5728\u5C40\u90E8\u53D8\u91CF\u8868\u91CC\uFF0C32\u4F4D\u4EE5\u5185\u7684\u7C7B\u578B\u53EA\u5360\u7528\u4E00\u4E2Aslot(\u5305\u62ECreturnAddressa\u7C7B\u578B\uFF09\uFF0C64\u4F4D\u7684\u7C7B\u578B(long\u548C double)\u5360\u7528\u4E24\u4E2Aslot. byte\u3001 short\u3001char\u5728\u5B58\u50A8\u524D\u88AB\u8F6C\u6362\u4E3Aint, boolean\u4E5F\u88AB\u8F6C\u6362\u4E3Aint,0\u8868\u793A false,\u975E0\u8868\u793Atrue\u3002 long\u548Cdouble\u5219\u5360\u636E\u4E24\u4E2ASlot\u3002</p><p>\u30FBJVM\u4F1A\u4E3A\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u7684\u6BCF\u4E00\u4E2ASlot\u90FD\u5206\u914D\u4E00\u4E2A\u8BBF\u95EE\u7D20\u5F15\uFF0C\u901A\u8FC7\u8FD9\u4E2A\u7D20\u5F15\u5373\u53EF\u6210\u529F\u8BBF\u95EE\u5230\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u6307\u5B9A\u7684\u5C40\u90E8\u53D8\u91CF\u503C. \u30FB\u5F53\u4E00\u4E2A\u5B9E\u4F8B\u65B9\u6CD5\u88AB\u8C03\u7528\u7684\u65F6\u5019\uFF0C\u5B83\u7684\u65B9\u6CD5\u53C2\u6570\u548C\u65B9\u6CD5\u4F53\u5185\u90E8\u5B9A\u4E49\u7684\u5C40\u90E8\u53D8\u91CF\u5C06\u4F1A\u6309\u7167\u987A\u5E8F\u88AB\u590D\u5236\u5230\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u7684\u6BCF\u4E00\u4E2ASlot\u4E0A. \u30FB\u5982\u679C\u9700\u8981\u8BBF\u95EE\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u30FC\u4E2A64bit\u7684\u5C40\u90E8\u53D8\u91CF\u503C\u65F6\uFF0C\u53EA\u9700\u8981\u4F7F\u7528\u524D\u4E00\u4E2A\u7D20\u5F15\u5373\u53EF\u3002(\u6BD4\u5982\uFF1A\u8BBF\u95EE1ong\u6216doub1e\u7C7B\u578B\u53D8\u91CF). \u30FB\u5982\u679C\u5F53\u524D\u5E27\u662F\u7531\u6784\u9020\u65B9\u6CD5\u6216\u8005\u5B9E\u4F8B\u65B9\u6CD5\u521B\u5EFA\u7684\uFF0C\u90A3\u4E48\u8BE5\u5BF9\u8C61\u5F15\u7528this\u5C06\u4F1A\u5B58\u653E\u5728 index\u4E3A0\u7684slot\u5904\uFF0C\u5176\u4F59\u7684\u53C2\u6570\u6309\u7167\u53C2\u6570\u8868\u987A\u5E8F\u7EE7\u7EED\u6392\u5217.</p><p>\u200B \u6808\u5E27\u4E2D\u7684\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u7684\u69FD\u4F4D\u662F\u53EF\u4EE5\u91CD\u7528\u7684\uFF0C\u5982\u679C\u4E00\u4E2A\u5C40\u90E8\u53D8\u91CF\u8FC7\u4E86\u5176\u4F5C\u7528\u57DF\uFF0C\u90A3\u4E48\u5728\u5176\u4F5C\u7528\u57DF\u4E4B\u540E\u7533\u660E\u7684\u65B0\u7684\u5C40\u90E8\u53D8\u91CF\u5C31\u5F88\u6709\u53EF\u80FD\u4F1A\u590D\u7528\u8FC7\u671F\u5C40\u90E8\u53D8\u91CF\u7684\u69FD\u4F4D\uFF0C\u4ECE\u800C\u8FBE\u5230\u8282\u7701\u8D44\u6E90\u7684\u76EE\u7684\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211122195538822.png" alt="image-20211122195538822" style="zoom:67%;"><h4 id="_7-\u9759\u6001\u53D8\u91CF\u548C\u5C40\u90E8\u53D8\u91CF\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#_7-\u9759\u6001\u53D8\u91CF\u548C\u5C40\u90E8\u53D8\u91CF\u5BF9\u6BD4" aria-hidden="true">#</a> 7.\u9759\u6001\u53D8\u91CF\u548C\u5C40\u90E8\u53D8\u91CF\u5BF9\u6BD4</h4>`,53),z=a("p",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u53C2\u6570\u8868\u5206\u914D\u5B8C\u6BD5\u4E4B\u540E\uFF0C\u518D\u6839\u636E\u65B9\u6CD5\u4F53\u5185\u5B9A\u4E49\u7684\u53D8\u91CF\u7684\u987A\u5E8F\u548C\u4F5C\u7528\u57DF\u5206\u914D "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u6211\u4EEC\u77E5\u9053\u7C7B\u53D8\u91CF\u8868\u6709\u4E24\u6B21\u521D\u59CB\u5316\u7684\u673A\u4F1A\uFF0C\u7B2C\u4E00\u6B21\u662F\u5728\u201C\u51C6\u5907\u9636\u6BB5\u201D\uFF0C\u6267\u884C\u7CFB\u7EDF\u521D\u59CB\u5316\uFF0C\u5BF9\u7C7B\u53D8\u91CF\u8BBE\u7F6E\u96F6\u503C\uFF0C\u53E6\u4E00\u6B21\u5219\u662F\u5728\u201C\u521D\u59CB\u5316\u201D\u9636\u6BB5\uFF0C\u8D4B\u4E88\u7A0B\u5E8F\u5458\u5728\u4EE3\u7801\u4E2D\u5B9A\u4E49\u7684\u521D\u59CB\u503C. "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u548C\u7C7B\u53D8\u91CF\u521D\u59CB\u5316\u4E0D\u540C\u7684\u662F\uFF0C\u5C40\u90E8\u53D8\u91CF\u8868\u4E0D\u5B58\u5728\u7CFB\u7EDF\u521D\u59CB\u5316\u7684\u8FC7\u7A0B\uFF0C\u8FD9\u610F\u5473\u7740\u4E00\u65E6\u5B9A\u4E49\u4E86\u5C40\u90E8\u53D8\u91CF\u5219\u5FC5\u987B\u4EBA\u4E3A\u7684\u521D\u59CB\u5316\uFF0C\u5426\u5219\u65E0\u6CD5\u4F7F\u7528\u3002")],-1),E=s(`<div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//\u8FD9\u6837\u7684\u4EE3\u7801\u662F\u9519\u8BEF\u7684\uFF0C\u6CA1\u6709\u8D4B\u503C\u4E0D\u80FD\u591F\u4F7F\u7528</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">int</span> i<span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out <span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),B=a("p",null,[a("strong",null,"\u53D8\u91CF\u7684\u5206\u7C7B\uFF1A"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u6309\u7167\u6570\u636E\u7C7B\u578B\u5206\uFF1A\u57FA\u672C\u6570\u636E\u7C7B\u578B\u3001\u5F15\u7528\u6570\u636E\u7C7B\u578B "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u6309\u7167\u5728\u7C7B\u4E2D\u58F0\u660E\u7684\u4F4D\u7F6E\u5206\uFF1A\u6210\u5458\u53D8\u91CF\uFF1A\u5728\u4F7F\u7528\u524D\uFF0C\u90FD\u7ECF\u5386\u8FC7\u9ED8\u8BA4\u521D\u59CB\u5316\u8D4B\u503C \u7C7B\u53D8\u91CF\uFF1A Linking\u7684 prepare\u9636\u6BB5\uFF1A\u7ED9\u7C7B\u53D8\u91CF\u9ED8\u8BA4\u8D4B\u503C\u2013>initial\u9636\u6BB5\uFF1A\u7ED9\u9759\u6001\u4EE3\u7801\u5757\u8D4B\u503C \u5B9E\u4F8B\u53D8\u91CF\uFF1A\u968F\u7740\u5BF9\u8C61\u7684\u521B\u5EFA\uFF0C\u4F1A\u5728\u5806\u7A7A\u95F4\u4E2D\u5206\u914D\u5B9E\u4F8B\u53D8\u91CF\u7A7A\u95F4\uFF0C\u5E76\u8FDB\u884C\u9ED8\u8BA4\u8D4B\u503C "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u5C40\u90E8\u53D8\u91CF\uFF1A\u5728\u4F7F\u7528\u524D\uFF0C\u5FC5\u987B\u8981\u8FDB\u884C\u663E\u5F0F\u8D4B\u503C\u7684\uFF01\u5426\u5219\uFF0C\u7F16\u8BD1\u4E0D\u901A\u8FC7\u3002")],-1),D=a("p",null,[a("strong",null,"\u8865\u5145\u8BF4\u660E"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u5728\u6808\u5E27\u4E2D \uFF0C \u4E0E\u6027\u80FD\u8C03\u4F18\u5173\u7CFB\u6700\u4E3A\u5BC6\u5207\u7684\u90E8\u5206\u5C31\u662F\u524D\u9762\u63D0\u5230\u7684\u5C40\u90E8\u53D8\u91CF\u8868 \u3002\u5728\u65B9\u6CD5\u6267\u884C\u65F6 \uFF0C \u865A\u62DF\u673A\u4F7F\u7528\u5C40\u90E8\u53D8\u91CF\u8868\u5B8C\u6210\u65B9\u6CD5\u7684\u4F20\u9012 \u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u7684\u53D8\u91CF\u4E5F\u662F\u91CD\u8981\u7684\u5783\u573E\u56DE\u6536\u6839\u8282\u70B9 \uFF0C \u53EA\u8981\u88AB\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u76F4\u63A5\u6216\u95F4\u63A5\u5F15\u7528\u7684\u5BF9\u8C61\u90FD\u4E0D\u4F1A\u88AB\u56DE\u6536 \u3002")],-1),R=a("h4",{id:"_8-\u64CD\u4F5C\u6570\u6808",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_8-\u64CD\u4F5C\u6570\u6808","aria-hidden":"true"},"#"),n(" 8.\u64CD\u4F5C\u6570\u6808")],-1),U=a("p",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u6BCF\u4E00\u4E2A\u72EC\u7ACB\u7684\u6808\u5E27\u4E2D\u9664\u4E86\u5305\u542B\u5C40\u90E8\u53D8\u91CF\u8868\u4EE5\u5916\uFF0C\u8FD8\u5305\u542B\u4E00\u4E2A\u540E\u8FDB\u5148\u51FA(Last-In-First-0ut)\u7684\u64CD\u4F5C\u6570\u6808\uFF0C\u4E5F\u53EF\u4EE5\u79F0\u4E4B\u4E3A\u8868\u8FBE\u5F0F\u6808(Expression Stack). "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u64CD\u4F5C\u6570\u6808\uFF0C\u5728\u65B9\u6CD5\u6267\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u6839\u636E\u5B57\u8282\u7801\u6307\u4EE4\uFF0C\u5F80\u6808\u4E2D\u5199\u5165\u6570\u636E\u6216\u63D0\u53D6\u6570\u636E\uFF0C\u5373\u5165\u6808(push)/\u51FA\u6808(pop). \u67D0\u4E9B\u5B57\u8282\u7801\u6307\u4EE4\u5C06\u503C\u538B\u5165\u64CD\u4F5C\u6570\u6808\uFF0C\u5176\u4F59\u7684\u5B57\u8282\u7801\u6307\u4EE4\u5C06\u64CD\u4F5C\u6570\u53D6\u51FA\u6808\u3002\u4F7F\u7528\u5B83\u4EEC\u540E\u518D\u628A\u7ED3\u679C\u538B\u5165\u6808\u3002\u6BD4\u5982\uFF1A\u6267\u884C\u590D\u5236\u3001\u4EA4\u6362\u3001\u6C42\u548C\u7B49\u64CD\u4F5C")],-1),I=a("p",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u5982\u679C\u88AB\u8C03\u7528\u7684\u65B9\u6CD5\u5E26\u6709\u8FD4\u56DE\u503C\u7684\u8BDD\uFF0C\u5176\u8FD4\u56DE\u503C\u5C06\u4F1A\u88AB\u538B\u5165\u5F53\u524D\u6808\u5E27\u7684\u64CD\u4F5C\u6570\u6808\u4E2D\uFF0C\u5E76\u66F4\u65B0PC\u5BC4\u5B58\u5668\u4E2D\u4E0B\u4E00\u6761\u9700\u8981\u6267\u884C\u7684\u5B57\u8282\u7801\u6307\u4EE4\u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u64CD\u4F5C\u6570\u6808\u4E2D\u5143\u7D20\u7684\u6570\u636E\u7C7B\u578B\u5FC5\u987B\u4E0E\u5B57\u8282\u7801\u6307\u4EE4\u7684\u5E8F\u5217\u4E25\u683C\u5339\u914D\uFF0C\u8FD9\u7531\u7F16\u8BD1\u5668\u5728\u7F16\u8BD1\u5668\u671F\u95F4\u8FDB\u884C\u9A8C\u8BC1\uFF0C\u540C\u65F6\u5728\u7C7B\u52A0\u8F7D\u8FC7\u7A0B\u4E2D\u7684\u7C7B\u68C0\u9A8C\u9636\u6BB5\u7684\u6570\u636E\u6D41\u5206\u6790\u9636\u6BB5\u8981\u518D\u6B21\u9A8C\u8BC1\u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u53E6\u5916\uFF0C\u6211\u4EEC\u8BF4Java\u865A\u62DF\u673A\u7684\u89E3\u91CA\u5F15\u64CE\u662F\u57FA\u4E8E\u6808\u7684\u6267\u884C\u5F15\u64CE\uFF0C\u5176\u4E2D\u7684\u6808\u6307\u7684\u5C31\u662F\u64CD\u4F5C\u6570\u6808\u3002")],-1),H=a("p",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u64CD\u4F5C\u6570\u6808\uFF0C\u4E3B\u8981\u7528\u4E8E"),a("strong",null,"\u4FDD\u5B58\u8BA1\u7B97\u8FC7\u7A0B\u7684\u4E2D\u95F4\u7ED3\u679C\uFF0C\u540C\u65F6\u4F5C\u4E3A\u8BA1\u7B97\u8FC7\u7A0B\u4E2D\u53D8\u91CF\u4E34\u65F6\u7684\u5B58\u50A8\u7A7A\u95F4\u3002"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u64CD\u4F5C\u6570\u6808\u5C31\u662FJVM\u6267\u884C\u5F15\u64CE\u7684-\u4E00\u4E2A\u5DE5\u4F5C\u533A\uFF0C\u5F53\u4E00\u4E2A\u65B9\u6CD5\u521A\u5F00\u59CB\u6267\u884C\u7684\u65F6\u5019\uFF0C\u4E00\u4E2A\u65B0\u7684\u6808\u5E27\u4E5F\u4F1A\u968F\u4E4B\u88AB\u521B\u5EFA\u51FA\u6765\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u7684\u64CD\u4F5C\u6570\u6808\u662F"),a("strong",null,"\u7A7A\u7684"),n("\u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u6BCF\u4E00\u4E2A\u64CD\u4F5C\u6570\u6808\u90FD\u4F1A\u62E5\u6709\u4E00\u4E2A\u660E\u786E\u7684\u6808\u6DF1\u5EA6\u7528\u4E8E\u5B58\u50A8\u6570\u503C\uFF0C\u5176\u6240\u9700\u7684\u6700\u5927\u6DF1\u5EA6\u5728\u7F16\u8BD1\u671F\u5C31\u5B9A\u4E49\u597D\u4E86\uFF0C\u4FDD\u5B58\u5728\u65B9\u6CD5\u7684Code\u5C5E\u6027\u4E2D\uFF0C\u4E3Amax stack\u7684\u503C\u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u6808\u4E2D\u7684\u4EFB\u4F55\u4E00\u4E2A\u5143\u7D20\u90FD\u662F\u53EF\u4EE5\u4EFB\u610F\u7684Java\u6570\u636E\u7C7B\u578B\u3002 \u27A232bit\u7684\u7C7B\u578B\u5360\u7528\u4E00\u4E2A\u6808\u5355\u4F4D\u6DF1\u5EA6 \u27A264bit\u7684\u7C7B\u578B\u5360\u7528\u4E24\u4E2A\u6808\u5355\u4F4D\u6DF1\u5EA6 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u25B9")]),a("annotation",{encoding:"application/x-tex"},"\\triangleright")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u25B9")])])]),n(" \u64CD\u4F5C\u6570\u6808\u5E76\u975E\u91C7\u7528\u8BBF\u95EE\u7D22\u5F15\u7684\u65B9\u5F0F\u6765\u8FDB\u884C\u6570\u636E\u8BBF\u95EE\u7684\uFF0C\u800C\u662F\u53EA\u80FD\u901A\u8FC7\u6807\u51C6\u7684\u5165\u6808(push) \u548C\u51FA\u6808(pop)\u64CD\u4F5C\u6765\u5B8C\u6210\u4E00\u6B21\u6570\u636E\u8BBF\u95EE\u3002")],-1),K=s(`<p><strong>\u4EE3\u7801\u793A\u4F8B\uFF1A</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAddOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">byte</span> i<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> k<span class="token operator">=</span>i <span class="token operator">+</span> j<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u56FE\u4F8B\uFF1A</strong></p><p><img src="http://qnimg.gisfsde.com/work/image-20211123140047087.png" alt="image-20211123140047087" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211123140228419.png" alt="image-20211123140228419" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211123140302504.png" alt="image-20211123140302504" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211123140320706.png" alt="image-20211123140320706" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211123140346031.png" alt="image-20211123140346031" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211123140429125.png" alt="image-20211123140429125" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211123140450391.png" alt="image-20211123140450391" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211123140754907.png" alt="image-20211123140754907" loading="lazy"></p><h4 id="_9-\u6808\u9876\u7F13\u5B58-top-of-stack-cashing-\u6280\u672F" tabindex="-1"><a class="header-anchor" href="#_9-\u6808\u9876\u7F13\u5B58-top-of-stack-cashing-\u6280\u672F" aria-hidden="true">#</a> 9.\u6808\u9876\u7F13\u5B58\uFF08Top-of-Stack-Cashing\uFF09\u6280\u672F</h4>`,12),F=a("p",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u524D\u9762\u63D0\u8FC7\uFF0C\u57FA\u4E8E\u6808\u5F0F\u67B6\u6784\u7684\u865B\u62DF\u673A\u6240\u4F7F\u7528\u7684\u96F6\u5730\u5740\u6307\u4EE4\u66F4\u52A0\u7D27\u51D1\uFF0C\u4F46\u5B8C\u6210\u4E00\u9879\u64CD\u4F5C\u7684\u65F6\u5019\u5FC5\u7136\u9700\u8981\u4F7F\u7528\u66F4\u591A\u7684\u5165\u6808\u548C\u51FA\u6808\u6307\u4EE4\uFF0C\u8FD9\u540C\u65F6\u4E5F\u5C31\u610F\u5473\u7740\u5C06\u9700\u8981\u66F4\u591A\u7684\u6307\u4EE4\u5206\u6D3E( instruction dispatch)\u6B21\u6570\u548C\u5185\u5B58\u8BFB/\u5199\u6B21\u6570\u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u7531\u4E8E\u64CD\u4F5C\u6570\u662F\u5B58\u50A8\u5728\u5185\u5B58\u4E2D\u7684\uFF0C\u56E0\u6B64\u9891\u7E41\u5730\u6267\u884C\u5185\u5B58\u8BFB/\u5199\u64CD\u4F5C\u5FC5\u7136\u4F1A\u5F71\u54CD\u6267\u884C\u901F\u5EA6\u3002\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C Hotspot JVM\u7684\u8BBE\u8BA1\u8005\u4EEC\u63D0\u51FA\u4E86\u6808\u9876\u7F13\u5B58(ToS,Top-of- Stack Cashing)\u6280\u672F\uFF0C\u5C06"),a("strong",null,"\u6808\u9876\u5143\u7D20\u5168\u90E8\u7F13\u5B58\u5728\u7269\u7406CPU\u7684\u5BC4\u5B58\u5668"),n("\u4E2D\uFF0C\u4EE5\u6B64\u964D\u4F4E\u5BF9\u5185\u5B58\u7684\u8BFB/\u5199\u6B21\u6570\uFF0C\u63D0\u5347\u6267\u884C\u5F15\u64CE\u7684\u6267\u884C\u6548\u7387\u3002")],-1),N=a("h4",{id:"_10-\u52A8\u6001\u94FE\u63A5",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_10-\u52A8\u6001\u94FE\u63A5","aria-hidden":"true"},"#"),n(" 10.\u52A8\u6001\u94FE\u63A5")],-1),W=a("p",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u6BCF\u4E00\u4E2A\u6808\u5E27\u5185\u90E8\u90FD\u5305\u542B\u4E00\u4E2A"),a("strong",null,"\u6307\u5411\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u4E2D\u8BE5\u6808\u5E27\u6240\u5C5E\u65B9\u6CD5\u7684\u5F15\u7528"),n(",\u5305\u542B\u8FD9\u4E2A\u5F15\u7528\u7684\u76EE\u7684\u5C31\u662F\u4E3A\u4E86\u652F\u6301\u5F53\u524D\u65B9\u6CD5\u7684\u4EE3\u7801\u80FD\u591F\u5B9E\u73B0\u52A8\u6001\u94FE\u63A5( Dynamic Linking)\u3002\u6BD4\u5982\uFF1Ainvoke dynamic \u6307\u4EE4\u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u5728Java\u6E90\u6587\u4EF6\u88AB\u7F16\u8BD1\u5230\u5B57\u8282\u7801\u6587\u4EF6\u4E2D\u65F6\uFF0C\u6240\u6709\u7684\u53D8\u91CF\u548C\u65B9\u6CD5\u5F15\u7528\u90FD\u4F5C\u4E3A\u7B26\u53F7\u5F15\u7528( Symbolic Reference)\u4FDD\u5B58\u5728class\u6587\u4EF6\u7684\u5E38\u91CF\u6C60\u91CC\u3002\u6BD4\u5982\uFF1A\u63CF\u8FF0\u4E00\u4E2A\u65B9\u6CD5\u8C03\u7528\u4E86\u53E6\u5916\u7684\u5176\u4ED6\u65B9\u6CD5\u65F6\uFF0C\u5C31\u662F\u901A\u8FC7\u5E38\u91CF\u6C60\u4E2D\u6307\u5411\u65B9\u6CD5\u7684\u7B26\u53F7\u5F15\u7528\u6765\u8868\u793A\u7684\uFF0C\u90A3\u4E48\u52A8\u6001\u94FE\u63A5\u7684\u4F5C\u7528\u5C31\u662F\u4E3A\u4E86"),a("strong",null,"\u5C06\u8FD9\u4E9B\u7B26\u53F7\u5F15\u7528\u8F6C\u6362\u4E3A\u8C03\u7528\u65B9\u6CD5\u7684\u76F4\u63A5\u5F15\u7528\u3002")],-1),Z=a("p",null,[a("img",{src:"http://qnimg.gisfsde.com/work/image-20211123190249212.png",alt:"image-20211123190249212",loading:"lazy"})],-1),Y=a("p",null,[a("img",{src:"http://qnimg.gisfsde.com/work/\u7B2C09\u7AE0_\u65B9\u6CD5\u533A\u4E0E\u6808\u7684\u5173\u8054\u7ED3\u6784.jpg",alt:"\u7B2C09\u7AE0_\u65B9\u6CD5\u533A\u4E0E\u6808\u7684\u5173\u8054\u7ED3\u6784",loading:"lazy"})],-1),$=a("h4",{id:"_11-\u65B9\u6CD5\u7684\u8C03\u7528",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_11-\u65B9\u6CD5\u7684\u8C03\u7528","aria-hidden":"true"},"#"),n(),a("strong",null,"11.\u65B9\u6CD5\u7684\u8C03\u7528")],-1),Q=a("p",null,[n("\u5728JVM\u4E2D\uFF0C\u5C06\u7B26\u53F7\u5F15\u7528\u8F6C\u6362\u4E3A\u8C03\u7528\u65B9\u6CD5\u7684\u76F4\u63A5\u5F15\u7528\u4E0E\u65B9\u6CD5\u7684\u7ED1\u5B9A\u673A\u5236\u76F8\u5173\u3002 "),a("strong",null,"\u9759\u6001\u94FE\u63A5\uFF1A"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u5F53\u4E00\u4E2A\u5B57\u8282\u7801\u6587\u4EF6\u88AB\u88C5\u8F7D\u8FDBJVM\u5185\u90E8\u65F6\uFF0C\u5982\u679C\u88AB\u8C03\u7528\u7684"),a("strong",null,"\u76EE\u6807\u65B9\u6CD5\u5728\u7F16\u8BD1\u671F\u53EF\u77E5"),n("\uFF0C\u4E14\u8FD0\u884C\u671F\u4FDD\u6301\u4E0D\u53D8\u65F6\u3002\u8FD9\u79CD\u60C5\u51B5\u4E0B\u5C06\u8C03\u7528\u65B9\u6CD5\u7684\u7B26\u53F7\u5F15\u7528\u8F6C\u6362\u4E3A\u76F4\u63A5\u5F15\u7528\u7684\u8FC7\u7A0B\u79F0\u4E4B\u4E3A\u9759\u6001\u94FE\u63A5 "),a("strong",null,"\u52A8\u6001\u94FE\u63A5\uFF1A"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u5982\u679C\u88AB\u8C03\u7528\u7684\u65B9\u6CD5\u5728"),a("strong",null,"\u7F16\u8BD1\u671F\u65E0\u6CD5\u88AB\u786E\u5B9A\u4E0B\u6765"),n("\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C\u53EA\u80FD\u591F\u5728\u7A0B\u5E8F\u8FD0\u884C\u671F\u5C06\u8C03\u7528\u65B9\u6CD5\u7684\u7B26\u53F7\u5F15\u7528\u8F6C\u6362\u4E3A\u76F4\u63A5\u5F15\u7528\uFF0C\u7531\u4E8E\u8FD9\u79CD\u5F15\u7528\u8F6C\u6362\u8FC7\u7A0B\u5177\u5907\u52A8\u6001\u6027\uFF0C\u56E0\u6B64\u4E5F\u5C31\u88AB\u79F0\u4E4B\u4E3A\u52A8\u6001\u94FE\u63A5\u3002")],-1),aa=a("p",null,[n("\u5BF9\u5E94\u7684\u65B9\u6CD5\u7684\u7ED1\u5B9A\u673A\u5236\u4E3A\uFF1A\u65E9\u671F\u7ED1\u5B9A(Early Binding)\u548C\u665A\u671F\u7ED1\u5B9A( Late Binding)\u3002\u7ED1\u5B9A\u662F\u4E00\u4E2A\u5B57\u6BB5\u3001\u65B9\u6CD5\u6216\u8005\u7C7B\u5728\u7B26\u53F7\u5F15\u7528\u88AB\u66FF\u6362\u4E3A\u76F4\u63A5\u5F15\u7528\u7684\u8FC7\u7A0B\uFF0C\u8FD9\u4EC5\u4EC5\u53D1\u751F\u4E00\u6B21\u3002 "),a("strong",null,"\u65E9\u671F\u7ED1\u5B9A\uFF1A"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u65E9\u671F\u7ED1\u5B9A\u5C31\u662F\u6307\u88AB\u8C03\u7528\u7684\u76EE\u6807\u65B9\u6CD5\u5982\u679C\u5728"),a("strong",null,"\u7F16\u8BD1\u671F\u53EF\u77E5\uFF0C\u4E14\u8FD0\u884C\u671F\u4FDD\u6301\u4E0D\u53D8\u65F6"),n("\uFF0C\u5373\u53EF\u5C06\u8FD9\u4E2A\u65B9\u6CD5\u4E0E\u6240\u5C5E\u7684\u7C7B\u578B\u8FDB\u884C\u7ED1\u5B9A\uFF0C\u8FD9\u6837\u4E00\u6765\uFF0C\u7531\u4E8E\u660E\u786E\u4E86\u88AB\u8C03\u7528\u7684\u76EE\u6807\u65B9\u6CD5\u7A76\u7ADF\u662F\u54EA\u4E00\u4E2A\uFF0C\u56E0\u6B64\u4E5F\u5C31\u53EF\u4EE5\u4F7F\u7528\u9759\u6001\u94FE\u63A5\u7684\u65B9\u5F0F\u5C06\u7B26\u53F7\u5F15\u7528\u8F6C\u6362\u4E3A\u76F4\u63A5\u5F15\u7528\u3002 "),a("strong",null,"\u665A\u671F\u7ED1\u5B9A\uFF1A"),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u5982\u679C\u88AB\u8C03\u7528\u7684\u65B9\u6CD5\u5728"),a("strong",null,"\u7F16\u8BD1\u671F\u65E0\u6CD5\u88AB\u786E\u5B9A\u4E0B\u6765\uFF0C\u53EA\u80FD\u591F\u5728\u7A0B\u5E8F\u8FD0\u884C\u671F\u6839\u636E\u5B9E\u9645\u7684\u7C7B\u578B\u7ED1\u5B9A\u76F8\u5173\u7684\u65B9\u6CD5"),n("\uFF0C\u8FD9\u79CD\u7ED1\u5B9A\u65B9\u5F0F\u4E5F\u5C31\u88AB\u79F0\u4E4B\u4E3A\u665A\u671F\u7ED1\u5B9A\u3002")],-1),na=s('<h4 id="_12-\u865A\u65B9\u6CD5\u3001\u975E\u865A\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_12-\u865A\u65B9\u6CD5\u3001\u975E\u865A\u65B9\u6CD5" aria-hidden="true">#</a> 12.\u865A\u65B9\u6CD5\u3001\u975E\u865A\u65B9\u6CD5</h4><p><strong>\u975E\u865A\u65B9\u6CD5\uFF1A</strong> \u5982\u679C\u65B9\u6CD5\u5728<strong>\u7F16\u8BD1\u671F\u5C31\u786E\u5B9A\u4E86\u5177\u4F53\u7684\u8C03\u7528\u7248\u672C</strong>\uFF0C\u8FD9\u4E2A\u7248\u672C\u5728<strong>\u8FD0\u884C\u65F6\u662F\u4E0D\u53EF\u53D8</strong>\u7684\u3002\u8FD9\u6837\u7684\u65B9\u6CD5\u79F0\u4E3A\u975E\u865A\u65B9\u6CD5\u3002<strong>\u9759\u6001\u65B9\u6CD5\u3001\u79C1\u6709\u65B9\u6CD5\u3001final\u65B9\u6CD5\u3001\u5B9E\u4F8B\u6784\u9020\u5668\u3001\u7236\u7C7B\u65B9\u6CD5</strong>\u90FD\u662F<strong>\u975E\u865A\u65B9\u6CD5</strong>\uFF0C\u5176\u4ED6\u65B9\u6CD5\u79F0\u4E3A\u865A\u65B9\u6CD5\u3002</p><p>\u200B \u968F\u7740\u9AD8\u7EA7\u8BED\u8A00\u7684\u6A2A\u7A7A\u51FA\u4E16\uFF0C\u7C7B\u4F3C\u4E8EJava\u30FC\u6837\u7684\u57FA\u4E8E\u9762\u5411\u5BF9\u8C61\u7684\u7F16\u7A0B\u8BED\u8A00\u5982\u4ECA\u8D8A\u6765\u8D8A\u591A\uFF0C\u5C3D\u7BA1\u8FD9\u7C7B\u7F16\u7A0B\u8BED\u8A00\u5728\u8BED\u6CD5\u98CE\u683C\u4E0A\u5B58\u5728\u4E00\u5B9A\u7684\u5DEE\u522B\uFF0C\u4F46\u662F\u5B83\u4EEC\u5F7C\u6B64\u4E4B\u95F4\u59CB\u7EC8\u4FDD\u6301\u7740\u4E00\u4E2A\u5171\u6027\uFF0C\u90A3\u5C31\u662F\u90FD\u652F\u6301\u5C01\u88C5\u3001\u7EE7\u627F\u548C\u591A\u6001\u7B49\u9762\u5411\u5BF9\u8C61\u7279\u6027\uFF0C\u65E2\u7136\u8FD9\u4E00\u7C7B\u7684<strong>\u7F16\u7A0B\u8BED\u8A00\u5177\u5907\u591A\u6001\u7279\u6027\uFF0C\u90A3\u4E48\u81EA\u7136\u4E5F\u5C31\u5177\u5907\u65E9\u671F\u7ED1\u5B9A\u548C\u665A\u671F\u7ED1\u5B9A\u4E24\u79CD\u7ED1\u5B9A\u65B9\u5F0F\u3002</strong> \u200B Java\u4E2D\u4EFB\u4F55\u4E00\u4E2A\u666E\u901A\u7684\u65B9\u6CD5\u5176\u5B9E\u90FD\u5177\u5907\u865A\u51FD\u6570\u7684\u7279\u5F81\uFF0C\u5B83\u4EEC\u76F8\u5F53\u4E8EC++\u8BED\u8A00\u4E2D\u7684\u865A\u51FD\u6570(C++\u4E2D\u5219\u9700\u8981\u4F7F\u7528\u5173\u952E\u5B57 virtual\u6765\u663E\u5F0F\u5B9A\u4E49)\u3002\u5982\u679C\u5728Java\u7A0B\u5E8F\u4E2D\u4E0D\u5E0C\u671B\u67D0\u4E2A\u65B9\u6CD5\u62E5\u6709\u865A\u51FD\u6570\u7684\u7279\u5F81\u65F6\uFF0C\u5219\u53EF\u4EE5\u4F7F\u7528\u5173\u952E\u5B57final\u6765\u6807\u8BB0\u8FD9\u4E2A\u65B9\u6CD5\u3002</p><p>\u865A\u62DF\u673A\u4E2D\u63D0\u4F9B\u4E86\u4EE5\u4E0B\u51E0\u6761\u65B9\u6CD5\u8C03\u7528\u6307\u4EE4</p><p><strong>\u666E\u901A\u8C03\u7528\u6307\u4EE4</strong></p><ol><li>invokestatic:\u8C03\u7528<strong>\u9759\u6001</strong>\u65B9\u6CD5\uFF0C\u89E3\u6790\u9636\u6BB5\u786E\u5B9A\u552F\u4E00\u65B9\u6CD5\u7248\u672C</li><li>invokespecial:\u8C03\u7528**&lt;init&gt;**\u65B9\u6CD5\u3001\u79C1\u6709\u53CA\u7236\u7C7B\u65B9\u6CD5\uFF0C\u89E3\u6790\u9636\u6BB5\u786E\u5B9A\u552F\u4E00\u65B9\u6CD5\u7248\u672C</li><li>involkevirtual:\u8C03\u7528\u6240\u6709\u865A\u65B9\u6CD5</li><li>invokeinterface:\u8C03\u7528\u63A5\u53E3\u65B9\u6CD5</li></ol><p><strong>\u52A8\u6001\u8C03\u7528\u6307\u4EE4</strong></p><ol><li>invokedynamic:\u52A8\u6001\u89E3\u6790\u51FA\u9700\u8981\u8C03\u7528\u7684\u65B9\u6CD5\uFF0C\u7136\u540E\u6267\u884C\u524D\u56DB\u6761\u6307\u4EE4\u56FA\u5316\u5728\u865A\u62DF\u673A\u5185\u90E8\uFF0C\u65B9\u6CD5\u7684\u8C03\u7528\u6267\u884C\u4E0D\u53EF\u4EBA\u4E3A\u5E72\u9884\uFF0C\u800C invokedynamic\u6307\u4EE4\u5219\u652F\u6301\u7531\u7528\u6237\u786E\u5B9A\u65B9\u6CD5\u7248\u672C\u3002\u5176\u4E2D <strong>invokestatic \u6307\u4EE4\u548C invokespecial \u6307\u4EE4\u8C03\u7528\u7684\u65B9\u6CD5\u79F0\u4E3A\u975E\u865A\u65B9\u6CD5\uFF0C\u5176\u4F59\u7684( final \u4FEE\u9970\u7684\u9664\u5916)\u79F0\u4E3A\u865A\u65B9\u6CD5\u3002</strong></li></ol><h4 id="_13-invokedynamic" tabindex="-1"><a class="header-anchor" href="#_13-invokedynamic" aria-hidden="true">#</a> 13.Invokedynamic</h4>',9),sa=a("p",null,[a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" JVM\u5B57\u8282\u7801\u6307\u4EE4\u96C6\u4E00\u76F4\u6BD4\u8F83\u7A33\u5B9A\uFF0C\u4E00\u76F4\u5230Java7\u4E2D\u30AA\u5897\u52A0\u4E86\u4E00\u4E2A invokedynamic \u6307\u4EE4\uFF0C\u8FD9\u662F Java \u4E3A\u4E86\u5B9E\u73B0\u300C\u52A8\u6001\u7C7B\u578B\u8BED\u8A00\u300D\u652F\u6301\u800C\u505A\u7684\u79CD\u6539\u8FDB\u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" \u4F46\u662F\u5728 Java7 \u4E2D\u5E76\u6CA1\u6709\u63D0\u4F9B\u76F4\u63A5\u751F\u6210 invokedynamic \u6307\u4EE4\u7684\u65B9\u6CD5\uFF0C\u9700\u8981\u501F\u52A9 ASM \u8FD9\u79CD\u5E95\u5C42\u5B57\u8282\u7801\u5DE5\u5177\u6765\u4EA7\u751F invokedynamic \u6307\u4EE4\u3002\u76F4\u5230 Java8 \u7684 Lambda \u8868\u8FBE\u5F0F\u7684\u51FA\u73B0\uFF0Cnvokedynamic \u6307\u4EE4\u7684\u751F\u6210\uFF0C\u5728 Java \u4E2D\u624D\u6709\u4E86\u76F4\u63A5\u7684\u751F\u6210\u65B9\u5F0F\u3002 "),a("span",{class:"katex"},[a("span",{class:"katex-mathml"},[a("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[a("semantics",null,[a("mrow",null,[a("mo",null,"\u22C6")]),a("annotation",{encoding:"application/x-tex"},"\\star")])])]),a("span",{class:"katex-html","aria-hidden":"true"},[a("span",{class:"base"},[a("span",{class:"strut",style:{height:"0.4653em"}}),a("span",{class:"mord"},"\u22C6")])])]),n(" Java7 \u4E2D\u589E\u52A0\u7684\u52A8\u6001\u8BED\u8A00\u7C7B\u578B\u652F\u6301\u7684\u672C\u8D28\u662F\u5BF9 Java \u865A\u62DF\u673A\u89C4\u8303\u7684\u4FEE\u6539\uFF0C\u800C\u4E0D\u662F\u5BF9 Java \u8BED\u8A00\u89C4\u5219\u7684\u4FEE\u6539\uFF0C\u8FD9\u4E00\u5757\u76F8\u5BF9\u6765\u8BB2\u6BD4\u8F83\u590D\u6742\uFF0C\u589E\u52A0\u4E86\u865A\u62DF\u673A\u4E2D\u7684\u65B9\u6CD5\u8C03\u7528\uFF0C\u6700\u76F4\u63A5\u7684\u53D7\u76CA\u8005\u5C31\u662F\u8FD0\u884C\u5728 Java \u5E73\u53F0\u7684\u52A8\u6001\u8BED\u8A00\u7684\u7F16\u8BD1\u5668\u3002")],-1),ea=s(`<p><strong>\u52A8\u6001\u7C7B\u578B\u8BED\u8A00\u548C\u9759\u6001\u7C7B\u578B\u8BED\u8A00</strong> \u52A8\u6001\u7C7B\u578B\u8BED\u8A00\u548C\u9759\u6001\u7C7B\u578B\u8BED\u8A00\u4E24\u8005\u7684\u533A\u522B\u5C31\u5728\u4E8E\u5BF9\u7C7B\u578B\u7684\u68C0\u67E5\u662F\u5728\u7F16\u8BD1\u671F\u8FD8\u662F\u5728\u8FD0\u884C\u671F\uFF0C\u6EE1\u8DB3\u524D\u8005\u5C31\u662F\u9759\u6001\u7C7B\u578B\u8BED\u8A00\uFF0C\u53CD\u4E4B\u662F\u52A8\u6001\u7C7B\u578B\u8BED\u8A00\u3002<strong>\u9759\u6001\u7C7B\u578B\u8BED\u8A00\u662F\u5224\u65AD\u53D8\u91CF\u81EA\u8EAB\u7684\u7C7B\u578B\u4FE1\u606F\uFF1B\u52A8\u6001\u7C7B\u578B\u8BED\u8A00\u662F\u5224\u65AD\u53D8\u91CF\u503C\u7684\u7C7B\u578B\u4FE1\u606F\uFF0C\u53D8\u91CF\u6CA1\u6709\u7C7B\u578B\u4FE1\u606F\uFF0C\u53D8\u91CF\u503C\u624D\u6709\u7C7B\u578B\u4FE1\u606F</strong>\uFF0C\u8FD9\u662F\u52A8\u6001\u8BED\u8A00\uFF08\u6BD4\u5982Python\uFF09\u7684\u4E00\u4E2A\u91CD\u8981\u7279\u5F81\u3002</p><h4 id="_14-\u65B9\u6CD5\u91CD\u5199\u672C\u8D28" tabindex="-1"><a class="header-anchor" href="#_14-\u65B9\u6CD5\u91CD\u5199\u672C\u8D28" aria-hidden="true">#</a> 14.\u65B9\u6CD5\u91CD\u5199\u672C\u8D28</h4><p><strong>Java\u8BED\u8A00\u4E2D\u65B9\u6CD5\u91CD\u5199\u7684\u672C\u8D28</strong> 1.\u627E\u5230\u64CD\u4F5C\u6570\u6808\u9876\u7684\u7B2C\u4E00\u4E2A\u5143\u7D20\u6240\u6267\u884C\u7684\u5BF9\u8C61\u7684\u5B9E\u9645\u7C7B\u578B\uFF0C\u8BB0\u4F5CC 2.\u5982\u679C\u5728\u7C7B\u578BC\u4E2D\u627E\u5230\u4E0E\u5E38\u91CF\u4E2D\u7684\u63CF\u8FF0\u7B26\u5408\u7B80\u5355\u540D\u79F0\u90FD\u76F8\u7B26\u7684\u65B9\u6CD5\uFF0C\u5219\u8FDB\u884C\u8BBF\u95EE\u6743\u9650\u6821\u9A8C\uFF0C\u5982\u679C\u901A\u8FC7\u5219\u8FD4\u56DE\u8FD9\u4E2A\u65B9\u6CD5\u7684\u76F4\u63A5\u5F15\u7528\uFF0C\u67FB\u627E\u8FC7\u7A0B\u7ED3\u675F\uFF1B\u5982\u679C\u4E0D\u901A\u8FC7\uFF0C\u5219\u8FD4\u56DEjava.lang.Illegal AccessError\u5F02\u5E38\u3002 3.\u5426\u5219\uFF0C\u6309\u7167\u7EE7\u627F\u5173\u7CFB\u4ECE\u4E0B\u5F80\u4E0A\u4F9D\u6B21\u5BF9C\u7684\u5404\u4E2A\u7236\u7C7B\u8FDB\u884C\u7B2C2\u6B65\u7684\u641C\u7D22\u548C\u9A8C\u8BC1\u8FC7\u7A0B\u3002 4.\u5982\u679C\u59CB\u7EC8\u6CA1\u6709\u627E\u5230\u5408\u9002\u7684\u65B9\u6CD5\uFF0C\u5219\u629B\u51FAjava.lang. AbstractMethodError\u5F02\u5E38\u3002 <strong>Illegal Accessarror\u4ECB\u7ECD\uFF1A</strong> \u7A0B\u5E8F\u8BD5\u56FE\u8BBF\u95EE\u6216\u4FEE\u6539\u4E00\u4E2A\u5C5E\u6027\u6216\u8C03\u7528\u4E00\u4E2A\u65B9\u6CD5\uFF0C\u8FD9\u4E2A\u5C5E\u6027\u6216\u65B9\u6CD5\uFF0C\u4F60\u6CA1\u6709\u6743\u9650\u8BBF\u95EE\u3002\u4E00\u822C\u7684\uFF0C\u8FD9\u4E2A\u4F1A\u5F15\u8D77\u7F16\u8BD1\u5668\u5F02\u5E38\u3002\u8FD9\u4E2A\u9519\u8BEF\u5982\u679C\u53D1\u751F\u5728\u8FD0\u884C\u65F6\uFF0C\u5C31\u8BF4\u660E\u4E00\u4E2A\u7C7B\u53D1\u751F\u4E86\u4E0D\u517C\u5BB9\u7684\u6539\u53D8\u3002</p><p>\u30FB\u5728\u9762\u5411\u5BF9\u8C61\u7684\u7F16\u7A0B\u4E2D\uFF0C\u4F1A\u5F88\u9891\u7E41\u7684\u4F7F\u7528\u5230\u52A8\u6001\u5206\u6D3E\uFF0C\u5982\u679C\u5728\u6BCF\u6B21\u52A8\u6001\u5206\u6D3E\u7684\u8FC7\u7A0B\u4E2D\u90FD\u8981\u91CD\u65B0\u5728\u7C7B\u7684\u65B9\u6CD5\u5143\u6570\u636E\u4E2D\u641C\u7D22\u5408\u9002\u7684\u76EE\u6807\u7684\u8BDD\u5C31\u53EF\u80FD\u5F71\u54CD\u5230\u6267\u884C\u6548\u7387\u3002\u56E0\u6B64\uFF0C<strong>\u4E3A\u4E86\u63D0\u9AD8\u6027\u80FD</strong>\uFF0CJVM\u91C7\u7528\u5728\u7C7B\u7684\u65B9\u6CD5\u533A\u5EFA\u7ACB\u4E00\u4E2A<strong>\u865A\u65B9\u6CD5\u8868</strong>( virtual method tabble)\uFF08\u975E\u865A\u65B9\u6CD5\u4E0D\u4F1A\u51FA\u73B0\u5728\u8868\u4E2D\uFF09\u6765\u5B9E\u73B0\u3002\u4F7F\u7528\u7D22\u5F15\u8868\u6765\u4EE3\u66FF\u67E5\u627E\u3002 \u30FB\u6BCF\u4E2A\u7C7B\u4E2D\u90FD\u6709\u4E00\u4E2A\u865A\u65B9\u6CD5\u8868\uFF0C\u8868\u4E2D\u5B58\u653E\u7740\u5404\u4E2A\u65B9\u6CD5\u7684\u5B9E\u9645\u5165\u53E3 \u30FB\u90A3\u4E48\u865A\u65B9\u6CD5\u8868\u4EC0\u4E48\u65F6\u5019\u88AB\u521B\u5EFA\uFF1F \u865A\u65B9\u6CD5\u8868\u4F1A\u5728\u7C7B\u52A0\u8F7D\u7684\u94FE\u63A5\u9636\u6BB5\u88AB\u521B\u5EFA\u5E76\u5F00\u59CB\u521D\u59CB\u5316\uFF0C\u7C7B\u7684\u53D8\u91CF\u521D\u59CB\u503C\u51C6\u5907\u5B8C\u6210\u4E4B\u540E\uFF0CJVM\u4F1A\u628A\u8BE5\u7C7B\u7684\u65B9\u6CD5\u8868\u4E5F\u521D\u59CB\u5316\u5B8C\u6BD5\u3002</p><h4 id="_15-\u65B9\u6CD5\u8FD4\u56DE\u5730\u5740" tabindex="-1"><a class="header-anchor" href="#_15-\u65B9\u6CD5\u8FD4\u56DE\u5730\u5740" aria-hidden="true">#</a> 15.\u65B9\u6CD5\u8FD4\u56DE\u5730\u5740</h4><p>\u5B58\u653E\u8C03\u7528\u8BE5\u65B9\u6CD5\u7684PC\u5BC4\u5B58\u5668\u7684\u503C\u3002</p><p>**\u4E00\u4E2A\u65B9\u6CD5\u7684\u7ED3\u675F\uFF0C\u6709\u4E24\u79CD\u65B9\u5F0F\uFF1A**1.\u6B63\u5E38\u6267\u884C\u5B8C\u6210\u30022.\u51FA\u73B0\u672A\u5904\u7406\u7684\u5F02\u5E38\uFF0C\u975E\u6B63\u5E38\u9000\u51FA</p><p>\u200B \u65E0\u8BBA\u901A\u8FC7\u54EA\u79CD\u65B9\u5F0F\u9000\u51FA\uFF0C\u5728\u65B9\u6CD5\u9000\u51FA\u540E\u90FD\u8FD4\u56DE\u5230\u8BE5\u65B9\u6CD5\u88AB\u8C03\u7528\u7684\u4F4D\u7F6E\u3002\u65B9\u6CD5\u6B63\u5E38\u9000\u51FA\u65F6\uFF0C<strong>\u8C03\u7528\u8005\u7684PC\u8BA1\u6570\u5668\u7684\u503C\u4F5C\u4E3A\u8FD4\u56DE\u5730\u5740\uFF0C\u5373\u8C03\u7528\u8BE5\u65B9\u6CD5\u7684\u6307\u4EE4\u7684\u4E0B\u4E00\u6761\u6307\u4EE4\u7684\u5730\u5740</strong>\u3002\u800C\u901A\u8FC7\u5F02\u5E38\u9000\u51FA\u7684\uFF0C\u8FD4\u56DE\u5730\u5740\u662F\u8981\u901A\u8FC7\u5F02\u5E38\u8868\u6765\u786E\u5B9A\uFF0C\u6808\u5E27\u4E2D\u4E00\u822C\u4E0D\u4F1A\u4FDD\u5B58\u8FD9\u90E8\u5206\u4FE1\u606F\u3002</p><p>\u200B \u672C\u8D28\u4E0A\uFF0C\u65B9\u6CD5\u7684\u9000\u51FA\u5C31\u662F\u5F53\u524D\u6808\u5E27\u51FA\u6808\u7684\u8FC7\u7A0B\u3002\u6B64\u65F6\uFF0C\u9700\u8981\u6062\u590D\u4E0A\u5C42\u65B9\u6CD5\u7684\u5C40\u90E8\u53D8\u91CF\u8868\u3001\u64CD\u4F5C\u6570\u6808\u3001\u5C06\u8FD4\u56DE\u503C\u538B\u5165\u8C03\u7528\u8005\u6808\u5E27\u7684\u64CD\u4F5C\u6570\u6808\u3001\u8BBE\u7F6EPC\u5BC4\u5B58\u5668\u503C\u7B49\uFF0C\u8BA9\u8C03\u7528\u8005\u65B9\u6CD5\u7EE7\u7EED\u6267\u884C\u4E0B\u53BB\u3002 \u200B \u6B63\u5E38\u5B8C\u6210\u51FA\u53E3\u548C\u5F02\u5E38\u5B8C\u6210\u51FA\u53E3\u7684\u533A\u522B\u5728\u4E8E\uFF1A\u901A\u8FC7\u5F02\u5E38\u5B8C\u6210\u51FA\u53E3\u9000\u51FA\u7684\u4E0D\u4F1A\u7ED9\u4ED6\u7684\u4E0A\u5C42\u8C03\u7528\u8005\u4EA7\u751F\u4EFB\u4F55\u7684\u8FD4\u56DE\u503C\u3002</p><p>\u5F53\u4E00\u4E2A\u65B9\u6CD5\u5F00\u59CB\u6267\u884C\u540E\uFF0C\u53EA\u6709<strong>\u4E24\u79CD\u65B9\u5F0F\u53EF\u4EE5\u9000\u51FA\u8FD9\u4E2A\u65B9\u6CD5</strong> 1\u3001\u6267\u884C\u5F15\u64CE\u9047\u5230\u4EFB\u610F\u4E00\u4E2A\u65B9\u6CD5\u8FD4\u56DE\u7684\u5B57\u8282\u7801\u6307\u4EE4( return),\u4F1A\u6709\u8FD4\u56DE\u503C\u4F20\u9012\u7ED9\u4E0A\u5C42\u7684\u65B9\u6CD5\u8C03\u7528\u8005\uFF0C\u7B80\u79F0<strong>\u6B63\u5E38\u5B8C\u6210\u51FA\u53E3</strong></p><p>\u200B \u4E00\u4E2A\u65B9\u6CD5\u5728\u6B63\u5E38\u8C03\u7528\u5B8C\u6210\u4E4B\u540E\u7A76\u7ADF\u9700\u8981\u4F7F\u7528\u54EA\u4E00\u4E2A\u8FD4\u56DE\u6307\u4EE4\u8FD8\u9700\u8981\u6839\u636E\u65B9\u6CD5\u8FD4\u56DE\u503C\u7684\u5B9E\u9645\u6570\u636E\u7C7B\u578B\u800C\u5B9A\u3002 \u200B \u5728\u5B57\u8282\u7801\u6307\u4EE4\u4E2D\uFF0C\u8FD4\u56DE\u6307\u4EE4\u5305\u542B lreturn(\u5F53\u8FD4\u56DE\u503C\u662F boolean\u3001byte\u3001char\u3001shorth\u548Cint\u7C7B\u578B\u65F6\u4F7F\u7528)\u3001lreturn\u3001 freturn\u3001 dreturn\u4EE5\u53CA areturn,\u53E6\u5916\u8FD8\u6709\u4E00\u4E2A return\u6307\u4EE4\u4F9B\u58F0\u660E\u4E3Avoid\u7684\u65B9\u6CD5\u3001\u5B9E\u4F8B\u521D\u59CB\u5316\u65B9\u6CD5\u3001\u7C7B\u548C\u63A5\u53E3\u7684\u521D\u59CB\u5316\u65B9\u6CD5\u4F7F\u7528\u3002</p><p>2\u3001\u5728\u65B9\u6CD5\u6267\u884C\u7684\u8FC7\u7A0B\u4E2D\u9047\u5230\u4E86\u5F02\u5E38( Exception),\u5E76\u4E14\u8FD9\u4E2A\u5F02\u5E38\u6CA1\u6709\u5728\u65B9\u6CD5\u5185\u8FDB\u884C\u5904\u7406\uFF0C\u4E5F\u5C31\u662F\u53EA\u8981\u5728\u672C\u65B9\u6CD5\u7684\u5F02\u5E38\u8868\u4E2D\u6CA1\u6709\u641C\u7D22\u5230\u5339\u914D\u7684\u5F02\u5E38\u5904\u7406\u5668\uFF0C\u5C31\u4F1A\u5BFC\u81F4\u65B9\u6CD5\u9000\u51FA\u3002\u7B80\u79F0<strong>\u5F02\u5E38\u5B8C\u6210\u51FA\u53E3</strong>\u3002 \u65B9\u6CD5\u6267\u884C\u8FC7\u7A0B\u4E2D\u629B\u51FA\u5F02\u5E38\u65F6\u7684\u5F02\u5E38\u5904\u7406\uFF0C\u5B58\u50A8\u5728\u4E00\u4E2A\u5F02\u5E38\u5904\u7406\u8868\uFF0C\u65B9\u4FBF\u5728\u53D1\u751F\u5F02\u5E38\u7684\u65F6\u5019\u627E\u5230\u5904\u7406\u5F02\u5E38\u7684\u4EE3\u7801\u3002</p><h4 id="_16-\u4E00\u4E9B\u9644\u52A0\u4FE1\u606F-\u7565" tabindex="-1"><a class="header-anchor" href="#_16-\u4E00\u4E9B\u9644\u52A0\u4FE1\u606F-\u7565" aria-hidden="true">#</a> 16.\u4E00\u4E9B\u9644\u52A0\u4FE1\u606F(\u7565)</h4><h2 id="_17-\u9762\u8BD5\u9898" tabindex="-1"><a class="header-anchor" href="#_17-\u9762\u8BD5\u9898" aria-hidden="true">#</a> 17.\u9762\u8BD5\u9898</h2><p>\u4E3E\u4F8B\u6808\u6EA2\u51FA\u7684\u60C5\u51B5\uFF1F( StackOverflowError):<a href="#2.%E6%A0%88%E4%B8%AD%E5%8F%AF%E8%83%BD%E5%87%BA%E7%8E%B0%E7%9A%84%E5%BC%82%E5%B8%B8">2.\u6808\u4E2D\u53EF\u80FD\u51FA\u73B0\u7684\u5F02\u5E38</a> \u901A\u8FC7-Xss\u8BBE\u7F6E\u6808\u7684\u5927\u5C0F\uFF1BOOM \u8C03\u6574\u6808\u5927\u5C0F\uFF0C\u5C31\u80FD\u4FDD\u8BC1\u4E0D\u51FA\u73B0\u6EA2\u51FA\u5417\uFF1F\u4E0D\u80FD \u5206\u914D\u7684\u6808\u5185\u5B58\u8D8A\u5927\u8D8A\u597D\u5417\uFF1F\u4E0D\u662F \u5783\u573E\u56DE\u6536\u662F\u5426\u4F1A\u6D89\u53CA\u5230\u865A\u62DF\u673A\u6808\uFF1F\u4E0D\u4F1A\u7684\uFF01 \u65B9\u6CD5\u4E2D\u5B9A\u4E49\u7684\u5C40\u90E8\u53D8\u91CF\u662F\u5426\u7EBF\u7A0B\u5B89\u5168\uFF1F<a href="#1.%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E8%A1%A8">1.\u5C40\u90E8\u53D8\u91CF\u8868</a></p><h1 id="\u516D\u3001\u672C\u5730\u65B9\u6CD5\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#\u516D\u3001\u672C\u5730\u65B9\u6CD5\u63A5\u53E3" aria-hidden="true">#</a> \u516D\u3001<em>\u672C\u5730\u65B9\u6CD5\u63A5\u53E3</em></h1><p><strong>\u4EC0\u4E48\u662F\u672C\u5730\u65B9\u6CD5\uFF1F</strong> \u7B80\u5355\u5730\u8BB2\uFF0C\u4E00\u4E2A Native Method \u5C31\u662F\u4E00\u4E2AJava\u8C03\u7528\u975EJava\u4EE3\u7801\u7684\u63A5\u53E3\u3002\u4E00\u4E2ANative Method\u662F\u8FD9\u6837\u4E00\u4E2AJava\u65B9\u6CD5\uFF1A\u8BE5\u65B9\u6CD5\u7684\u5B9E\u73B0\u7531\u975EJava\u8BED\u8A00\u5B9E\u73B0\uFF0C\u6BD4\u5982C.\u8FD9\u4E2A\u7279\u5F81\u5E76\u975EJava\u6240\u7279\u6709\uFF0C\u5F88\u591A\u5176\u5B83\u7684\u7F16\u7A0B\u8BED\u8A00\u90FD\u6709\u8FD9\u4E00\u673A\u5236\uFF0C\u6BD4\u5982\u5728 C \u4E2D\uFF0C\u4F60\u53EF\u4EE5\u7528 extern&quot;c&quot;\u544A\u77E5C \u7F16\u8BD1\u5668\u53BB\u8C03\u7528\u4E00\u4E2AC\u7684\u51FD\u6570\u3002</p><blockquote><p>A native method is a Java method whose Implementation is provided by non-java code</p></blockquote><p>\u5728\u5B9A\u4E49\u30FC\u4E2A native method \u65F6\uFF0C\u5E76\u4E0D\u63D0\u4F9B\u5B9E\u73B0\u4F53(\u6709\u4E9B\u50CF\u5B9A\u4E49\u30FC\u4E2AJavai nterface),\u56E0\u4E3A\u5176\u5B9E\u73B0\u4F53\u662F\u7531\u975Ejava\u8BED\u8A00\u5728\u5916\u9762\u5B9E\u73B0\u7684\u3002 \u672C\u5730\u63A5\u53E3\u7684\u4F5C\u7528\u662F\u878D\u5408\u4E0D\u540C\u7684\u7F16\u7A0B\u8BED\u8A00\u4E3AJava\u6240\u7528\uFF0C\u5B83\u7684\u521D\u8877\u662F\u878D\u5408C/C++\u7A0B\u5E8F\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211124202600273.png" alt="image-20211124202600273" style="zoom:67%;"><img src="http://qnimg.gisfsde.com/work/image-20211124202817626.png" alt="image-20211124202817626" style="zoom:80%;"><p><strong>\u4E3A\u4EC0\u4E48\u8981\u4F7F\u7528 Native Method?</strong> Java\u4F7F\u7528\u8D77\u6765\u975E\u5E38\u65B9\u4FBF\uFF0C\u7136\u800C\u6709\u4E9B\u5C42\u6B21\u7684\u4EFB\u52A1\u7528Java\u5B9E\u73B0\u8D77\u6765\u4E0D\u5BB9\u6613\uFF0C\u6216\u8005\u6211\u4EEC\u5BF9\u7A0B\u5E8F\u7684\u6548\u7387\u5F88\u5728\u610F\u65F6\uFF0C\u95EE\u9898\u5C31\u6765\u4E86\u3002 \u30FB\u4E0EJava\u73AF\u5883\u5916\u4EA4\u4E92\uFF1A**\u6709\u65F6Java\u5E94\u7528\u9700\u8981\u4E0EJava\u5916\u9762\u7684\u73AF\u5883\u4EA4\u4E92\uFF0C\u8FD9\u662F\u672C\u5730\u65B9\u6CD5\u5B58\u5728\u7684\u4E3B\u8981\u539F\u56E0\u3002**\u4F60\u53EF\u4EE5\u60F3\u60F3Java\u9700\u8981\u4E0E\u4E00\u4E9B\u5E95\u5C42\u7CFB\u7EDF\uFF0C\u5982\u64CD\u4F5C\u7CFB\u7EDF\u6216\u67D0\u4E9B\u786C\u4EF6\u4EA4\u6362\u4FE1\u606F\u65F6\u7684\u60C5\u51B5\u3002\u672C\u5730\u65B9\u6CD5\u6B63\u662F\u8FD9\u6837\u4E00\u79CD\u4EA4\u6D41\u673A\u5236\uFF1A\u5B83\u4E3A\u6211\u4EEC\u63D0\u4F9B\u4E86\u4E00\u4E2A\u975E\u5E38\u7B80\u6D01\u7684\u63A5\u53E3\u800C\u4E14\u6211\u4EEC\u65E0\u9700\u53BB\u4E86\u89E3Java\u5E94\u7528\u4E4B\u5916\u7684\u7E41\u7410\u7684\u7EC6\u8282\u3002</p><p><strong>\u4E0E\u64CD\u4F5C\u7CFB\u7EDF\u4EA4\u4E92</strong> JVM\u652F\u6301\u7740Java\u8BED\u8A00\u672C\u8EAB\u548C\u8FD0\u884C\u65F6\u5E93\uFF0C\u5B83\u662FJava\u7A0B\u5E8F\u8D56\u4EE5\u751F\u5B58\u7684\u5E73\u53F0\uFF0C\u5B83\u7531\u4E00\u4E2A\u89E3\u91CA\u5668\uFF08\u89E3\u91CA\u5B57\u8282\u7801\uFF09\u548C\u4E00\u4E9B\u8FDE\u63A5\u5230\u672C\u5730\u4EE3\u7801\u7684\u5E93\u7EC4\u6210\u3002\u7136\u800C\u4E0D\u7BA1\u600E\u6837\uFF0C\u5B83\u6BD5\u7ADF\u4E0D\u662F\u4E00\u4E2A\u5B8C\u6574\u7684\u7CFB\u7EDF\uFF0C\u5B83\u7ECF\u5E38\u4F9D\u8D56\u4E8E\u4E00\u4E9B\u5E95\u5C42\u7CFB\u7EDF\u7684\u652F\u6301\u3002\u8FD9\u4E9B\u5E95\u5C42\u7CFB\u7EDF\u5E38\u5E38\u662F\u5F3A\u5927\u7684\u64CD\u4F5C\u7CFB\u7EDF\u3002\u901A\u8FC7\u4F7F\u7528\u672C\u5730\u65B9\u6CD5\uFF0C\u6211\u4EEC\u5F97\u4EE5\u7528Java\u5B9E\u73B0\u4E86jre\u7684\u4E0E\u5E95\u5C42\u7CFB\u7EDF\u7684\u4EA4\u4E92\uFF0C\u751A\u81F3JVM\u7684\u4E00\u4E9B\u90E8\u5206\u5C31\u662F\u7528C\u5199\u7684\u3002\u8FD8\u6709\uFF0C\u5982\u679C\u6211\u4EEC\u8981\u4F7F\u7528\u4E00\u4E9BJava\u8BED\u8A00\u672C\u8EAB\u6CA1\u6709\u63D0\u4F9B\u5C01\u88C5\u7684\u64CD\u4F5C\u7CFB\u7EDF\u7684\u7279\u6027\u65F6\uFF0C\u6211\u4EEC\u4E5F\u9700\u8981\u4F7F\u7528\u672C\u5730\u65B9\u6CD5\u3002 <strong>Sun\u2019s Java</strong> **Sun\u7684\u89E3\u91CA\u5668\u662F\u7528C\u5B9E\u73B0\u7684\uFF0C\u8FD9\u4F7F\u5F97\u5B83\u80FD\u50CF\u4E00\u4E9B\u666E\u901A\u7684C\u4E00\u6837\u4E0E\u5916\u90E8\u4EA4\u4E92\u3002**jre\u5927\u90E8\u5206\u662F\u7528Java\u5B9E\u73B0\u7684\uFF0C\u5B83\u4E5F\u901A\u8FC7\u4E00\u4E9B\u672C\u5730\u65B9\u6CD5\u4E0E\u5916\u754C\u4EA4\u4E92\u3002\u4F8B\u5982\uFF1A\u7C7Bjava.lang. hread\u7684 setpriority\uFF08\uFF09\u65B9\u6CD5\u662F\u7528Java\u5B9E\u73B0\u7684\uFF0C\u4F46\u662F\u5B83\u5B9E\u73B0\u8C03\u7528\u7684\u662F\u8BE5\u7C7B\u91CC\u7684\u672C\u5730\u65B9\u6CD5setprlority0\uFF08\uFF09\u3002\u8FD9\u4E2A\u672C\u5730\u65B9\u6CD5\u662F\u7528C\u5B9E\u73B0\u7684\uFF0C\u5E76\u88AB\u690D\u5165JVM\u5185\u90E8\uFF0C\u5728Windows 95\u7684\u5E73\u53F0\u4E0A\uFF0C\u8FD9\u4E2A\u672C\u5730\u65B9\u6CD5\u6700\u7EC8\u5C06\u8C03\u7528Win32 Setpriority\uFF08\uFF09API\u3002\u8FD9\u662F\u4E00\u4E2A\u672C\u5730\u65B9\u6CD5\u7684\u5177\u4F53\u5B9E\u73B0\u7531JVM\u76F4\u63A5\u63D0\u4F9B\uFF0C\u66F4\u591A\u7684\u60C5\u51B5\u662F\u672C\u5730\u65B9\u6CD5\u7531\u5916\u90E8\u7684\u52A8\u6001\u94FE\u63A5\u5E93( external dynamic link library)\u63D0\u4F9B\uFF0C\u7136\u540E\u88ABJVM\u8C03\u7528\u3002</p><p><strong>\u73B0\u72B6</strong></p><p>\u76EE\u524D\u8BE5\u65B9\u6CD5\u4F7F\u7528\u7684\u8D8A\u6765\u8D8A\u5C11\u4E86\uFF0C\u9664\u975E\u662F\u4E0E\u786C\u4EF6\u6709\u5173\u7684\u5E94\u7528\uFF0C\u6BD4\u5982\u901A\u8FC7Java\u7A0B\u5E8F\u9A71\u52A8\u6253\u5370\u673A\u6216\u8005Java\u7CFB\u7EDF\u7BA1\u7406\u751F\u4EA7\u8BBE\u5907\uFF0C\u5728\u4F01\u4E1A\u7EA7\u5E94\u7528\u4E2D\u5DF2\u7ECF\u6BD4\u8F83\u5C11\u89C1\u3002\u56E0\u4E3A\u73B0\u5728\u7684\u5F02\u6784\u9886\u57DF\u95F4\u7684\u901A\u4FE1\u5F88\u53D1\u8FBE\uFF0C\u6BD4\u5982\u53EF\u4EE5\u4F7F\u7528 Socket\u901A\u4FE1\uFF0C\u4E5F\u53EF\u4EE5\u4F7F\u7528\u7F51 Web Service\u7B49\u7B49\uFF0C\u4E0D\u591A\u505A\u4ECB\u7ECD\u3002</p><h1 id="\u4E03\u3001\u672C\u5730\u65B9\u6CD5\u6808" tabindex="-1"><a class="header-anchor" href="#\u4E03\u3001\u672C\u5730\u65B9\u6CD5\u6808" aria-hidden="true">#</a> \u4E03\u3001<em>\u672C\u5730\u65B9\u6CD5\u6808</em></h1><p>\u672C\u5730\u65B9\u6CD5\u6808( Native Method Stack) \u30FBJava\u865A\u62DF\u673A\u6808\u7528\u4E8E\u7BA1\u7406Java\u65B9\u6CD5\u7684\u8C03\u7528\uFF0C\u800C\u672C\u5730\u65B9\u6CD5\u6808<strong>\u7528\u4E8E\u7BA1\u7406\u672C\u5730\u65B9\u6CD5\u7684\u8C03\u7528</strong>\u3002 \u30FB\u672C\u5730\u65B9\u6CD5\u6808\uFF0C\u4E5F\u662F\u7EBF\u7A0B\u79C1\u6709\u7684\u3002 \u30FB\u5141\u8BB8\u88AB\u5B9E\u73B0\u6210\u56FA\u5B9A\u6216\u8005\u662F\u53EF\u52A8\u6001\u6269\u5C55\u7684\u5185\u5B58\u5927\u5C0F\u3002\uFF08\u5728\u5185\u5B58\u6EA2\u51FA\u65B9\u9762\u662F\u76F8\u540C\u7684\uFF09</p><p>\u200B \u5982\u679C\u7EBF\u7A0B\u8BF7\u6C42\u5206\u914D\u7684\u6808\u5BB9\u91CF\u8D85\u8FC7\u672C\u5730\u65B9\u6CD5\u6808\u5141\u8BB8\u7684\u6700\u5927\u5BB9\u91CF\uFF0CJava\u865A\u62DF\u673A\u5C06\u4F1A\u629B\u51FA\u4E00\u4E2A StackOverflowError\u5F02\u5E38\u3002 \u200B \u5982\u679C\u672C\u5730\u65B9\u6CD5\u6808\u53EF\u4EE5\u52A8\u6001\u6269\u5C55\uFF0C\u5E76\u4E14\u5728\u5C1D\u8BD5\u6269\u5C55\u7684\u65F6\u5019\u65E0\u6CD5\u7533\u8BF7\u5230\u8DB3\u591F\u7684\u5185\u5B58\uFF0C\u6216\u8005\u5728\u521B\u5EFA\u65B0\u7684\u7EBF\u7A0B\u65F6\u6CA1\u6709\u8DB3\u591F\u7684\u5185\u5B58\u53BB\u521B\u5EFA\u5BF9\u5E94\u7684\u672C\u5730\u65B9\u6CD5\u6808\uFF0C\u90A3\u4E48Java\u865A\u62DF\u673A\u5C06\u4F1A\u629B\u51FA\u4E00\u4E2A OutOfMemoryError\u5F02\u5E38\u3002 \u30FB\u672C\u5730\u65B9\u6CD5\u6808\u662F\u4F7F\u7528C\u8BED\u8A00\u5B9E\u73B0\u7684 \u30FB\u5B83\u7684\u5177\u4F53\u505A\u6CD5\u662F Native Method Stack\u4E2D\u767B\u8BB0 native \u65B9\u6CD5\uFF0C\u5728 Execution Engine \u6267\u884C\u65F6\u52A0\u8F7D\u672C\u5730\u65B9\u6CD5\u5E93\u3002</p><p>\u30FB\u5F53\u67D0\u4E2A\u7EBF\u7A0B\u8C03\u7528\u4E00\u4E2A\u672C\u5730\u65B9\u6CD5\u65F6\uFF0C\u5B83\u5C31\u8FDB\u5165\u4E86\u4E00\u4E2A\u5168\u65B0\u7684\u5E76\u4E14\u4E0D\u518D\u53D7\u865A\u62DF\u673A\u9650\u5236\u7684\u4E16\u754C\u3002\u5B83\u548C\u865A\u62DF\u673A\u62E5\u6709\u540C\u6837\u7684\u6743\u9650\u3002 \u672C\u5730\u65B9\u6CD5\u6808\u53EF\u4EE5\u901A\u8FC7\u672C\u5730\u65B9\u6CD5\u63A5\u53E3\u6765\u8BBF\u95EE\u865A\u62DF\u673A\u5185\u90E8\u7684\u8FD0\u884C\u65F6\u6570\u636E\u533A\u3002 \u5B83\u751A\u81F3\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u672C\u5730\u5904\u7406\u5668\u4E2D\u7684\u5BC4\u5B58\u5668 \u76F4\u63A5\u4ECE\u672C\u5730\u5185\u5B58\u7684\u5806\u4E2D\u5206\u914D\u4EFB\u610F\u6570\u91CF\u7684\u5185\u5B58\u3002 \u5E76\u4E0D\u662F\u6240\u6709\u7684JVM\u90FD\u652F\u6301\u672C\u5730\u65B9\u6CD5\u3002\u56E0\u4E3AJava\u865A\u62DF\u673A\u89C4\u8303\u5E76\u6CA1\u6709\u660E\u786E\u8981\u6C42\u672C\u5730\u65B9\u6CD5\u6808\u7684\u4F7F\u7528\u8BED\u8A00\u3001\u5177\u4F53\u5B9E\u73B0\u65B9\u5F0F\u3001\u6570\u636E\u7ED3\u6784\u7B49\u3002\u5982\u679CJVM\u4EA7\u54C1\u4E0D\u6253\u7B97\u652F\u6301 native\u65B9\u6CD5\uFF0C\u4E5F\u53EF\u4EE5\u65E0\u9700\u5B9E\u73B0\u672C\u5730\u65B9\u6CD5\u6808\u3002 \u30FB\u5728 Hotspot JVM\u4E2D\uFF0C\u76F4\u63A5\u5C06\u672C\u5730\u65B9\u6CD5\u6808\u548C\u865A\u62DF\u673A\u6808\u5408\u4E8C\u4E3A\u4E00\u3002</p><h1 id="\u516B\u3001\u5806" tabindex="-1"><a class="header-anchor" href="#\u516B\u3001\u5806" aria-hidden="true">#</a> \u516B\u3001\u5806</h1><h2 id="_1-\u5806\u7684\u6838\u5FC3\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#_1-\u5806\u7684\u6838\u5FC3\u6982\u8FF0" aria-hidden="true">#</a> 1.\u5806\u7684\u6838\u5FC3\u6982\u8FF0</h2><p>\u30FB\u4E00\u4E2AJVM\u5B9E\u4F8B\u53EA\u5B58\u5728<strong>\u4E00\u4E2A</strong>\u5806\u5185\u5B58\uFF0C\u5806\u4E5F\u662FJava\u5185\u5B58\u7BA1\u7406\u7684\u6838\u5FC3\u533A\u57DF\u3002 \u30FBJava\u5806\u533A\u5728JVM\u542F\u52A8\u7684\u65F6\u5019\u5373\u88AB\u521B\u5EFA\uFF0C\u5176\u7A7A\u95F4\u5927\u5C0F\u4E5F\u5C31\u786E\u5B9A\u4E86\u3002\u662FJVM\u7BA1\u7406\u7684<strong>\u6700\u5927</strong>\u4E00\u5757\u5185\u5B58\u7A7A\u95F4\u3002\u5806\u5185\u5B58\u7684\u5927\u5C0F\u662F\u53EF\u4EE5\u8C03\u8282\u7684\u3002\u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u89C4\u5B9A\uFF0C\u5806\u53EF\u4EE5\u5904\u4E8E\u7269\u7406\u4E0A\u4E0D\u8FDE\u7EED\u7684\u5185\u5B58\u7A7A\u95F4\u4E2D\uFF0C\u4F46\u5728\u903B\u8F91\u4E0A\u5B83\u5E94\u8BE5\u88AB\u89C6\u4E3A\u8FDE\u7EED\u7684\u3002 \u30FB\u6240\u6709\u7684\u7EBF\u7A0B\u5171\u4EABJava\u5806\uFF0C\u5728\u8FD9\u91CC\u8FD8\u53EF\u4EE5\u5212\u5206\u7EBF\u7A0B\u79C1\u6709\u7684\u7F13\u51B2\u533A\uFF08 Thread Local Allocation Buffer, <strong>TLAB</strong>)</p><p>\u30FB\u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u4E2D\u5BF9Java\u5806\u7684\u63CF\u8FF0\u662F\uFF1A\u6240\u6709\u7684\u5BF9\u8C61\u5B9E\u4F8B\u4EE5\u53CA\u6570\u7EC4\u90FD\u5E94\u5F53\u5728\u8FD0\u884C\u65F6\u5206\u914D\u5728\u5806\u4E0A\u3002\uFF08 The heap is the run-time data area fromwhich memcry for all class instances and arrays is allocated)\u6211\u8981\u8BF4\u7684\u662F\uFF1A\u201C\u51E0\u4E4E\u201D\u6240\u6709\u7684\u5BF9\u8C61\u5B9E\u4F8B\u90FD\u5728\u8FD9\u91CC\u5206\u914D\u5185\u5B58\u3002\u4E00\u4ECE\u5B9E\u9645\u4F7F\u7528\u89D2\u5EA6\u770B\u7684\u3002 \u30FB\u6570\u7EC4\u548C\u5BF9\u8C61\u53EF\u80FD\u6C38\u8FDC\u4E0D\u4F1A\u5B58\u50A8\u5728\u6808\u4E0A\uFF0C\u56E0\u4E3A\u6808\u5E27\u4E2D\u4FDD\u5B58\u5F15\u7528\uFF0C\u8FD9\u4E2A\u5F15\u7528\u6307\u5411\u5BF9\u8C61\u6216\u8005\u6570\u7EC4\u5728\u5806\u4E2D\u7684\u4F4D\u7F6E\u3002 \u30FB\u5728\u65B9\u6CD5\u7ED3\u675F\u540E\uFF0C\u5806\u4E2D\u7684\u5BF9\u8C61\u4E0D\u4F1A\u9A6C\u4E0A\u88AB\u79FB\u9664\uFF0C\u4EC5\u4EC5\u5728\u5783\u573E\u6536\u96C6\u7684\u65F6\u5019\u624D\u4F1A\u88AB\u79FB\u9664\u3002 \u30FB\u5806\uFF0C\u662FGC( Garbage Collection,\u5783\u573E\u6536\u96C6\u5668)\u6267\u884C<strong>\u5783\u573E\u56DE\u6536\u7684\u91CD\u70B9\u533A\u57DF</strong>\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211125134653273.png" alt="image-20211125134653273" style="zoom:50%;"><h2 id="_2-\u5806\u7684\u7EC6\u5206\u5185\u5B58\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_2-\u5806\u7684\u7EC6\u5206\u5185\u5B58\u7ED3\u6784" aria-hidden="true">#</a> 2.\u5806\u7684\u7EC6\u5206\u5185\u5B58\u7ED3\u6784</h2><img src="http://qnimg.gisfsde.com/work/image-20211125135924933.png" alt="image-20211125135924933" style="zoom:80%;"><p><img src="http://qnimg.gisfsde.com/work/image-20211125140503796.png" alt="image-20211125140503796" loading="lazy"></p><h2 id="_3-\u8BBE\u7F6E\u5806\u5185\u5B58\u5927\u5C0F\u4E0Eoom" tabindex="-1"><a class="header-anchor" href="#_3-\u8BBE\u7F6E\u5806\u5185\u5B58\u5927\u5C0F\u4E0Eoom" aria-hidden="true">#</a> 3.\u8BBE\u7F6E\u5806\u5185\u5B58\u5927\u5C0F\u4E0EOOM</h2><h3 id="_1-\u8BBE\u7F6E\u5806\u5185\u5B58" tabindex="-1"><a class="header-anchor" href="#_1-\u8BBE\u7F6E\u5806\u5185\u5B58" aria-hidden="true">#</a> 1.\u8BBE\u7F6E\u5806\u5185\u5B58</h3><p>Java\u5806\u533A\u7528\u4E8E\u5B58\u50A8Java\u5BF9\u8C61\u5B9E\u4F8B\uFF0C\u90A3\u4E48\u5806\u7684\u5927\u5C0F\u5728JVM\u542F\u52A8\u65F6\u5C31\u5DF2\u7ECF\u8BBE\u5B9A\u597D\u4E86\uFF0C\u5927\u5BB6\u53EF\u4EE5\u901A\u8FC7\u9009\u9879&quot;-Xmx&quot;\u548C&quot;-Xms&quot;\u6765\u8FDB\u884C\u8BBE\u7F6E</p><p>\u200B \u201C-Xms&quot;\u7528\u4E8E\u8868\u793A\u5806\u533A\u7684\u8D77\u59CB\u5185\u5B58\uFF0C\u7B49\u4EF7\u4E8E\u30FCXX: Initialheapsize \u200B \u201C-Xmx&quot;\u5219\u7528\u4E8E\u8868\u793A\u5806\u533A\u7684\u6700\u5927\u5185\u5B58\uFF0C\u7B49\u4EF7\u4E8E\u30FCXX: Maxheapsize \u4E00\u65E6\u5806\u533A\u4E2D\u7684\u5185\u5B58\u5927\u5C0F\u8D85\u8FC7\u201C-Xmx&quot;\u6240\u6307\u5B9A\u7684\u6700\u5927\u5185\u5B58\u65F6\uFF0C\u5C06\u4F1A\u629B\u51FA OutOfMemoryError \u5F02\u5E38\u3002 \u30FB\u901A\u5E38\u4F1A\u5C06 -Xms \u548C -Xmx \u4E24\u4E2A\u53C2\u6570\u914D\u7F6E\u76F8\u540C\u7684\u503C\uFF0C\u5176\u76EE\u7684\u662F\u4E3A\u4E86\u80FD\u591F\u5728java\u5783\u573E\u56DE\u6536\u673A\u5236\u6E05\u7406\u5B8C\u5806\u533A\u540E\u4E0D\u9700\u8981\u91CD\u65B0\u5206\u9694\u8BA1\u7B97\u5806\u533A\u7684\u5927\u5C0F\uFF0C\u4ECE\u800C\u63D0\u9AD8\u6027\u80FD\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF1A<strong>\u521D\u59CB\u5185\u5B58\u5927\u5C0F\uFF1A\u7269\u7406\u7535\u8111\u5185\u5B58\u5927\u5C0F/64\uFF0C\u6700\u5927\u5185\u5B58\u5927\u5C0F\uFF1A\u7269\u7406\u7535\u8111\u5185\u5B58\u5927\u5C0F/4</strong></p><p>4.\u67E5\u770B\u8BBE\u7F6E\u7684\u53C2\u6570\uFF1A\u65B9\u5F0F\u4E00\uFF1Ajps/jstat -GC \u8FDB\u7A0Bid \u65B9\u5F0F\u4E8C\uFF1A-XX: +PrintGCdetails</p><h3 id="_2-oom\u8BF4\u660E\u4E0E\u4E3E\u4F8B" tabindex="-1"><a class="header-anchor" href="#_2-oom\u8BF4\u660E\u4E0E\u4E3E\u4F8B" aria-hidden="true">#</a> 2.OOM\u8BF4\u660E\u4E0E\u4E3E\u4F8B</h3><h5 id="\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#\u5DE5\u5177" aria-hidden="true">#</a> \u5DE5\u5177\uFF1A</h5><p>jvisualvm\uFF1A\u67E5\u770B\u5185\u5B58\u60C5\u51B5\uFF0Cjvisualvm\u547D\u4EE4\u53EF\u76F4\u63A5\u6253\u5F00</p><p><img src="http://qnimg.gisfsde.com/work/image-20211125191145594.png" alt="image-20211125191145594" loading="lazy"></p><h5 id="\u5B89\u88C5\u63D2\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5\u63D2\u4EF6" aria-hidden="true">#</a> \u5B89\u88C5\u63D2\u4EF6</h5><p><img src="http://qnimg.gisfsde.com/work/image-20211125191600977.png" alt="image-20211125191600977" loading="lazy"></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OOMInstance</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">ArrayList</span>\\<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Picture1</span><span class="token punctuation">&gt;</span></span> list<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span>\\<span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

    <span class="token punctuation">{</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Picture1</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Picture1</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span>  <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pixels<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Picture1</span><span class="token punctuation">(</span><span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pixels <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u7F16\u8BD1\u7A0B\u5E8F" tabindex="-1"><a class="header-anchor" href="#\u7F16\u8BD1\u7A0B\u5E8F" aria-hidden="true">#</a> \u7F16\u8BD1\u7A0B\u5E8F</h5><p><img src="http://qnimg.gisfsde.com/work/image-20211125192134417.png" alt="image-20211125192134417" loading="lazy"></p><h5 id="\u4FEE\u6539\u5806\u5927\u5C0F" tabindex="-1"><a class="header-anchor" href="#\u4FEE\u6539\u5806\u5927\u5C0F" aria-hidden="true">#</a> \u4FEE\u6539\u5806\u5927\u5C0F</h5><p><img src="http://qnimg.gisfsde.com/work/image-20211125192042179.png" alt="image-20211125192042179" loading="lazy"></p><h5 id="\u8FD0\u884C\u7A0B\u5E8F\u67E5\u770B-jvisualvm" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u884C\u7A0B\u5E8F\u67E5\u770B-jvisualvm" aria-hidden="true">#</a> \u8FD0\u884C\u7A0B\u5E8F\u67E5\u770B jvisualvm</h5><img src="http://qnimg.gisfsde.com/work/image-20211125193145169.png" alt="image-20211125193145169"><p>Exception in thread &quot;main&quot; java.lang.<strong>OutOfMemoryError</strong>: Java heap space at pers.lxl.mylearnproject.programbase.jvm.Picture1.&lt;init&gt;(OOMInstance.java:27) at pers.lxl.mylearnproject.programbase.jvm.OOMInstance.main(OOMInstance.java:19)</p><h2 id="_4-\u5E74\u8F7B\u4EE3\u4E0E\u8001\u5E74\u4EE3" tabindex="-1"><a class="header-anchor" href="#_4-\u5E74\u8F7B\u4EE3\u4E0E\u8001\u5E74\u4EE3" aria-hidden="true">#</a> 4.\u5E74\u8F7B\u4EE3\u4E0E\u8001\u5E74\u4EE3</h2><p>\u30FB\u5B58\u50A8\u5728JVM\u4E2D\u7684Java\u5BF9\u8C61\u53EF\u4EE5\u88AB\u5212\u5206\u4E3A\u4E24\u7C7B \u4E00\u7C7B\u662F\u751F\u547D\u5468\u671F\u8F83\u77ED\u7684\u77AC\u65F6\u5BF9\u8C61\uFF0C\u8FD9\u7C7B\u5BF9\u8C61\u7684\u521B\u5EFA\u548C\u6D88\u4EA1\u90FD\u975E\u5E38\u8FC5\u901F \u53E6\u5916\u4E00\u7C7B\u5BF9\u8C61\u7684\u751F\u547D\u5468\u671F\u5374\u975E\u5E38\u957F\uFF0C\u5728\u67D0\u4E9B\u6781\u7AEF\u7684\u60C5\u51B5\u4E0B\u8FD8\u80FD\u591F\u4E0EJVM\u7684\u751F\u547D\u5468\u671F\u4FDD\u6301\u4E00\u81F4\u3002 \u30FBJava\u5806\u533A\u8FDB\u4E00\u6B65\u7EC6\u5206\u7684\u8BDD\uFF0C\u53EF\u4EE5\u5212\u5206\u4E3A\u5E74\u8F7B\u4EE3( YoungGen)\u548C\u8001\u5E74\u4EE3( OldGen) \u30FB\u5176\u4E2D\u5E74\u8F7B\u4EE3\u53C8\u53EF\u4EE5\u5212\u5206\u4E3AEden\u7A7A\u95F4\u3001 Survivor0\u7A7A\u95F4\u548C Survivor1\u7A7A\u95F4(\u6709\u65F6\u4E5F\u53EB\u505Afrom\u533A\u3001to\u533A)\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211126133609902.png" alt="image-20211126133609902" style="zoom:67%;"><p><img src="http://qnimg.gisfsde.com/work/image-20211126133644542.png" alt="image-20211126133644542" loading="lazy"></p><h3 id="\u53C2\u6570\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570\u8BBE\u7F6E" aria-hidden="true">#</a> \u53C2\u6570\u8BBE\u7F6E\uFF1A</h3><p>\u914D\u7F6E\u65B0\u751F\u4EE3\u4E0E\u8001\u5E74\u4EE3\u5728\u5806\u7ED3\u6784\u7684\u5360\u6BD4\u3002 \u9ED8\u8BA4**-XX: NewRatio=2**,\u8868\u793A\u65B0\u751F\u4EE3\u53601,\u8001\u5E74\u4EE3\u53602,\u65B0\u751F\u4EE3\u5360\u6574\u4E2A\u5806\u76841/3 \u53EF\u4EE5\u4FEE\u6539-XX: Newratio=4,\u8868\u793A\u65B0\u751F\u4EE3\u53601,\u8001\u5E74\u4EE3\u53604,\u65B0\u751F\u4EE3\u5360\u6574\u4E2A\u5806\u76841/5</p><p>\u5728 Hot Spot\u4E2D\uFF0CEden\u7A76\u95F4\u548C\u53E6\u5916\u4E24\u4E2A Survivor&#39;\u7A7A\u95F4\u7F3A\u7701\u6240\u5360\u7684\u6BD4\u4F8B\u662F8:1:1\u5F53\u7136\u5F00\u53D1\u4EBA\u5458\u53EF\u4EE5\u901A\u8FC7\u9009\u9879\u201C<strong>-Xx: SurvivorRatio</strong>\u201D\u8C03\u6574\u8FD9\u4E2A\u7A7A\u95F4\u6BD4\u4F8B\u3002\u6BD4\u5982XX: Survivorratio=8,\u9ED8\u8BA48 \u51E0\u4E4E\u6240\u6709\u7684Java\u5BF9\u8C61\u90FD\u662F\u5728Eden\u533A\u88ABnew\u51FA\u6765\u7684\u7EDD\u5927\u90E8\u5206\u7684Java\u5BF9\u8C61\u7684\u9500\u6BC1\u90FD\u5728\u65B0\u751F\u4EE3\u8FDB\u884C\u4E86\u3002IBM\u516C\u53F8\u7684\u4E13\u95E8\u7814\u7A76\u8868\u660E\uFF0C\u65B0\u751F\u4EE3\u4E2D80%\u7684\u5BF9\u8C61\u90FD\u662F\u201C\u671D\u751F\u5915\u6B7B\u201D\u7684\u3002 \u53EF\u4EE5\u4F7F\u7528\u9009\u9879&quot;<strong>-Xmn</strong>&#39;&quot;\u8BBE\u7F6E\u65B0\u751F\u4EE3\u6700\u5927\u5185\u5B58\u5927\u5C0F&gt;\u8FD9\u4E2A\u53C2\u6570\u4E00\u822C\u4F7F\u7528\u9ED8\u8BA4\u503C\u5C31\u53EF\u4EE5\u4E86\u3002</p><h3 id="\u5BF9\u8C61\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u6D41\u7A0B" aria-hidden="true">#</a> \u5BF9\u8C61\u6D41\u7A0B\uFF1A</h3><p><img src="http://qnimg.gisfsde.com/work/image-20211126133944542.png" alt="image-20211126133944542" loading="lazy"></p><h2 id="_5-\u5BF9\u8C61\u5206\u914D\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#_5-\u5BF9\u8C61\u5206\u914D\u8FC7\u7A0B" aria-hidden="true">#</a> 5.\u5BF9\u8C61\u5206\u914D\u8FC7\u7A0B</h2><h3 id="_1-\u4E00\u822C\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#_1-\u4E00\u822C\u8FC7\u7A0B" aria-hidden="true">#</a> 1.\u4E00\u822C\u8FC7\u7A0B</h3><p>\u200B Eden \u6EE1\u89E6\u53D1 YGC/Minor GC \u5BF9 Eden\u4E0E From \u533A\u56DE\u6536\uFF0C\u8FD8\u5728\u7528\u7684\u5BF9\u8C61\u653E\u5230 From \u533A\uFF0CAge\u8BBE\u4E3A1\uFF0C\u4E0B\u6B21\u56DE\u6536\u89E6\u53D1\u65F6\u590D\u5236 From \u533A\u8F6C\u5230 To \u533A\uFF08\u7A7A\u7684\u533A\uFF09\uFF0CAge+1\uFF0CAge \u8FBE\u5230\u9608\u503C\uFF08\u53EF\u901A\u8FC7\u8BBE\u7F6E -XX: MaxTenuringThreshold=&lt;N&gt;\uFF09\u653E\u5165Old\u3002</p><p><img src="http://qnimg.gisfsde.com/work/\u7B2C08\u7AE0_\u65B0\u751F\u4EE3\u5BF9\u8C61\u5206\u914D\u4E0E\u56DE\u6536\u8FC7\u7A0B.jpg" alt="\u7B2C08\u7AE0_\u65B0\u751F\u4EE3\u5BF9\u8C61\u5206\u914D\u4E0E\u56DE\u6536\u8FC7\u7A0B" loading="lazy"></p><p>\u4E3A\u65B0\u5BF9\u8C61\u5206\u914D\u5185\u5B58\u662F\u4E00\u4EF6\u975E\u5E38\u4E25\u8C28\u548C\u590D\u6742\u7684\u4EFB\u52A1\uFF0CJVM\u7684\u8BBE\u8BA1\u8005\u4EEC\u4E0D\u4EC5\u9700\u8981\u8003\u8651\u5185\u5B58\u5982\u4F55\u5206\u914D\u3001\u5728\u54EA\u91CC\u5206\u914D\u7B49\u95EE\u9898\uFF0C\u5E76\u4E14\u7531\u4E8E\u5185\u5B58\u5206\u914D\u7B97\u6CD5\u4E0E\u5185\u5B58\u56DE\u6536\u7B97\u6CD5\u5BC6\u5207\u76F8\u5173\uFF0C\u6240\u4EE5\u8FD8\u9700\u8981\u8003\u8651GC\u6267\u884C\u5B8C\u5185\u5B58\u56DE\u6536\u540E\u662F\u5426\u4F1A\u5728\u5185\u5B58\u7A7A\u95F4\u4E2D\u722C\u751F\u5185\u5B58\u788E\u7247\u3002 1.new\u7684\u5BF9\u8C61\u5148\u653E\u4F0A\u7538\u56ED\u533A\u3002\u6B64\u533A\u6709\u5927\u5C0F\u9650\u5236\u3002 2.\u5F53\u4F0A\u7538\u56ED\u7684\u7A7A\u95F4\u586B\u6EE1\u65F6\uFF0C\u7A0B\u5E8F\u53C8\u9700\u8981\u521B\u5EFA\u5BF9\u8C61\uFF0CJVM\u7684\u5783\u573E\u56DE\u6536\u5668\u5C06\u5BF9\u4F0A\u7538\u56ED\u533A\u8FDB\u884C\u5783\u573E\u56DE\u6536( Minor GC),\u5C06\u4F0A\u7538\u56ED\u533A\u4E2D\u7684\u4E0D\u518D\u88AB\u5176\u4ED6\u5BF9\u8C61\u6240\u5F15\u7528\u7684\u5BF9\u8C61\u8FDB\u884C\u9500\u6BC1\u3002\u518D\u52A0\u8F7D\u65B0\u7684\u5BF9\u8C61\u653E\u5230\u4F0A\u7538\u56ED\u533A\u3002 3.\u7136\u540E\u5C06\u4F0A\u7538\u56ED\u4E2D\u7684\u5269\u4F59\u5BF9\u8C61\u79FB\u52A8\u5230\u5E78\u5B58\u80050\u533A 4.\u5982\u679C\u518D\u6B21\u89E6\u53D1\u5783\u573E\u56DE\u6536\uFF0C\u6B64\u65F6\u4E0A\u6B21\u5E78\u5B58\u4E0B\u6765\u7684\u653E\u5230\u5E78\u5B58\u80050\u533A\u7684\uFF0C\u5982\u679C\u6CA1\u6709\u56DE\u6536\uFF0C\u5C31\u4F1A\u653E\u5230\u5E78\u5B58\u80051\u533A\u3002 5.\u5982\u679C\u518D\u6B21\u7ECF\u5386\u5783\u573E\u56DE\u6536\uFF0C\u6B64\u65F6\u4F1A\u91CD\u65B0\u653E\u56DE\u5E78\u5B58\u80050\u533A\uFF0C\u63A5\u7740\u518D\u53BB\u5E78\u5B58\u80051\u533A 6.\u5565\u65F6\u5019\u80FD\u53BB\u517B\u8001\u533A\u5462\uFF1F\u53EF\u4EE5\u8BBE\u7F6E\u6B21\u6570\u3002\u9ED8\u8BA4\u662F15\u6B21\u3002\u53EF\u4EE5\u8BBE\u7F6E\u53C2\u6570\uFF1A-XX: MaxTenuringThreshold=&lt;N&gt;\u8FDB\u884C\u8BBE\u7F6E\u3002</p><p><strong>\u603B\u7ED3</strong> \u9488\u5BF9\u5E78\u5B58\u8005s0,s1\u533A\u7684\u603B\u7ED3\uFF1A\u590D\u5236\u4E4B\u540E\u6709\u4EA4\u6362\uFF0C\u8C01\u7A7A\u8C01\u662FTo \u5173\u4E8E\u5783\u573E\u56DE\u6536\uFF1A\u9891\u7E41\u5728\u65B0\u751F\u533A\u6536\u96C6\uFF0C\u5F88\u5C11\u5728\u517B\u8001\u533A\u6536\u96C6\uFF0C\u51E0\u4E4E\u4E0D\u5728\u6C38\u4E45\u533A/\u5143\u7A7A\u95F4\u6536\u96C6\u3002</p><h3 id="_2-\u7279\u6B8A\u60C5\u51B5" tabindex="-1"><a class="header-anchor" href="#_2-\u7279\u6B8A\u60C5\u51B5" aria-hidden="true">#</a> 2.\u7279\u6B8A\u60C5\u51B5</h3><p><img src="http://qnimg.gisfsde.com/work/image-20211129132015044.png" alt="image-20211129132015044" loading="lazy"></p><h2 id="_6-\u5E38\u7528\u8C03\u4F18\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#_6-\u5E38\u7528\u8C03\u4F18\u5DE5\u5177" aria-hidden="true">#</a> 6.\u5E38\u7528\u8C03\u4F18\u5DE5\u5177</h2><p>\u30FBJDK\u547D\u4EE4\u884C Ecllpse: Memory Analyzer Tool Jconsole Visualvm Jprofiler Java Flight Recorder GCVlewer GC Easy</p><h2 id="_7-minor-gc\u3001-maior-gc\u3001-full-gc" tabindex="-1"><a class="header-anchor" href="#_7-minor-gc\u3001-maior-gc\u3001-full-gc" aria-hidden="true">#</a> 7.Minor GC\u3001 Maior GC\u3001 Full GC</h2><p>JVM\u5728\u8FDB\u884CGC\u65F6\uFF0C\u5E76\u975E\u6BCF\u6B21\u90FD\u5BF9\u4E0A\u9762\u4E09\u4E2A\u5185\u5B58(\u65B0\u751F\u4EE3\u3001\u8001\u5E74\u4EE3\u3001\u65B9\u6CD5\u533A)\u533A\u57DF\u4E00\u8D77\u56DE\u6536\u7684\uFF0C\u5927\u90E8\u5206\u65F6\u5019\u56DE\u6536\u7684\u90FD\u662F\u6307\u65B0\u751F\u4EE3\u3002 \u9488\u5BF9 HotSpot VM\u7684\u5B9E\u73B0\uFF0C\u5B83\u91CC\u9762\u7684GC\u6309\u7167\u56DE\u6536\u533A\u57DF\u53C8\u5206\u4E3A\u4E24\u5927\u79CD\u7C7B\u578B\uFF1A\u4E00\u79CD\u662F\u90E8\u5206\u6536\u96C6( Partial GC),\u4E00\u79CD\u662F\u6574\u5806\u6536\u96C6(Full GC) <strong>\u90E8\u5206\u6536\u96C6</strong>\uFF1A\u4E0D\u662F\u5B8C\u6574\u6536\u96C6\u6574\u4E2AJAVA\u5806\u7684\u5783\u573E\u6536\u96C6\u3002\u5176\u4E2D\u53C8\u5206\u4E3A\uFF1A \u65B0\u751F\u4EE3\u6536\u96C6( Minor GC / Young GC):\u53EA\u662F\u65B0\u751F\u4EE3\u7684\u5783\u573E\u6536\u96C6 \u8001\u5E74\u4EE3\u6536\u96C6( Major GC / Old GC):\u53EA\u662F\u8001\u5E74\u4EE3\u7684\u5783\u573E\u6536\u96C6 \u76EE\u524D\uFF0C\u53EA\u6709 CMS GC\u4F1A\u6709\u5355\u72EC\u6536\u96C6\u8001\u5E74\u4EE3\u7684\u884C\u4E3A\u3002 \u6CE8\u610F\uFF0C\u5F88\u591A\u65F6\u5019 Major GC \u4F1A\u548C Full GC\u6DF7\u6DC6\u4F7F\u7528\uFF0C\u9700\u8981\u5177\u4F53\u5206\u8FA8\u662F\u8001\u5E74\u4EE3\u56DE\u6536\u8FD8\u662F\u6574\u5806\u56DE\u6536\u3002 \u6DF7\u5408\u6536\u96C6( Mixed GC):\u6536\u96C6\u6574\u4E2A\u65B0\u751F\u4EE3\u4EE5\u53CA\u90E8\u5206\u8001\u5E74\u4EE3\u7684\u5783\u573E\u6536\u96C6\u3002 \u76EE\u524D\uFF0C\u53EA\u6709G1 GC\u4F1A\u6709\u8FD9\u79CD\u884C\u4E3A <strong>\u6574\u5806\u6536\u96C6</strong>(Full GC):\u6536\u96C6\u6574\u4E2Ajava\u5806\u548C\u65B9\u6CD5\u533A\u7684\u5783\u573E\u6536\u96C6\u3002</p><h3 id="_1-\u5E74\u8F7B\u4EE3gc-minor-gc-\u89E6\u53D1\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#_1-\u5E74\u8F7B\u4EE3gc-minor-gc-\u89E6\u53D1\u673A\u5236" aria-hidden="true">#</a> 1.\u5E74\u8F7B\u4EE3GC( Minor GC)\u89E6\u53D1\u673A\u5236\uFF1A</h3><p>\u200B \u5F53\u5E74\u8F7B\u4EE3\u7A7A\u95F4\u4E0D\u8DB3\u65F6\uFF0C\u5C31\u4F1A\u89E6\u53D1 Minor GC,\u8FD9\u91CC\u7684\u5E74\u8F7B\u4EE3\u6EE1\u6307\u7684\u662F Eden\u4EE3\u6EE1\uFF0C Survivor\u6EE1\u4E0D\u4F1A\u5F15\u53D1GC.(\u6BCF\u6B21 Minor GC\u4F1A\u6E05\u7406\u5E74\u8F7B\u4EE3\u7684\u5185\u5B58\u3002\uFF09 \u200B \u56E0\u4E3AJava\u5BF9\u8C61\u5927\u591A\u90FD\u5177\u5907\u671D\u751F\u5915\u706D\u7684\u7279\u6027\uFF0C\u6240\u4EE5 Minor GC\u975E\u5E38\u9891\u7E41\uFF0C\u4E00\u822C\u56DE\u6536\u901F\u5EA6\u4E5F\u6BD4\u8F83\u5FEB\u3002\u8FD9\u4E00\u5B9A\u4E49\u65E2\u6E05\u6670\u53C8\u6613\u4E8E\u7406\u89E3\u3002 \u200B Minor GC\u4F1A\u5F15\u53D1STW,\u6682\u505C\u5176\u5B83\u7528\u6237\u7684\u7EBF\u7A0B\uFF0C\u7B49\u5783\u573E\u56DE\u6536\u7ED3\u6771\uFF0C\u7528\u6237\u7EBF\u7A0B\u624D\u6062\u590D\u8FD0\u884C\u3002</p><h3 id="_2-\u8001\u5E74\u4EE3gc-major-gc-full-gc-\u89E6\u53D1\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#_2-\u8001\u5E74\u4EE3gc-major-gc-full-gc-\u89E6\u53D1\u673A\u5236" aria-hidden="true">#</a> 2.\u8001\u5E74\u4EE3GC( Major GC / Full GC) \u89E6\u53D1\u673A\u5236</h3><p>\u6307\u53D1\u751F\u5728\u8001\u5E74\u4EE3\u7684GC,\u5BF9\u8C61\u4ECE\u8001\u5E74\u4EE3\u6D88\u5931\u65F6\uFF0C\u6211\u4EEC\u8BF4\u201C Major GC\u201D\u6216\u201CFull GC\u201D\u53D1\u751F\u4E86\u3002 \u51FA\u73B0\u4E86 Major GC,\u7ECF\u5E38\u4F1A\u4F34\u968F\u81F3\u5C11\u4E00\u6B21\u7684 Minor GC(\u4F46\u975E\u7EDD\u5BF9\u7684\uFF0C\u5728Parallel Scavenge\u6536\u96C6\u5668\u7684\u6536\u96C6\u7B56\u7565\u91CC\u5C31\u6709\u76F4\u63A5\u8FDB\u884C Major GCE\u7684\u7B56\u7565\u9009\u62E9\u8FC7\u7A0B\uFF09 \u4E5F\u5C31\u662F\u5728\u8001\u5E74\u4EE3\u7A7A\u95F4\u4E0D\u8DB3\u65F6\uFF0C\u4F1A\u5148\u5C1D\u8BD5\u89E6\u53D1 Minor GC\u3002\u5982\u679C\u4E4B\u540E\u7A7A\u95F4\u8FD8\u4E0D\u8DB3\uFF0C\u5219\u89E6\u53D1 Major GC\u3002 Major GC\u7684\u901F\u5EA6\u4E00\u822C\u4F1A\u6BD4 Minor GC \u616210\u500D\u4EE5\u4E0A\uFF0CSTW \u7684\u65F6\u95F4\u66F4\u957F\u3002 \u5982\u679C Major GC\u540E\uFF0C\u5185\u5B58\u8FD8\u4E0D\u8DB3\uFF0C\u5C31\u62A5OOM\u4E86 Major GC \u7684\u901F\u5EA6\u4E00\u822C\u4F1A\u6BD4 Minor GC\u616210\u500D\u4EE5\u4E0A\u3002</p><h3 id="_3-full-gc-\u89E6\u53D1\u673A\u5236-\u540E\u9762\u7EC6\u8BB2\u89E6\u53D1full-gc\u6267\u884C\u7684\u60C5\u51B5\u6709\u5982\u4E0B\u4E94\u79CD" tabindex="-1"><a class="header-anchor" href="#_3-full-gc-\u89E6\u53D1\u673A\u5236-\u540E\u9762\u7EC6\u8BB2\u89E6\u53D1full-gc\u6267\u884C\u7684\u60C5\u51B5\u6709\u5982\u4E0B\u4E94\u79CD" aria-hidden="true">#</a> 3.Full GC \u89E6\u53D1\u673A\u5236\uFF1A\uFF08\u540E\u9762\u7EC6\u8BB2\u89E6\u53D1Full GC\u6267\u884C\u7684\u60C5\u51B5\u6709\u5982\u4E0B\u4E94\u79CD\uFF1A</h3><p>(1)\u8C03\u7528 System.GC\uFF08\uFF09\u65F6\uFF0C\u7CFB\u7EDF\u5EFA\u8BAE\u6267\u884CFull GC,\u4F46\u662F\u4E0D\u5FC5\u7136\u6267\u884C (2)\u8001\u5E74\u4EE3\u7A7A\u95F4\u4E0D\u8DB3 (3)\u65B9\u6CD5\u533A\u7A7A\u95F4\u4E0D\u8DB3 (4)\u901A\u8FC7 Minor GC\u540E\u8FDB\u5165\u8001\u5E74\u4EE3\u7684\u5E73\u5747\u5927\u5C0F\u5927\u4E8E\u8001\u5E74\u4EE3\u7684\u53EF\u7528\u5185\u5B58 (5)\u7531Eden\u533A\u3001 survivor space0( From Space)\u533A\u5411 survivor space1(To Space)\u533A\u590D\u5236\u65F6\uFF0C\u5BF9\u8C61\u5927\u5C0F\u5927\u4E8E To Space\u53EF\u7528\u5185\u5B58\uFF0C\u5219\u628A\u8BE5\u5BF9\u8C61\u8F6C\u5B58\u5230\u8001\u5E74\u4EE3\uFF0C\u4E14\u8001\u5E74\u4EE3\u7684\u53EF\u7528\u5185\u5B58\u5C0F\u4E8E\u8BE5\u5BF9\u8C61\u5927\u5C0F \u8BF4\u660E\uFF1AFull GC\u662F\u5F00\u53D1\u6216\u8C03\u4F18\u4E2D\u5C3D\u91CF\u8981\u907F\u514D\u7684\u3002\u8FD9\u6837\u6682\u65F6\u65F6\u95F4\u4F1A\u77ED\u4E00\u4E9B\u3002</p><h2 id="_8-gc\u4E3E\u4F8B\u4E0E\u65E5\u5FD7\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_8-gc\u4E3E\u4F8B\u4E0E\u65E5\u5FD7\u5206\u6790" aria-hidden="true">#</a> 8.GC\u4E3E\u4F8B\u4E0E\u65E5\u5FD7\u5206\u6790</h2><p>\u6DFB\u52A0\u53C2\u6570\uFF1A-XX:PrintGCDetails</p><p>\u67E5\u770B\u65E5\u5FD7\uFF1A<img src="http://qnimg.gisfsde.com/work/image-20211129140420672.png" alt="image-20211129140420672" loading="lazy"></p><h2 id="_9-\u5806\u7A7A\u95F4\u5206\u4EE3\u601D\u60F3" tabindex="-1"><a class="header-anchor" href="#_9-\u5806\u7A7A\u95F4\u5206\u4EE3\u601D\u60F3" aria-hidden="true">#</a> 9.\u5806\u7A7A\u95F4\u5206\u4EE3\u601D\u60F3</h2><p>\u4E3A\u4EC0\u4E48\u9700\u8981\u628AJava\u5806\u5206\u4EE3\uFF1F\u4E0D\u5206\u4EE3\u5C31\u4E0D\u80FD\u6B63\u5E38\u5DE5\u4F5C\u4E86\u5417\uFF1F \u5176\u5B9E\u4E0D\u5206\u4EE3\u5B8C\u5168\u53EF\u4EE5\uFF0C\u5206\u4EE3\u7684\u552F\u4E00\u7406\u7531\u5C31\u662F\u4F18\u5316GC\u6027\u80FD\u3002\u5982\u679C\u6CA1\u6709\u5206\u4EE3\uFF0C\u90A3\u6240\u6709\u7684\u5BF9\u8C61\u90FD\u5728\u4E00\u5757\uFF0C\u5C31\u5982\u540C\u628A\u4E00\u4E2A\u5B66\u6821\u7684\u4EBA\u90FD\u5173\u5728\u4E00\u4E2A\u6559\u5BA4\u3002GC\u7684\u65F6\u5019\u8981\u627E\u5230\u54EA\u4E9B\u5BF9\u8C61\u6CA1\u7528\uFF0C\u8FD9\u6837\u5C31\u4F1A\u5BF9\u5806\u7684\u6240\u6709\u533A\u57DF\u8FDB\u884C\u626B\u63CF\u3002\u800C\u5F88\u591A\u5BF9\u8C61\u90FD\u662F\u671D\u751F\u5915\u6B7B\u7684\uFF0C\u5982\u679C\u5206\u4EE3\u7684\u8BDD\uFF0C\u628A\u65B0\u521B\u5EFA\u7684\u5BF9\u8C61\u653E\u5230\u67D0\u4E00\u5730\u65B9\uFF0C\u5F53GC\u7684\u65F6\u5019\u5148\u628A\u8FD9\u5757\u5B58\u50A8\u201C\u671D\u751F\u5915\u6B7B\u201D\u5BF9\u8C61\u7684\u533A\u57DF\u8FDB\u884C\u56DE\u6536\uFF0C\u8FD9\u6837\u5C31\u4F1A\u817E\u51FA\u5F88\u5927\u7684\u7A7A\u95F4\u51FA\u6765\u3002</p><h2 id="_10-\u5185\u5B58\u5206\u914D\u7B56\u7565-\u5BF9\u8C61\u63D0\u5347\u3010promotion\u3011\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_10-\u5185\u5B58\u5206\u914D\u7B56\u7565-\u5BF9\u8C61\u63D0\u5347\u3010promotion\u3011\u89C4\u5219" aria-hidden="true">#</a> 10.\u5185\u5B58\u5206\u914D\u7B56\u7565\uFF08\u5BF9\u8C61\u63D0\u5347\u3010Promotion\u3011\u89C4\u5219\uFF09</h2><p>\u200B \u5982\u679C\u5BF9\u8C61\u5728 Eden \u51FA\u751F\u5E76\u7ECF\u8FC7\u7B2C\u4E00\u6B21 Miinor GC \u540E\u4ECD\u7136\u5B58\u6D3B\uFF0C\u5E76\u4E14\u80FD\u88AB Survivor \u5BB9\u7EB3\u7684\u8BDD\uFF0C\u5C06\u88AB\u79FB\u52A8\u5230 Survivor \u7A7A\u95F4\u4E2D\uFF0C\u5E76\u5C06\u5BF9\u8C61\u5E74\u9F84\u8BBE\u4E3A1\u3002\u5BF9\u8C61 Survivor\u533A\u4E2D\u6BCF\u71AC\u8FC7\u4E00\u6B21 MInorGC,\u5E74\u9F84\u5C31\u589E\u52A01\u5C81\uFF0C\u5F53\u5B83\u7684\u5E74\u9F84\u589E\u52A0\u5230\u4E00\u5B9A\u7A0B\u5EA6(<strong>\u9ED8\u8BA4\u4E3A15\u5C81</strong>\uFF0C\u5176\u5B9E\u6BCF\u4E2AJVM\u3001\u6BCF\u4E2AGC\u90FD\u6709\u6240\u4E0D\u540C)\u65F6\uFF0C\u5C31\u4F1A\u88AB\u664B\u5347\u5230\u8001\u5E74\u4EE3\u4E2D\u3002\u5BF9\u8C61\u664B\u5347\u8001\u5E74\u4EE3\u7684\u5E74\u9F84\u9608\u503C\uFF0C\u53EF\u4EE5\u901A\u8FC7\u9009\u9879**-XX: MaxTenuringThreshold**\u6765\u8BBE\u7F6E\u3002</p><p>\u9488\u5BF9\u4E0D\u540C\u5E74\u9F84\u6BB5\u7684\u5BF9\u8C61\u5206\u914D\u539F\u5219\u5982\u4E0B\u6240\u793A\uFF1A \u4F18\u5148\u5206\u914D\u5230Eden\u3002 \u5927\u5BF9\u8C61\u76F4\u63A5\u5206\u914D\u5230\u8001\u5E74\u4EE3\u3002 \u5C3D\u91CF\u907F\u5154\u7A0B\u5E8F\u4E2D\u51FA\u73B0\u8FC7\u591A\u7684\u5927\u5BF9\u8C61\u3002 \u957F\u671F\u5B58\u6D3B\u7684\u5BF9\u8C61\u5206\u914D\u5230\u8001\u5E74\u4EE3\u3002 \u52A8\u6001\u5BF9\u8C61\u5E74\u9F84\u5224\u65AD \u5982\u679C Survivor\u533A\u4E2D\u76F8\u540C\u5E74\u9F84\u7684\u6240\u6709\u5BF9\u8C61\u5927\u5C0F\u7684\u603B\u548C\u5927\u4E8E Survivor\u7A7A\u95F4\u7684\u4E00\u534A\uFF0C\u5E74\u9F84\u5927\u4E8E\u6216\u7B49\u4E8E\u8BE5\u5E74\u9F84\u7684\u5BF9\u8C61\u53EF\u4EE5\u76F4\u63A5\u8FDB\u5165\u8001\u5E74\u4EE3\uFF0C\u65E0\u987B\u7B49\u5230 MaxTenuringThreshold\u4E2D\u8981\u6C42\u7684\u5E74\u9F84 \u7A7A\u95F4\u5206\u914D\u62C5\u4FDD\uFF1A -XX: HandlePromotionFailure</p><h2 id="_11-\u5BF9\u8C61\u5206\u914D\u8FC7\u7A0B-tlab" tabindex="-1"><a class="header-anchor" href="#_11-\u5BF9\u8C61\u5206\u914D\u8FC7\u7A0B-tlab" aria-hidden="true">#</a> 11.\u5BF9\u8C61\u5206\u914D\u8FC7\u7A0B\uFF1ATLAB</h2><h3 id="_1-\u4E3A\u4EC0\u4E48\u6709tlab-thread-local-allocation-buffer" tabindex="-1"><a class="header-anchor" href="#_1-\u4E3A\u4EC0\u4E48\u6709tlab-thread-local-allocation-buffer" aria-hidden="true">#</a> 1.\u4E3A\u4EC0\u4E48\u6709TLAB( Thread Local Allocation Buffer)?</h3><p>\u{1F3A7} \u5806\u533A\u662F\u7EBF\u7A0B\u5171\u4EAB\u533A\u57DF\uFF0C\u4EFB\u4F55\u7EBF\u7A0B\u90FD\u53EF\u4EE5\u8BBF\u95EE\u5230\u5806\u533A\u4E2D\u7684\u5171\u4EAB\u6570\u636E \u{1F3A7} \u7531\u4E8E\u5BF9\u8C61\u5B9E\u4F8B\u7684\u521B\u5EFA\u5728JVM\u4E2D\u975E\u5E38\u9891\u7E41\uFF0C\u56E0\u6B64\u5728\u5E76\u53D1\u73AF\u5883\u4E0B\u4ECE\u5806\u533A\u4E2D\u5212\u5206\u5185\u5B58\u7A7A\u95F4\u662F\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684 \u{1F3A7} \u4E3A\u907F\u514D\u591A\u4E2A\u7EBF\u7A0B\u64CD\u4F5C\u540C\u4E00\u5730\u5740\uFF0C\u9700\u8981\u4F7F\u7528\u52A0\u9501\u7B49\u673A\u5236\uFF0C\u8FDB\u800C\u5F71\u54CD\u5206\u914D\u901F\u5EA6\u3002</p><img src="http://qnimg.gisfsde.com/work/\u7B2C08\u7AE0_TLAB.jpg" alt="\u7B2C08\u7AE0_TLAB" style="zoom:50%;"><h3 id="_2-\u4EC0\u4E48\u662Ftlab" tabindex="-1"><a class="header-anchor" href="#_2-\u4EC0\u4E48\u662Ftlab" aria-hidden="true">#</a> 2.\u4EC0\u4E48\u662FTLAB?</h3><p>\u{1F41C} \u4ECE\u5185\u5B58\u6A21\u578B\u800C\u4E0D\u662F\u5783\u573E\u6536\u96C6\u7684\u89D2\u5EA6\uFF0C\u5BF9Eden\u533A\u57DF\u7EE7\u7EED\u8FDB\u884C\u5212\u5206\uFF0CJVM\u4E3A\u6BCF\u4E2A\u7EBF\u7A0B\u5206\u914D\u4E86\u4E00\u4E2A\u79C1\u6709\u7F13\u5B58\u533A\u57DF\uFF0C\u5B83\u5305\u542B\u5728Eden\u7A7A\u95F4\u5185 \u{1F41C} \u591A\u7EBF\u7A0B\u540C\u65F6\u5206\u914D\u5185\u5B58\u65F6\uFF0C\u4F7F\u7528TLAB\u53EF\u4EE5\u907F\u514D\u4E00\u7CFB\u5217\u7684\u975E\u7EBF\u7A0B\u5B89\u5168\u95EE\u9898\uFF0C\u540C\u65F6\u8FD8\u80FD\u591F\u63D0\u5347\u5185\u5B58\u5206\u914D\u7684\u541E\u5410\u91CF\uFF0C\u56E0\u6B64\u6211\u4EEC\u53EF\u4EE5\u5C06\u8FD9\u79CD\u5185\u5B58\u5206\u914D\u65B9\u5F0F\u79F0\u4E4B\u4E3A\u5FEB\u901F\u5206\u914D\u7B56\u7565\u3002 \u{1F41C} \u636E\u6211\u6240\u77E5\u6240\u6709 OPENJDK\u884C\u751F\u51FA\u6765\u7684JVM\u90FD\u63D0\u4F9B\u4E86TLAB\u7684\u8BBE\u8BA1 \u{1F41C} \u5C3D\u7BA1\u4E0D\u662F\u6240\u6709\u7684\u5BF9\u8C61\u5B9E\u4F8B\u90FD\u80FD\u591F\u5728TLAB\u4E2D\u6210\u529F\u5206\u914D\u5185\u5B58\uFF0C\u4F46JVM\u786E\u5B9E\u662F\u5C06TLAB\u4F5C\u4E3A\u5185\u5B58\u5206\u914D\u7684\u9996\u9009\u3002 \u{1F41C} \u5728\u7A0B\u5E8F\u4E2D\uFF0C\u5F00\u53D1\u4EBA\u5458\u53EF\u4EE5\u901A\u8FC7\u9009\u9879\u201C-XX: USETLAB\u201D\u8BBE\u7F6E\u662F\u5426\u5F00\u542FTLAB\u7A7A\u95F4\u3002 \u{1F41C} \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CTLAB\u7A7A\u95F4\u7684\u5185\u5B58\u975E\u5E38\u5C0F\uFF0C\u4EC5\u5360\u6709\u6574\u4E2AEden\u7A7A\u95F4\u76841%,\u5F53\u7136\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u9009\u9879\u201C-XX: TLABWasteTargetPercent\u201D\u8BBE\u7F6ETLAB\u7A7A\u95F4\u6240\u5360\u7528Eden\u7A7A\u95F4\u7684\u767E\u5206\u6BD4\u5927\u5C0F\u3002 \u{1F41C} \u4E00\u65E6\u5BF9\u8C61\u5728AB\u7A7A\u95F4\u5206\u914D\u5185\u5B58\u5931\u8D25\u65F6\uFF0CJVM\u5C31\u4F1A\u5C1D\u8BD5\u7740\u901A\u8FC7\u4F7F\u7528\u52A0\u9501\u673A\u5236\u786E\u4FDD\u6570\u636E\u64CD\u4F5C\u7684\u539F\u5B50\u6027\uFF0C\u4ECE\u800C\u76F4\u63A5\u5728Eden\u7A7A\u95F4\u4E2D\u5206\u914D\u5185\u5B58\u3002</p><img src="http://qnimg.gisfsde.com/work/\u7B2C08\u7AE0_\u5BF9\u8C61\u5206\u914D\u8FC7\u7A0B.jpg" alt="\u7B2C08\u7AE0_\u5BF9\u8C61\u5206\u914D\u8FC7\u7A0B" style="zoom:50%;"><h2 id="_12-\u5806\u7A7A\u95F4\u5E38\u89C1\u53C2\u6570" tabindex="-1"><a class="header-anchor" href="#_12-\u5806\u7A7A\u95F4\u5E38\u89C1\u53C2\u6570" aria-hidden="true">#</a> 12.\u5806\u7A7A\u95F4\u5E38\u89C1\u53C2\u6570</h2><p>-XX: +PrintFlagsInitial:\u67E5\u770B\u6240\u6709\u7684\u53C2\u6570\u7684\u9ED8\u8BA4\u521D\u59CB\u503C -XX: +PrintFlagsFinal:\u67E5\u770B\u6240\u6709\u7684\u53C2\u6570\u7684\u6700\u7EC8\u503C\uFF08\u53EF\u80FD\u4F1A\u5B58\u5728\u4FEE\u6539\uFF0C\u4E0D\u518D\u662F\u521D\u59CB\u503C) -Xms:\u521D\u59CB\u96C4\u7A7A\u5411\u5185\u5B58(\u9ED8\u8BA4\u4E3A\u7269\u7406\u5185\u5B58\u76841/64) -Xmx:\u6700\u5927\u96C4\u7A7A\u95F4\u5185\u5B58(\u9ED8\u8BA4\u4E3A\u7269\u7406\u5185\u5B58\u76841/4) -Xmn:\u8BBE\u7F6E\u65B0\u751F\u4EE3\u7684\u5927\u5C0F\u3002\uFF08\u521D\u59CB\u503C\u53CA\u6700\u5927\u503C\uFF09 -XX: NewRatio:\u914D\u7F6E\u65B0\u751F\u4EE3\u4E0E\u8001\u5E74\u4EE3\u5728\u5806\u7ED3\u6784\u7684\u5360\u6BD4 -XX: SurvivorRatio:\u8BBE\u7F6E\u65B0\u751F\u4EE3\u4E2DEden\u548CS0/S1\u7A7A\u95F4\u6BD4\u4F8B -XX: MaxTenuringThreshold:\u8BBE\u7F6E\u65B0\u751F\u4EE3\u5783\u6271\u7684\u6700\u5927\u5E74\u9F84 -XX: +PrintGCdetails:\u8F93\u51FA\u8BE6\u7EC6GC\u5904\u7406\u65E5\u5FD7 \u6253\u5370\u7B52\u8981\u4FE1\u606F\uFF1A\u{1F31E} -XX: +PrintGC \u{1F31E} - verbose:GC -XX: HandlePromotionFailure:\u662F\u5426\u8BBE\u7F6E\u7A7A\u95EE\u5206\u914D\u62C5\u4FDD</p><p><strong>\u662F\u5426\u8BBE\u7F6E\u7A7A\u95EE\u5206\u914D\u62C5\u4FDD\uFF1F\uFF1A</strong></p><p>\u5728\u53D1\u751F Minor GC\u4E4B\u524D\uFF0C\u865A\u62DF\u673A\u4F1A\u68C0\u67E5\u8001\u5E74\u4EE3\u6700\u5927\u53EF\u7528\u7684\u8FDE\u7EED\u7A7A\u95F4\u662F\u5426\u5927\u4E8E\u65B0\u751F\u4EE3\u6240\u6709\u5BF9\u8C61\u7684\u603B\u7A7A\u95F4\u3002 \u5982\u679C\u5927\u4E8E\uFF0C\u5219\u6B64\u6B21 Minor GC\u662F\u5B89\u5168\u7684 \u5982\u679C\u5C0F\u4E8E\uFF0C\u5219\u865A\u62DF\u673A\u4F1A\u67E5\u770B\u30FCXX: HandlePromotionFailure\u8BBE\u7F6E\u503C\u662F\u5426\u5141\u8BB8\u62C5\u4FDD\u5931\u8D25\u3002 \u5982\u679C HandlepromotionFailure=true,\u90A3\u4E48\u4F1A\u7EE7\u7EED\u68C0\u67E5\u8001\u5E74\u4EE3\u6700\u5927\u53EF\u7528\u8FDE\u7EED\u7A7A\u95F4\u662F\u5426\u5927\u4E8E\u5386\u6B21\u664B\u5347\u5230\u8001\u5E74\u4EE3\u7684\u5BF9\u8C61\u7684\u5E73\u5747\u5927\u5C0F\u3002 \u5982\u679C\u5927\u4E8E\uFF0C\u5219\u5C1D\u8BD5\u8FDB\u884C\u4E00\u6B21 Minor GC,\u4F46\u8FD9\u6B21 Minor GC\u4F9D\u7136\u662F\u6709\u98CE\u9669\u7684\u3002 \u5982\u679C\u5C0F\u4E8E\uFF0C\u5219\u6539\u4E3A\u8FDB\u884C\u4E00\u6B21Full GC\u3002 \u5982\u679C HandlePromotionFalure= false,\u5219\u6539\u4E3A\u8FDB\u884C\u4E00\u6B21Full GC\u3002 \u5728JDK6 Update24\u4E4B\u540E\uFF0C HandlePromotionFailure \u53C2\u6570\u4E0D\u4F1A\u518D\u5F71\u54CD\u5230\u865A\u62DF\u673A\u7684\u7A7A\u95F4\u5206\u914D\u62C5\u4FDD\u7B56\u7565\uFF0C\u89C2\u5BDF OpenJDK\u4E2D\u7684\u6E90\u7801\u53D8\u5316\uFF0C\u867D\u7136\u6E90\u7801\u4E2D\u8FD8\u5B9A\u4E49\u4E86HandlePromotionFailure \u53C2\u6570\uFF0C\u4F46\u662F\u5728\u4EE3\u7801\u4E2D\u5DF2\u7ECF\u4E0D\u4F1A\u518D\u4F7F\u7528\u5B83\u3002JDK6 Update24\u4E4B\u540E\u7684\u89C4\u5219\u53D8\u4E3A \u53EA\u8981\u8001\u5E74\u4EE3\u7684\u8FDE\u7EED\u7A7A\u95F4\u5927\u4E8E\u65B0\u751F\u4EE3\u5BF9\u8C61\u603B\u5927\u5C0F\u6216\u8005\u5386\u6B21\u664B\u5347\u7684\u5E73\u5747\u5927\u5C0F \u5C31\u4F1A\u8FDB\u884C Minor GC,\u5426\u5219\u5C06\u8FDB\u884CFull GC\u3002</p><h2 id="_13-\u901A\u8FC7\u9003\u9038\u5206\u6790\u770B\u5806\u7A7A\u95F4\u7684\u5BF9\u8C61\u5206\u914D" tabindex="-1"><a class="header-anchor" href="#_13-\u901A\u8FC7\u9003\u9038\u5206\u6790\u770B\u5806\u7A7A\u95F4\u7684\u5BF9\u8C61\u5206\u914D" aria-hidden="true">#</a> 13.\u901A\u8FC7\u9003\u9038\u5206\u6790\u770B\u5806\u7A7A\u95F4\u7684\u5BF9\u8C61\u5206\u914D</h2><p><strong>\u5806\u662F\u5206\u914D\u5BF9\u8C61\u5B58\u50A8\u7684\u552F\u4E00\u9009\u62E9\u5417\uFF1F</strong></p><p>\u200B \u5728\u300A\u6DF1\u5165\u7406\u89E3Java\u865A\u62DF\u673A\u300B\u4E2D\u5173\u4E8EJava\u5806\u5185\u5B58\u6709\u8FD9\u6837\u4E00\u6BB5\u63CF\u8FF0\uFF1A\u968F\u7740JIT\u7F16\u8BD1\u671F\u7684\u53D1\u5C55\u4E0E\u9003\u9038\u5206\u6790\u6280\u672F\u9010\u6E10\u6210\u719F\uFF0C\u6808\u4E0A\u5206\u914D\u3001\u6807\u91CF\u66FF\u6362\u4F18\u5316\u6280\u672F\u5C06\u4F1A\u5BFC\u81F4\u4E00\u4E9B\u5FAE\u5999\u7684\u53D8\u5316\uFF0C\u6240\u6709\u7684\u5BF9\u8C61\u90FD\u5206\u914D\u5230\u5806\u4E0A\u4E5F\u6E10\u6E10\u53D8\u5F97\u4E0D\u90A3\u4E48\u201C\u7EDD\u5BF9\u201D\u4E86\u3002\u5728Java\u865A\u62DF\u673A\u4E2D\uFF0C\u5BF9\u8C61\u662F\u5728Java\u5806\u4E2D\u5206\u914D\u5185\u5B58\u7684\uFF0C\u8FD9\u662F\u4E00\u4E2A\u666E\u904D\u7684\u5E38\u8BC6\u3002\u4F46\u662F\uFF0C\u6709\u79CD\u7279\u6B8A\u60C5\u51B5\uFF0C\u90A3\u5C31\u662F\u5982\u679C\u7ECF\u8FC7\u9003\u9038\u5206\u6790( Escape Analysis)\u540E\u53D1\u73B0\uFF0C\u4E00\u4E2A\u5BF9\u8C61\u5E76\u6CA1\u6709\u9003\u9038\u51FA\u65B9\u6CD5**\u3010NEW\u7684\u5BF9\u8C61\u662F\u5426\u6709\u53EF\u80FD\u5728\u65B9\u6CD5\u5916\u88AB\u8C03\u7528\uFF0C\u8C03\u7528\u5219\u53D1\u751F\u9003\u9038\u3011**\u7684\u8BDD\uFF0C\u90A3\u4E48\u5C31\u53EF\u80FD\u88AB\u4F18\u5316\u6210\u6808\u4E0A\u5206\u914D\u3002\u8FD9\u6837\u5C31\u65E0\u9700\u5728\u5806\u4E0A\u5206\u914D\u5185\u5B58\uFF0C\u4E5F\u65E0\u987B\u8FDB\u884C\u5783\u573E\u56DE\u6536\u4E86\u3002\u8FD9\u4E5F\u662F\u6700\u5E38\u89C1\u7684\u5806\u5916\u5B58\u50A8\u6280\u672F\u3002 \u200B \u6B64\u5916\uFF0C\u524D\u9762\u63D0\u5230\u7684\u57FA\u4E8E OPENJDK\u6DF1\u5EA6\u5B9A\u5236\u7684 TaoBaoVM,\u5176\u4E2D\u521B\u65B0\u7684GCIH(GCinvisible heap)\u6280\u672F\u5B9E\u73B0\u3002off-heap,\u5C06\u751F\u547D\u5468\u671F\u8F83\u957F\u7684Java\u5BF9\u8C61\u4ECEheap\u4E2D\u79FB\u81F3heap\u5916\uFF0C\u5E76\u4E14GC\u4E0D\u80FD\u7BA1\u7406GCIH\u5185\u90E8\u7684Java\u5BF9\u8C61\uFF0C\u4EE5\u6B64\u8FBE\u5230\u964D\u4F4EGC\u7684\u56DE\u6536\u9891\u7387\u548C\u63D0\u5347GC\u7684\u56DE\u6536\u6548\u7387\u7684\u76EE\u7684\u3002</p><p>[\u5806<strong>\u4E0D\u662F</strong>\u5206\u914D\u5BF9\u8C61\u5B58\u50A8\u7684\u552F\u4E00\u9009\u62E9\u5417](# 4.\u5806<strong>\u4E0D\u662F</strong>\u5206\u914D\u5BF9\u8C61\u5B58\u50A8\u7684\u552F\u4E00\u9009\u62E9\u5417)</p><p><strong>\u5982\u4F55\u5C06\u5806\u4E0A\u7684\u5BF9\u8C61\u5206\u914D\u5230\u6808\uFF0C\u9700\u8981\u4F7F\u7528\u9003\u9038\u5206\u6790\u624B\u6BB5\u3002</strong> \u8FD9\u662F\u4E00\u79CD\u53EF\u4EE5\u6709\u6548\u51CF\u5C11Java\u7A0B\u5E8F\u4E2D\u540C\u6B65\u8D1F\u8F7D\u548C\u5185\u5B58\u5806\u5206\u914D\u538B\u529B\u7684\u8DE8\u51FD\u6570\u5168\u5C40\u6570\u636E\u6D41\u5206\u6790\u7B97\u6CD5\u3002\u901A\u8FC7\u9003\u9038\u5206\u6790\uFF0C Java Hotspot\u7F16\u8BD1\u5668\u80FD\u591F\u5206\u6790\u51FA\u4E00\u4E2A\u65B0\u7684\u5BF9\u8C61\u7684\u5F15\u7528\u7684\u4F7F\u7528\u8303\u56F4\u4ECE\u800C\u51B3\u5B9A\u662F\u5426\u8981\u5C06\u8FD9\u4E2A\u5BF9\u8C61\u5206\u914D\u5230\u5806\u4E0A\u3002</p><p>\u9003\u9038\u5206\u6790\u7684\u57FA\u672C\u884C\u4E3A\u5C31\u662F\u5206\u6790\u5BF9\u8C61\u52A8\u6001\u4F5C\u7528\u57DF\uFF1A \u5F53\u4E00\u4E2A\u5BF9\u8C61\u5728\u65B9\u6CD5\u4E2D\u88AB\u5B9A\u4E49\u540E\uFF0C\u5BF9\u8C61\u53EA\u5728\u65B9\u6CD5\u5185\u90E8\u4F7F\u7528\uFF0C\u5219\u8BA4\u4E3A\u6CA1\u6709\u53D1\u751F\u9003\u9038\u3002 \u5F53\u4E00\u4E2A\u5BF9\u8C61\u5728\u65B9\u6CD5\u4E2D\u88AB\u5B9A\u4E49\u540E\uFF0C\u5B83\u88AB\u5916\u90E8\u65B9\u6CD5\u6240\u5F15\u7528\uFF0C\u5219\u8BA4\u4E3A\u53D1\u751F\u9003\u9038\u3002\u4F8B\u5982\u4F5C\u4E3A\u8C03\u7528\u53C2\u6570\u4F20\u9012\u5230\u5176\u4ED6\u5730\u65B9\u4E2D\u3002</p><p>\u53C2\u6570\u8BBE\u7F6E\uFF1A \u30FB\u5728JDK6u23\u7248\u672C\u4E4B\u540E\uFF0C HotSpot\u4E2D\u9ED8\u8BA4\u5C31\u5DF2\u7ECF\u5F00\u542F\u4E86\u9003\u9038\u5206\u6790\u3002\u5982\u679C\u4F7F\u7528\u7684\u662F\u8F83\u65E9\u7684\u7248\u672C\uFF0C\u5F00\u53D1\u4EBA\u5458\u5219\u53EF\u4EE5\u901A\u8FC7 \u9009\u9879\u201C-XX: Doescapeanalysis&quot;\u663E\u5F0F\u5F00\u542F\u9003\u9038\u5206\u6790 \u901A\u8FC7\u9009\u9879\u201C-X: Printescapeanalysis&quot;\u67E5\u770B\u9003\u9038\u5206\u6790\u7684\u7B5B\u9009\u7ED3\u679C</p><blockquote><p><strong>\u7ED3\u8BBA\uFF1A</strong> \u5F00\u53D1\u4E2D\u80FD\u4F7F\u7528\u5C40\u90E8\u53D8\u91CF\u7684\uFF0C\u5C31\u4E0D\u8981\u4F7F\u7528\u5728\u65B9\u6CD5\u5916\u5B9A\u4E49\u3002</p></blockquote><h2 id="_14-\u9003\u9038\u5206\u6790-\u4EE3\u7801\u4F18\u5316" tabindex="-1"><a class="header-anchor" href="#_14-\u9003\u9038\u5206\u6790-\u4EE3\u7801\u4F18\u5316" aria-hidden="true">#</a> 14.\u9003\u9038\u5206\u6790\uFF1A\u4EE3\u7801\u4F18\u5316</h2><p>\u200B \u4F7F\u7528\u9003\u9038\u5206\u6790\uFF0C\u7F16\u8BD1\u5668\u53EF\u4EE5\u5BF9\u4EE3\u7801\u505A\u5982\u4E0B\u4F18\u5316\uFF1A \u4E00\u3001<strong>\u6808\u4E0A\u5206\u914D</strong>\u3002\u5C06\u5806\u5206\u914D\u8F6C\u5316\u4E3A\u6808\u5206\u914D\u3002\u5982\u679C\u4E00\u4E2A\u5BF9\u8C61\u5728\u5B50\u7A0B\u5E8F\u4E2D\u88AB\u5206\u914D\uFF0C\u8981\u4F7F\u6307\u5411\u8BE5\u5BF9\u8C61\u7684\u6307\u9488\u6C38\u8FDC\u4E0D\u4F1A\u9003\u9038\uFF0C\u5BF9\u8C61\u53EF\u80FD\u662F\u6808\u5206\u914D\u7684\u5019\u9009\uFF0C\u800C\u4E0D\u662F\u5806\u5206\u914D\u3002 \u4E8C\u3001<strong>\u540C\u6B65\u7701\u7565</strong>\u3002\u5982\u679C\u4E00\u4E2A\u5BF9\u8C61\u88AB\u53D1\u73B0\u53EA\u80FD\u4ECE\u4E00\u4E2A\u7EBF\u7A0B\u88AB\u8BBF\u95EE\u5230\uFF0C\u90A3\u4E48\u5BF9\u4E8E\u8FD9\u4E2A\u5BF9\u8C61\u7684\u64CD\u4F5C\u53EF\u4EE5\u4E0D\u8003\u8651\u540C\u6B65\u3002 \u4E09\u3001<strong>\u5206\u79BB\u5BF9\u8C61\u6216\u6807\u91CF\u66FF\u6362</strong>\u3002\u6709\u7684\u5BF9\u8C61\u53EF\u80FD\u4E0D\u9700\u8981\u4F5C\u4E3A\u4E00\u4E2A\u8FDE\u7EED\u7684\u5185\u5B58\u7ED3\u6784\u5B58\u5728\u4E5F\u53EF\u4EE5\u88AB\u8BBF\u95EE\u5230\uFF0C\u90A3\u4E48\u5BF9\u8C61\u7684\u90E8\u5206\uFF08\u6216\u5168\u90E8\uFF09\u53EF\u4EE5\u4E0D\u5B58\u50A8\u5728\u5185\u5B58\uFF0C\u800C\u662F\u5B58\u50A8\u5728CPU\u5BC4\u5B58\u5668\u4E2D\u3002</p><h3 id="_1-\u6808\u4E0A\u5206\u914D" tabindex="-1"><a class="header-anchor" href="#_1-\u6808\u4E0A\u5206\u914D" aria-hidden="true">#</a> 1.\u6808\u4E0A\u5206\u914D</h3><p>\u5B9E\u9A8C\uFF1A</p><p>1.-Xmx1G -Xms1G -XX:-DoEscapeAnalysis -XX:+PrintGCDetails</p><p>2.-Xmx1G -Xms1G -XX:+DoEscapeAnalysis -XX:+PrintGCDetails</p><p>3.-Xmx256m -Xms256m -XX:-DoEscapeAnalysis -XX:+PrintGCDetails</p><p>4.-Xmx256m -Xms256m -XX:+DoEscapeAnalysis -XX:+PrintGCDetails</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6808\u4E0A\u5206\u914D\u6D4B\u8BD5
 * -Xmx1G -Xms1G -XX:-DoEscapeAnalysis -XX:+PrintGCDetails
 * <span class="token keyword">@author</span> shkstart  shkstart@126.com
 * <span class="token keyword">@create</span> 2020  10:31
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackAllocation</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i \\<span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// \u67E5\u770B\u6267\u884C\u65F6\u95F4</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u82B1\u8D39\u7684\u65F6\u95F4\u4E3A\uFF1A &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u4E3A\u4E86\u65B9\u4FBF\u67E5\u770B\u5806\u5185\u5B58\u4E2D\u5BF9\u8C61\u4E2A\u6570\uFF0C\u7EBF\u7A0Bsleep</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u672A\u53D1\u751F\u9003\u9038</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-\u540C\u6B65\u7701\u7565-\u9501\u6D88\u9664" tabindex="-1"><a class="header-anchor" href="#_2-\u540C\u6B65\u7701\u7565-\u9501\u6D88\u9664" aria-hidden="true">#</a> 2.\u540C\u6B65\u7701\u7565\uFF08\u9501\u6D88\u9664\uFF09</h3><p>\u200B <strong>\u7EBF\u7A0B\u540C\u6B65\u7684\u4EE3\u4EF7\u662F\u76F8\u5F53\u9AD8\u7684\uFF0C\u540C\u6B65\u7684\u540E\u679C\u662F\u964D\u4F4E\u5E76\u53D1\u6027\u548C\u6027\u80FD\u3002</strong> \u200B \u5728\u52A8\u6001\u7F16\u8BD1\u540C\u6B65\u5757\u7684\u65F6\u5019\uFF0CJIT\u7F16\u8BD1\u5668\u53EF\u4EE5\u501F\u52A9\u9003\u9038\u5206\u6790\u6765<strong>\u5224\u65AD\u540C\u6B65\u5757\u6240\u4F7F\u7528\u7684\u9501\u5BF9\u8C61\u662F\u5426\u53EA\u80FD\u591F\u88AB\u4E00\u4E2A\u7EBF\u7A0B\u8BBF\u95EE\u800C\u6CA1\u6709\u88AB\u53D1\u5E03\u5230\u5176\u4ED6\u7EBF\u7A0B</strong>\u3002\u5982\u679C\u6CA1\u6709\uFF0C\u90A3\u4E48JIT\u7F16\u8BD1\u5668\u5728\u7F16\u8BD1\u8FD9\u4E2A\u540C\u6B65\u5757\u7684\u65F6\u5019\u5C31\u4F1A\u53D6\u6D88\u5BF9\u8FD9\u90E8\u5206\u4EE3\u7801\u7684\u540C\u6B65\u3002\u8FD9\u6837\u5C31\u80FD\u5927\u5927\u63D0\u9AD8\u5E76\u53D1\u6027\u548C\u6027\u80FD\u3002\u8FD9\u4E2A\u53D6\u6D88\u540C\u6B65\u7684\u8FC7\u7A0B\u5C31\u53EB\u540C\u6B65\u7701\u7565\uFF0C\u4E5F\u53EB\u9501\u6D88\u9664\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211130134841650.png" alt="image-20211130134841650" style="zoom:67%;"><h3 id="_3-\u5206\u79BB\u5BF9\u8C61\u6216\u6807\u91CF\u66FF\u6362" tabindex="-1"><a class="header-anchor" href="#_3-\u5206\u79BB\u5BF9\u8C61\u6216\u6807\u91CF\u66FF\u6362" aria-hidden="true">#</a> 3.\u5206\u79BB\u5BF9\u8C61\u6216\u6807\u91CF\u66FF\u6362</h3><p>\u200B \u6807\u91CF(Scalar)\u662F\u6307\u4E00\u4E2A\u65E0\u6CD5\u518D\u5206\u89E3\u6210\u66F4\u5C0F\u7684\u6570\u636E\u7684\u6570\u636E\u3002Java\u4E2D\u7684<strong>\u539F\u59CB\u6570\u636E\u7C7B\u578B</strong>\u5C31\u662F<strong>\u6807\u91CF</strong>\u3002\u76F8\u5BF9\u7684\uFF0C\u90A3\u4E9B<strong>\u8FD8\u53EF\u4EE5\u5206\u89E3</strong>\u7684\u6570\u636E\u53EB\u505A<strong>\u805A\u5408\u91CF( Aggregate)</strong>,Java\u4E2D\u7684<strong>\u5BF9\u8C61\u5C31\u662F\u805A\u5408\u91CF</strong>\uFF0C\u56E0\u4E3A\u4ED6\u53EF\u4EE5\u5206\u89E3\u6210\u5176\u4ED6\u805A\u5408\u6688\u548C\u6807\u91CF \u200B \u5728JIT\u9636\u6BB5\uFF0C\u5982\u679C\u7ECF\u8FC7\u9003\u9038\u5206\u6790\uFF0C\u53D1\u73B0\u4E00\u4E2A\u5BF9\u8C61\u4E0D\u4F1A\u88AB\u5916\u754C\u8BBF\u95EE\u7684\u8BDD\uFF0C\u90A3\u4E48\u7ECF\u8FC7JIT\u4F18\u5316\uFF0C\u5C31\u4F1A\u628A\u8FD9\u4E2A\u5BF9\u8C61\u62C6\u89E3\u6210\u82E5\u5E72\u4E2A\u5176\u4E2D\u5305\u542B\u7684\u82E5\u5E72\u4E2A\u6210\u5458\u53D8\u91CF\u6765\u4EE3\u66FF\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u5C31\u662F<strong>\u6807\u91CF\u66FF\u6362\u3002</strong></p><p><strong>\u6807\u91CF\u66FF\u6362\u53C2\u6570\u8BBE\u7F6E\uFF1A</strong> \u53C2\u6570-XX:+EliminateAllocations:\u5F00\u542F\u6807\u91CF\u66FF\u63DB\uFF08\u9ED8\u8BA4\u6253\u5F00\uFF09\uFF0C\u5141\u8BB8\u5C06\u5BF9\u8C61\u6253\u6563\u5206\u914D\u5728\u6808\u4E0A\u3002</p><h3 id="_4-\u5806\u4E0D\u662F\u5206\u914D\u5BF9\u8C61\u5B58\u50A8\u7684\u552F\u4E00\u9009\u62E9\u5417" tabindex="-1"><a class="header-anchor" href="#_4-\u5806\u4E0D\u662F\u5206\u914D\u5BF9\u8C61\u5B58\u50A8\u7684\u552F\u4E00\u9009\u62E9\u5417" aria-hidden="true">#</a> 4.\u5806<strong>\u4E0D\u662F</strong>\u5206\u914D\u5BF9\u8C61\u5B58\u50A8\u7684\u552F\u4E00\u9009\u62E9\u5417\uFF1F</h3><p>\u4E0A\u8FF0\u4EE3\u7801\u5728\u4E3B\u51FD\u6570\u4E2D\u8FDB\u884C\u4E861\u4EBF\u6B21alloc\u3002\u8C03\u7528\u8FDB\u884C\u5BF9\u8C61\u521B\u5EFA\uFF0C\u7531\u4E8EUser\u5BF9\u8C61\u5B9E\u4F8B\u9700\u8981\u5360\u636E\u7EA616\u5B57\u8282\u7684\u7A7A\u95F4\uFF0C\u56E0\u6B64\u7D2F\u8BA1\u5206\u914D\u7A7A\u95F4\u8FBE\u5230\u5C06\u8FD11.5GB\u3002\u5982\u679C\u5806\u7A7A\u95F4\u5C0F\u4E8E\u8FD9\u4E2A\u503C\uFF0C\u5C31\u5FC5\u7136\u4F1A\u53D1\u751FGC\u3002\u4F7F\u7528\u5982\u4E0B\u53C2\u6570\u8FD0\u884C\u4E0A\u8FF0\u4EE3\u7801 -server -Xmx100m -xms100m -xx:+DoEscapeAnalvsis -XX: Print GC -XX:+EliminateAllocations \u8FD9\u91CC\u4F7F\u7528\u53C2\u6570\u5982\u4E0B \u30FB\u53C2\u6570- server:\u542F\u52A8 server\u6A21\u5F0F\uFF0C\u56E0\u4E3A\u5728 Server\u6A21\u5F0F\u4E0B\uFF0C\u30AA\u53EF\u4EE5\u542F\u7528\u9003\u9038\u5206\u6790\u3002 \u30FB\u53C2\u6570-XX: +DoEscapeAnalysis:\u542F\u7528\u9003\u9038\u5206\u6790 \u30FB\u53C2\u6570-Xmx10m:\u6307\u5B9A\u4E86\u5806\u7A7A\u95F4\u6700\u5927\u4E3A10MB \u30FB\u53C2\u6570-XX: Print GC:\u5C06\u6253\u5370GC\u65E5\u5FD7\u3002 \u30FB\u53C2\u6570-XX: EliminateAllocations:\u5F00\u542F\u4E86\u6807\u91CF\u66FF\u6362\uFF08\u9ED8\u8BA4\u6253\u5F00\uFF09\uFF0C\u5141\u8BB8\u5C06\u5BF9\u8C61\u6253\u6563\u5206\u914D\u5728\u6808\u4E0A\uFF0C\u6BD4\u5982\u5BF9\u8C61\u62E5\u6709id\u548Cname\u4E24\u4E2A\u5B57\u6BB5\uFF0C\u90A3\u4E48\u8FD9\u4E24\u4E2A\u5B57\u6BB5\u5C06\u4F1A\u88AB\u89C6\u4E3A\u4E24\u4E2A\u72EC\u7ACB\u7684\u5C40\u90E8\u53D8\u91CF\u8FDB\u884C\u5206\u914D\u3002</p><p>\u200B \u5173\u4E8E\u9003\u9038\u5206\u6790\u7684\u8BBA\u6587\u57281999\u5E74\u5C31\u5DF2\u7ECF\u53D1\u8868\u4E86\uFF0C\u4F46\u76F4\u5230JDK1.6\u30AA\u6709\u5B9E\u73B0\uFF0C\u800C\u4E14\u8FD9\u9879\u6280\u672F\u5230\u5982\u4ECA\u4E5F<strong>\u5E76\u4E0D\u662F\u5341\u5206\u6210\u719F</strong>\u7684\u3002 \u200B \u5176\u6839\u672C\u539F\u56E0\u5C31\u662F\u65E0\u6CD5\u4FDD\u8BC1\u9003\u9038\u5206\u6790\u7684\u6027\u80FD\u6D88\u8017\u4E00\u5B9A\u80FD\u9AD8\u4E8E\u4ED6\u7684\u6D88\u8017\u3002\u867D\u7136\u7ECF\u8FC7\u9003\u9038\u5206\u6790\u53EF\u4EE5\u505A\u6807\u91CF\u66FF\u6362\u3001\u6808\u4E0A\u5206\u914D\u3001\u548C\u9501\u6D88\u9664\u3002\u4F46\u662F\u9003\u9038\u5206\u6790\u81EA\u8EAB\u4E5F\u662F\u9700\u8981\u8FDB\u884C\u4E00\u7CFB\u5217\u590D\u6742\u7684\u5206\u6790\u7684\uFF0C\u8FD9\u5176\u5B9E\u4E5F\u662F\u4E00\u4E2A\u76F8\u5BF9\u8017\u65F6\u7684\u8FC7\u7A0B\u3002 \u200B \u4E00\u4E2A\u6781\u7AEF\u7684\u4F8B\u5B50\uFF0C\u5C31\u662F\u7ECF\u8FC7\u9003\u9038\u5206\u6790\u4E4B\u540E\uFF0C\u53D1\u73B0\u6CA1\u6709\u4E00\u4E2A\u5BF9\u8C61\u662F\u4E0D\u9003\u9038\u7684\u3002\u90A3\u8FD9\u4E2A\u9003\u9038\u5206\u6790\u7684\u8FC7\u7A0B\u5C31\u767D\u767D\u6D6A\u8D39\u6389\u4E86 \u200B \u867D\u7136\u8FD9\u9879\u6280\u672F\u5E76\u4E0D\u5341\u5206\u6210\u719F\uFF0C\u4F46\u662F\u5B83\u4E5F\u662F\u5373\u65F6\u7F16\u8BD1\u5668\u4F18\u5316\u6280\u672F\u4E2D\u4E00\u4E2A\u5341\u5206\u91CD\u8981\u7684\u624B\u6BB5\u3002\u6CE8\u610F\u5230\u6709\u4E00\u4E9B\u89C2\u70B9\uFF0C\u8BA4\u4E3A\u901A\u8FC7\u9003\u9038\u5206\u6790\uFF0CJVM\u4F1A\u5728\u6808\u4E0A\u5206\u914D\u90A3\u4E9B\u4E0D\u4F1A\u9003\u9038\u7684\u5BF9\u8C61\uFF0C\u8FD9\u5728\u7406\u8BBA\u4E0A\u662F\u53EF\u884C\u7684\uFF0C\u4F46\u662F\u53D6\u51B3\u4E8EJVM\u8BBE\u8BA1\u8005\u7684\u9009\u62E9\u3002\u636E\u6211\u6240\u77E5\uFF0C Oracle Hotspot JVM\u4E2D\u5E76\u672A\u8FD9\u4E48\u505A\uFF0C\u8FD9\u4E00\u70B9\u5728\u9003\u9038\u5206\u6790\u76F8\u5173\u7684\u6587\u6863\u91CC\u5DF2\u7ECF\u8BF4\u660E\uFF0C\u6240\u4EE5\u53EF\u4EE5\u660E\u786E\u6240\u6709\u7684\u5BF9\u8C61\u5B9E\u4F8B\u90FD\u662F\u521B\u5EFA\u5728\u5806\u4E0A\u3002 \u200B \u76EE\u524D\u5F88\u591A\u4E66\u7C4D\u8FD8\u662F\u57FA\u4E8EJDK7\u4EE5\u524D\u7684\u7248\u672C\uFF0CJDK\u5DF2\u7ECF\u53D1\u751F\u4E86\u5F88\u5927\u53D8\u5316\uFF0C intern\u5B57\u7B26\u4E32\u7684\u7F13\u5B58\u548C\u9759\u6001\u53D8\u91CF\u66FE\u7ECF\u90FD\u88AB\u5206\u914D\u5728\u6C38\u4E45\u4EE3\u4E0A\uFF0C\u800C\u6C38\u4E45\u4EE3\u5DF2\u7ECF\u88AB\u5143\u6570\u636E\u533A\u53D6\u4EE3\u3002\u4F46\u662F\uFF0Cintern:\u5B57\u7B26\u4E32\u7F13\u5B58\u548C\u9759\u6001\u53D8\u91CF\u5E76\u4E0D\u662F\u88AB\u8F6C\u79FB\u5230\u5143\u6570\u636E\u533A\uFF0C\u800C\u662F\u76F4\u63A5\u5728\u5806\u4E0A\u5206\u914D\uFF0C\u6240\u4EE5\u8FD9\u4E00\u70B9\u540C\u6837\u7B26\u5408\u524D\u9762\u4E00\u70B9\u7684\u7ED3\u8BBA\uFF1A<strong>\u5BF9\u8C61\u5B9E\u4F8B\u90FD\u662F\u5206\u914D\u5728\u5806\u4E0A\u3002</strong></p><h1 id="\u4E5D\u3001\u65B9\u6CD5\u533A" tabindex="-1"><a class="header-anchor" href="#\u4E5D\u3001\u65B9\u6CD5\u533A" aria-hidden="true">#</a> \u4E5D\u3001\u65B9\u6CD5\u533A</h1><h2 id="_1-\u6808\u3001\u5806\u3001\u65B9\u6CD5\u533A\u95F4\u7684\u4EA4\u4E92\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#_1-\u6808\u3001\u5806\u3001\u65B9\u6CD5\u533A\u95F4\u7684\u4EA4\u4E92\u5173\u7CFB" aria-hidden="true">#</a> 1.\u6808\u3001\u5806\u3001\u65B9\u6CD5\u533A\u95F4\u7684\u4EA4\u4E92\u5173\u7CFB</h2><p><img src="http://qnimg.gisfsde.com/work/image-20211130192113431.png" alt="image-20211130192113431" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211130192158749.png" alt="image-20211130192158749" loading="lazy"></p><h2 id="_2-\u65B9\u6CD5\u533A\u57FA\u672C\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#_2-\u65B9\u6CD5\u533A\u57FA\u672C\u7406\u89E3" aria-hidden="true">#</a> 2.\u65B9\u6CD5\u533A\u57FA\u672C\u7406\u89E3</h2><p>\u200B \u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u4E2D\u660E\u786E\u8BF4\u660E\uFF1A&quot;\u5C3D\u7BA1\u6240\u6709\u7684\u65B9\u6CD5\u533A\u5728\u903B\u8F91\u4E0A\u662F\u5C5E\u4E8E\u5806\u7684\u4E00\u90E8\u5206\uFF0C\u4F46\u4E9B\u7B80\u5355\u7684\u5B9E\u73B0\u53EF\u80FD\u4E0D\u4F1A\u9009\u62E9\u53BB\u8FDB\u884C\u5783\u573E\u6536\u96C6\u6216\u8005\u8FDB\u884C\u538B\u7F29\u3002\u201D\u4F46\u5BF9\u4E8E HotSpotJVM\u800C\u8A00\uFF0C\u65B9\u6CD5\u533A\u8FD8\u6709\u4E00\u4E2A\u522B\u540D\u53EB\u505A<strong>Non-Heap\uFF08\u975E\u5806\uFF09\uFF0C\u76EE\u7684\u5C31\u662F\u8981\u548C\u5806\u5206\u5F00\u3002\u6240\u4EE5\uFF0C\u65B9\u6CD5\u533A\u770B\u4F5C\u662F\u4E00\u5757\u72EC\u7ACB\u4E8EJava\u5806\u7684\u5185\u5B58\u7A7A\u95F4\u3002</strong></p><p>\u30FB\u65B9\u6CD5\u533A( Method Area)\u4E0EJAVA\u5806\u4E00\u6837\uFF0C\u662F\u5404\u4E2A<strong>\u7EBF\u7A0B\u5171\u4EAB</strong>\u7684\u5185\u5B58\u533A\u57DF\u3002 \u30FB\u65B9\u6CD5\u533A\u5728JVM\u542F\u52A8\u7684\u65F6\u4FAF\u88AB\u521B\u5EFA\uFF0C\u5E76\u4E14\u5B83\u7684\u5B9E\u9645\u7684\u7269\u7406\u5185\u5B58\u7A7A\u95F4\u4E2D\u548CJava\u5806\u533A\u4E00\u6837\u90FD\u53EF\u4EE5\u662F\u4E0D\u8FDE\u7EED\u7684\u3002 \u30FB\u65B9\u6CD5\u533A\u7684\u5927\u5C0F\uFF0C\u8DDF\u5806\u7A7A\u95F4\u4E00\u6837\uFF0C\u53EF\u4EE5\u9009\u62E9\u56FA\u5B9A\u5927\u5C0F\u6216\u8005\u53EF\u6269\u5C55\u3002 \u30FB\u65B9\u6CD5\u533A\u7684\u5927\u5C0F\u51B3\u5B9A\u4E86\u7CFB\u7EDF\u53EF\u4EE5\u4FDD\u5B58\u591A\u5C11\u4E2A\u7C7B\uFF0C\u5982\u679C\u7CFB\u7EDF\u5B9A\u4E49\u4E86\u592A\u591A\u7684\u7C7B\u3010\u6BD4\u5982\u52A0\u8F7D\u5927\u91CF\u7684\u7B2C\u4E09\u65B9\u7684jar\u5305\uFF1B Tomcat\u90E8\u7F72\u7684\u5DE5\u7A0B\u8FC7\u591A(30-50\u4E2A)\uFF1B\u5927\u91CF\u52A8\u6001\u7684\u751F\u6210\u53CD\u5C04\u7C7B\u3011\uFF0C\u5BFC\u81F4\u65B9\u6CD5\u533A\u6EA2\u51FA\uFF0C\u865A\u62DF\u673A\u540C\u6837\u4F1A\u629B\u51FA\u5185\u5B58\u6EA2\u51FA\u9519\u8BEF\uFF1Ajava.lang. OutOfMemoryError: PermGen space \u6216\u8005 java. lang.OutOfMemoryError: Metaspace \u30FB\u5173\u95EDJVM\u5C31\u4F1A\u91CA\u653E\u8FD9\u4E2A\u533A\u57DF\u7684\u5185\u5B58\u3002</p><h2 id="_3-hotspot\u4E2D\u65B9\u6CD5\u533A\u7684\u6F14\u8FDB" tabindex="-1"><a class="header-anchor" href="#_3-hotspot\u4E2D\u65B9\u6CD5\u533A\u7684\u6F14\u8FDB" aria-hidden="true">#</a> 3.HotSpot\u4E2D\u65B9\u6CD5\u533A\u7684\u6F14\u8FDB</h2><p>\u5728<strong>jdk7\u53CA\u4EE5\u524D</strong>\uFF0C\u4E60\u60EF\u4E0A\u628A\u65B9\u6CD5\u533A\uFF0C\u79F0\u4E3A<strong>\u6C38\u4E45\u4EE3</strong>\u3002<strong>jdk8\u5F00\u59CB</strong>\uFF0C\u4F7F\u7528<strong>\u5143\u7A7A\u95F4</strong>\u53D6\u4EE3\u4E86\u6C38\u4E45\u4EE3\u3002 In JDK8, classes metadata is now stored in the native heap and this space is called Metaspace \u672C\u8D28\u4E0A\uFF0C\u65B9\u6CD5\u533A\u548C\u6C38\u4E45\u4EE3\u5E76\u4E0D\u7B49\u4EF7\u3002<strong>\u4EC5\u662F\u5BF9 HotSpot\u800C\u8A00\u7684</strong>\u3002\u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u5BF9\u5982\u4F55\u5B9E\u73B0\u65B9\u6CD5\u533A\uFF0C\u4E0D\u505A\u7EDF\u4E00\u8981\u6C42\u3002\u4F8B\u5982\uFF1A BEA JRockit / IBM J9\u4E2D\u4E0D\u5B58\u5728\u6C38\u4E45\u4EE3\u7684\u6982\u5FF5\u3002\u73B0\u5728\u6765\u770B\uFF0C\u5F53\u5E74\u4F7F\u7528\u6C38\u4E45\u4EE3\uFF0C\u4E0D\u662F\u597D\u7684idea\u3002\u5BFC\u81F4Java\u7A0B\u5E8F\u66F4\u5BB9\u6613OOM(\u8D85\u8FC7XX: MaxPermSize\u4E0A\u9650)</p><p>\u800C\u5230\u4E86JDK8,\u7EC8\u4E8E\u5B8C\u5168\u5E9F\u5F03\u4E86\u6C38\u4E45\u4EE3\u7684\u6982\u5FF5\uFF0C\u6539\u7528\u4E0E Jrockit\u3001J9\u4E00\u6837\u5728\u672C\u5730\u5185\u5B58\u4E2D\u5B9E\u73B0\u7684\u5143\u7A7A\u95F4( Metaspace)\u6765\u4EE3\u66FF</p><p>\u5143\u7A7A\u95F4\u7684\u672C\u8D28\u548C\u6C38\u4E45\u4EE3\u7C7B\u4F3C\uFF0C\u90FD\u662F\u5BF9JVM\u89C4\u8303\u4E2D\u65B9\u6CD5\u533A\u7684\u5B9E\u73B0\u3002\u4E0D\u8FC7**\u5143\u7A7A\u95F4\u4E0E\u6C38\u4E45\u4EE3\u6700\u5927\u7684\u533A\u522B\u5728\u4E8E\uFF1A\u5143\u7A7A\u95F4\u4E0D\u5728\u865A\u62DF\u673A\u8BBE\u7F6E\u7684\u5185\u5B58\u4E2D\uFF0C\u800C\u662F\u4F7F\u7528\u672C\u5730\u5185\u5B58\u3002**\u6C38\u4E45\u4EE3\u3001\u5143\u7A7A\u95F4\u4E8C\u8005\u5E76\u4E0D\u53EA\u662F\u540D\u5B57\u53D8\u4E86\uFF0C\u5185\u90E8\u7ED3\u6784\u4E5F\u8C03\u6574\u4E86\u3002\u6839\u636E\u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u7684\u89C4\u5B9A\uFF0C\u5982\u679C\u65B9\u6CD5\u533A\u65E0\u6CD5\u6EE1\u8DB3\u65B0\u7684\u5185\u5B58\u5206\u914D\u9700\u6C42\u65F6\uFF0C\u5C06\u629B\u51FAOOM\u5F02\u5E38\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211130193924514.png" alt="image-20211130193924514" style="zoom:67%;"><h2 id="_4-\u8BBE\u7F6E\u65B9\u6CD5\u533A\u5927\u5C0F" tabindex="-1"><a class="header-anchor" href="#_4-\u8BBE\u7F6E\u65B9\u6CD5\u533A\u5927\u5C0F" aria-hidden="true">#</a> 4.\u8BBE\u7F6E\u65B9\u6CD5\u533A\u5927\u5C0F</h2><p>\u65B9\u6CD5\u533A\u7684\u5927\u5C0F\u4E0D\u5FC5\u662F\u56FA\u5B9A\u7684\uFF0CJVM\u53EF\u4EE5\u6839\u636E\u5E94\u7528\u7684\u9700\u8981\u52A8\u6001\u8C03\u6574\u3002 <strong>jdk7\u53CA\u4EE5\u524D\uFF1A</strong></p><p>\u901A\u8FC7**-XX: PermSize**\u6765\u8BBE\u7F6E\u6C38\u4E45\u4EE3\u521D\u59CB\u5206\u914D\u7A7A\u95F4\u3002\u9ED8\u8BA4\u503C\u662F20.75M <strong>-XX: MaxPermSize</strong>\u6765\u8BBE\u5B9A\u6C38\u4E45\u4EE3\u6700\u5927\u53EF\u5206\u914D\u7A7A\u95F4\u300232\u4F4D\u673A\u5668\u9ED8\u8BA4\u662F64M,64\u4F4D\u673A\u5668\u6A21\u5F0F\u662F82M \u5F53JVM\u52A0\u8F7D\u7684\u7C7B\u4FE1\u606F\u5BB9\u91CF\u8D85\u8FC7\u4E86\u8FD9\u4E2A\u503C\uFF0C\u4F1A\u62A5\u5F02\u5E38 OutOfMemoryError: Permgen Space\u3002 \u53EF\u901A\u8FC7\u547D\u4EE4\u884C\u67E5\u770B\uFF1Ajps\u2014\u2014\u2014\u2014\u300Bjinfo -flag PermSize/MaxPermSize \u2019num\u2018</p><p><strong>jdk8\u53CA\u4EE5\u540E\uFF1A</strong></p><p>\u200B \u5143\u6570\u636E\u533A\u5927\u5C0F\u53EF\u4EE5\u4F7F\u7528\u53C2\u6570**-XX: MetaspaceSize<strong>\u548C</strong>-XX: MaxMetaspacesSize**\u6307\u5B9A\uFF0C\u66FF\u4EE3\u4E0A\u8FF0\u539F\u6709\u7684\u4E24\u4E2A\u53C2\u6570\u3002 \u200B <strong>\u9ED8\u8BA4\u503C</strong>\u4F9D\u8D56\u4E8E\u5E73\u53F0\u3002 windows\u4E0B\uFF0C-XX: MetaspaceSize\u662F21M,-XX: MaxMetaspaceSize\u7684\u503C\u662F-1,\u5373\u6CA1\u6709\u9650\u5236\u3002 \u200B \u4E0E\u6C38\u4E45\u4EE3\u4E0D\u540C\uFF0C\u5982\u679C\u4E0D\u6307\u5B9A\u5927\u5C0F\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u865A\u62DF\u673A\u4F1A\u8017\u5C3D\u6240\u6709\u7684\u53EF\u7528\u7CFB\u7EDF\u5185\u5B58\u3002\u5982\u679C\u5143\u6570\u636E\u533A\u53D1\u751F\u6EA2\u51FA\uFF0C\u865A\u62DF\u673A\u4E00\u6837\u4F1A\u629B\u51FA\u5F02\u5E38OutOfMemoryError:Metaspace \u200B -XX: MetaspaceSize:\u8BBE\u7F6E\u521D\u59CB\u7684\u5143\u7A7A\u95F4\u5927\u5C0F\u3002\u5BF9\u4E8E\u30FC\u4E2A64\u4F4D\u7684\u670D\u52A1\u5668\u7AEFJVM\u6765\u8BF4\uFF0C\u5176\u9ED8\u8BA4\u7684-XX: MetaspaceSize\u503C\u4E3A21MB\u3002\u8FD9\u5C31\u662F\u521D\u59CB\u7684\u9AD8\u6C34\u4F4D\u7EBF\uFF0C\u4E00\u65E6\u89E6\u53CA\u8FD9\u4E2A\u6C34\u4F4D\u7EBF\uFF0CFull GC\u5C06\u4F1A\u88AB\u89E6\u53D1\u5E76\u5378\u8F7D\u6CA1\u7528\u7684\u7C7B\uFF08\u5373\u8FD9\u4E9B\u7C7B\u5BF9\u5E94\u7684\u7C7B\u52A0\u8F7D\u5668\u4E0D\u518D\u5B58\u6D3B\uFF09\uFF0C\u7136\u540E\u8FD9\u4E2A\u9AD8\u6C34\u4F4D\u7EBF\u5C06\u4F1A\u91CD\u7F6E\u3002\u65B0\u7684\u9AD8\u6C34\u4F4D\u7EBF\u7684\u503C\u53D6\u51B3\u4E8EGC\u540E\u91CA\u653E\u4E86\u591A\u5C11\u5143\u7A7A\u95F4\u3002\u5982\u679C\u91CA\u653E\u7684\u7A7A\u95F4\u4E0D\u8DB3\uFF0C\u90A3\u4E48\u5728\u4E0D\u8D85\u8FC7 MaxMetaspaceSize\u65F6\uFF0C\u9002\u5F53\u63D0\u9AD8\u8BE5\u503C\u3002\u5982\u679C\u91CA\u653E\u7A7A\u95F4\u8FC7\u591A\uFF0C\u5219\u9002\u5F53\u964D\u4F4E\u8BE5\u503C\u3002 \u200B \u5982\u679C\u521D\u59CB\u5316\u7684\u9AD8\u6C34\u4F4D\u7EBF\u8BBE\u7F6E\u8FC7\u4F4E\uFF0C\u4E0A\u8FF0\u9AD8\u6C34\u4F4D\u7EBF\u8C03\u6574\u60C5\u51B5\u4F1A\u53D1\u751F\u5F88\u591A\u6B21\u3002\u901A\u8FC7\u5783\u573E\u56DE\u6536\u5668\u7684\u65E5\u5FD7\u53EF\u4EE5\u89C2\u5BDF\u5230FullGC\u591A\u6B21\u8C03\u7528\u3002\u4E3A\u4E86\u907F\u514D\u9891\u7E41\u5730GC,\u5EFA\u8BAE\u5C06 -XX: MetaspaceSize\u8BBE\u7F6E\u4E3A\u4E00\u4E2A\u76F8\u5BF9\u8F83\u9AD8\u7684\u503C\u3002</p><h2 id="_5-oom\u4E3E\u4F8B" tabindex="-1"><a class="header-anchor" href="#_5-oom\u4E3E\u4F8B" aria-hidden="true">#</a> 5.OOM\u4E3E\u4F8B</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>ws<span class="token punctuation">.</span>org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">ClassWriter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>org<span class="token punctuation">.</span>objectweb<span class="token punctuation">.</span>asm<span class="token punctuation">.</span></span><span class="token class-name">Opcodes</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * jdk6/7\u4E2D\uFF1A
 * -XX:PermSize=10m -XX:MaxPermSize=10m
 *
 * jdk8\u4E2D\uFF1A
 * -XX:MetaspaceSize=10m -XX:MaxMetaspaceSize=10m
 *
 * <span class="token keyword">@author</span> shkstart  shkstart@126.com
 * <span class="token keyword">@create</span> 2020  22:24
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OOMTest</span> <span class="token keyword">extends</span> <span class="token class-name">ClassLoader</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">OOMTest</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OOMTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i \\<span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u521B\u5EFAClassWriter\u5BF9\u8C61\uFF0C\u7528\u4E8E\u751F\u6210\u7C7B\u7684\u4E8C\u8FDB\u5236\u5B57\u8282\u7801</span>
                <span class="token class-name">ClassWriter</span> classWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassWriter</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//\u6307\u660E\u7248\u672C\u53F7\uFF0C\u4FEE\u9970\u7B26\uFF0C\u7C7B\u540D\uFF0C\u5305\u540D\uFF0C\u7236\u7C7B\uFF0C\u63A5\u53E3</span>
                classWriter<span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token class-name">Opcodes</span><span class="token punctuation">.</span>V1_6<span class="token punctuation">,</span> <span class="token class-name">Opcodes</span><span class="token punctuation">.</span>ACC_PUBLIC<span class="token punctuation">,</span> <span class="token string">&quot;Class&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;java/lang/Object&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//\u8FD4\u56DEbyte[]</span>
                <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> code <span class="token operator">=</span> classWriter<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//\u7C7B\u7684\u52A0\u8F7D</span>
                test<span class="token punctuation">.</span><span class="token function">defineClass</span><span class="token punctuation">(</span><span class="token string">&quot;Class&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> code<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> code<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Class\u5BF9\u8C61</span>
                j<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5982\u4F55\u89E3\u51B3\u8FD9\u4E9BOOM\uFF1F</strong></p><p>1\u3001\u8981\u89E3\u51B3OOM\u5F02\u5E38\u6216 heap space\u7684\u5F02\u5E38\uFF0C\u4E00\u822C\u7684\u624B\u6BB5\u662F\u9996\u5148\u901A\u8FC7\u5185\u5B58\u6620\u50CF\u5206\u6790\u5DE5\u5177(\u5982Eclipse Memory Analyzer)\u5BF9dump\u51FA\u6765\u7684\u5806\u8F6C\u50A8\u5FEB\u7167\u8FDB\u884C\u5206\u6790\uFF0C\u91CD\u70B9\u662F\u786E\u8BA4\u5185\u5B58\u4E2D\u7684\u5BF9\u8C61\u662F\u5426\u662F\u5FC5\u8981\u7684\uFF0C\u4E5F\u5C31\u662F\u8981\u5148\u5206\u6E05\u695A\u5230\u5E95\u662F\u51FA\u73B0\u4E86\u5185\u5B58\u6CC4\u6F0F\uFF08 Memory Leak)\u8FD8\u662F\u5185\u5B58\u6EA2\u51FA( Memory Overflow) 2\u3001\u5982\u679C\u662F\u5185\u5B58\u6CC4\u6F0F\uFF0C\u53EF\u8FDB\u4E00\u6B65\u901A\u8FC7\u5DE5\u5177\u67FB\u770B\u6CC4\u6F0F\u5BF9\u8C61\u5230 GC Roots\u7684\u5F15\u7528\u94FE\u3002\u4E8E\u662F\u5C31\u80FD\u627E\u5230\u6CC4\u6F0F\u5BF9\u8C61\u662F\u901A\u8FC7\u600E\u6837\u7684\u8DEF\u5F84\u4E0E GC Roots\u76F8\u5173\u8054\u5E76\u5BFC\u81F4\u5783\u573E\u6536\u96C6\u5668\u65E0\u6CD5\u81EA\u52A8\u56DE\u6536\u5B83\u4EEC\u7684\u3002\u638C\u63E1\u4E86\u6CC4\u6F0F\u5BF9\u8C61\u7684\u7C7B\u578B\u4FE1\u606F\uFF0C\u4EE5\u53CA GC Roots\u5F15\u7528\u94FE\u7684\u4FE1\u606F\uFF0C\u5C31\u53EF\u4EE5\u6BD4\u8F83\u51C6\u786E\u5730\u5B9A\u4F4D\u51FA\u6CC4\u6F0F\u4EE3\u7801\u7684\u4F4D\u7F6E\u3002 3\u3001\u5982\u679C\u4E0D\u5B58\u5728\u5185\u5B58\u6CC4\u6F0F\uFF0C\u6362\u53E5\u8BDD\u8BF4\u5C31\u662F\u5185\u5B58\u4E2D\u7684\u5BF9\u8C61\u786E\u5B9E\u90FD\u8FD8\u5FC5\u987B\u5B58\u6D3B\u7740\uFF0C\u90A3\u5C31\u5E94\u5F53\u68C0\u67FB\u865A\u62DF\u673A\u7684\u5806\u53C2\u6570(-Xmx\u4E0E-Xms),\u4E0E\u673A\u5668\u7269\u7406\u5185\u5B58\u5BF9\u6BD4\u770B\u662F\u5426\u8FD8\u53EF\u4EE5\u8C03\u5927\uFF0C\u4ECE\u4EE3\u7801\u4E0A\u68C0\u67E5\u662F\u5426\u5B58\u5728\u67D0\u4E9B\u5BF9\u8C61\u751F\u547D\u5468\u671F\u8FC7\u957F\u3001\u6301\u6709\u72B6\u6001\u65F6\u95F4\u8FC7\u957F\u7684\u60C5\u51B5\uFF0C\u5C1D\u8BD5\u51CF\u5C11\u7A0B\u5E8F\u8FD0\u884C\u671F\u7684\u5185\u5B58\u6D88\u8017\u3002</p><h2 id="_6-\u65B9\u6CD5\u533A\u5185\u90E8\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_6-\u65B9\u6CD5\u533A\u5185\u90E8\u7ED3\u6784" aria-hidden="true">#</a> <strong>6.\u65B9\u6CD5\u533A\u5185\u90E8\u7ED3\u6784</strong></h2><p>\u200B \u300A\u6DF1\u5165\u7406\u89E3Java\u865A\u62DF\u673A\u300B\u4E66\u4E2D\u5BF9\u65B9\u6CD5\u533A( Method Area)\u5B58\u50A8\u5185\u5BB9\u63CF\u8FF0\u5982\u4E0B\u5B83\u7528\u4E8E\u5B58\u50A8\u5DF2\u88AB\u865A\u62DF\u673A\u52A0\u8F7D\u7684<strong>\u7C7B\u578B\u4FE1\u606F\u3001\u5E38\u91CF\u3001\u9759\u6001\u53D8\u91CF\u3001\u5373\u65F6\u7F16\u8BD1\u5668\u7F16\u8BD1\u540E\u7684\u4EE3\u7801\u7F13\u5B58\u7B49</strong>\u3002</p><p><img src="http://qnimg.gisfsde.com/work/image-20211130202647120.png" alt="image-20211130202647120" loading="lazy"></p><h3 id="\u7C7B\u578B\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#\u7C7B\u578B\u4FE1\u606F" aria-hidden="true">#</a> <strong>\u7C7B\u578B\u4FE1\u606F\uFF1A</strong></h3><p>\u5BF9\u6BCF\u4E2A\u52A0\u8F7D\u7684\u7C7B\u578B(\u7C7Bclass\u3001\u63A5\u53E3 interface\u3001\u679A\u4E3Eenum\u3001\u6CE8\u89E3 annotation),JVM\u5FC5\u987B\u5728\u65B9\u6CD5\u533A\u4E2D\u5B58\u50A8\u4EE5\u4E0B\u7C7B\u578B\u4FE1\u606F\uFF1A \u2460\u8FD9\u4E2A\u7C7B\u578B\u7684\u5B8C\u6574\u6709\u6548\u540D\u79F0(\u5168\u540D=\u5305\u540D.\u7C7B\u540D) \u2461)\u8FD9\u4E2A\u7C7B\u578B\u76F4\u63A5\u7236\u7C7B\u7684\u5B8C\u6574\u6709\u6548\u540D\uFF08\u5BF9\u4E8E interface\u6216\u662Fjava.lang.Object,\u90FD\u6CA1\u6709\u7236\u7C7B) \u2462\u8FD9\u4E2A\u7C7B\u578B\u7684\u4FEE\u9970\u7B26\uFF08pulblic, abstract,fina\u7684\u67D0\u4E2A\u5B50\u96C6) \u2463\u8FD9\u4E2A\u7C7B\u578B\u76F4\u63A5\u63A5\u53E3\u7684\u4E00\u4E2A\u6709\u5E8F\u5217\u8868</p><h3 id="\u57DF-filed-\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#\u57DF-filed-\u4FE1\u606F" aria-hidden="true">#</a> <strong>\u57DF\uFF08Filed\uFF09\u4FE1\u606F</strong></h3><p>JVM\u5FC5\u987B\u5728\u65B9\u6CD5\u533A\u4E2D\u4FDD\u5B58\u7C7B\u578B\u7684\u6240\u6709\u57DF\u7684\u76F8\u5173\u4FE1\u606F\u4EE5\u53CA\u57DF\u7684\u58F0\u660E\u987A\u5E8F\u3002 \u57DF\u7684\u76F8\u5173\u4FE1\u606F\u5305\u62EC\uFF1A\u57DF\u540D\u79F0\u3001\u57DF\u7C7B\u578B\u3001\u57DF\u4FEE\u9970\u7B26\uFF08 public\uFF0Cprivate\uFF0Cprotected\uFF0Cstatic\uFF0Cfina\uFF0C volatile\uFF0Ctransient\u7684\u67D0\u4E2A\u5B50\u96C6\uFF09</p><h3 id="\u65B9\u6CD5-method-\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6CD5-method-\u4FE1\u606F" aria-hidden="true">#</a> <strong>\u65B9\u6CD5\uFF08Method\uFF09\u4FE1\u606F</strong></h3><p>JTVM\u5FC5\u987B\u4FDD\u5B58\u6240\u6709\u65B9\u6CD5\u7684\u4EE5\u4E0B\u4FE1\u606F\uFF0C\u540C\u57DF\u4FE1\u606F\u4E00\u6837\u5305\u62EC\u58F0\u660E\u987A\u5E8F \u{1F53C} \u65B9\u6CD5\u540D\u79F0 \u{1F53C} \u65B9\u6CD5\u7684\u8FD4\u56DE\u7C7B\u578B(\u6216void)\u65B9\u6CD5\u53C2\u6570\u7684\u6570\u91CF\u548C\u7C7B\u578B\uFF08\u6309\u987A\u5E8F \u{1F53C} \u65B9\u6CD5\u7684\u4FEE\u9970\u7B26\uFF08 public, private, protected, static, final,synchronized, native, abstract\u7684\u4E00\u4E2A\u5B50\u96C6) \u{1F53C} \u65B9\u6CD5\u7684\u5B57\u8282\u7801( bytecodes)\u3001\u64CD\u4F5C\u6570\u6808\u3001\u5C40\u90E8\u53D8\u91CF\u8868\u53CA\u5927\u5C0F( abstract\u548Cnative\u65B9\u6CD5\u9664\u5916) \u{1F53C} \u5F02\u5E38\u8868( abstract\u548C native\u65B9\u6CD5\u9664\u5916)\uFF1A\u6BCF\u4E2A\u5F02\u5E38\u5904\u7406\u7684\u5F00\u59CB\u4F4D\u7F6E\u3001\u7ED3\u675F\u4F4D\u7F6E\u3001\u4EE3\u7801\u5904\u7406\u5728\u7A0B\u5E8F\u8BA1\u6570\u5668\u4E2D\u7684\u504F\u79FB\u5730\u5740\u88AB\u6355\u83B7\u7684\u5F02\u5E38\u7C7B\u7684\u5E38\u91CF\u6C60\u7D22\u5F15</p><p><strong>non- final\u7684\u7C7B\u53D8\u91CF</strong></p><p>\u9759\u6001\u53D8\u91CF\u548C\u7C7B\u5173\u8054\u5728\u4E00\u8D77\uFF0C\u968F\u7740\u7C7B\u7684\u52A0\u8F7D\u800C\u52A0\u8F7D\uFF0C\u5B83\u4EEC\u6210\u4E3A\u7C7B\u6570\u636E\u5728\u903B\u8F91\u4E0A\u7684\u4E00\u90E8\u5206\u3002 \u7C7B\u53D8\u91CF\u88AB\u7C7B\u7684\u6240\u6709\u5B9E\u4F8B\u5171\u4EAB\uFF0C\u5373\u4F7F\u6CA1\u6709\u7C7B\u5B9E\u4F8B\u65F6\u4F60\u4E5F\u53EF\u4EE5\u8BBF\u95EE\u5B83\u3002</p><p><strong>\u5168\u5C40\u5E38\u91CF\uFF1A static final</strong> \u88AB\u58F0\u660E\u4E3A final\u7684\u7C7B\u53D8\u91CF\u7684\u5904\u7406\u65B9\u6CD5\u5219\u4E0D\u540C\uFF0C\u6BCF\u4E2A\u5168\u5C40\u5E38\u91CF\u5728\u7F16\u8BD1\u7684\u65F6\u5019\u5C31\u4F1A\u88AB\u5206\u914D\u4E86\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * \u6D4B\u8BD5\u65B9\u6CD5\u533A\u7684\u5185\u90E8\u6784\u6210
 * <span class="token keyword">@author</span> shkstart  shkstart@126.com
 * <span class="token keyword">@create</span> 2020  23:39
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MethodInnerStrucTest</span> <span class="token keyword">extends</span> <span class="token class-name">Object</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span>\\<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span><span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u5C5E\u6027</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;\u6D4B\u8BD5\u65B9\u6CD5\u7684\u5185\u90E8\u7ED3\u6784&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//\u6784\u9020\u5668</span>
    <span class="token comment">//\u65B9\u6CD5</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;count = &quot;</span> <span class="token operator">+</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token keyword">int</span> cal<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
            result <span class="token operator">=</span> value <span class="token operator">/</span> cal<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">String</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//\u8FD0\u884Cjavap-v-p MethodInnerStrucTest.class &gt; test.txt</span>


<span class="token class-name">Classfile</span> <span class="token operator">/</span><span class="token class-name">D</span><span class="token operator">:</span><span class="token operator">/</span>workspace_idea5<span class="token operator">/</span><span class="token class-name">JVMDemo</span><span class="token operator">/</span>out<span class="token operator">/</span>production<span class="token operator">/</span>chapter09<span class="token operator">/</span>com<span class="token operator">/</span>atguigu<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">MethodInnerStrucTest</span><span class="token punctuation">.</span><span class="token keyword">class</span>
  <span class="token class-name">Last</span> modified <span class="token number">2020</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">22</span><span class="token punctuation">;</span> size <span class="token number">1626</span> bytes
  MD5 checksum <span class="token number">69643</span>a16925bb67a96f54050375c75d0
  <span class="token class-name">Compiled</span> from <span class="token string">&quot;MethodInnerStrucTest.java&quot;</span>
  <span class="token comment">//\u7C7B\u578B\u4FE1\u606F</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>java<span class="token punctuation">.</span></span>MethodInnerStrucTest</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span> 
<span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Comparable</span>\\<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span>

  minor version<span class="token operator">:</span> <span class="token number">0</span>
  major version<span class="token operator">:</span> <span class="token number">51</span>
  flags<span class="token operator">:</span> ACC_PUBLIC<span class="token punctuation">,</span> ACC_SUPER
<span class="token class-name">Constant</span> pool<span class="token operator">:</span>
   #<span class="token number">1</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">18.</span>#<span class="token number">52</span>        <span class="token comment">// java/lang/Object.&quot;\\&lt;init&gt;&quot;:()V</span>
   #<span class="token number">2</span> <span class="token operator">=</span> <span class="token class-name">Fieldref</span>           #<span class="token number">17.</span>#<span class="token number">53</span>        <span class="token comment">// com/atguigu/java/MethodInnerStrucTest.num:I</span>
   #<span class="token number">3</span> <span class="token operator">=</span> <span class="token class-name">Fieldref</span>           #<span class="token number">54.</span>#<span class="token number">55</span>        <span class="token comment">// java/lang/System.out:Ljava/io/PrintStream;</span>
   #<span class="token number">4</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">56</span>            <span class="token comment">// java/lang/StringBuilder</span>
   #<span class="token number">5</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">4.</span>#<span class="token number">52</span>         <span class="token comment">// java/lang/StringBuilder.&quot;\\&lt;init&gt;&quot;:()V</span>
   #<span class="token number">6</span> <span class="token operator">=</span> <span class="token class-name">String</span>             #<span class="token number">57</span>            <span class="token comment">// count =</span>
   #<span class="token number">7</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">4.</span>#<span class="token number">58</span>         <span class="token comment">// java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
   #<span class="token number">8</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">4.</span>#<span class="token number">59</span>         <span class="token comment">// java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;</span>
   #<span class="token number">9</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">4.</span>#<span class="token number">60</span>         <span class="token comment">// java/lang/StringBuilder.toString:()Ljava/lang/String;</span>
  #<span class="token number">10</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">61.</span>#<span class="token number">62</span>        <span class="token comment">// java/io/PrintStream.println:(Ljava/lang/String;)V</span>
  #<span class="token number">11</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">63</span>            <span class="token comment">// java/lang/Exception</span>
  #<span class="token number">12</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">11.</span>#<span class="token number">64</span>        <span class="token comment">// java/lang/Exception.printStackTrace:()V</span>
  #<span class="token number">13</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">65</span>            <span class="token comment">// java/lang/String</span>
  #<span class="token number">14</span> <span class="token operator">=</span> <span class="token class-name">Methodref</span>          #<span class="token number">17.</span>#<span class="token number">66</span>        <span class="token comment">// com/atguigu/java/MethodInnerStrucTest.compareTo:(Ljava/lang/String;)I</span>
  #<span class="token number">15</span> <span class="token operator">=</span> <span class="token class-name">String</span>             #<span class="token number">67</span>            <span class="token comment">// \u6D4B\u8BD5\u65B9\u6CD5\u7684\u5185\u90E8\u7ED3\u6784</span>
  #<span class="token number">16</span> <span class="token operator">=</span> <span class="token class-name">Fieldref</span>           #<span class="token number">17.</span>#<span class="token number">68</span>        <span class="token comment">// com/atguigu/java/MethodInnerStrucTest.str:Ljava/lang/String;</span>
  #<span class="token number">17</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">69</span>            <span class="token comment">// com/atguigu/java/MethodInnerStrucTest</span>
  #<span class="token number">18</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">70</span>            <span class="token comment">// java/lang/Object</span>
  #<span class="token number">19</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">71</span>            <span class="token comment">// java/lang/Comparable</span>
  #<span class="token number">20</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">72</span>            <span class="token comment">// java/io/Serializable</span>
  #<span class="token number">21</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               num
  #<span class="token number">22</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">I</span>
  #<span class="token number">23</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               str
  #<span class="token number">24</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span>
  #<span class="token number">25</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               \\<span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span>
  #<span class="token number">26</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>
  #<span class="token number">27</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Code</span>
  #<span class="token number">28</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">LineNumberTable</span>
  #<span class="token number">29</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">LocalVariableTable</span>
  #<span class="token number">30</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token keyword">this</span>
  #<span class="token number">31</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Lcom</span><span class="token operator">/</span>atguigu<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">MethodInnerStrucTest</span><span class="token punctuation">;</span>
  #<span class="token number">32</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               test1
  #<span class="token number">33</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               count
  #<span class="token number">34</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               test2
  #<span class="token number">35</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">I</span>
  #<span class="token number">36</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               value
  #<span class="token number">37</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               e
  #<span class="token number">38</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Exception</span><span class="token punctuation">;</span>
  #<span class="token number">39</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               cal
  #<span class="token number">40</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               result
  #<span class="token number">41</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">StackMapTable</span>
  #<span class="token number">42</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">63</span>            <span class="token comment">// java/lang/Exception</span>
  #<span class="token number">43</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               compareTo
  #<span class="token number">44</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">I</span>
  #<span class="token number">45</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               o
  #<span class="token number">46</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">I</span>
  #<span class="token number">47</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               \\<span class="token generics"><span class="token punctuation">&lt;</span>clinit<span class="token punctuation">&gt;</span></span>
  #<span class="token number">48</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Signature</span>
  #<span class="token number">49</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Comparable</span>\\<span class="token operator">&lt;</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token class-name">Ljava</span><span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">Serializable</span><span class="token punctuation">;</span>
  #<span class="token number">50</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">SourceFile</span>
  #<span class="token number">51</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">MethodInnerStrucTest</span><span class="token punctuation">.</span>java
  #<span class="token number">52</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">25</span><span class="token operator">:</span>#<span class="token number">26</span>        <span class="token comment">// &quot;\\&lt;init&gt;&quot;:()V</span>
  #<span class="token number">53</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">21</span><span class="token operator">:</span>#<span class="token number">22</span>        <span class="token comment">// num:I</span>
  #<span class="token number">54</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">73</span>            <span class="token comment">// java/lang/System</span>
  #<span class="token number">55</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">74</span><span class="token operator">:</span>#<span class="token number">75</span>        <span class="token comment">// out:Ljava/io/PrintStream;</span>
  #<span class="token number">56</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">StringBuilder</span>
  #<span class="token number">57</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               count <span class="token operator">=</span>
  #<span class="token number">58</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">76</span><span class="token operator">:</span>#<span class="token number">77</span>        <span class="token comment">// append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
  #<span class="token number">59</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">76</span><span class="token operator">:</span>#<span class="token number">78</span>        <span class="token comment">// append:(I)Ljava/lang/StringBuilder;</span>
  #<span class="token number">60</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">79</span><span class="token operator">:</span>#<span class="token number">80</span>        <span class="token comment">// toString:()Ljava/lang/String;</span>
  #<span class="token number">61</span> <span class="token operator">=</span> <span class="token class-name">Class</span>              #<span class="token number">81</span>            <span class="token comment">// java/io/PrintStream</span>
  #<span class="token number">62</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">82</span><span class="token operator">:</span>#<span class="token number">83</span>        <span class="token comment">// println:(Ljava/lang/String;)V</span>
  #<span class="token number">63</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Exception</span>
  #<span class="token number">64</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">84</span><span class="token operator">:</span>#<span class="token number">26</span>        <span class="token comment">// printStackTrace:()V</span>
  #<span class="token number">65</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span>
  #<span class="token number">66</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">43</span><span class="token operator">:</span>#<span class="token number">44</span>        <span class="token comment">// compareTo:(Ljava/lang/String;)I</span>
  #<span class="token number">67</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               \u6D4B\u8BD5\u65B9\u6CD5\u7684\u5185\u90E8\u7ED3\u6784
  #<span class="token number">68</span> <span class="token operator">=</span> <span class="token class-name">NameAndType</span>        #<span class="token number">23</span><span class="token operator">:</span>#<span class="token number">24</span>        <span class="token comment">// str:Ljava/lang/String;</span>
  #<span class="token number">69</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               com<span class="token operator">/</span>atguigu<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">MethodInnerStrucTest</span>
  #<span class="token number">70</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span>
  #<span class="token number">71</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Comparable</span>
  #<span class="token number">72</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">Serializable</span>
  #<span class="token number">73</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">System</span>
  #<span class="token number">74</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               out
  #<span class="token number">75</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token class-name">Ljava</span><span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">PrintStream</span><span class="token punctuation">;</span>
  #<span class="token number">76</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               append
  #<span class="token number">77</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">StringBuilder</span><span class="token punctuation">;</span>
  #<span class="token number">78</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">StringBuilder</span><span class="token punctuation">;</span>
  #<span class="token number">79</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               toString
  #<span class="token number">80</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span>
  #<span class="token number">81</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               java<span class="token operator">/</span>io<span class="token operator">/</span><span class="token class-name">PrintStream</span>
  #<span class="token number">82</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               println
  #<span class="token number">83</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               <span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">V</span>
  #<span class="token number">84</span> <span class="token operator">=</span> <span class="token class-name">Utf8</span>               printStackTrace
<span class="token punctuation">{</span>
  <span class="token comment">//\u57DF\u4FE1\u606F</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> num<span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token class-name">I</span>
    flags<span class="token operator">:</span> ACC_PUBLIC

  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> str<span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span>
    flags<span class="token operator">:</span> ACC_PRIVATE<span class="token punctuation">,</span> ACC_STATIC

  <span class="token comment">//\u65B9\u6CD5\u4FE1\u606F</span>
  <span class="token keyword">public</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>java<span class="token punctuation">.</span></span>MethodInnerStrucTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>
    flags<span class="token operator">:</span> ACC_PUBLIC
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span><span class="token operator">:</span> aload_0
         <span class="token number">1</span><span class="token operator">:</span> invokespecial #<span class="token number">1</span>                  <span class="token comment">// Method java/lang/Object.&quot;\\&lt;init&gt;&quot;:()V</span>
         <span class="token number">4</span><span class="token operator">:</span> aload_0
         <span class="token number">5</span><span class="token operator">:</span> bipush        <span class="token number">10</span>
         <span class="token number">7</span><span class="token operator">:</span> putfield      #<span class="token number">2</span>                  <span class="token comment">// Field num:I</span>
        <span class="token number">10</span><span class="token operator">:</span> <span class="token keyword">return</span>
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span>
        line <span class="token number">10</span><span class="token operator">:</span> <span class="token number">0</span>
        line <span class="token number">12</span><span class="token operator">:</span> <span class="token number">4</span>
      <span class="token class-name">LocalVariableTable</span><span class="token operator">:</span>
        <span class="token class-name">Start</span>  <span class="token class-name">Length</span>  <span class="token class-name">Slot</span>  <span class="token class-name">Name</span>   <span class="token class-name">Signature</span>
            <span class="token number">0</span>      <span class="token number">11</span>     <span class="token number">0</span>  <span class="token keyword">this</span>   <span class="token class-name">Lcom</span><span class="token operator">/</span>atguigu<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">MethodInnerStrucTest</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>
    flags<span class="token operator">:</span> ACC_PUBLIC
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span><span class="token operator">:</span> bipush        <span class="token number">20</span>
         <span class="token number">2</span><span class="token operator">:</span> istore_1
         <span class="token number">3</span><span class="token operator">:</span> getstatic     #<span class="token number">3</span>                  <span class="token comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span>
         <span class="token number">6</span><span class="token operator">:</span> <span class="token keyword">new</span>           #<span class="token number">4</span>                  <span class="token comment">// class java/lang/StringBuilder</span>
         <span class="token number">9</span><span class="token operator">:</span> dup
        <span class="token number">10</span><span class="token operator">:</span> invokespecial #<span class="token number">5</span>                  <span class="token comment">// Method java/lang/StringBuilder.&quot;\\&lt;init&gt;&quot;:()V</span>
        <span class="token number">13</span><span class="token operator">:</span> ldc           #<span class="token number">6</span>                  <span class="token comment">// String count =</span>
        <span class="token number">15</span><span class="token operator">:</span> invokevirtual #<span class="token number">7</span>                  <span class="token comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span>
        <span class="token number">18</span><span class="token operator">:</span> iload_1
        <span class="token number">19</span><span class="token operator">:</span> invokevirtual #<span class="token number">8</span>                  <span class="token comment">// Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder;</span>
        <span class="token number">22</span><span class="token operator">:</span> invokevirtual #<span class="token number">9</span>                  <span class="token comment">// Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span>
        <span class="token number">25</span><span class="token operator">:</span> invokevirtual #<span class="token number">10</span>                 <span class="token comment">// Method java/io/PrintStream.println:(Ljava/lang/String;)V</span>
        <span class="token number">28</span><span class="token operator">:</span> <span class="token keyword">return</span>
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span>
        line <span class="token number">17</span><span class="token operator">:</span> <span class="token number">0</span>
        line <span class="token number">18</span><span class="token operator">:</span> <span class="token number">3</span>
        line <span class="token number">19</span><span class="token operator">:</span> <span class="token number">28</span>
      <span class="token class-name">LocalVariableTable</span><span class="token operator">:</span>
        <span class="token class-name">Start</span>  <span class="token class-name">Length</span>  <span class="token class-name">Slot</span>  <span class="token class-name">Name</span>   <span class="token class-name">Signature</span>
            <span class="token number">0</span>      <span class="token number">29</span>     <span class="token number">0</span>  <span class="token keyword">this</span>   <span class="token class-name">Lcom</span><span class="token operator">/</span>atguigu<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">MethodInnerStrucTest</span><span class="token punctuation">;</span>
            <span class="token number">3</span>      <span class="token number">26</span>     <span class="token number">1</span> count   <span class="token class-name">I</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">I</span><span class="token punctuation">)</span><span class="token class-name">I</span>
    flags<span class="token operator">:</span> ACC_PUBLIC<span class="token punctuation">,</span> ACC_STATIC
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">1</span>
         <span class="token number">0</span><span class="token operator">:</span> iconst_0
         <span class="token number">1</span><span class="token operator">:</span> istore_1
         <span class="token number">2</span><span class="token operator">:</span> bipush        <span class="token number">30</span>
         <span class="token number">4</span><span class="token operator">:</span> istore_2
         <span class="token number">5</span><span class="token operator">:</span> iload_2
         <span class="token number">6</span><span class="token operator">:</span> iload_0
         <span class="token number">7</span><span class="token operator">:</span> idiv
         <span class="token number">8</span><span class="token operator">:</span> istore_1
         <span class="token number">9</span><span class="token operator">:</span> <span class="token keyword">goto</span>          <span class="token number">17</span>
        <span class="token number">12</span><span class="token operator">:</span> astore_2
        <span class="token number">13</span><span class="token operator">:</span> aload_2
        <span class="token number">14</span><span class="token operator">:</span> invokevirtual #<span class="token number">12</span>                 <span class="token comment">// Method java/lang/Exception.printStackTrace:()V</span>
        <span class="token number">17</span><span class="token operator">:</span> iload_1
        <span class="token number">18</span><span class="token operator">:</span> ireturn
      <span class="token class-name">Exception</span> table<span class="token operator">:</span>
         from    <span class="token keyword">to</span>  <span class="token namespace">target</span> type
             <span class="token number">2</span>     <span class="token number">9</span>    <span class="token number">12</span>   <span class="token class-name">Class</span> java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Exception</span>
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span>
        line <span class="token number">21</span><span class="token operator">:</span> <span class="token number">0</span>
        line <span class="token number">23</span><span class="token operator">:</span> <span class="token number">2</span>
        line <span class="token number">24</span><span class="token operator">:</span> <span class="token number">5</span>
        line <span class="token number">27</span><span class="token operator">:</span> <span class="token number">9</span>
        line <span class="token number">25</span><span class="token operator">:</span> <span class="token number">12</span>
        line <span class="token number">26</span><span class="token operator">:</span> <span class="token number">13</span>
        line <span class="token number">28</span><span class="token operator">:</span> <span class="token number">17</span>
      <span class="token class-name">LocalVariableTable</span><span class="token operator">:</span>
        <span class="token class-name">Start</span>  <span class="token class-name">Length</span>  <span class="token class-name">Slot</span>  <span class="token class-name">Name</span>   <span class="token class-name">Signature</span>
            <span class="token number">5</span>       <span class="token number">4</span>     <span class="token number">2</span> value   <span class="token class-name">I</span>
           <span class="token number">13</span>       <span class="token number">4</span>     <span class="token number">2</span>     e   <span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Exception</span><span class="token punctuation">;</span>
            <span class="token number">0</span>      <span class="token number">19</span>     <span class="token number">0</span>   cal   <span class="token class-name">I</span>
            <span class="token number">2</span>      <span class="token number">17</span>     <span class="token number">1</span> result   <span class="token class-name">I</span>
      <span class="token class-name">StackMapTable</span><span class="token operator">:</span> number_of_entries <span class="token operator">=</span> <span class="token number">2</span>
        frame_type <span class="token operator">=</span> <span class="token number">255</span> <span class="token comment">/* full_frame */</span>
          offset_delta <span class="token operator">=</span> <span class="token number">12</span>
          locals <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token punctuation">]</span>
          stack <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token keyword">class</span> java<span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Exception</span> <span class="token punctuation">]</span>
        frame_type <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment">/* same */</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">I</span>
    flags<span class="token operator">:</span> ACC_PUBLIC
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">2</span>
         <span class="token number">0</span><span class="token operator">:</span> iconst_0
         <span class="token number">1</span><span class="token operator">:</span> ireturn
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span>
        line <span class="token number">33</span><span class="token operator">:</span> <span class="token number">0</span>
      <span class="token class-name">LocalVariableTable</span><span class="token operator">:</span>
        <span class="token class-name">Start</span>  <span class="token class-name">Length</span>  <span class="token class-name">Slot</span>  <span class="token class-name">Name</span>   <span class="token class-name">Signature</span>
            <span class="token number">0</span>       <span class="token number">2</span>     <span class="token number">0</span>  <span class="token keyword">this</span>   <span class="token class-name">Lcom</span><span class="token operator">/</span>atguigu<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">MethodInnerStrucTest</span><span class="token punctuation">;</span>
            <span class="token number">0</span>       <span class="token number">2</span>     <span class="token number">1</span>     o   <span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">String</span><span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token class-name">Ljava</span><span class="token operator">/</span>lang<span class="token operator">/</span><span class="token class-name">Object</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token class-name">I</span>
    flags<span class="token operator">:</span> ACC_PUBLIC<span class="token punctuation">,</span> ACC_BRIDGE<span class="token punctuation">,</span> ACC_SYNTHETIC
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">2</span>
         <span class="token number">0</span><span class="token operator">:</span> aload_0
         <span class="token number">1</span><span class="token operator">:</span> aload_1
         <span class="token number">2</span><span class="token operator">:</span> checkcast     #<span class="token number">13</span>                 <span class="token comment">// class java/lang/String</span>
         <span class="token number">5</span><span class="token operator">:</span> invokevirtual #<span class="token number">14</span>                 <span class="token comment">// Method compareTo:(Ljava/lang/String;)I</span>
         <span class="token number">8</span><span class="token operator">:</span> ireturn
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span>
        line <span class="token number">10</span><span class="token operator">:</span> <span class="token number">0</span>
      <span class="token class-name">LocalVariableTable</span><span class="token operator">:</span>
        <span class="token class-name">Start</span>  <span class="token class-name">Length</span>  <span class="token class-name">Slot</span>  <span class="token class-name">Name</span>   <span class="token class-name">Signature</span>
            <span class="token number">0</span>       <span class="token number">9</span>     <span class="token number">0</span>  <span class="token keyword">this</span>   <span class="token class-name">Lcom</span><span class="token operator">/</span>atguigu<span class="token operator">/</span>java<span class="token operator">/</span><span class="token class-name">MethodInnerStrucTest</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    descriptor<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token class-name">V</span>
    flags<span class="token operator">:</span> ACC_STATIC
    <span class="token class-name">Code</span><span class="token operator">:</span>
      stack<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> locals<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> args_size<span class="token operator">=</span><span class="token number">0</span>
         <span class="token number">0</span><span class="token operator">:</span> ldc           #<span class="token number">15</span>                 <span class="token comment">// String \u6D4B\u8BD5\u65B9\u6CD5\u7684\u5185\u90E8\u7ED3\u6784</span>
         <span class="token number">2</span><span class="token operator">:</span> putstatic     #<span class="token number">16</span>                 <span class="token comment">// Field str:Ljava/lang/String;</span>
         <span class="token number">5</span><span class="token operator">:</span> <span class="token keyword">return</span>
      <span class="token class-name">LineNumberTable</span><span class="token operator">:</span>
        line <span class="token number">13</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token class-name">Signature</span><span class="token operator">:</span> #<span class="token number">49</span>                          <span class="token comment">// Ljava/lang/Object;Ljava/lang/Comparable\\&lt;Ljava/lang/String;&gt;;Ljava/io/Serializable;</span>
<span class="token class-name">SourceFile</span><span class="token operator">:</span> <span class="token string">&quot;MethodInnerStrucTest.java&quot;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60vs\u5E38\u91CF\u6C60" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60vs\u5E38\u91CF\u6C60" aria-hidden="true">#</a> \u8FD0\u884C\u65F6\u5E38\u91CF\u6C60VS\u5E38\u91CF\u6C60</h3><h4 id="\u5E38\u91CF\u6C60" tabindex="-1"><a class="header-anchor" href="#\u5E38\u91CF\u6C60" aria-hidden="true">#</a> \u5E38\u91CF\u6C60</h4>`,164),ta=n("\u65B9\u6CD5\u533A\u5185\u90E8\u5305\u542B\u4E86"),oa=a("strong",null,"\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60",-1),pa=n(" \u30FB\u5B57\u8282\u7801\u6587\u4EF6\uFF0C\u5185\u90E8\u5305\u542B\u4E86"),la=a("strong",null,"\u5E38\u91CF\u6C60",-1),ia=n("\u3002 \u30FB\u8981\u5F04\u6E05\u695A\u65B9\u6CD5\u533A\uFF0C\u9700\u8981\u7406\u89E3\u6E05\u695AClassFile,\u56E0\u4E3A\u52A0\u8F7D\u7C7B\u7684\u4FE1\u606F\u90FD\u5728\u65B9\u6CD5\u533A\u3002 \u30FB\u8981\u5F04\u6E05\u695A\u65B9\u6CD5\u533A\u7684\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\uFF0C\u9700\u8981\u7406\u89E3\u6E05\u695AClassFile\u4E2D\u7684\u5E38\u91CF\u6C60"),ra={href:"https://docs.oracle.com/javase/specs/ivms/se8/htm1/jvms-4.html%E5%A6%82%E4%B8%8B%EF%BC%9A",target:"_blank",rel:"noopener noreferrer"},ca=n("https://docs.oracle.com/javase/specs/ivms/se8/htm1/jvms-4.html\u5982\u4E0B\uFF1A"),da=s(`<p>\u4E00\u4E2A\u6709\u6548\u7684\u5B57\u8282\u7801\u6587\u4EF6\u4E2D\u9664\u4E86\u5305\u542B\u7C7B\u7684\u7248\u672C\u4FE1\u606F\u3001\u5B57\u6BB5\u3001\u65B9\u6CD5\u4EE5\u53CA\u63A5\u53E3\u7B49\u63CF\u8FF0\u4FE1\u606F\u5916\uFF0C\u8FD8\u5305\u542B\u4E00\u9879\u4FE1\u606F\u90A3\u5C31\u662F<strong>\u5E38\u91CF\u6C60\u8868( Constant Pool Table)</strong>,\u5305\u62EC\u5404\u79CD\u5B57\u9762\u91CF\u548C\u5BF9\u7C7B\u578B\u3001\u57DF\u548C\u65B9\u6CD5\u7684\u7B26\u53F7\u5F15\u7528\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211201133937336.png" alt="image-20211201133937336" style="zoom:80%;"><h5 id="\u4E3A\u4EC0\u4E48\u9700\u8981\u5E38\u91CF\u6C60" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u9700\u8981\u5E38\u91CF\u6C60" aria-hidden="true">#</a> <strong>\u4E3A\u4EC0\u4E48\u9700\u8981\u5E38\u91CF\u6C60\uFF1F</strong></h5><p>\u4E00\u4E2Ajava\u6E90\u6587\u4EF6\u4E2D\u7684\u7C7B\u3001\u63A5\u53E3\uFF0C\u7F16\u8BD1\u540E\u4EA7\u751F\u4E00\u4E2A\u5B57\u8282\u7801\u6587\u4EF6\u3002\u800CJava\u4E2D\u7684\u5B57\u8282\u7801\u9700\u8981\u6570\u636E\u652F\u6301\uFF0C\u901A\u5E38\u8FD9\u79CD\u6570\u636E\u4F1A\u5F88\u5927\u4EE5\u81F3\u4E8E\u4E0D\u80FD\u76F4\u63A5\u5B58\u5230\u5B57\u8282\u7801\u91CC\uFF0C\u6362\u53E6\u4E00\u79CD\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u5B58\u5230\u5E38\u91CF\u6C60\uFF0C\u8FD9\u4E2A\u5B57\u8282\u7801\u5305\u542B\u4E86\u6307\u5411\u5E38\u91CF\u6C60\u7684\u5F15\u7528\u3002\u5728\u52A8\u6001\u94FE\u63A5\u7684\u65F6\u5019\u4F1A\u7528\u5230\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\uFF0C\u4E4B\u524D\u6709\u4ECB\u7ECD\u3002</p><h5 id="\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u5C0F\u7ED3" aria-hidden="true">#</a> <strong>\u5C0F\u7ED3</strong></h5><p>\u5E38\u91CF\u6C60\uFF0C\u53EF\u4EE5\u770B\u505A\u662F\u4E00\u5F20\u8868\uFF0C\u865A\u62DF\u673A\u6307\u4EE4\u6839\u636E\u8FD9\u5F20\u5E38\u91CF\u8868\u627E\u5230\u8981\u6267\u884C\u7684\u7C7B\u540D\u3001\u65B9\u6CD5\u540D\u3001\u53C2\u6570\u7C7B\u578B\u3001\u5B57\u9762\u91CF\u7B49\u7C7B\u578B\u3002</p><h4 id="\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60" aria-hidden="true">#</a> \u8FD0\u884C\u65F6\u5E38\u91CF\u6C60</h4><p>\u{1F951} \u8FD0\u884C\u65F6\u5E38\u91CF\u6C60( Runtime Constant Pool)\u662F\u65B9\u6CD5\u533A\u7684\u4E00\u90E8\u5206\u3002 \u{1F951} \u5E38\u91CF\u6C60\u8868( Constant Pool Table)\u662FClass\u6587\u4EF6\u7684\u4E00\u90E8\u5206\uFF0C\u7528\u4E8E<strong>\u5B58\u653E\u7F16\u8BD1\u671F\u751F\u6210\u7684\u5404\u79CD\u5B57\u9762\u91CF\u4E0E\u7B26\u53F7\u5F15\u7528\uFF0C\u8FD9\u90E8\u5206\u5185\u5BB9\u5C06\u5728\u7C7B\u52A0\u8F7D\u540E\u5B58\u653E\u5230\u65B9\u6CD5\u533A\u7684\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u4E2D\u3002</strong> \u{1F951} \u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\uFF0C\u5728\u52A0\u8F7D\u7C7B\u548C\u63A5\u53E3\u5230\u865A\u62DF\u673A\u540E\uFF0C\u5C31\u4F1A\u521B\u5EFA\u5BF9\u5E94\u7684\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u3002 \u{1F951} JVM\u4E3A\u6BCF\u4E2A\u5DF2\u52A0\u8F7D\u7684\u7C7B\u578B\uFF08\u7C7B\u6216\u63A5\u53E3\uFF09\u90FD\u7EF4\u62A4\u4E00\u4E2A\u5E38\u91CF\u6C60\u3002\u6C60\u4E2D\u7684\u6570\u636E\u9879\u50CF\u6570\u7EC4\u9879\u4E00\u6837\uFF0C\u662F\u901A\u8FC7\u7D22\u5F15\u8BBF\u95EE\u7684\u3002 \u{1F951} \u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u4E2D\u5305\u542B\u591A\u79CD\u4E0D\u540C\u7684\u5E38\u91CF\uFF0C\u5305\u62EC\u7F16\u8BD1\u671F\u5C31\u5DF2\u7ECF\u660E\u786E\u7684\u6570\u503C\u5B57\u9762\u91CF\uFF0C\u4E5F\u5305\u62EC\u5230\u8FD0\u884C\u671F\u89E3\u6790\u540E\u624D\u80FD\u591F\u83B7\u5F97\u7684\u65B9\u6CD5\u6216\u8005\u5B57\u6BB5\u5F15\u7528\u3002\u6B64\u65F6\u4E0D\u518D\u662F\u5E38\u91CF\u6C60\u4E2D\u7684\u7B26\u53F7\u5730\u5740\u4E86\uFF0C\u8FD9\u91CC\u6362\u4E3A\u771F\u5B9E\u5730\u5740\u3002 \u{1F951} \u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\uFF0C\u76F8\u5BF9\u4E8EClass\u6587\u4EF6\u5E38\u91CF\u6C60\u7684\u53E6\u4E00\u91CD\u8981\u7279\u5F81\u662F\uFF1A\u5177\u5907\u52A8\u6001\u6027\u3002\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u7C7B\u4F3C\u4E8E\u4F20\u7EDF\u7F16\u7A0B\u8BED\u8A00\u4E2D\u7684\u7B26\u53F7\u8868( symol table),\u4F46\u662F\u5B83\u6240\u5305\u542B\u7684\u6570\u636E\u5374\u6BD4\u7B26\u53F7\u8868\u8981\u66F4\u52A0\u4E30\u5BCC\u4E00\u4E9B\u3002 \u{1F951} \u5F53\u521B\u5EFA\u7C7B\u6216\u63A5\u53E3\u7684\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u65F6\uFF0C\u5982\u679C\u6784\u9020\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60\u6240\u9700\u7684\u5185\u5B58\u7A7A\u95F4\u8D85\u8FC7\u4E86\u65B9\u6CD5\u533A\u6240\u80FD\u63D0\u4F9B\u7684\u6700\u5927\u503C\uFF0C\u5219JVM\u4F1A\u629B OutOfMemoryError\u5F02\u5E38\u3002</p><h2 id="_7-\u65B9\u6CD5\u533A\u7684\u6F14\u8FDB\u7EC6\u8282" tabindex="-1"><a class="header-anchor" href="#_7-\u65B9\u6CD5\u533A\u7684\u6F14\u8FDB\u7EC6\u8282" aria-hidden="true">#</a> 7.\u65B9\u6CD5\u533A\u7684\u6F14\u8FDB\u7EC6\u8282</h2><h3 id="_1-\u9996\u5148\u660E\u786E-\u53EA\u6709-hotspot\u30AA\u6709\u6C38\u4E45\u4EE3\u3002" tabindex="-1"><a class="header-anchor" href="#_1-\u9996\u5148\u660E\u786E-\u53EA\u6709-hotspot\u30AA\u6709\u6C38\u4E45\u4EE3\u3002" aria-hidden="true">#</a> 1.\u9996\u5148\u660E\u786E\uFF1A\u53EA\u6709 HotSpot\u30AA\u6709\u6C38\u4E45\u4EE3\u3002</h3><p>BEA JRockit\u3001IBM J9\u7B49\u6765\u8BF4\uFF0C\u662F\u4E0D\u5B58\u5728\u6C38\u4E45\u4EE3\u7684\u6982\u5FF5\u7684\u3002\u539F\u5219\u4E0A\u5982\u4F55\u5B9E\u73B0\u65B9\u6CD5\u533A\u5C5E\u4E8E\u865A\u62DF\u673A\u5B9E\u73B0\u7EC6\u8282\uFF0C\u4E0D\u53D7\u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u7BA1\u675F\uFF0C\u5E76\u4E0D\u8981\u6C42\u7EDF\u4E00\u3002</p><h3 id="_2-hotspot\u4E2D\u65B9\u6CD5\u533A\u7684\u53D8\u5316" tabindex="-1"><a class="header-anchor" href="#_2-hotspot\u4E2D\u65B9\u6CD5\u533A\u7684\u53D8\u5316" aria-hidden="true">#</a> 2, HotSpot\u4E2D\u65B9\u6CD5\u533A\u7684\u53D8\u5316\uFF1A</h3><table><thead><tr><th>jak1.6\u53CA\u4E4B\u524D</th><th>\u6709\u6C38\u4E45\u4EE3( permanent generation),\u9759\u6001\u53D8\u91CF\uFF08\u53D8\u91CF\u540D\uFF09\u5B58\u653E\u5728\u6C38\u4E45\u4EE3\u4E0A</th></tr></thead><tbody><tr><td>jdk. 7</td><td>\u6709\u6C38\u4E45\u4EE3\uFF0C\u4F46\u5DF2\u7ECF\u9010\u6B65\u201C\u53BB\u6C38\u4E45\u4EE3\u201D\uFF0C\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u3001\u9759\u6001\u53D8\u91CF\u79FB\u9664\uFF0C\u4FDD\u5B58\u5728\u5806\u4E2D</td></tr><tr><td>jak1.8\u53CA\u4E4B\u540E</td><td>\u65E0\u6C38\u4E45\u4EE3\uFF0C\u7C7B\u578B\u4FE1\u606F\u3001\u5B57\u6BB5\u3001\u65B9\u6CD5\u3001\u5E38\u91CF\u4FDD\u5B58\u5728\u672C\u5730\u5185\u5B58\u7684\u5143\u7A7A\u95F4\uFF0C\u4F46\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u3001\u9759\u6001\u53D8\u91CF\u4ECD\u5728\u5806</td></tr></tbody></table><img src="http://qnimg.gisfsde.com/work/\u7B2C08\u7AE0_\u65B9\u6CD5\u533A\u7684\u6F14\u8FDB\u7EC6\u8282-hotspot.jpg" alt="\u7B2C08\u7AE0_\u65B9\u6CD5\u533A\u7684\u6F14\u8FDB\u7EC6\u8282-hotspot" style="zoom:50%;"><h3 id="_3-\u6C38\u4E45\u4EE3\u4E3A\u4EC0\u4E48\u8981\u88AB\u5143\u7A7A\u95F4\u66FF\u6362" tabindex="-1"><a class="header-anchor" href="#_3-\u6C38\u4E45\u4EE3\u4E3A\u4EC0\u4E48\u8981\u88AB\u5143\u7A7A\u95F4\u66FF\u6362" aria-hidden="true">#</a> 3.\u6C38\u4E45\u4EE3\u4E3A\u4EC0\u4E48\u8981\u88AB\u5143\u7A7A\u95F4\u66FF\u6362\uFF1F</h3><p>\u30FB\u968F\u7740Java8\u7684\u5230\u6765\uFF0C Hotspot Vy\u4E2D\u518D\u4E5F\u89C1\u4E0D\u5230\u6C38\u4E45\u4EE3\u4E86\u3002\u4F46\u662F\u8FD9\u5E76\u4E0D\u610F\u5473\u7740\u7C7B\u7684\u5143\u6570\u636E\u4FE1\u606F\u4E5F\u6D88\u5931\u4E86\u3002\u8FD9\u4E9B\u6570\u636E\u88AB\u79FB\u5230\u4E86\u4E00\u4E2A\u4E0E\u5806\u4E0D\u76F8\u8FDE\u7684\u672C\u5730\u5185\u5B58\u533A\u57DF\uFF0C\u8FD9\u4E2A\u533A\u57DF\u53EB\u505A\u5143\u7A7A\u95F4( Metaspace). \u30FB\u7531\u4E8E\u7C7B\u7684\u5143\u6570\u636E\u5206\u914D\u5728\u672C\u5730\u5185\u5B58\u4E2D\uFF0C\u5143\u7A7A\u95F4\u7684\u6700\u5927\u53EF\u5206\u914D\u7A7A\u95F4\u5C31\u662F\u7CFB\u7EDF\u53EF\u7528\u5185\u5B58\u7A7A \u30FB\u8FD9\u9879\u6539\u52A8\u662F\u5F88\u6709\u5FC5\u8981\u7684\uFF0C\u539F\u56E0\u6709\uFF1A</p><h4 id="_1-\u4E3A\u6C38\u4E45\u4EE3\u8BBE\u7F6E\u7A7A\u95F4\u5927\u5C0F\u662F\u5F88\u96BE\u786E\u5B9A\u7684" tabindex="-1"><a class="header-anchor" href="#_1-\u4E3A\u6C38\u4E45\u4EE3\u8BBE\u7F6E\u7A7A\u95F4\u5927\u5C0F\u662F\u5F88\u96BE\u786E\u5B9A\u7684" aria-hidden="true">#</a> 1)\u4E3A\u6C38\u4E45\u4EE3\u8BBE\u7F6E\u7A7A\u95F4<strong>\u5927\u5C0F\u662F\u5F88\u96BE\u786E\u5B9A</strong>\u7684</h4><p>\u200B \u5728\u67D0\u4E9B\u573A\u666F\u4E0B\uFF0C\u5982\u679C\u52A8\u6001\u52A0\u8F7D\u7C7B\u8FC7\u591A\uFF0C\u5BB9\u6613\u4EA7\u751FPerm \u533A\u7684OOM\u3002\u6BD4\u5982\u67D0\u4E2A\u5B9E\u9645Web\u5DE5\u7A0B\u4E2D\uFF0C\u56E0\u4E3A\u529F\u80FD\u70B9\u6BD4\u8F83\u591A\uFF0C\u5728\u8FD0\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u8981\u4E0D\u65AD\u52A8\u6001\u52A0\u8F7D\u5F88\u591A\u7C7B\uFF0C\u7ECF\u5E38\u51FA\u73B0\u81F4\u547D\u9519\u8BEF\u3002\u6BD4\u5982Exception in thread \u2018dubbo client x.x conner\u2019 java. lang. Outommemoryemor PermGen space \u800C\u5143\u7A7A\u95F4\u548C\u6C38\u4E45\u4EE3\u4E4B\u95F4\u6700\u5927\u7684\u533A\u522B\u5728\u4E8E\uFF1A\u5143\u7A7A\u95F4\u5E76\u4E0D\u5728\u865A\u62DF\u673A\u4E2D\uFF0C\u800C\u662F\u4F7F\u7528\u672C\u5730\u5185\u5B58\u3002\u56E0\u6B64\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5143\u7A7A\u95F4\u7684\u5927\u5C0F\u4EC5\u53D7\u672C\u5730\u5185\u5B58\u9650\u5236\u3002</p><h4 id="_2-\u5BF9\u6C38\u4E45\u4EE3\u8FDB\u884C\u8C03\u4F18\u662F\u5F88\u56F0\u96BE\u7684\u3002" tabindex="-1"><a class="header-anchor" href="#_2-\u5BF9\u6C38\u4E45\u4EE3\u8FDB\u884C\u8C03\u4F18\u662F\u5F88\u56F0\u96BE\u7684\u3002" aria-hidden="true">#</a> 2)\u5BF9\u6C38\u4E45\u4EE3\u8FDB\u884C<strong>\u8C03\u4F18\u662F\u5F88\u56F0\u96BE</strong>\u7684\u3002</h4><p>\u30FB\u5224\u5B9A\u4E00\u4E2A\u5E38\u91CF\u662F\u5426\u201C\u5E9F\u5F03\u201D\u8FD8\u662F\u76F8\u5BF9\u7B80\u5355\uFF0C\u800C\u8981\u5224\u5B9A\u4E00\u4E2A\u7C7B\u578B\u662F\u5426\u5C5E\u4E8E\u201C\u4E0D\u518D\u88AB\u4F7F\u7528\u7684\u7C7B\u201D\u7684\u6761\u4EF6\u5C31\u6BD4\u8F83\u82DB\u523B\u4E86\u3002\u9700\u8981\u540C\u65F6\u6EE1\u8DB3\u4E0B\u9762\u4E09\u4E2A\u6761\u4EF6\uFF1A \u8BE5\u7C7B\u6240\u6709\u7684\u5B9E\u4F8B\u90FD\u5DF2\u7ECF\u88AB\u56DE\u6536\uFF0C\u4E5F\u5C31\u662FJAVA\u5806\u4E2D\u4E0D\u5B58\u5728\u8BE5\u7C7B\u53CA\u5176\u4EFB\u4F55\u6D3E\u751F\u5B50\u7C7B\u7684\u5B9E\u4F8B\u3002 \u52A0\u8F7D\u8BE5\u7C7B\u7684\u7C7B\u52A0\u8F7D\u5668\u5DF2\u7ECF\u88AB\u56DE\u6536\uFF0C\u8FD9\u4E2A\u6761\u4EF6\u9664\u975E\u662F\u7ECF\u8FC7\u7CBE\u5FC3\u8BBE\u8BA1\u7684\u53EF\u66FF\u6362\u7C7B\u52A0\u8F7D\u5668\u7684\u573A\u666F\uFF0C\u5982OSGi\u3001JSP\u7684\u91CD\u52A0\u8F7D\u7B49\uFF0C\u5426\u5219\u901A\u5E38\u662F\u5F88\u96BE\u8FBE\u6210\u7684\u3002 \u8BE5\u7C7B\u5BF9\u5E94\u7684java.lang.Class\u5BF9\u8C61\u6CA1\u6709\u5728\u4EFB\u4F55\u5730\u65B9\u88AB\u5F15\u7528\uFF0C\u65E0\u6CD5\u5728\u4EFB\u4F55\u5730\u65B9\u901A\u8FC7\u53CD\u5C04\u8BBF\u95EE\u8BE5\u7C7B\u7684\u65B9\u6CD5\u3002 \u30FBJAVA\u865A\u62DF\u673A\u88AB\u5141\u8BB8\u5BF9\u6EE1\u8DB3\u4E0A\u8FF0\u4E09\u4E2A\u6761\u4EF6\u7684\u65E0\u7528\u7C7B\u8FDB\u884C\u56DE\u6536\uFF0C\u8FD9\u91CC\u8BF4\u7684\u4EC5\u4EC5\u662F\u201C\u88AB\u5141\u8BB8\u201D\uFF0C\u800C\u5E76\u4E0D\u662F\u548C\u5BF9\u8C61\u4E00\u6837\uFF0C\u6CA1\u6709\u5F15\u7528\u4E86\u5C31\u5FC5\u7136\u4F1A\u56DE\u6536\u3002\u5173\u4E8E\u662F\u5426\u8981\u5BF9\u7C7B\u578B\u8FDB\u884C\u56DE\u6536\uFF0CHotSpot\u865A\u62DF\u673A\u63D0\u4F9B\u4E86-Xnoclassc\u53C2\u6570\u8FDB\u884C\u63A7\u5236\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528 -verbose:class \u4EE5\u53CA -XX: TracedClass - Loading\u3001-XX: +TraceClassUnLoading\u67E5\u770B\u7C7B\u52A0\u8F7D\u548C\u5378\u8F7D\u4FE1\u606F\u3002 \u30FB\u5728\u5927\u91CF\u4F7F\u7528\u53CD\u5C04\u3001\u52A8\u6001\u4EE3\u7406\u3001CGLib\u7B49\u5B57\u8282\u7801\u6846\u67B6\uFF0C\u52A8\u6001\u751F\u6210JSP\u4EE5\u53CAOSGi\u8FD9\u7C7B\u9891\u7E41\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u7684\u573A\u666F\u4E2D\uFF0C\u901A\u5E38\u90FD\u9700\u8981Java\u865A\u62DF\u673A\u5177\u5907\u7C7B\u578B\u5378\u8F7D\u7684\u80FD\u529B\uFF0C\u4EE5\u4FDD\u8BC1\u4E0D\u4F1A\u5BF9\u65B9\u6CD5\u533A\u9020\u6210\u8FC7\u5927\u7684\u5185\u5B58\u538B\u529B\u3002</p><h3 id="_4\u3001stringtable\u4E3A\u4EC0\u4E48\u8981\u8C03\u6574" tabindex="-1"><a class="header-anchor" href="#_4\u3001stringtable\u4E3A\u4EC0\u4E48\u8981\u8C03\u6574" aria-hidden="true">#</a> 4\u3001Stringtable\u4E3A\u4EC0\u4E48\u8981\u8C03\u6574\uFF1F</h3><p>\u200B jdk7\u4E2D\u5C06 string Table\u653E\u5230\u4E86\u5806\u7A7A\u95F4\u4E2D\u3002\u56E0\u4E3A\u6C38\u4E45\u4EE3\u7684\u56DE\u6536\u6548\u7387\u5F88\u4F4E\uFF0C\u5728full GC\u7684\u65F6\u5019\u624D\u4F1A\u89E6\u53D1\u3002\u800Cfull GC\u662F\u8001\u5E74\u4EE3\u7684\u7A7A\u95F4\u4E0D\u8DB3\u3001\u6C38\u4E45\u4EE3\u4E0D\u8DB3\u65F6\u624D\u4F1A\u89E6\u53D1 \u8FD9\u5C31\u5BFC\u81F4 StringTable\u56DE\u6536\u6548\u7387\u4E0D\u9AD8\u3002\u800C\u6211\u4EEC\u5F00\u53D1\u4E2D\u4F1A\u6709\u5927\u91CF\u7684\u5B57\u7B26\u4E32\u88AB\u521B\u5EFA\uFF0C\u56DE\u6536\u6548\u7387\u4F4E\uFF0C\u5BFC\u81F4\u6C38\u4E45\u4EE3\u5185\u5B58\u4E0D\u8DB3\u3002\u653E\u5230\u5806\u91CC\uFF0C\u80FD\u53CA\u65F6\u56DE\u6536\u5185\u5B58\u3002</p><h2 id="_8-\u9759\u6001\u53D8\u91CF\u5B58\u5728\u54EA" tabindex="-1"><a class="header-anchor" href="#_8-\u9759\u6001\u53D8\u91CF\u5B58\u5728\u54EA" aria-hidden="true">#</a> 8.\u9759\u6001\u53D8\u91CF\u5B58\u5728\u54EA</h2><p>\u5DE5\u5177\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StaticObjTest</span> <span class="token punctuation">{</span>
        <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
            <span class="token keyword">static</span> <span class="token class-name">ObjectHolder</span> staticObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ObjectHolder</span> instanceObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">void</span> foo

            <span class="token punctuation">{</span>
                <span class="token class-name">ObjectHolder</span> localObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectH01der</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;done&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ObjectHolder</span> <span class="token punctuation">{</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> main <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span>args<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">Test</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StaticObjTest<span class="token punctuation">.</span>Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                test<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>staticOBJ\u968F\u7740Test\u7684\u7C7B\u578B\u4FE1\u606F\u5B58\u653E\u5728\u65B9\u6CD5\u533A\uFF0C instanceOBJ\u968F\u7740Test\u7684\u5BF9\u8C61\u5B9E\u4F8B\u5B58\u653E\u5728JAVA\u5806\uFF0ClocalObject\u5219\u662F\u5B58\u653E\u5728foo()\u65B9\u6CD5\u6808\u5E27\u7684\u5C40\u90E8\u53D8\u91CF\u8868\u4E2D\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>hsdb&gt;scanoops 0x00007f32c7800000 0x00007f32c7b50000 JHSDB_TestCase$ObjectHolder
0x00007f32c7a7c458 JHSDB_TestCase$ObjectHolder
0x00007f32c7a7c480 JHSDB_TestCase$ObjectHolder
0x00007f32c7a7c490 JHSDB_TestCase$ObjectHolder
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD5\u53D1\u73B0\uFF1A\u4E09\u4E2A\u5BF9\u8C61\u7684\u6570\u636E\u5728\u5185\u5B58\u4E2D\u7684\u5730\u5740\u90FD\u843D\u5728Eden\u533A\u8303\u56F4\u5185\uFF0C\u6240\u4EE5\u7ED3\u8BBA\uFF1A\u53EA\u8981\u662F\u5BF9\u8C61\u5B9E\u4F8B\u5FC5\u7136\u4F1A\u5728Java\u5806\u4E2D\u5206\u914D</p><p>\u63A5\u7740\uFF0C\u627E\u5230\u4E86\u4E00\u4E2A\u5F15\u7528\u8BE5 staticon&gt;\u5BF9\u8C61\u7684\u5730\u65B9\uFF0C\u662F\u5728\u4E00\u4E2Ajava.1ang.C1ass\u7684\u5B9E\u4F8B\u91CC\uFF0C\u5E76\u4E14\u7ED9\u51FA\u4E86\u8FD9\u4E2A\u5B9E\u4F8B\u7684\u5730\u5740\uFF0C\u901A\u8FC7\u5DE5 nspector\u67E5\u770B\u8BE5\u5BF9\u8C61\u5B9E\u4F8B\uFF0C\u53EF\u4EE5\u6E05\u695A\u770B\u5230\u8FD9\u786E\u5B9E\u662F\u4E00\u4E2Ajava.1ang.C1ass\u7C7B\u578B\u7684\u5BF9\u8C61\u5B9E\u4F8B\uFF0C\u91CC\u9762\u6709\u4E00\u4E2A\u540D\u4E3A statical]\u7684\u5B9E\u4F8B\u5B57\u6BB5\uFF1A</p><p><img src="http://qnimg.gisfsde.com/work/image-20211201190914101.png" alt="image-20211201190914101" loading="lazy"></p><p>\u200B \u4ECE\u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u6240\u5B9A\u4E49\u7684\u6982\u5FF5\u6A21\u578B\u6765\u770B\uFF0C\u6240\u6709Class\u76F8\u5173\u7684\u4FE1\u606F\u90FD\u5E94\u8BE5\u5B58\u653E\u5728\u65B9\u6CD5\u533A\u4E4B\u4E2D\uFF0C\u4F46\u65B9\u6CD5\u533A\u8BE5\u5982\u4F55\u5B9E\u73B0\uFF0C\u300AJAVA\u865A\u62DF\u673A\u89C4\u8303\u300B\u5E76\u672A\u505A\u51FA\u89C4\u5B9A\uFF0C\u8FD9\u5C31\u6210\u4E86\u4E00\u4EF6\u5141\u8BB8\u4E0D\u540C\u865A\u62DF\u673A\u81EA\u5DF1\u7075\u6D3B\u628A\u63E1\u7684\u4E8B\u60C5\u3002<strong>JDK7\u53CA\u5176\u4EE5\u540E\u7248\u672C\u7684 HotSpot\u865A\u62DF\u673A\u9009\u62E9\u628A\u9759\u6001\u53D8\u91CF\u4E0E\u7C7B\u578B\u5728Java\u8BED\u8A00\u4E00\u7AEF\u7684\u6620\u5C04class\u5BF9\u8C61\u5B58\u653E\u5728\u4E00\u8D77\uFF0C\u5B58\u50A8\u4E8EJava\u5806\u4E4B\u4E2D\uFF0C\u4ECE\u6211\u4EEC\u7684\u5B9E\u9A8C\u4E2D\u4E5F\u660E\u786E\u9A8C\u8BC1\u4E86\u8FD9\u4E00\u70B9\u3002</strong></p><h2 id="_9-\u65B9\u6CD5\u533A\u5783\u573E\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#_9-\u65B9\u6CD5\u533A\u5783\u573E\u56DE\u6536" aria-hidden="true">#</a> 9.\u65B9\u6CD5\u533A\u5783\u573E\u56DE\u6536</h2><p>\u200B \u6709\u4E9B\u4EBA\u8BA4\u4E3A\u65B9\u6CD5\u533A(\u5982 HotSpot\u865A\u62DF\u673A\u4E2D\u7684\u5143\u7A7A\u95F4\u6216\u8005\u6C38\u4E45)\u662F\u6CA1\u6709\u5783\u573E\u6536\u96C6\u884C\u4E3A\u7684\uFF0C\u5176\u5B9E\u4E0D\u7136\u3002\u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u5BF9\u65B9\u6CD5\u533A\u7684\u7EA6\u675F\u662F\u975E\u5E38\u5BBD\u677E\u7684\uFF0C\u63D0\u5230\u8FC7\u53EF\u4EE5\u4E0D\u8981\u6C42\u865A\u62DF\u673A\u5728\u65B9\u6CD5\u533A\u4E2D\u5B9E\u73B0\u5783\u573E\u6536\u96C6\u3002\u4E8B\u5B9E\u4E0A\u4E5F\u786E\u5B9E\u6709\u672A\u5B9E\u73B0\u6216\u672A\u80FD\u5B8C\u6574\u5B9E\u73B0\u65B9\u6CD5\u533A\u7C7B\u578B\u5378\u8F7D\u7684\u6536\u96C6\u5668\u5B58\u5728(\u5982JDK11\u65F6\u671F\u7684ZGC\u6536\u96C6\u5668\u5C31\u4E0D\u652F\u6301\u7C7B\u5378\u8F7D)\u3002 \u200B \u4E00\u822C\u6765\u8BF4\u8FD9\u4E2A\u533A\u57DF\u7684\u56DE\u6536\u6548\u679C\u6BD4\u8F83\u96BE\u4EE4\u4EBA\u6EE1\u610F\uFF0C\u5C24\u5176\u662F<strong>\u7C7B\u578B\u7684\u5378\u8F7D\uFF0C\u6761\u4EF6\u76F8\u5F53\u82DB\u523B</strong>\u3002\u4F46\u662F\u8FD9\u90E8\u5206\u533A\u57DF\u7684\u56DE\u6536\u6709\u65F6\u53C8\u786E\u5B9E\u662F\u5FC5\u8981\u7684\u3002\u4EE5\u524DSun\u516C\u53F8\u7684Bug\u5217\u8868\u4E2D\uFF0C\u66FE\u51FA\u73B0\u8FC7\u7684\u82E5\u5E72\u4E2A\u4E25\u91CD\u7684Bug\u5C31\u662F\u7531\u4E8E\u4F4E\u7248\u672C\u7684 HotSpot\u865A\u62DF\u673A\u5BF9\u6B64\u533A\u57DF\u672A\u5B8C\u5168\u56DE\u6536\u800C\u5BFC\u81F4\u5185\u5B58\u6CC4\u6F0F\u3002 \u200B <strong>\u65B9\u6CD5\u533A\u7684\u5783\u573E\u6536\u96C6\u4E3B\u8981\u56DE\u6536\u4E24\u90E8\u5206\u5185\u5BB9\uFF1A\u5E38\u91CF\u6C60\u4E2D\u5E9F\u5F03\u7684\u5E38\u91CF\u548C\u4E0D\u518D\u4F7F\u7528\u7684\u7C7B\u578B\u3002</strong></p><p>\u200B \u5148\u6765\u8BF4\u8BF4\u65B9\u6CD5\u533A\u5185\u5E38\u91CF\u6C60\u4E4B\u4E2D\u4E3B\u8981\u5B58\u653E\u7684<strong>\u4E24\u5927\u7C7B\u5E38\u91CF</strong>\uFF1A\u5B57\u9762\u91CF\u548C\u7B26\u53F7\u5F15\u7528\u5B57\u9762\u91CF\u6BD4\u8F83\u63A5\u8FD1JAVA\u8BED\u8A00\u5C42\u6B21\u7684\u5E38\u91CF\u6982\u5FF5\uFF0C\u5982\u6587\u672C\u5B57\u7B26\u4E32\u3001\u88AB\u58F0\u660E\u4E3Afinal\u7684\u5E38\u91CF\u503C\u7B49\u3002\u800C\u7B26\u53F7\u5F15\u7528\u5219\u5C5E\u4E8E\u7F16\u8BD1\u539F\u7406\u65B9\u9762\u7684\u6982\u5FF5\uFF0C\u5305\u62EC\u4E0B\u9762\u4E09\u7C7B\u5E38\u91CF\uFF1A \u200B 1\u3001\u7C7B\u548C\u63A5\u53E3\u7684\u5168\u9650\u5B9A\u540D \u200B 2\u3001\u5B57\u6BB5\u7684\u540D\u79F0\u548C\u63CF\u8FF0\u7B26 \u200B 3\u3001\u65B9\u6CD5\u7684\u540D\u79F0\u548C\u63CF\u8FF0\u7B26 \u200B HotSpot,\u865A\u62DF\u673A\u5BF9\u5E38\u91CF\u6C60\u7684\u56DE\u6536\u7B56\u7565\u662F\u5F88\u660E\u786E\u7684\uFF0C<strong>\u53EA\u8981\u5E38\u91CF\u6C60\u4E2D\u7684\u5E38\u91CF\u6CA1\u6709\u88AB\u4EFB\u4F55\u5730\u65B9\u5F15\u7528\uFF0C\u5C31\u53EF\u4EE5\u88AB\u56DE\u6536\u3002</strong> \u200B \u56DE\u6536\u5E9F\u5F03\u5E38\u91CF\u4E0E\u56DE\u6536JAVA\u5806\u4E2D\u7684\u5BF9\u8C61\u975E\u5E38\u7C7B\u4F3C</p><p>\u200B \u5224\u5B9A\u4E00\u4E2A\u5E38\u91CF\u662F\u5426\u201C\u5E9F\u5F03\u201D\u8FD8\u662F\u76F8\u5BF9\u7B80\u5355\uFF0C\u800C\u8981<strong>\u5224\u5B9A\u4E00\u4E2A\u7C7B\u578B\u662F\u5426\u5C5E\u4E8E\u201C\u4E0D\u518D\u88AB\u4F7F\u7528\u7684\u7C7B\u201D\u7684\u6761\u4EF6\u5C31\u6BD4\u8F83\u82DB\u523B\u4E86\u3002\u9700\u8981\u540C\u65F6\u6EE1\u8DB3\u4E0B\u9762\u4E09\u4E2A\u6761\u4EF6</strong> \u200B \u8BE5\u7C7B\u6240\u6709\u7684\u5B9E\u4F8B\u90FD\u5DF2\u7ECF\u88AB\u56DE\u6536\uFF0C\u4E5F\u5C31\u662FJava\u5806\u4E2D\u4E0D\u5B58\u5728\u8BE5\u7C7B\u53CA\u5176\u4EFB\u4F55\u6D3E\u751F\u5B50\u7C7B\u7684\u5B9E\u4F8B\u3002 \u200B \u52A0\u8F7D\u8BE5\u7C7B\u7684\u7C7B\u52A0\u8F7D\u5668\u5DF2\u7ECF\u88AB\u56DE\u6536\uFF0C\u8FD9\u4E2A\u6761\u4EF6\u9664\u975E\u662F\u7ECF\u8FC7\u7CBE\u5FC3\u8BBE\u8BA1\u7684\u53EF\u66FF\u6362\u7C7B\u52A0\u8F7D\u5668\u7684\u573A\u666F\uFF0C\u5982OSGi\u3001JSP\u7684\u91CD\u52A0\u8F7D\u7B49\uFF0C\u5426\u5219\u901A\u5E38\u662F\u5F88\u96BE\u8FBE\u6210\u7684\u3002 \u200B \u8BE5\u7C7B\u5BF9\u5E94\u7684java.lang.Class\u5BF9\u8C61\u6CA1\u6709\u5728\u4EFB\u4F55\u5730\u65B9\u88AB\u5F15\u7528\uFF0C\u65E0\u6CD5\u5728\u4EFB\u4F55\u5730\u65B9\u901A\u8FC7\u53CD\u5C04\u8BBF\u95EE\u8BE5\u7C7B\u7684\u65B9\u6CD5\u3002 \u200B Java\u865A\u62DF\u673A\u88AB\u5141\u8BB8\u5BF9\u6EE1\u8DB3\u4E0A\u8FF0\u4E09\u4E2A\u6761\u4EF6\u7684\u65E0\u7528\u7C7B\u8FDB\u884C\u56DE\u6536\uFF0C\u8FD9\u91CC\u8BF4\u7684\u4EC5\u4EC5\u662F\u201C\u88AB\u5141\u8BB8\u201D\uFF0C\u800C\u5E76\u4E0D\u662F\u548C\u5BF9\u8C61\u4E00\u6837\uFF0C\u6CA1\u6709\u5F15\u7528\u4E86\u5C31\u5FC5\u7136\u4F1A\u56DE\u6536\u3002\u5173\u4E8E\u662F\u5426\u8981\u5BF9\u7C7B\u578B\u8FDB\u884C\u56DE\u6536\uFF0CHotSpot\u865A\u62DF\u673A\u63D0\u4F9B\u4E86-Xnoclassc\u53C2\u6570\u8FDB\u884C\u63A7\u5236\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528 -cverbose:class\u4EE5\u53CA -XX: +TracedClass- Loading\u3001-XX: TracedClassUnLoading\u67E5\u770B\u7C7B\u52A0\u8F7D\u548C\u5378\u8F7D\u4FE1\u606F\u3002 \u200B \u5728\u5927\u91CF\u4F7F\u7528\u53CD\u5C04\u3001\u52A8\u6001\u4EE3\u7406\u3001CGLib\u7B49\u5B57\u8282\u7801\u6846\u67B6\uFF0C\u52A8\u6001\u751F\u6210JSP\u4EE5\u53CASGi\u8FD9\u7C7B\u9891\u7E41\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u7684\u573A\u666F\u4E2D\uFF0C\u901A\u5E38\u90FD\u9700\u8981Java\u865A\u62DF\u673A\u5177\u5907\u7C7B\u578B\u5378\u8F7D\u7684\u80FD\u529B\uFF0C\u4EE5\u4FDD\u8BC1\u4E0D\u4F1A\u5BF9\u65B9\u6CD5\u533A\u9020\u6210\u8FC7\u5927\u7684\u5185\u5B58\u538B\u529B\u3002</p><h1 id="\u5341\u3001\u5BF9\u8C61\u7684\u5B9E\u4F8B\u5316\u5185\u5B58-\u5E03\u5C40\u4E0E\u8BBF\u95EE\u5B9A\u4F4D" tabindex="-1"><a class="header-anchor" href="#\u5341\u3001\u5BF9\u8C61\u7684\u5B9E\u4F8B\u5316\u5185\u5B58-\u5E03\u5C40\u4E0E\u8BBF\u95EE\u5B9A\u4F4D" aria-hidden="true">#</a> \u5341\u3001\u5BF9\u8C61\u7684\u5B9E\u4F8B\u5316\u5185\u5B58 \u5E03\u5C40\u4E0E\u8BBF\u95EE\u5B9A\u4F4D</h1><p><img src="http://qnimg.gisfsde.com/\u7B2C10\u7AE0_\u5BF9\u8C61\u7684\u5185\u5B58\u5E03\u5C40.jpg" alt="\u7B2C10\u7AE0_\u5BF9\u8C61\u7684\u5185\u5B58\u5E03\u5C40" loading="lazy"></p><h2 id="_1-\u5BF9\u8C61\u5B9E\u4F8B\u5316\u7684\u51E0\u79CD\u65B9\u5F0F" tabindex="-1"><a class="header-anchor" href="#_1-\u5BF9\u8C61\u5B9E\u4F8B\u5316\u7684\u51E0\u79CD\u65B9\u5F0F" aria-hidden="true">#</a> 1.\u5BF9\u8C61\u5B9E\u4F8B\u5316\u7684\u51E0\u79CD\u65B9\u5F0F</h2><p><img src="http://qnimg.gisfsde.com/\u7B2C10\u7AE0_\u5BF9\u8C61\u7684\u5B9E\u4F8B\u5316.jpg" alt="\u7B2C10\u7AE0_\u5BF9\u8C61\u7684\u5B9E\u4F8B\u5316" loading="lazy"></p><h2 id="_2-\u521B\u5EFA\u5BF9\u8C61\u7684\u6B65\u9AA4" tabindex="-1"><a class="header-anchor" href="#_2-\u521B\u5EFA\u5BF9\u8C61\u7684\u6B65\u9AA4" aria-hidden="true">#</a> 2.\u521B\u5EFA\u5BF9\u8C61\u7684\u6B65\u9AA4</h2><h3 id="_1-\u5224\u65AD\u5BF9\u8C61\u5BF9\u5E94\u7684\u7C7B\u662F\u5426\u52A0\u8F7D\u3001\u94FE\u63A5\u3001\u521D\u59CB\u5316" tabindex="-1"><a class="header-anchor" href="#_1-\u5224\u65AD\u5BF9\u8C61\u5BF9\u5E94\u7684\u7C7B\u662F\u5426\u52A0\u8F7D\u3001\u94FE\u63A5\u3001\u521D\u59CB\u5316" aria-hidden="true">#</a> 1.\u5224\u65AD\u5BF9\u8C61\u5BF9\u5E94\u7684\u7C7B\u662F\u5426\u52A0\u8F7D\u3001\u94FE\u63A5\u3001\u521D\u59CB\u5316</h3><p>\u200B \u865A\u62DF\u673A\u9047\u5230\u4E00\u6761new\u6307\u4EE4\uFF0C\u9996\u5148\u53BB\u68C0\u67FB\u8FD9\u4E2A\u6307\u4EE4\u7684\u53C2\u6570\u80FD\u5426\u5728 Metaspace\u7684\u5E38\u91CF\u6C60\u4E2D\u5B9A\u4F4D\u5230\u4E00\u4E2A\u7C7B\u7684\u7B26\u53F7\u5F15\u7528\uFF0C\u5E76\u4E14\u68C0\u67E5\u8FD9\u4E2A\u7B26\u53F7\u5F15\u7528\u4EE3\u8868\u7684\u7C7B\u662F\u5426\u5DF2\u7ECF\u88AB\u52A0\u8F7D\u3001\u89E3\u6790\u548C\u521D\u59CB\u5316\u3002\uFF08\u5373\u5224\u65AD\u7C7B\u5143\u4FE1\u606F\u662F\u5426\u5B58\u5728\uFF09\u3002\u5982\u679C\u6CA1\u6709\uFF0C\u90A3\u4E48\u5728\u53CC\u4EB2\u59D4\u6D3E\u6A21\u5F0F\u4E0B\uFF0C\u4F7F\u7528\u5F53\u524D\u7C7B\u52A0\u8F7D\u5668\u4EE5classloader \u5305\u540D \u7C7B\u540D\u4E3AKey\u8FDB\u884C\u67E5\u627E\u5BF9\u5E94\u7684\uFF0Cclass\u6587\u4EF6\u3002\u5982\u679C\u6CA1\u6709\u627E\u5230\u6587\u4EF6\uFF0C\u5219\u629B\u51FAClassnotfound Exception\u5F02\u5E38\uFF0C\u5982\u679C\u627E\u5230\uFF0C\u5219\u8FDB\u884C\u7C7B\u52A0\u8F7D\uFF0C\u5E76\u751F\u6210\u5BF9\u5E94\u7684class\u7C7B\u5BF9\u8C61</p><h3 id="_2-\u4E3A\u5BF9\u8C61\u5206\u914D\u5185\u5B58" tabindex="-1"><a class="header-anchor" href="#_2-\u4E3A\u5BF9\u8C61\u5206\u914D\u5185\u5B58" aria-hidden="true">#</a> 2.\u4E3A\u5BF9\u8C61\u5206\u914D\u5185\u5B58</h3><p>\u200B \u9996\u5148\u8BA1\u7B97\u5BF9\u8C61\u5360\u7528\u7A7A\u95F4\u5927\u5C0F\uFF0C\u63A5\u7740\u5728\u5806\u4E2D\u5212\u5206\u4E00\u5757\u5185\u5B58\u7ED9\u65B0\u5BF9\u8C61\u3002\u5982\u679C\u5B9E\u4F8B\u6210\u5458\u53D8\u91CF\u662F\u5F15\u7528\u53D8\u91CF\uFF0C\u4EC5\u5206\u914D\u5F15\u7528\u53D8\u91CF\u7A7A\u95F4\u5373\u53EF\uFF0C\u53734\u4E2A\u5B57\u8282\u5927\u5C0F\u3002 <strong>\u5982\u679C\u5185\u5B58\u89C4\u6574\uFF0C\u4F7F\u7528\u6307\u9488\u78B0\u649E</strong> \u200B \u5982\u679C\u5185\u5B58\u662F\u89C4\u6574\u7684\uFF0C\u90A3\u4E48\u865A\u62DF\u673A\u5C06\u91C7\u7528\u7684\u662F\u6307\u9488\u78B0\u649E\u6CD5( Bump The Pointer)\u6765\u4E3A\u5BF9\u8C61\u5206\u914D\u5185\u5B58\u3002\u610F\u601D\u662F\u6240\u6709\u7528\u8FC7\u7684\u5185\u5B58\u5728\u4E00\u8FB9\uFF0C\u7A7A\u95F2\u7684\u5185\u5B58\u5728\u53E6\u5916\u4E00\u8FB9\uFF0C\u4E2D\u95F4\u653E\u7740\u4E00\u4E2A\u6307\u9488\u4F5C\u4E3A\u5206\u754C\u70B9\u7684\u6307\u793A\u5668\uFF0C\u5206\u914D\u5185\u5B58\u5C31\u4EC5\u4EC5\u662F\u628A\u6307\u9488\u5411\u7A7A\u95F2\u90A3\u8FB9\u632A\u52A8\u4E00\u6BB5\u4E0E\u5BF9\u8C61\u5927\u5C0F\u76F8\u7B49\u7684\u8DDD\u79BB\u7F62\u4E86\u3002\u5982\u679C\u5783\u573E\u6536\u96C6\u5668\u9009\u62E9\u7684\u662F Serial\u3001 Pardew\u8FD9\u79CD\u57FA\u4E8E\u538B\u7F29\u7B97\u6CD5\u7684\uFF0C\u865A\u62DF\u673A\u91C7\u7528\u8FD9\u79CD\u5206\u914D\u65B9\u5F0F\u3002\u822C\u4F7F\u7528\u5E26\u6709 compact\uFF08\u6574\u7406\uFF09\u8FC7\u7A0B\u7684\u6536\u96C6\u5668\u65F6\uFF0C\u4F7F\u7528\u6307\u9488\u78B0\u649E\u3002 <strong>\u5982\u679C\u5185\u5B58\u4E0D\u89C4\u6574\uFF0C\u865A\u62DF\u673A\u9700\u8981\u7EF4\u62A4\u4E00\u4E2A\u5217\u8868\uFF0C\u4F7F\u7528\u7A7A\u95F2\u5217\u8868\u5206\u914D</strong> \u200B \u5982\u679C\u5185\u5B58\u4E0D\u662F\u89C4\u6574\u7684\uFF0C\u5DF2\u4F7F\u7528\u7684\u5185\u5B58\u548C\u672A\u4F7F\u7528\u7684\u5185\u5B58\u76F8\u4E92\u4EA4\u9519\uFF0C\u90A3\u4E48\u865A\u62DF\u673A\u5C06\u91C7\u7528\u7684\u662F\u7A7A\u95F2\u5217\u8868\u6CD5\u6765\u4E3A\u5BF9\u8C61\u5206\u914D\u5185\u5B58\u3002\u610F\u601D\u662F\u865A\u62DF\u673A\u7EF4\u62A4\u4E86\u4E00\u4E2A\u5217\u8868\uFF0C\u8BB0\u5F55\u4E0A\u54EA\u4E9B\u5185\u5B58\u5757\u662F\u53EF\u7528\u7684\uFF0C\u518D\u5206\u914D\u7684\u65F6\u5019\u4ECE\u5217\u8868\u4E2D\u627E\u5230\u4E00\u5757\u8DB3\u591F\u5927\u7684\u7A7A\u95F4\u5212\u5206\u7ED9\u5BF9\u8C61\u5B9E\u4F8B\uFF0C\u5E76\u66F4\u65B0\u5217\u8868\u4E0A\u7684\u5185\u5BB9\u3002\u8FD9\u79CD\u5206\u914D\u65B9\u5F0F\u6210\u4E3A\u201C\u7A7A\u95F2\u5217\u8868( Free List)\u201D \u8BF4\u660E\uFF1A\u9009\u62E9\u54EA\u79CD\u5206\u914D\u65B9\u5F0F\u7531Java\u5806\u662F\u5426\u89C4\u6574\u51B3\u5B9A\uFF0C\u800CJAVA\u5806\u662F\u5426\u89C4\u6574\u53C8\u7531\u6240\u91C7\u7528\u7684\u5783\u573E\u6536\u96C6\u5668\u662F\u5426\u5E26\u6709\u538B\u7F29\u6574\u7406\u529F\u80FD\u51B3\u5B9A\u3002</p><h3 id="_3-\u5904\u7406\u5E76\u53D1\u5B89\u5168\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_3-\u5904\u7406\u5E76\u53D1\u5B89\u5168\u95EE\u9898" aria-hidden="true">#</a> 3.\u5904\u7406\u5E76\u53D1\u5B89\u5168\u95EE\u9898</h3><p>\u200B \u5728\u5206\u914D\u5185\u5B58\u7A7A\u95F4\u65F6\uFF0C\u53E6\u5916\u4E00\u4E2A\u95EE\u9898\u662F\u53CA\u65F6\u4FDD\u8BC1new\u5BF9\u8C61\u65F6\u5019\u7684\u7EBF\u7A0B\u5B89\u5168\u6027\uFF1A\u521B\u5EFA\u5BF9\u8C61\u662F\u975E\u5E38\u9891\u7E41\u7684\u64CD\u4F5C\uFF0C\u865A\u62DF\u673A\u9700\u8981\u89E3\u51B3\u5E76\u53D1\u95EE\u9898\u3002\u865A\u62DF\u673A\u91C7\u7528\u4E86\u4E24\u79CD\u65B9\u5F0F\u89E3\u51B3\u5E76\u53D1\u95EE\u9898: \u30FBCAS( Compare And Swap)\u5931\u8D25\u91CD\u8BD5\u3001\u533A\u57DF\u52A0\u9501\uFF1A\u4FDD\u8BC1\u6307\u9488\u66F4\u65B0\u64CD\u4F5C\u7684\u539F\u5B50\u6027\uFF1B \u30FBTLAB\u628A\u5185\u5B58\u5206\u914D\u7684\u52A8\u4F5C\u6309\u7167\u7EBF\u7A0B\u5212\u5206\u5728\u4E0D\u540C\u7684\u7A7A\u95F4\u4E4B\u4E2D\u8FDB\u884C\uFF0C\u5373\u6BCF\u4E2A\u7EBF\u7A0B\u5728JAVA\u5806\u4E2D\u9884\u5148\u5206\u914D\u4E00\u5C0F\u5757\u5185\u5B58\uFF0C\u79F0\u4E3A\u672C\u5730\u7EBF\u7A0B\u5206\u914D\u7F13\u51B2\u533A\uFF0C\uFF08TLAB, Thread Local All ocation Buffer)\u865A\u62DF\u673A\u662F\u5426\u4F7F\u7528TLAB,\u53EF\u4EE5\u901A\u8FC7-XX:+/- UseTLAB\u53C2\u6570\u6765\u8BBE\u5B9A\u3002</p><h3 id="_4-\u521D\u59CB\u5316\u5206\u914D\u5230\u7684\u7A7A\u95F4" tabindex="-1"><a class="header-anchor" href="#_4-\u521D\u59CB\u5316\u5206\u914D\u5230\u7684\u7A7A\u95F4" aria-hidden="true">#</a> 4,\u521D\u59CB\u5316\u5206\u914D\u5230\u7684\u7A7A\u95F4</h3><p>\u200B \u5185\u5B58\u5206\u914D\u7ED3\u675F\uFF0C\u865A\u62DF\u673A\u5C06\u5206\u914D\u5230\u7684\u5185\u5B58\u7A7A\u95F4\u90FD\u521D\u59CB\u5316\u4E3A\u96F6\u503C\uFF08\u4E0D\u5305\u62EC\u5BF9\u8C61\u5934\uFF09\u3002\u8FD9\u4E00\u6B65\u4FDD\u8BC1\u4E86\u5BF9\u8C61\u7684\u5B9E\u4F8B\u5B57\u6BB5\u5728JAVA\u4EE3\u7801\u4E2D\u53EF\u4EE5\u4E0D\u7528\u8D4B\u521D\u59CB\u503C\u5C31\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\uFF0C\u7A0B\u5E8F\u80FD\u8BBF\u95EE\u5230\u8FD9\u4E9B\u5B57\u6BB5\u7684\u6570\u636E\u7C7B\u578B\u6240\u5BF9\u5E94\u7684\u96F6\u503C\u3002</p><h3 id="_5-\u8BBE\u7F6E\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934" tabindex="-1"><a class="header-anchor" href="#_5-\u8BBE\u7F6E\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934" aria-hidden="true">#</a> 5,\u8BBE\u7F6E\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934</h3><p>\u200B \u5C06\u5BF9\u8C61\u7684\u6240\u5C5E\u7C7B\uFF08\u5373\u7C7B\u7684\u5143\u6570\u636E\u4FE1\u606F\uFF09\u3001\u5BF9\u8C61\u7684 Hashcode,\u548C\u5BF9\u8C61\u7684GC\u4FE1\u606F\u3001\u9501\u4FE1\u606F\u7B49\u6570 \u636E\u5B58\u50A8\u5728\u5BF9\u8C61\u7684\u5BF9\u8C61\u5934\u4E2D\u3002\u8FD9\u4E2A\u8FC7\u7A0B\u7684\u5177\u4F53\u8BBE\u7F6E\u65B9\u5F0F\u53D6\u51B3\u4E8EJVM\u5B9E\u73B0\u3002</p><h3 id="_6-\u6267\u884Cinit\u65B9\u6CD5\u8FDB\u884C\u521D\u59CB\u5316" tabindex="-1"><a class="header-anchor" href="#_6-\u6267\u884Cinit\u65B9\u6CD5\u8FDB\u884C\u521D\u59CB\u5316" aria-hidden="true">#</a> 6,\u6267\u884Cinit\u65B9\u6CD5\u8FDB\u884C\u521D\u59CB\u5316</h3><p>\u200B \u5728Java\u7A0B\u5E8F\u7684\u89C6\u89D2\u770B\u6765\uFF0C\u521D\u59CB\u5316\u624D\u6B63\u5F0F\u5F00\u59CB\u3002\u521D\u59CB\u5316\u6210\u5458\u53D8\u91CF\uFF0C\u6267\u884C\u5B9E\u4F8B\u5316\u4EE3\u7801\u5757\uFF0C\u8C03\u7528\u7C7B\u7684\u6784\u9020\u65B9\u6CD5\uFF0C\u5E76\u628A\u5806\u5185\u5BF9\u8C61\u7684\u9996\u5730\u5740\u8D4B\u503C\u7ED9\u5F15\u7528\u53D8\u91CF\u3002\u56E0\u6B64\u4E00\u822C\u6765\u8BF4(\u7531\u5B57\u8282\u7801\u4E2D\u662F\u5426\u8DDF\u968F\u6709invokespecial\u6307\u4EE4\u6240\u51B3\u5B9A)\uFF0Cnew\u6307\u4EE4\u4E4B\u540E\u4F1A\u63A5\u7740\u5C31\u662F\u6267\u884C\u65B9\u6CD5\uFF0C\u628A\u5BF9\u8C61\u6309\u7167\u7A0B\u5E8F\u5458\u7684\u610F\u613F\u8FDB\u884C\u521D\u59CB\u5316\uFF0C\u8FD9\u6837\u4E00\u4E2A\u771F\u6B63\u53EF\u7528\u7684\u5BF9\u8C61\u624D\u7B97\u5B8C\u5168\u521B\u5EFA\u51FA\u6765\u3002</p><h2 id="_3-\u5BF9\u8C61\u7684\u5185\u5B58\u5E03\u5C40" tabindex="-1"><a class="header-anchor" href="#_3-\u5BF9\u8C61\u7684\u5185\u5B58\u5E03\u5C40" aria-hidden="true">#</a> 3.\u5BF9\u8C61\u7684\u5185\u5B58\u5E03\u5C40</h2><p><img src="http://qnimg.gisfsde.com/\u7B2C10\u7AE0_\u5185\u5B58\u5E03\u5C40.jpg" alt="\u7B2C10\u7AE0_\u5185\u5B58\u5E03\u5C40" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/\u7B2C10\u7AE0_\u56FE\u793A\u5BF9\u8C61\u7684\u5185\u5B58\u5E03\u5C40.jpg" alt="\u7B2C10\u7AE0_\u56FE\u793A\u5BF9\u8C61\u7684\u5185\u5B58\u5E03\u5C40" loading="lazy"></p><h2 id="_4-\u5BF9\u8C61\u8BBF\u95EE\u5B9A\u4F4D" tabindex="-1"><a class="header-anchor" href="#_4-\u5BF9\u8C61\u8BBF\u95EE\u5B9A\u4F4D" aria-hidden="true">#</a> 4.\u5BF9\u8C61\u8BBF\u95EE\u5B9A\u4F4D</h2><p><img src="http://qnimg.gisfsde.com/\u7B2C10\u7AE0_\u5BF9\u8C61\u8BBF\u95EE\u5B9A\u4F4D.jpg" alt="\u7B2C10\u7AE0_\u5BF9\u8C61\u8BBF\u95EE\u5B9A\u4F4D" loading="lazy"></p><img src="http://qnimg.gisfsde.com/\u7B2C10\u7AE0_\u65B9\u5F0F1\uFF1A\u53E5\u67C4\u8BBF\u95EE.jpg" alt="\u7B2C10\u7AE0_\u65B9\u5F0F1\uFF1A\u53E5\u67C4\u8BBF\u95EE" style="zoom:50%;"><img src="http://qnimg.gisfsde.com/\u7B2C10\u7AE0_\u65B9\u5F0F2\uFF1A\u4F7F\u7528\u76F4\u63A5\u6307\u9488\u8BBF\u95EE.jpg" alt="\u7B2C10\u7AE0_\u65B9\u5F0F2\uFF1A\u4F7F\u7528\u76F4\u63A5\u6307\u9488\u8BBF\u95EE" style="zoom:50%;"><img src="http://qnimg.gisfsde.com/\u7B2C10\u7AE0_\u53E5\u67C4\u8BBF\u95EE\u5BF9\u8C61-\u4E34\u65F6.jpg" alt="\u7B2C10\u7AE0_\u53E5\u67C4\u8BBF\u95EE\u5BF9\u8C61-\u4E34\u65F6" style="zoom:50%;"><h1 id="\u5341\u4E00\u3001\u76F4\u63A5\u5185\u5B58" tabindex="-1"><a class="header-anchor" href="#\u5341\u4E00\u3001\u76F4\u63A5\u5185\u5B58" aria-hidden="true">#</a> \u5341\u4E00\u3001<em>\u76F4\u63A5\u5185\u5B58</em></h1><p>\u30FB\u4E0D\u662F\u865A\u62DF\u673A\u8FD0\u884C\u65F6\u6570\u636E\u533A\u7684\u4E00\u90E8\u5206\uFF0C\u4E5F\u4E0D\u662F\u300AJava\u865A\u62DF\u673A\u89C4\u8303\u300B\u4E2D\u5B9A\u4E49\u7684\u5185\u5B58\u533A\u57DF\u3002 \u30FB\u76F4\u63A5\u5185\u5B58\u662F\u5728Java\u5806\u5916\u7684\u3001\u76F4\u63A5\u5411\u7CFB\u7EDF\u7533\u8BF7\u7684\u5185\u5B58\u533A\u95F4\u3002 \u6765\u6E90\u4E8ENIO,\u901A\u8FC7\u5B58\u5728\u5806\u4E2D\u7684 Directbytebuffer\u64CD\u4F5C Native\u5185\u5B58 \u30FB\u901A\u5E38\uFF0C\u8BBF\u95EE\u76F4\u63A5\u5185\u5B58\u7684\u901F\u5EA6\u4F1A\u4F18\u4E8EJava\u5806\u3002\u5373\u8BFB\u5199\u6027\u80FD\u9AD8\u3002\u56E0\u6B64\u51FA\u4E8E\u6027\u80FD\u8003\u8651\uFF0C\u8BFB\u5199\u9891\u7E41\u7684\u573A\u5408\u53EF\u80FD\u4F1A\u8003\u8651\u4F7F\u7528\u76F4\u63A5\u5185\u5B58\u3002 Java\u7684NIO\u5E93\u5141\u8BB8Java\u7A0B\u5E8F\u4F7F\u7528\u76F4\u63A5\u5185\u5B58\uFF0C\u7528\u4E8E\u6570\u636E\u7F13\u51B2\u533A</p><p>\u975E\u76F4\u63A5\u7F13\u5B58\uFF1A\u8BFB\u5199\u6587\u4EF6\uFF0C\u9700\u8981\u4E0E\u78C1\u76D8\u4EA4\u4E92\uFF0C\u9700\u8981\u7531\u7528\u6237\u6001\u5207\u6362\u5230\u5185\u6838\u6001\u3002\u5728\u5185\u6838\u6001\u65F6\uFF0C\u9700\u8981\u5185\u5B58\u5982\u53F3\u56FE\u7684\u64CD\u4F5C\u3002 \u4F7F\u7528\uFF74O,\u89C1\u53F3\u56FE\u3002\u8FD9\u91CC\u9700\u8981\u4E24\u4EFD\u5185\u5B58\u5B58\u50A8\u91CD\u590D\u6570\u636E\uFF0C\u6548\u7387\u4F4E\u3002</p><p>\u76F4\u63A5\u7F13\u5B58\uFF1A\u4F7F\u7528NIO\u65F6\uFF0C\u5982\u56FE\u3002\u64CD\u4F5C\u7CFB\u7EDF\u5212\u51FA\u7684\u76F4\u63A5\u7F13\u5B58\u533A\u53EF\u4EE5\u88ABjava\u4EE3\u7801\u76F4\u63A5\u8BBF\u95EE\uFF0C\u53EA\u6709\u4E00\u4EFD\u3002NIO\u9002\u5408\u5BF9\u5927\u6587\u4EF6\u7684\u8BFB\u5199\u64CD\u4F5C\u3002</p><p><img src="http://qnimg.gisfsde.com/image-20211204181442675.png" alt="image-20211204181442675" loading="lazy"></p><p>\u76F4\u63A5\u5185\u5B58\u4E5F\u53EF\u80FD\u5BFC\u81F4 Outofmemoryerror\u5F02\u5E38\uFF0C\u7531\u4E8E\u76F4\u63A5\u5185\u5B58\u5728Java\u5806\u5916\uFF0C\u56E0\u6B64\u5B83\u7684\u5927\u5C0F\u4E0D\u4F1A\u76F4\u63A5\u53D7\u9650\u4E8E-Xmx\u6307\u5B9A\u7684\u6700\u5927\u5806\u5927\u5C0F\uFF0C\u4F46\u662F\u7CFB\u7EDF\u5185\u5B58\u662F\u6709\u9650\u7684\uFF0CJava\u5806\u548C\u76F4\u63A5\u5185\u5B58\u7684\u603B\u548C\u4F9D\u7136\u53D7\u9650\u4E8E\u64CD\u4F5C\u7CFB\u7EDF\u80FD\u7ED9\u51FA\u7684\u6700\u5927\u5185\u5B58\u3002 <strong>\u7F3A\u70B9\uFF1A</strong> \u5206\u914D\u56DE\u6536\u6210\u672C\u8F83\u9AD8 \u4E0D\u53D7JVM\u5185\u5B58\u56DE\u6536\u7BA1\u7406 \u76F4\u63A5\u5185\u5B58\u5927\u5C0F\u53EF\u4EE5\u901A\u8FC7 MaxDlrectMemorySize\u5982\u679C\u4E0D\u6307\u5B9A\uFF0C\u9ED8\u8BA4\u4E0E\u5806\u7684\u6700\u5927\u503C\u4E00Xmx\u53C2\u6570\u503C\u4E00\u81F4</p><h1 id="\u5341\u4E8C\u3001\u6267\u884C\u5F15\u64CE" tabindex="-1"><a class="header-anchor" href="#\u5341\u4E8C\u3001\u6267\u884C\u5F15\u64CE" aria-hidden="true">#</a> \u5341\u4E8C\u3001<em>\u6267\u884C\u5F15\u64CE</em></h1><h1 id="\u5341\u4E09\u3001stringtable" tabindex="-1"><a class="header-anchor" href="#\u5341\u4E09\u3001stringtable" aria-hidden="true">#</a> \u5341\u4E09\u3001StringTable</h1><h2 id="_1-string\u7684\u57FA\u672C\u7279\u6027" tabindex="-1"><a class="header-anchor" href="#_1-string\u7684\u57FA\u672C\u7279\u6027" aria-hidden="true">#</a> 1.String\u7684\u57FA\u672C\u7279\u6027</h2><p><strong>String:\u5B57\u7B26\u4E32,\u4F7F\u7528\u4E00\u5BF9&quot; &quot;\u5F15\u8D77\u6765\u8868\u793A.</strong> \u30FB string s1=&quot; atgulqu&quot;;//\u5B57\u9762\u91CF\u7684\u5B9A\u4E49\u65B9\u5F0F \u30FB string s2= new String(&quot;hello&quot;)\uFF1B <strong>string\u58F0\u660E\u4E3Afinal\u7684,\u4E0D\u53EF\u88AB\u7EE7\u627F</strong> \u30FB string\u5B9E\u73B0\u4E86 Serializable\u63A5\u53E3:\u8868\u793A\u5B57\u7B26\u4E32\u662F\u652F\u6301\u5E8F\u5217\u5316\u7684. \u5B9E\u73B0\u4E86 Comparable\u63A5\u53E3:\u8868\u793A string\u53EF\u4EE5\u6BD4\u8F83\u5927\u5C0F \u30FB String\u5728jdk8\u53CA\u4EE5\u524D\u5185\u90E8\u5B9A\u4E49\u4E86 final char\u3010\u3011 value\u7528\u4E8E\u5B58\u50A8\u5B57\u7B26\u4E32\u6570\u636E.jk9\u65F6\u6539\u4E3Abyte\u3010\u3011\u52A0\u4E0A\u7F16\u7801\u6807\u8BB0 \u4EE5\u8282\u7EA6\u7A7A\u95F4\u3002StringBuffer\u4E0EStringBuilder\u540C\u6B65\u4FEE\u6539\u3002 <strong>string:\u4EE3\u8868\u4E0D\u53EF\u53D8\u7684\u5B57\u7B26\u5E8F\u5217.\u7B80\u79F0:\u4E0D\u53EF\u53D8\u6027.</strong></p><p>\u5F53\u5BF9\u5B57\u7B26\u4E32\u91CD\u65B0\u8D4B\u503C\u65F6,\u9700\u8981\u91CD\u5199\u6307\u5B9A\u5185\u5B58\u533A\u57DF\u8D4B\u503C,\u4E0D\u80FD\u4F7F\u7528\u539F\u6709\u7684value\u8FDB\u884C\u8D4B\u503C. \u5F53\u5BF9\u73B0\u6709\u7684\u5B57\u7B26\u4E32\u8FDB\u884C\u8FDE\u63A5\u64CD\u4F5C\u65F6,\u4E5F\u9700\u8981\u91CD\u65B0\u6307\u5B9A\u5185\u5B58\u533A\u57DF\u8D4B\u503C,\u4E0D\u80FD\u4F7F\u7528\u539F\u6709\u7684value\u8FDB\u884C\u8D4B\u503C. \u5F53\u8C03\u7528 string\u7684 replace()\u65B9\u6CD5\u4FEE\u6539\u6307\u5B9A\u5B57\u7B26\u6216\u5B57\u7B26\u4E32\u65F6,\u4E5F\u9700\u8981\u91CD\u65B0\u6307\u5B9A\u5185\u5B58\u533A\u57DF\u8D4B\u503C,\u4E0D\u80FD\u4F7F\u7528\u539F\u6709\u7684value\u8FDB\u884C\u8D4B\u503C \u901A\u8FC7\u5B57\u9762\u91CF\u7684\u65B9\u5F0F(\u533A\u522B\u4E8Enew)\u7ED9\u4E00\u4E2A\u5B57\u7B26\u4E32\u8D4B\u503C,\u6B64\u65F6\u7684\u5B57\u7B26\u4E32\u503C\u58F0\u660E\u5728\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D.</p><p><strong>\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u662F\u4E0D\u4F1A\u5B58\u50A8\u76F8\u540C\u5185\u5BB9\u7684\u5B57\u7B26\u4E32\u7684</strong> Stringl\u7684 String Pool\u662F\u4E00\u4E2A\u56FA\u5B9A\u5927\u5C0F\u7684 Hashtable,\u9ED8\u8BA4\u503C\u5927\u5C0F\u957F\u5EA6\u662F1009.\u5982\u679C\u653E\u8FDB string Pool\u7684String\u975E\u5E38\u591A,\u5C31\u4F1A\u9020\u6210Hash\u51B2\u4E25\u91CD,\u4ECE\u800C\u5BFC\u81F4\u94FE\u8868\u4F1A\u5F88\u957F,\u800C\u94FE\u8868\u957F\u4E86\u540E\u76F4\u63A5\u4F1A\u9020\u6210\u7684\u5F71\u54CD\u5C31\u662F\u5F53\u8C03\u7528 String. internl\u65F6\u6027\u80FD\u4F1A\u5927\u5E45\u4E0B\u964D. \u4F7F\u7528-XX: StringTableSize\u53EF\u8BBE\u7F6E StringTable\u7684\u957F\u5EA6 \u5728jdk6\u4E2D StringTable\u662F\u56FA\u5B9A\u7684,\u5C31\u662F1009\u7684\u957F\u5EA6,\u6240\u4EE5\u5982\u679C\u5E38\u91CF\u6C60\u4E2D\u7684\u5B57\u7B26\u4E32\u8FC7\u591A\u5C31\u4F1A\u5BFC\u81F4\u6548\u7387\u4E0B\u964D\u5F88\u5FEB. StringTableSize\u8BBE\u7F6E\u6CA1\u6709\u8981\u6C42 \u5728jdk7\u4E2D\uFF0C Stringtable\u7684\u957F\u5EA6\u9ED8\u8BA4\u503C\u662F60013, StringTableSize\u8BBE\u7F6E\u6CA1\u6709\u8981\u6C42 Jdk8\u5F00\u59CB\uFF0C\u8BBE\u7F6E StringTable\u7684\u957F\u5EA6\u7684\u8BDD\uFF0C1009\u662F\u53EF\u8BBE\u7F6E\u7684\u6700\u5C0F\u503C\u3002</p><h2 id="_2-string\u7684\u5185\u5B58\u5206\u914D" tabindex="-1"><a class="header-anchor" href="#_2-string\u7684\u5185\u5B58\u5206\u914D" aria-hidden="true">#</a> 2.String\u7684\u5185\u5B58\u5206\u914D</h2>`,73),ua=n('\u200B \u5728Java\u8BED\u8A00\u4E2D\u67098\u79CD\u57FA\u672C\u6570\u636E\u7C7B\u578B\u548C\u4E00\u79CD\u6BD4\u8F83\u7279\u6B8A\u7684\u7C7B\u578B string\u3002\u8FD9\u4E9B\u7C7B\u578B\u4E3A\u4E86\u4F7F\u5B83\u4EEC\u5728\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u901F\u5EA6\u66F4\u5FEB\u3001\u66F4\u8282\u7701\u5185\u5B58\uFF0C\u90FD\u63D0\u4F9B\u4E86\u4E00\u79CD\u5E38\u91CF\u6C60\u7684\u6982\u5FF5\u3002\u5E38\u91CF\u6C60\u5C31\u7C7B\u4F3C\u4E00\u4E2AJava\u7CFB\u7EDF\u7EA7\u522B\u63D0\u4F9B\u7684\u7F13\u5B58\u30028\u79CD\u57FA\u672C\u6570\u636E\u7C7B\u578B\u7684\u5E38\u91CF\u6C60\u90FD\u662F\u7CFB\u7EDF\u534F\u8C03\u7684\uFF0CString\u7C7B\u578B\u7684\u5E38\u91CF\u6C60\u6BD4\u8F83\u7279\u6B8A\u3002\u5B83\u7684\u4E3B\u8981\u4F7F\u7528\u65B9\u6CD5\u6709\u4E24\u79CD\uFF1A \u76F4\u63A5\u4F7F\u7528\u53CC\u5F15\u53F7\u58F0\u660E\u51FA\u6765\u7684 string\u5BF9\u8C61\u4F1A\u76F4\u63A5\u5B58\u50A8\u5728\u5E38\u91CF\u6C60\u4E2D\u3002\u6BD4\u5982\uFF1AStringinfo="'),ma={href:"http://atqulgu.com",target:"_blank",rel:"noopener noreferrer"},ka=n("atqulgu.com"),ha=n('"; \u5982\u679C\u4E0D\u662F\u7528\u53CC\u5F15\u53F7\u58F0\u660E\u7684 string\u5BF9\u8C61\uFF0C\u53EF\u4EE5\u4F7F\u7528 string\u63D0\u4F9B\u7684 Intern\uFF08\uFF09\u65B9\u6CD5\u3002'),ga=s(`<p>Java6\u53CA\u4EE5\u524D\uFF0C\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u5B58\u653E\u5728\u6C38\u4E45\u4EE3\u3002 Java7 \u4E2D Oracle\u7684\u5DE5\u7A0B\u5E08\u5BF9\u5B57\u7B26\u4E32\u6C60\u7684\u903B\u8F91\u505A\u4E86\u5F88\u5927\u7684\u6539\u53D8\uFF0C\u5373\u5C06\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u7684\u4F4D\u7F6E\u8C03\u6574\u5230Java\u5806\u5185\u3002 \u6240\u6709\u7684\u5B57\u7B26\u4E32\u90FD\u4FDD\u5B58\u5728\u5806(Heap)\u4E2D\uFF0C\u548C\u5176\u4ED6\u666E\u901A\u5BF9\u8C61\u4E00\u6837\uFF0C\u8FD9\u6837\u53EF\u4EE5\u8BA9\u4F60\u5728\u8FDB\u884C\u8C03\u4F18\u5E94\u7528\u65F6\u4EC5\u9700\u8981\u8C03\u6574\u5806\u5927\u5C0F\u5C31\u53EF\u4EE5\u4E86\u3002 \u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u6982\u5FF5\u539F\u672C\u4F7F\u7528\u5F97\u6BD4\u8F83\u591A\uFF0C\u4F46\u662F\u8FD9\u4E2A\u6539\u52A8\u4F7F\u5F97\u6211\u4EEC\u6709\u8DB3\u591F\u7684\u7406\u7531\u8BA9\u6211\u4EEC\u91CD\u65B0\u8003\u8651\u5728Java7\u4E2D\u4F7F\u7528 string.intern\uFF08\uFF09 Java8\u5143\u7A7A\u95F4\uFF0C\u5B57\u7B26\u4E32\u5E38\u91CF\u5728\u5806\u3002</p><h2 id="_3-string\u7684\u57FA\u672C\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_3-string\u7684\u57FA\u672C\u64CD\u4F5C" aria-hidden="true">#</a> 3.String\u7684\u57FA\u672C\u64CD\u4F5C</h2><p><img src="http://qnimg.gisfsde.com/work/image-20211207141556841.png" alt="image-20211207141556841" loading="lazy"></p><h2 id="_4-\u5B57\u7B26\u4E32\u62FC\u63A5\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_4-\u5B57\u7B26\u4E32\u62FC\u63A5\u64CD\u4F5C" aria-hidden="true">#</a> 4.\u5B57\u7B26\u4E32\u62FC\u63A5\u64CD\u4F5C</h2><p>\u5E38\u91CF\u4E0E\u5E38\u91CF\u7684\u62FC\u63A5\u7ED3\u679C\u5728\u5E38\u91CF\u6C60\uFF0C\u539F\u7406\u662F\u7F16\u8BD1\u671F\u4F18\u5316 2.\u5E38\u91CF\u6C60\u4E2D\u4E0D\u4F1A\u5B58\u5728\u76F8\u540C\u5185\u5BB9\u7684\u5E38\u91CF\u3002 3.\u53EA\u8981\u5176\u4E2D\u6709\u4E00\u4E2A\u662F\u53D8\u91CF\uFF0C\u7ED3\u679C\u5C31\u5728\u5806\u4E2D\u3002\u53D8\u91CF\u62FC\u63A5\u7684\u539F\u7406\u662F String Builder 4.\u5982\u679C\u62FC\u63A5\u7684\u7ED3\u679C\u8C03\u7528 intern\uFF08\uFF09\u65B9\u6CD5\uFF0C\u5219\u4E3B\u52A8\u5C06\u5E38\u91CF\u6C60\u4E2D\u8FD8\u6CA1\u6709\u7684\u5B57\u7B26\u4E32\u5BF9\u8C61\u653E\u5165\u6C60\u4E2D\uFF0C\u5E76\u8FD4\u56DE\u6B64\u5BF9\u8C61\u5730\u5740\u3002</p><h3 id="\u5B57\u7B26\u4E32\u5982\u4F55\u62FC\u63A5" tabindex="-1"><a class="header-anchor" href="#\u5B57\u7B26\u4E32\u5982\u4F55\u62FC\u63A5" aria-hidden="true">#</a> \u5B57\u7B26\u4E32\u5982\u4F55\u62FC\u63A5\uFF1F</h3><p>\u5B57\u7B26\u5BA1\u62FC\u63A5\u64CD\u4F5C\u4E0D\u4E00\u5B9A\u4F7F\u7528\u7684\u662F Stringbuilder! \u5982\u679C\u62FC\u63A5\u7B26\u53F7\u5DE6\u53F3\u4E24\u8FB9\u90E8\u662F\u5B57\u7B26\u5BA1\u5E38\u91CF\u6226\u5E38\u91CF\u5F15\u7528\uFF0C\u5219\u4ECD\u7136\u4F7F\u7F16\u8BD1\u671F\u4F18\u5316\uFF0C\u5373\u975E StringBuilder\u7684\u65B9\u5F0F\u5206\u5BF9\u4E8E final\u4FEE\u98FE\u7C7B\u3001\u65B9\u6CD5\u3001\u84B8\u672C\u6570\u7C7B\u7387\u3001\u5F15\u7528\u6570\u636E\u7C7B\u578B\u7684\u91CF\u7684\u7ED3\u6784\u65F6\uFF0C\u80FD\u4F7F\u7528\u4E0A final\u7684\u65F6\u5019\u5EFA\u8BAE\u4F7F\u7528\u4E0A\u3002</p><p>\u4F53\u4F1A\u6267\u884C\u6548\u7387\uFF1A\u901A\u8FC7 StringBuilder\u7684append\uFF08\uFF09\u7684\u65B9\u5F0F\u6DFB\u52A0\u5B57\u7B26\u5B87\u7684\u6559\u7387\u8981\u8FDC\u9AD8\u4E8E\u4F7F\u7528 string\u7684\u5B57\u7B26\u5B87\u62FC\u63A5\u65B9\u5F0F\uFF01 \u6D0B\u60C5\uFF1A StringBuilder\u7684 append\uFF08\uFF09\u7684\u65B9\u5F0F\uFF1A\u81EA\u59CB\u81F3\u7D42\u4E2D\u53EA\u521B\u5EFA\u8FC7\u4E00\u4E2AStringBuilder\u7684\u5BF9\u8C61 \u4F7F\u7528String\u7684\u5B57\u7B26\u4E32\u62FC\u63A5\u65B9\u5F0F\uFF1A\u5EFA\u8FC7\u591A\u4E2A StringBuilder\u548C String\u7684\u5BF9\u8C61 \u4F7F\u7528 String\u7684\u5B57\u7B26\u4E32\u62FC\u63A5\u65B9\u5F0F\uFF1A\u5185\u5B58\u4E2D\u51FA\u4E8E\u521B\u5EFA\u4E86\u8F83\u591A StringBuilder\u548C String\u7684\u5BF9\u8C61\uFF0C\u5185\u5B58\u5360\u7528\u66F4\u5927\uFF1B\u5982\u679C\u8FDB\u884CGC,\u9700\u8981\u82B1\u8D39\u989D\u5916\u7684\u65F6\u95F4\u3002 \u6539\u8FDB\u7A7A\u95F4\uFF1A\u5728\u5B9E\u9645\u5F00\u53D1\u4E2D\uFF0C\u5982\u679C\u57FA\u672C\u786E\u5B9A\u8981\u524D\u524D\u540E\u540E\u6DFB\u52A0\u7684\u5B57\u7B26\u4E32\u957F\u5EA6\u4E0D\u9AD8\u624B\u67D0\u4E2A\u9650\u5B9A\u503C highlevel\u7684\u51B5\u4E0B\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u6784\u9020\u5668\u5B9E\u4F8B\u5316</p><p>StringBuilder s=new StringBuilder(highlevel);//new char[highlevel]</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> s1<span class="token operator">=</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> s2<span class="token operator">=</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> s3<span class="token operator">=</span><span class="token string">&quot;ab&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//s1+s2\u7EC6\u8282\uFF1A</span>
<span class="token comment">//1.StringBuilder s=new StringBuilder();</span>
<span class="token comment">//s.append(&quot;a&quot;);</span>
<span class="token comment">//s.append(&quot;b&quot;);</span>
<span class="token comment">//s.toString()//---&gt;\u7EA6\u7B49\u4E8E new String(&quot;ab&quot;)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-intern-\u7684\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_5-intern-\u7684\u4F7F\u7528" aria-hidden="true">#</a> 5.intern\uFF08\uFF09\u7684\u4F7F\u7528</h2><p>\u200B \u5982\u679C\u4E0D\u662F\u7528\u53CC\u5F15\u53F7\u58F0\u660E\u7684 string\u5BF9\u8C61\uFF0C\u53EF\u4EE5\u4F7F\u7528 string\u63D0\u4F9B\u7684 intern\u65B9\u6CD5\uFF1A intern\u65B9\u6CD5\u4F1A\u4ECE\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u67FB\u8BE2\u5F53\u524D\u5B57\u7B26\u4E32\u662F\u5426\u5B58\u5728\uFF0C\u82E5\u4E0D\u5B58\u5728\u5C31\u4F1A\u5C06\u5F53\u524D\u5B57\u7B26\u4E32\u653E\u5165\u5E38\u91CF\u6C60\u4E2D\u3002 \u6BD4\u5982\uFF1AString myinfo = new string(&quot;I love atguigu&quot;).intern(\uFF09 \u200B \u4E5F\u5C31\u662F\u8BF4\uFF0C\u5982\u679C\u5728\u4EFB\u610F\u5B57\u7B26\u4E32\u4E0A\u8C03\u7528 string. intern\u65B9\u6CD5\uFF0C\u90A3\u4E48\u5176\u8FD4\u56DE\u7ED3\u679C\u6240\u6307\u5411\u7684\u90A3\u4E2A\u7C7B\u5B9E\u4F8B\uFF0C\u5FC5\u987B\u548C\u76F4\u63A5\u4EE5\u5E38\u91CF\u5F62\u5F0F\u51FA\u73B0\u7684\u5B57\u7B26\u4E32\u5B9E\u4F8B\u5B8C\u5168\u76F8\u540C\u3002\u56E0\u6B64\uFF0C\u4E0B\u5217\u8868\u8FBE\u5F0F\u7684\u503C\u5FC5\u5B9A\u662Ftrue: \u200B (\u201Ca\u201D+\u201Cb\u201D+\u201Cc\u201D).intern() ==&quot;abc&quot; \u200B \u901A\u4FD7\u70B9\u8BB2\uFF0C Interned String/\u5C31\u662F\u786E\u4FDD\u5B57\u7B26\u4E32\u5728\u5185\u5B58\u91CC\u53EA\u6709\u4E00\u4EFD\u62F7\u8D1D\uFF0C\u8FD9\u6837\u53EF\u4EE5\u8282\u7EA6\u5185\u5B58\u7A7A\u95F4\uFF0C\u52A0\u5FEB\u5B57\u7B26\u4E32\u64CD\u4F5C\u4EFB\u52A1\u7684\u6267\u884C\u901F\u5EA6\u3002\u6CE8\u610F\uFF0C\u8FD9\u4E2A\u503C\u4F1A\u88AB\u5B58\u653E\u5728\u5B57\u7B26\u4E32\u5185\u90E8\u6C60(String Intern Pool)</p><h3 id="\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u95EE\u9898" aria-hidden="true">#</a> \u95EE\u9898</h3><p>new String\uFF08\u201Cab\u201D\uFF09\u4F1A\u521B\u5EFA\u51E0\u4E2A\u5BF9\u8C61,new String(&quot;a&quot;) + new String(&quot;b&quot;)\u5462\uFF1F</p><p><img src="http://qnimg.gisfsde.com/work/image-20211208140030760.png" alt="image-20211208140030760" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211208140108804.png" alt="image-20211208140108804" loading="lazy"></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u9898\u76EE\uFF1A
 * new String(&quot;ab&quot;)\u4F1A\u521B\u5EFA\u51E0\u4E2A\u5BF9\u8C61\uFF1F\u770B\u5B57\u8282\u7801\uFF0C\u5C31\u77E5\u9053\u662F\u4E24\u4E2A\u3002
 *     \u4E00\u4E2A\u5BF9\u8C61\u662F\uFF1Anew\u5173\u952E\u5B57\u5728\u5806\u7A7A\u95F4\u521B\u5EFA\u7684
 *     \u53E6\u4E00\u4E2A\u5BF9\u8C61\u662F\uFF1A\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u7684\u5BF9\u8C61&quot;ab&quot;\u3002 \u5B57\u8282\u7801\u6307\u4EE4\uFF1Aldc
 *
 *
 * \u601D\u8003\uFF1A
 * new String(&quot;a&quot;) + new String(&quot;b&quot;)\u5462\uFF1F
 *  \u5BF9\u8C611\uFF1Anew StringBuilder()
 *  \u5BF9\u8C612\uFF1A new String(&quot;a&quot;)
 *  \u5BF9\u8C613\uFF1A \u5E38\u91CF\u6C60\u4E2D\u7684&quot;a&quot;
 *  \u5BF9\u8C614\uFF1A new String(&quot;b&quot;)
 *  \u5BF9\u8C615\uFF1A \u5E38\u91CF\u6C60\u4E2D\u7684&quot;b&quot;
 *
 *  \u6DF1\u5165\u5256\u6790\uFF1A StringBuilder\u7684toString():
 *      \u5BF9\u8C616 \uFF1Anew String(&quot;ab&quot;)
 *       \u5F3A\u8C03\u4E00\u4E0B\uFF0CtoString()\u7684\u8C03\u7528\uFF0C\u5728\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\uFF0C\u6CA1\u6709\u751F\u6210&quot;ab&quot;
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringNewTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//        String str = new String(&quot;ab&quot;);</span>

        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5982\u4F55\u4FDD\u8BC1\u53D8\u91CFs\u6307\u5411\u7684\u662F\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u7684\u6570\u636E\u5462" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u4FDD\u8BC1\u53D8\u91CFs\u6307\u5411\u7684\u662F\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u7684\u6570\u636E\u5462" aria-hidden="true">#</a> \u5982\u4F55\u4FDD\u8BC1\u53D8\u91CFs\u6307\u5411\u7684\u662F\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u7684\u6570\u636E\u5462\uFF1F</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u5982\u4F55\u4FDD\u8BC1\u53D8\u91CFs\u6307\u5411\u7684\u662F\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u7684\u6570\u636E\u5462\uFF1F
 * \u6709\u4E24\u79CD\u65B9\u5F0F\uFF1A
 * \u65B9\u5F0F\u4E00\uFF1A String s = &quot;shkstart&quot;;//\u5B57\u9762\u91CF\u5B9A\u4E49\u7684\u65B9\u5F0F
 * \u65B9\u5F0F\u4E8C\uFF1A \u8C03\u7528intern()
 *         String s = new String(&quot;shkstart&quot;).intern();
 *         String s = new StringBuilder(&quot;shkstart&quot;).toString().intern();
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringIntern</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        s<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u8C03\u7528\u6B64\u65B9\u6CD5\u4E4B\u524D\uFF0C\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u5DF2\u7ECF\u5B58\u5728\u4E86&quot;1&quot;</span>
        <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s <span class="token operator">==</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//jdk6\uFF1Afalse   jdk7/8\uFF1Afalse</span>


        <span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//s3\u53D8\u91CF\u8BB0\u5F55\u7684\u5730\u5740\u4E3A\uFF1Anew String(&quot;11&quot;)</span>
        <span class="token comment">//\u6267\u884C\u5B8C\u4E0A\u4E00\u884C\u4EE3\u7801\u4EE5\u540E\uFF0C\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\uFF0C\u662F\u5426\u5B58\u5728&quot;11&quot;\u5462\uFF1F\u7B54\u6848\uFF1A\u4E0D\u5B58\u5728\uFF01\uFF01</span>
        s3<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u5728\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u751F\u6210&quot;11&quot;\u3002\u5982\u4F55\u7406\u89E3\uFF1Ajdk6:\u521B\u5EFA\u4E86\u4E00\u4E2A\u65B0\u7684\u5BF9\u8C61&quot;11&quot;,\u4E5F\u5C31\u6709\u65B0\u7684\u5730\u5740\u3002</span>
                                            <span class="token comment">//         jdk7:\u6B64\u65F6\u5E38\u91CF\u4E2D\u5E76\u6CA1\u6709\u521B\u5EFA&quot;11&quot;,\u800C\u662F\u521B\u5EFA\u4E00\u4E2A\u6307\u5411\u5806\u7A7A\u95F4\u4E2Dnew String(&quot;11&quot;)\u7684\u5730\u5740</span>
        <span class="token class-name">String</span> s4 <span class="token operator">=</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">;</span><span class="token comment">//s4\u53D8\u91CF\u8BB0\u5F55\u7684\u5730\u5740\uFF1A\u4F7F\u7528\u7684\u662F\u4E0A\u4E00\u884C\u4EE3\u7801\u4EE3\u7801\u6267\u884C\u65F6\uFF0C\u5728\u5E38\u91CF\u6C60\u4E2D\u751F\u6210\u7684&quot;11&quot;\u7684\u5730\u5740</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//jdk6\uFF1Afalse  jdk7/8\uFF1Atrue</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringIntern1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//new String(&quot;11&quot;)</span>
        <span class="token comment">//\u6267\u884C\u5B8C\u4E0A\u4E00\u884C\u4EE3\u7801\u4EE5\u540E\uFF0C\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\uFF0C\u662F\u5426\u5B58\u5728&quot;11&quot;\u5462\uFF1F\u7B54\u6848\uFF1A\u4E0D\u5B58\u5728\uFF01\uFF01</span>
        <span class="token class-name">String</span> s4 <span class="token operator">=</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">;</span><span class="token comment">//\u5728\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u751F\u6210\u5BF9\u8C61&quot;11&quot;</span>
        <span class="token class-name">String</span> s5 <span class="token operator">=</span> s3<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s5 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u603B\u7ED3-stringl\u7684-intern-\u7684\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3-stringl\u7684-intern-\u7684\u4F7F\u7528" aria-hidden="true">#</a> \u603B\u7ED3 stringl\u7684 intern\uFF08\uFF09\u7684\u4F7F\u7528</h3><p>\u30FBjdk1.6\u4E2D\uFF0C\u5C06\u8FD9\u4E2A\u5B57\u7B26\u4E32\u5BF9\u8C61\u5C1D\u8BD5\u653E\u5165\u4E32\u6C60\u3002 \u5982\u679C\u4E32\u6C60\u4E2D\u6709\uFF0C\u5219\u5E76\u4E0D\u4F1A\u653E\u5165\u3002\u8FD4\u56DE\u5DF2\u6709\u7684\u4E32\u6C60\u4E2D\u7684\u5BF9\u8C61\u7684\u5730\u5740\u3002\u5982\u679C\u6CA1\u6709\uFF0C<strong>\u4F1A\u628A\u6B64\u5BF9\u8C61\u590D\u5236\u4E00\u4EFD</strong>\uFF0C\u653E\u5165\u4E32\u6C60\uFF0C\u5E76\u8FD4\u56DE\u4E32\u6C60\u4E2D\u7684\u5BF9\u8C61\u5730\u5740 \u30FBJdk1.7\u8D77\uFF0C\u5C06\u8FD9\u4E2A\u5B57\u7B26\u4E32\u5BF9\u8C61\u5C1D\u8BD5\u653E\u5165\u4E32\u6C60\u3002 \u5982\u679C\u4E32\u6C60\u4E2D\u6709\uFF0C\u5219\u5E76\u4E0D\u4F1A\u653E\u5165\u3002\u8FD4\u56DE\u5DF2\u6709\u7684\u4E32\u6C60\u4E2D\u7684\u5BF9\u8C61\u7684\u5730\u5740\u3002\u5982\u679C\u6CA1\u6709\uFF0C<strong>\u5219\u4F1A\u628A\u5BF9\u8C61\u7684\u5F15\u7528\u5730\u5740\u590D\u5236\u4E00\u4EFD</strong>\uFF0C\u653E\u5165\u4E32\u6C60\uFF0C\u5E76\u8FD4\u56DE\u4E32\u6C60\u4E2D\u7684\u5F15\u7528\u5730\u5740</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringExer1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> x <span class="token operator">=</span> <span class="token string">&quot;ab&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//new String(&quot;ab&quot;)</span>
        <span class="token comment">//\u5728\u4E0A\u4E00\u884C\u4EE3\u7801\u6267\u884C\u5B8C\u4EE5\u540E\uFF0C\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u5E76\u6CA1\u6709&quot;ab&quot;</span>

        <span class="token class-name">String</span> s2 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//jdk6\u4E2D\uFF1A\u5728\u4E32\u6C60\u4E2D\u521B\u5EFA\u4E00\u4E2A\u5B57\u7B26\u4E32&quot;ab&quot;</span>
                               <span class="token comment">//jdk8\u4E2D\uFF1A\u4E32\u6C60\u4E2D\u6CA1\u6709\u521B\u5EFA\u5B57\u7B26\u4E32&quot;ab&quot;,\u800C\u662F\u521B\u5EFA\u4E00\u4E2A\u5F15\u7528\uFF0C\u6307\u5411new String(&quot;ab&quot;)\uFF0C\u5C06\u6B64\u5F15\u7528\u8FD4\u56DE</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s2 <span class="token operator">==</span> <span class="token string">&quot;ab&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//jdk6:true  jdk8:true</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token string">&quot;ab&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//jdk6:false  jdk8:true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringExer2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;ab&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u6267\u884C\u5B8C\u4EE5\u540E\uFF0C\u4F1A\u5728\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u4F1A\u751F\u6210&quot;ab&quot;</span>
<span class="token comment">//        String s1 = new String(&quot;a&quot;) + new String(&quot;b&quot;);////\u6267\u884C\u5B8C\u4EE5\u540E\uFF0C\u4E0D\u4F1A\u5728\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60\u4E2D\u4F1A\u751F\u6210&quot;ab&quot;</span>
        s1<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">&quot;ab&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1 <span class="token operator">==</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7A7A\u95F4\u6548\u7387\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u7A7A\u95F4\u6548\u7387\u6D4B\u8BD5" aria-hidden="true">#</a> \u7A7A\u95F4\u6548\u7387\u6D4B\u8BD5</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u4F7F\u7528intern()\u6D4B\u8BD5\u6267\u884C\u6548\u7387\uFF1A\u7A7A\u95F4\u4F7F\u7528\u4E0A
 *
 * \u7ED3\u8BBA\uFF1A\u5BF9\u4E8E\u7A0B\u5E8F\u4E2D\u5927\u91CF\u5B58\u5728\u5B58\u5728\u7684\u5B57\u7B26\u4E32\uFF0C\u5C24\u5176\u5176\u4E2D\u5B58\u5728\u5F88\u591A\u91CD\u590D\u5B57\u7B26\u4E32\u65F6\uFF0C\u4F7F\u7528intern()\u53EF\u4EE5\u8282\u7701\u5185\u5B58\u7A7A\u95F4\u3002
 * \u5927\u7684\u7F51\u7AD9\u5E73\u53F0\uFF0C\u9700\u8981\u5185\u5B58\u4E2D\u5B58\u50A8\u5927\u91CF\u7684\u5B57\u7B26\u4E32\u3002\u6BD4\u5982\u793E\u4EA4\u7F51\u7AD9\uFF0C\u5F88\u591A\u4EBA\u90FD\u5B58\u50A8\uFF1A\u5317\u4EAC\u5E02\u3001\u6D77\u6DC0\u533A\u7B49\u4FE1\u606F\u3002\u8FD9\u65F6\u4FAF\u5982\u679C\u5B57\u7B26\u4E32\u90FD\u8C03\u7528intern\uFF08\uFF09\u65B9 *    * \u6CD5\uFF0C\u5C31\u4F1A\u660E\u663E\u964D\u4F4E\u5185\u5B58\u7684\u5927\u5C0F\u3002
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringIntern2</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_COUNT <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">10000</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>MAX_COUNT<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Integer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i \\<span class="token operator">&lt;</span> MAX_COUNT<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//            arr[i] = new String(String.valueOf(data[i % data.length]));</span>
            arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i <span class="token operator">%</span> data<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u82B1\u8D39\u7684\u65F6\u95F4\u4E3A\uFF1A&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">GC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5783\u573E\u56DE\u6536\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u56DE\u6536\u6D4B\u8BD5" aria-hidden="true">#</a> \u5783\u573E\u56DE\u6536\u6D4B\u8BD5</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * String\u7684\u5783\u573E\u56DE\u6536:
 * -Xms15m -Xmx15m -XX:+PrintStringTableStatistics -XX:+PrintGCDetails
 *
 * <span class="token keyword">@author</span> shkstart  shkstart@126.com
 * <span class="token keyword">@create</span> 2020  21:27
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringGCTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j \\<span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="g1\u7684string\u53BB\u91CD\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#g1\u7684string\u53BB\u91CD\u64CD\u4F5C" aria-hidden="true">#</a> G1\u7684String\u53BB\u91CD\u64CD\u4F5C</h3><h4 id="\u80CC\u666F" tabindex="-1"><a class="header-anchor" href="#\u80CC\u666F" aria-hidden="true">#</a> <strong>\u80CC\u666F\uFF1A</strong></h4><p>\u5BF9\u8BB8\u591AJava\u5E94\u7528\uFF08\u6709\u5927\u7684\u4E5F\u6709\u5C0F\u7684\uFF09\u505A\u7684\u6D4B\u8BD5\u5F97\u51FA\u4EE5\u4E0B\u7ED3\u679C\uFF1A \u5806\u5B58\u6D3B\u6570\u636E\u96C6\u5408\u91CC\u9762 string,\u5BF9\u8C61\u5360\u4E8625% \u5806\u5B58\u6D3B\u6570\u636E\u96C6\u5408\u91CC\u9762\u91CD\u590D\u7684 string\u5BF9\u8C61\u670913.5% String\u5BF9\u8C61\u7684\u5E73\u5747\u957F\u5EA6\u662F45 \u8BB8\u591A\u5927\u89C4\u6A21\u7684Java\u5E94\u7528\u7684\u74F6\u9888\u5728\u4E8E\u5185\u5B58\uFF0C\u6D4B\u8BD5\u8868\u660E\uFF0C\u5728\u8FD9\u4E9B\u7C7B\u578B\u7684\u5E94\u7528\u91CC\u9762\uFF0CJava\u5806\u4E2D\u5B58\u6D3B\u7684\u6570\u636E\u96C6\u5408\u5DEE\u4E0D\u591A25%\u662F string\u5BF9\u8C61\u3002\u66F4\u8FDB\u4E00\u6B65\uFF0C\u8FD9\u91CC\u9762\u5DEE\u4E0D\u591A\u4E00\u534A string\u5BF9\u8C61\u662F\u91CD\u590D\u7684\uFF0C\u91CD\u590D\u7684\u610F\u601D\u662F\u8BF4: strinG1. equals( string2)=true\u3002\u5806\u4E0A\u5B58\u5728\u91CD\u590D\u7684 String\u5BF9\u8C61\u5FC5\u7136\u662F\u4E00\u79CD\u5185\u5B58\u7684\u6D6A\u8D39\u3002\u8FD9\u4E2A\u9879\u76EE\u5C06\u5728G1\u5783\u573E\u6536\u96C6\u5668\u4E2D\u5B9E\u73B0\u81EA\u52A8\u6301\u7EED\u5BF9\u91CD\u590D\u7684 string\u5BF9\u8C61\u8FDB\u884C\u53BB\u91CD\uFF0C\u8FD9\u6837\u5C31\u80FD\u907F\u514D\u6D6A\u8D39\u5185\u5B58\u3002</p><h4 id="\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u73B0" aria-hidden="true">#</a> <strong>\u5B9E\u73B0</strong></h4><p>\u5F53\u5783\u573E\u6536\u96C6\u5668\u5DE5\u4F5C\u7684\u65F6\u5019\uFF0C\u4F1A\u8BBF\u95EE\u5806\u4E0A\u5B58\u6D3B\u7684\u5BF9\u8C61\u3002\u5BF9\u6BCF\u4E00\u4E2A\u8BBF\u95EE\u7684\u5BF9\u8C61\u90FD\u4F1A\u68C0\u67E5\u662F\u5426\u662F\u5019\u9009\u7684\u8981\u53BB\u91CD\u7684String\u5BF9\u8C61\u3002 \u5982\u679C\u662F\uFF0C\u628A\u8FD9\u4E2A\u5BF9\u8C61\u7684\u4E00\u4E2A\u5F15\u7528\u63D2\u5165\u5230\u961F\u5217\u4E2D\u7B49\u5F85\u540E\u7EED\u7684\u5904\u7406\u3002\u4E00\u4E2A\u53BB\u91CD\u7684\u7EBF\u7A0B\u5728\u540E\u53F0\u8FD0\u884C\uFF0C\u5904\u7406\u8FD9\u4E2A\u961F\u5217\u3002\u5904\u7406\u961F\u5217\u7684\u4E00\u4E2A\u5143\u7D20\u610F\u5473\u7740\u4ECE\u961F\u5217\u5220\u9664\u8FD9\u4E2A\u5143\u7D20\uFF0C\u7136\u540E\u5C1D\u8BD5\u53BB\u91CD\u5B83\u5F15\u7528\u7684String\u5BF9\u8C61\u3002 \u4F7F\u7528\u4E00\u4E2A hashtable\u6765\u8BB0\u5F55\u6240\u6709\u7684\u88AB String\u5BF9\u8C61\u4F7F\u7528\u7684\u4E0D\u91CD\u590D\u7684char\u6570\u7EC4\u3002\u5F53\u53BB\u91CD\u7684\u65F6\u5019\uFF0C\u4F1A\u67FB\u8FD9\u4E2A hashtable,\u6765\u770B\u5806\u4E0A\u662F\u5426\u5DF2\u7ECF\u5B58\u5728\u4E00\u4E2A\u4E00\u6A21\u4E00\u6837\u7684char\u6570\u7EC4\u3002 \u5982\u679C\u5B58\u5728\uFF0C string\u5BF9\u8C61\u4F1A\u88AB\u8C03\u6574\u5F15\u7528\u90A3\u4E2A\u6570\u7EC4\uFF0C\u91CA\u653E\u5BF9\u539F\u6765\u7684\u6570\u7EC4\u7684\u5F15\u7528\uFF0C\u6700\u7EC8\u4F1A\u88AB\u5783\u573E\u6536\u96C6\u5668\u56DE\u6536\u6389\u3002 \u5982\u679C\u67E5\u627E\u5931\u8D25\uFF0Cchar\u6570\u7EC4\u4F1A\u88AB\u63D2\u5165\u5230 hashtable,\u8FD9\u6837\u4EE5\u540E\u7684\u65F6\u5019\u5C31\u53EF\u4EE5\u5171\u4EAB\u8FD9\u4E2A\u6570\u7EC4\u4E86\u3002</p><h4 id="\u547D\u4EE4\u884C\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#\u547D\u4EE4\u884C\u9009\u9879" aria-hidden="true">#</a> <strong>\u547D\u4EE4\u884C\u9009\u9879</strong></h4><p>UsestringDeduplication(bool):\u5F00\u542F String\u53BB\u91CD\uFF0C\u9ED8\u8BA4\u662F\u4E0D\u5F00\u542F\u7684\uFF0C\u9700\u8981\u624B\u52A8\u5F00\u542F\u3002 PrintstringDeduplicationStatistics(bool):\u6253\u5370\u8BE6\u7EC6\u7684\u53BB\u91CD\u7EDF\u8BA1\u4FE1\u606F StringdeduplicationAgethreshold( uintx):\u8FBE\u5230\u8FD9\u4E2A\u5E74\u9F84\u7684 string\u5BF9\u8C61\u88AB\u8BA4\u4E3A\u662F\u53BB\u91CD\u7684\u5019\u9009\u5BF9\u8C61</p><h1 id="\u5341\u56DB\u3001\u5783\u573E\u56DE\u6536\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#\u5341\u56DB\u3001\u5783\u573E\u56DE\u6536\u6982\u8FF0" aria-hidden="true">#</a> \u5341\u56DB\u3001<em>\u5783\u573E\u56DE\u6536\u6982\u8FF0</em></h1><p>\u5783\u573E\u6536\u96C6\uFF0C\u4E0D\u662FJava\u8BED\u8A00\u7684\u4F34\u751F\u4EA7\u7269\u3002\u65E9\u57281960\u5E74\uFF0C\u7B2C\u4E00\u95E8\u5F00\u59CB\u4F7F\u7528\u5185\u5B58\u52A8\u6001\u5206\u914D\u548C\u5783\u573E\u6536\u96C6\u6280\u672F\u7684Lisp\u8BED\u8A00\u8BDE\u751F \u5173\u4E8E\u5783\u573E\u6536\u96C6\u6709\u4E09\u4E2A\u7ECF\u5178\u95EE\u9898\uFF1A\u54EA\u4E9B\u5185\u5B58\u9700\u8981\u56DE\u6536\uFF1F&gt;\u4EC0\u4E48\u65F6\u5019\u56DE\u6536\uFF1F\u5982\u4F55\u56DE\u6536\uFF1F \u5783\u573E\u6536\u96C6\u673A\u5236\u662FJava\u7684\u62DB\u724C\u80FD\u529B\uFF0C\u6781\u5927\u5730\u63D0\u9AD8\u4E86\u5F00\u53D1\u6548\u7387\u3002\u5982\u4ECA\uFF0C\u5783\u573E\u6536\u96C6\u51E0\u4E4E\u6210\u4E3A\u73B0\u4EE3\u8BED\u8A00\u7684\u6807\u914D\uFF0C\u5373\u4F7F\u7ECF\u8FC7\u5982\u6B64\u957F\u65F6\u95F4\u7684\u53D1\u5C55\uFF0CJava\u7684\u5783\u573E\u6536\u96C6\u673A\u5236\u4ECD\u7136\u5728\u4E0D\u65AD\u7684\u6F14\u8FDB\u4E2D\uFF0C\u4E0D\u540C\u5927\u5C0F\u7684\u8BBE\u5907\u3001\u4E0D\u540C\u7279\u5F81\u7684\u5E94\u7528\u573A\u666F\uFF0C\u5BF9\u5783\u573E\u6536\u96C6\u63D0\u51FA\u4E86\u65B0\u7684\u6311\u6218\uFF0C\u8FD9\u5F53\u7136\u4E5F\u662F\u9762\u8BD5\u7684\u70ED\u70B9\u3002</p><p>\u9898\u4F8B\uFF1A <strong>\u8682\u8681\u91D1\u670D\uFF1A</strong> \u4F60\u77E5\u9053\u54EA\u51E0\u79CD\u5783\u573E\u56DE\u6536\u5668\uFF0C\u5404\u81EA\u7684\u4F18\u7F3A\u70B9\uFF0C\u91CD\u70B9\u8BB2\u4E00\u4E0BCMS\u548CG1 \u9762\uFF1A JVM GC\u7B97\u6CD5\u6709\u54EA\u4E9B\uFF0C\u76EE\u524D\u7684JDK\u7248\u672C\u91C7\u7528\u4EC0\u4E48\u56DE\u6536\u7B97\u6CD5 \u9762\uFF1AG1\u56DE\u6536\u5668\u8BB2\u4E0B\u56DE\u6536\u8FC7\u7A0B GC\u662F\u4EC0\u4E48\uFF1F\u4E3A\u4EC0\u4E48\u8981\u6709GC? \u9762\uFF1AGC\u7684\u4E24\u79CD\u5224\u5B9A\u65B9\u6CD5?CMS\u6536\u96C6\u5668\u4E0EG1\u6536\u96C6\u5668\u7684\u7279\u70B9\u3002 <strong>\u767E\u5EA6\uFF1A</strong> \u8BF4\u4E00\u4E0BGC\u7B97\u6CD5\uFF0C\u5206\u4EE3\u56DE\u6536\u8BF4\u4E0B\u5783\u573E\u6536\u96C6\u7B56\u7565\u548C\u7B97\u6CD5 <strong>\u5929\u732B\uFF1A</strong> \u9762\uFF1A JVM GC\u539F\u7406\uFF0CJVM\u600E\u4E48\u56DE\u6536\u5185\u5B58 \u4E00\u9762\uFF1ACMS\u7279\u70B9\uFF0C\u5783\u573E\u56DE\u6536\u7B97\u6CD5\u6709\u54EA\u4E9B\uFF1F\u5404\u81EA\u7684\u4F18\u7F3A\u70B9\uFF0C\u4ED6\u4EEC\u5171\u540C\u7684\u7F3A\u70B9\u662F\u4EC0\u4E48\uFF1F <strong>\u6EF4\u6EF4</strong> \u9762\uFF1Ajava\u7684\u5783\u573E\u56DE\u6536\u5668\u90FD\u6709\u54EA\u4E9B\uFF0C\u8BF4\u4E0BG1\u7684\u5E94\u7528\u573A\u666F\uFF0C\u5E73\u65F6\u4F60\u662F\u5982\u4F55\u642D\u914D\u4F7F\u7528\u5783\u573E\u56DE\u6536\u5668\u7684\u3002 <strong>\u4EAC\u4E1C\uFF1A</strong> \u4F60\u77E5\u9053\u54EA\u51E0\u79CD\u5783\u573E\u6536\u96C6\u5668\uFF0C\u5404\u81EA\u7684\u4F18\u7F3A\u70B9\uFF0C\u91CD\u70B9\u8BB2\u4E0BCMS\u548CG1,\u5305\u62EC\u539F\u7406\uFF0C\u6D41\u7A0B\uFF0C\u4F18\u7F3A\u70B9\u3002\u5783\u573E\u56DE\u6536\u7B97\u6CD5\u7684\u5B9E\u73B0\u539F\u7406\u963F\u91CC\uFF1A \u8BB2\u4E00\u8BB2\u5783\u573E\u56DE\u6536\u7B97\u6CD5\u3002\u4EC0\u4E48\u60C5\u51B5\u4E0B\u89E6\u53D1\u5783\u573E\u56DE\u6536\uFF1F\u5982\u4F55\u9009\u62E9\u5408\u9002\u7684\u5783\u573E\u6536\u96C6\u7B97\u6CD5\uFF1F JVM\u6709\u54EA\u4E09\u79CD\u5783\u573E\u56DE\u6536\u5668\uFF1F <strong>\u5B57\u8282\u8DF3\u52A8\uFF1A</strong> \u5E38\u89C1\u7684\u5783\u573E\u56DE\u6536\u5668\u7B97\u6CD5\u6709\u54EA\u4E9B\uFF0C\u5404\u6709\u4EC0\u4E48\u4F18\u52A3\uFF1Fsystem.GC\uFF08\uFF09\u548C runtime.GC\uFF08\uFF09\u4F1A\u505A\u4EC0\u4E48\u4E8B\u60C5\uFF1F\u9762\uFF1A Java GC\u673A\u5236\uFF1F GC Roots\u6709\u54EA\u4E9B\uFF1F \u4E8C\u9762\uFF1AJava\u5BF9\u8C61\u7684\u56DE\u6536\u65B9\u5F0F\uFF0C\u56DE\u6536\u7B97\u6CD5 CMS\u548CG1\u4E86\u89E3\u4E48\uFF0CCMS\u89E3\u51B3\u4EC0\u4E48\u95EE\u9898\uFF0C\u8BF4\u4E00\u4E0B\u56DE\u6536\u7684\u8FC7\u7A0B\u3002 CMS\u56DE\u6536\u505C\u987F\u4E86\u51E0\u6B21\uFF0C\u4E3A\u4EC0\u4E48\u8981\u505C\u987F\u4E24\u6B21\u3002</p><h2 id="_1-\u4EC0\u4E48\u662F\u5783\u573E" tabindex="-1"><a class="header-anchor" href="#_1-\u4EC0\u4E48\u662F\u5783\u573E" aria-hidden="true">#</a> 1.\u4EC0\u4E48\u662F\u5783\u573E</h2><p><strong>\u4EC0\u4E48\u662F\u5783\u573E( Garbage)\u5462\uFF1F</strong></p><p>\u5783\u573E\u662F\u6307\u5728\u8FD0\u884C\u7A0B\u5E8F\u4E2D\u6CA1\u6709\u4EFB\u4F55\u6307\u9488\u6307\u5411\u7684\u5BF9\u8C61\uFF0C\u8FD9\u4E2A\u5BF9\u8C61\u5C31\u662F\u9700\u8981\u88AB\u56DE\u6536\u7684\u5783\u573E\u3002 An object is considered garbage when it can nolonger be reached from any pointer in the runningprogram \u5982\u679C\u4E0D\u53CA\u65F6\u5BF9\u5185\u5B58\u4E2D\u7684\u5783\u573E\u8FDB\u884C\u6E05\u7406\uFF0C\u90A3\u4E48\uFF0C\u8FD9\u4E9B\u5783\u573E\u5BF9\u8C61\u6240\u5360\u7684\u5185\u5B58\u7A7A\u95F4\u4F1A\u4E00\u76F4\u4FDD\u7559\u5230\u5E94\u7528\u7A0B\u5E8F\u7ED3\u675F\uFF0C\u88AB\u4FDD\u7559\u7684\u7A7A\u95F4\u65E0\u6CD5\u88AB\u5176\u4ED6\u5BF9\u8C61\u4F7F\u7528\u3002\u751A\u81F3\u53EF\u80FD\u5BFC\u81F4\u5185\u5B58\u6EA2\u51FA\u3002</p><h2 id="_2-\u60F3\u8981\u5B66\u4E60gc-\u9996\u5148\u9700\u8981\u7406\u89E3\u4E3A\u4EC0\u4E48\u9700\u8981gc" tabindex="-1"><a class="header-anchor" href="#_2-\u60F3\u8981\u5B66\u4E60gc-\u9996\u5148\u9700\u8981\u7406\u89E3\u4E3A\u4EC0\u4E48\u9700\u8981gc" aria-hidden="true">#</a> 2.\u60F3\u8981\u5B66\u4E60GC,\u9996\u5148\u9700\u8981\u7406\u89E3\u4E3A\u4EC0\u4E48\u9700\u8981GC?</h2><p>\u200B \u5BF9\u4E8E\u9AD8\u7EA7\u8BED\u8A00\u6765\u8BF4\uFF0C\u4E00\u4E2A\u57FA\u672C\u8BA4\u77E5\u662F\u5982\u679C\u4E0D\u8FDB\u884C\u5783\u573E\u56DE\u6536\uFF0C\u5185\u5B58\u8FDF\u65E9\u90FD\u4F1A\u88AB\u6D88\u8017\u5B8C\u56E0\u4E3A\u4E0D\u65AD\u5730\u5206\u914D\u5185\u5B58\u7A7A\u95F4\u800C\u4E0D\u8FDB\u884C\u56DE\u6536\uFF0C\u5C31\u597D\u50CF\u4E0D\u505C\u5730\u751F\u4EA7\u751F\u6D3B\u5783\u573E\u800C\u4ECE\u6765\u4E0D\u6253\u626B\u4E00\u6837\u3002 \u200B \u9664\u4E86\u91CA\u653E\u6CA1\u7528\u7684\u5BF9\u8C61\uFF0C\u5783\u573E\u56DE\u6536\u4E5F\u53EF\u4EE5\u6E05\u9664\u5185\u5B58\u91CC\u7684\u8BB0\u5F55\u788E\u7247\u3002\u788E\u7247\u6574\u7406\u5C06\u6240\u5360\u7528\u7684\u5806\u5185\u5B58\u79FB\u5230\u5806\u7684\u4E00\u7AEF\uFF0C\u4EE5\u4FBFJVM\u5C06\u6574\u7406\u51FA\u7684\u5185\u5B58\u5206\u914D\u7ED9\u65B0\u7684\u5BF9\u8C61\u3002 \u200B \u968F\u7740\u5E94\u7528\u7A0B\u5E8F\u6240\u5E94\u4ED8\u7684\u4E1A\u52A1\u8D8A\u6765\u8D8A\u5E9E\u5927\u3001\u590D\u6742\uFF0C\u7528\u6237\u8D8A\u6765\u8D8A\u591A\uFF0C\u6CA1\u6709GC\u5C31\u4E0D\u80FD\u4FDD\u8BC1\u5E94\u7528\u7A0B\u5E8F\u7684\u6B63\u5E38\u8FDB\u884C\u3002\u800C\u7ECF\u5E38\u9020\u6210STW\u7684GC\u53C8\u8DDF\u4E0D\u4E0A\u5B9E\u9645\u7684\u9700\u6C42\uFF0C\u6240\u4EE5\u624D\u4F1A\u4E0D\u65AD\u5730\u5C1D\u8BD5\u5BF9GC\u8FDB\u884C\u4F18\u5316\u3002</p><ol start="3"><li><h2 id="\u65E9\u671F\u5783\u573E\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#\u65E9\u671F\u5783\u573E\u56DE\u6536" aria-hidden="true">#</a> \u65E9\u671F\u5783\u573E\u56DE\u6536</h2><p>\u200B \u5728\u65E9\u671F\u7684C/C \u65F6\u4EE3\uFF0C\u5783\u573E\u56DE\u6536\u57FA\u672C\u4E0A\u662F\u624B\u5DE5\u8FDB\u884C\u7684\u3002\u5F00\u53D1\u4EBA\u5458\u53EF\u4EE5\u4F7F\u7528new\u5173\u952E\u5B57\u8FDB\u884C\u5185\u5B58\u7533\u8BF7\uFF0C\u5E76\u4F7F\u7528 delete\u5173\u952E\u5B57\u8FDB\u884C\u5185\u5B58\u91CA\u653E\u3002\u6BD4\u5982\u4EE5\u4E0B\u4EE3\u7801\u3002</p><p><img src="http://qnimg.gisfsde.com/work/image-20211213192112115.png" alt="image-20211213192112115" loading="lazy"></p><p>\u200B \u8FD9\u79CD\u65B9\u5F0F\u53EF\u4EE5\u7075\u6D3B\u63A7\u5236\u5185\u5B58\u91CA\u653E\u7684\u65F6\u95F4\uFF0C\u4F46\u662F\u4F1A\u7ED9\u5F00\u53D1\u4EBA\u5458\u5E26\u6765\u9891\u7E41\u7533\u8BF7\u548C\u91CA\u653E\u5185\u5B58\u7684\u7BA1\u7406\u8D1F\u62C5\u3002\u5018\u82E5\u6709\u4E00\u5904\u5185\u5B58\u533A\u95F4\u7531\u4E8E\u7A0B\u5E8F\u5458\u7F16\u7801\u7684\u95EE\u9898\u5FD8\u8BB0\u88AB\u56DE\u6536\uFF0C\u90A3\u4E48\u5C31\u4F1A\u4EA7\u751F\u5185\u5B58\u6CC4\u6F0F\uFF0C\u5783\u573E\u5BF9\u8C61\u6C38\u8FDC\u65E0\u6CD5\u88AB\u6E05\u9664\uFF0C\u968F\u7740\u7CFB\u7EDF\u8FD0\u884C\u65F6\u95F4\u7684\u4E0D\u65AD\u589E\u957F\uFF0C\u5783\u573E\u5BF9\u8C61\u6240\u8017\u5185\u5B58\u53EF\u80FD\u6301\u7EED\u4E0A\u5347\uFF0C\u76F4\u5230\u51FA\u73B0\u5185\u5B58\u6EA2\u51FA\u5E76\u9020\u6210\u5E94\u7528\u7A0B\u5E8F\u5D29\u6E83\u3002\u73B0\u5728\uFF0C\u9664\u4E86Java\u4EE5\u5916\uFF0CC#\u3001 python\u3001Ruby\u7B49\u8BED\u8A00\u90FD\u4F7F\u7528\u4E86\u81EA\u52A8\u5783\u573E\u56DE\u6536\u7684\u601D\u60F3\uFF0C\u4E5F\u662F\u672A\u6765\u53D1\u5C55\u8D8B\u52BF\u3002\u53EF\u4EE5\u8BF4\uFF0C\u8FD9\u79CD\u81EA\u52A8\u5316\u7684\u5185\u5B58\u5206\u914D\u548C\u5783\u573E\u56DE\u6536\u7684\u65B9\u5F0F\u5DF1\u7ECF\u6210\u4E3A\u73B0\u4EE3\u5F00\u53D1\u8BED\u8A00\u5FC5\u5907\u7684\u6807\u51C6\u3002</p></li><li><h2 id="java\u5783\u573E\u56DE\u6536\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#java\u5783\u573E\u56DE\u6536\u673A\u5236" aria-hidden="true">#</a> Java\u5783\u573E\u56DE\u6536\u673A\u5236</h2></li></ol>`,44),va=n("\u200B \u81EA\u52A8\u5185\u5B58\u7BA1\u7406\uFF0C\u65E0\u9700\u5F00\u53D1\u4EBA\u5458\u624B\u52A8\u53C2\u4E0E\u5185\u5B58\u7684\u5206\u914D\u4E0E\u56DE\u6536\uFF0C\u8FD9\u6837\u964D\u4F4E\u5185\u5B58\u6CC4\u6F0F\u548C\u5185\u5B58\u6EA2\u51FA\u7684\u98CE\u9669\u3002\u6CA1\u6709\u5783\u573E\u56DE\u6536\u5668\uFF0Cjava\u4E5F\u4F1A\u548Ccpp\u4E00\u6837\uFF0C\u5404\u79CD\u60AC\u5782\u6307\u9488\uFF0C\u91CE\u6307\u9488\uFF0C\u6CC4\u9732\u95EE\u9898\u8BA9\u4F60\u5934\u75BC\u4E0D\u5DF2\u3002 \u200B \u81EA\u52A8\u5185\u5B58\u7BA1\u7406\u673A\u5236\uFF0C\u5C06\u7A0B\u5E8F\u5458\u4ECE\u7E41\u91CD\u7684\u5185\u5B58\u7BA1\u7406\u4E2D\u91CA\u653E\u51FA\u6765\uFF0C\u53EF\u4EE5\u66F4\u4E13\u5FC3\u5730\u4E13\u6CE8\u4E8E\u4E1A\u52A1\u5F00\u53D1 oracle\u5B98\u7F51\u5173\u4E8E\u5783\u573E\u56DE\u6536\u7684\u4ECB\u7ECD\uFF1A"),ba={href:"https://docs.oracle.com/javase/8/docs/technotes/guides/vm/GCtuning/toc.html",target:"_blank",rel:"noopener noreferrer"},fa=n("https://docs.oracle.com/javase/8/docs/technotes/guides/vm/GCtuning/toc.html"),Ca=n(" \u200B \u5BF9\u4E8EJava\u5F00\u53D1\u4EBA\u5458\u800C\u8A00\uFF0C\u81EA\u52A8\u5185\u5B58\u7BA1\u7406\u5C31\u50CF\u662F\u4E00\u4E2A\u9ED1\u5323\u5B50\uFF0C\u5982\u679C\u8FC7\u5EA6\u4F9D\u8D56\u4E8E\u201C\u81EA\u52A8\u201D\uFF0C\u90A3\u4E48\u8FD9\u5C06\u4F1A\u662F\u4E00\u573A\u707E\u96BE\uFF0C\u6700\u4E25\u91CD\u7684\u5C31\u4F1A\u5F31\u5316Java\u5F00\u53D1\u4EBA\u5458\u5728\u7A0B\u5E8F\u51FA\u73B0\u5185\u5B58\u6EA2\u51FA\u65F6\u5B9A\u4F4D\u95EE\u9898\u548C\u89E3\u51B3\u95EE\u9898\u7684\u80FD\u529B\u3002 \u200B \u6B64\u65F6\uFF0C\u4E86\u89E3JVM\u7684\u81EA\u52A8\u5185\u5B58\u5206\u914D\u548C\u5185\u5B58\u56DE\u6536\u539F\u7406\u5C31\u663E\u5F97\u975E\u5E38\u91CD\u8981\uFF0C\u53EA\u6709\u5728\u771F\u6B63\u4E86\u89E3JVM\u662F\u5982\u4F55\u7BA1\u7406\u5185\u5B58\u540E\uFF0C\u6211\u4EEC\u624D\u80FD\u591F\u5728\u9047\u89C1 OutOfMemoryError\u65F6\uFF0C\u5FEB\u901F\u5730\u6839\u636E\u9519\u8BEF\u5F02\u5E38\u65E5\u5FD7\u5B9A\u4F4D\u95EE\u9898\u548C\u89E3\u51B3\u95EE\u9898\u3002 \u200B \u5F53\u9700\u8981\u6392\u67E5\u5404\u79CD\u5185\u5B58\u6EA2\u51FA\u3001\u5185\u5B58\u6CC4\u6F0F\u95EE\u9898\u65F6\uFF0C\u5F53\u5783\u573E\u6536\u96C6\u6210\u4E3A\u7CFB\u7EDF\u8FBE\u5230\u66F4\u9AD8\u5E76\u53D1\u91CF\u7684\u74F6\u9888\u65F6\uFF0C\u6211\u4EEC\u5C31\u5FC5\u987B\u5BF9\u8FD9\u4E9B\u201C\u81EA\u52A8\u5316\u201D\u7684\u6280\u672F\u5B9E\u65BD\u5FC5\u8981\u7684\u76D1\u63A7\u548C\u8C03\u8282\u3002"),Sa=s('<p><img src="http://qnimg.gisfsde.com/work/image-20211213193207101.png" alt="image-20211213193207101" loading="lazy"></p><p>\u5783\u573E\u56DE\u6536\u5668\u53EF\u4EE5\u5BF9\u5E74\u8F7B\u4EE3\u56DE\u6536\uFF0C\u4E5F\u53EF\u4EE5\u5BF9\u8001\u5E74\u4EE3\u56DE\u6536\uFF0C\u751A\u81F3\u662F\u5168\u5806\u548C\u65B9\u6CD5\u533A\u7684\u56DE\u6536\u3002 \u5176\u4E2D\uFF0CJava\u5806\u662F\u5783\u573E\u6536\u96C6\u5668\u7684\u5DE5\u4F5C\u91CD\u70B9\u3002 \u4ECE\u6B21\u6570\u4E0A\u8BB2 \u9891\u7E41\u6536\u96C6 Young\u533A \u8F83\u5C11\u6536\u96C6old\u533A \u57FA\u672C\u4E0D\u52A8Perm\u533A</p><h1 id="\u5341\u4E94\u3001\u5783\u573E\u56DE\u6536\u76F8\u5173\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u5341\u4E94\u3001\u5783\u573E\u56DE\u6536\u76F8\u5173\u7B97\u6CD5" aria-hidden="true">#</a> \u5341\u4E94\u3001<em>\u5783\u573E\u56DE\u6536\u76F8\u5173\u7B97\u6CD5</em></h1><h2 id="_1-\u5783\u573E\u6807\u8BB0\u9636\u6BB5\u7684\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#_1-\u5783\u573E\u6807\u8BB0\u9636\u6BB5\u7684\u7B97\u6CD5" aria-hidden="true">#</a> 1.\u5783\u573E\u6807\u8BB0\u9636\u6BB5\u7684\u7B97\u6CD5</h2><h3 id="_1-\u5783\u573E\u6807\u8BB0\u9636\u6BB5-\u5BF9\u8C61\u5B58\u6D3B\u5224\u65AD" tabindex="-1"><a class="header-anchor" href="#_1-\u5783\u573E\u6807\u8BB0\u9636\u6BB5-\u5BF9\u8C61\u5B58\u6D3B\u5224\u65AD" aria-hidden="true">#</a> 1.\u5783\u573E\u6807\u8BB0\u9636\u6BB5\uFF1A\u5BF9\u8C61\u5B58\u6D3B\u5224\u65AD</h3><p>\u200B \u5728\u5806\u91CC\u5B58\u653E\u7740\u51E0\u4E4E\u6240\u6709\u7684Java\u5BF9\u8C61\u5B9E\u4F8B\uFF0C\u5728GC\u6267\u884C\u5783\u573E\u56DE\u6536\u4E4B\u524D\uFF0C\u9996\u5148\u9700\u8981\u533A\u5206\u51FA\u5185\u5B58\u4E2D\u54EA\u4E9B\u662F\u5B58\u6D3B\u5BF9\u8C61\uFF0C\u54EA\u4E9B\u662F\u5DF2\u7ECF\u6B7B\u4EA1\u7684\u5BF9\u8C61\u3002\u53EA\u6709\u88AB\u6807\u8BB0\u4E3A\u5DF1\u7ECF\u6B7B\u4EA1\u7684\u5BF9\u8C61\uFF0CGC\u30AA\u4F1A\u5728\u6267\u884C\u5783\u573E\u56DE\u6536\u65F6\uFF0C\u91CA\u653E\u6389\u5176\u6240\u5360\u7528\u7684\u5185\u5B58\u7A7A\u95F4\uFF0C\u56E0\u6B64\u8FD9\u4E2A\u8FC7\u7A0B\u6211\u4EEC\u53EF\u4EE5\u79F0\u4E3A<strong>\u5783\u573E\u6807\u8BB0\u9636\u6BB5</strong>\u3002 \u90A3\u4E48\u5728JVM\u4E2D\u7A76\u7ADF\u662F\u5982\u4F55\u6807\u8BB0\u4E00\u4E2A\u6B7B\u4EA1\u5BF9\u8C61\u5462\uFF1F\u7B80\u5355\u6765\u8BF4\uFF0C\u5F53\u4E00\u4E2A\u5BF9\u8C61\u5DF2\u7ECF\u4E0D\u518D\u88AB\u4EFB\u4F55\u7684\u5B58\u6D3B\u5BF9\u8C61\u7EE7\u7EED\u5F15\u7528\u65F6\uFF0C\u5C31\u53EF\u4EE5\u5BA3\u5224\u4E3A\u5DF2\u7ECF\u6B7B\u4EA1\u3002<strong>\u5224\u65AD\u5BF9\u8C61\u5B58\u6D3B\u4E00\u822C\u6709\u4E24\u79CD\u65B9\u5F0F\uFF1A\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5\u548C\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\u3002</strong></p><h4 id="\u65B9\u5F0F\u4E00-\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u65B9\u5F0F\u4E00-\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5" aria-hidden="true">#</a> \u65B9\u5F0F\u4E00\uFF1A\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5</h4><ul><li>\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5( Reference Counting)\u6BD4\u8F83\u7B80\u5355\uFF0C<strong>\u5BF9\u6BCF\u4E2A\u5BF9\u8C61\u4FDD\u5B58\u4E00\u4E2A\u6574\u578B\u7684\u5F15\u7528\u8BA1\u6570\u5668\u5C5E\u6027\u3002\u7528\u4E8E\u8BB0\u5F55\u5BF9\u8C61\u88AB\u5F15\u7528\u7684\u60C5\u51B5\u3002</strong></li><li>\u5BF9\u4E8E\u4E00\u4E2A\u5BF9\u8C61A,\u53EA\u8981\u6709\u4EFB\u4F55\u4E00\u4E2A\u5BF9\u8C61\u5F15\u7528\u4E86A,\u5219A\u7684\u5F15\u7528\u8BA1\u6570\u5668\u5C31\u52A01;\u5F53\u5F15\u7528\u5931\u6548\u65F6\uFF0C\u5F15\u7528\u8BA1\u6570\u5668\u5C31\u51CF1\u3002\u53EA\u8981\u5BF9\u8C61A\u7684\u5F15\u7528\u8BA1\u6570\u5668\u7684\u503C\u4E3A0,\u5373\u8868\u793A\u5BF9\u8C61A\u4E0D\u53EF\u80FD\u518D\u88AB\u4F7F\u7528\uFF0C\u53EF\u8FDB\u884C\u56DE\u6536\u3002</li><li><strong>\u4F18\u70B9</strong>\uFF1A\u5B9E\u73B0\u7B80\u5355\uFF0C\u5783\u573E\u5BF9\u8C61\u4FBF\u4E8E\u8FA8\u8BC6\uFF1B\u5224\u5B9A\u6548\u7387\u9AD8\uFF0C\u56DE\u6536\u6CA1\u6709\u5EF6\u9000\u6027\u3002</li><li><strong>\u7F3A\u70B9</strong>\uFF1A\u5B83\u9700\u8981\u5355\u72EC\u7684\u5B57\u6BB5\u5B58\u50A8\u8BA1\u6570\u5668\uFF0C\u8FD9\u6837\u7684\u505A\u6CD5\u589E\u52A0\u4E86\u5B58\u50A8\u7A7A\u95F4\u7684\u5F00\u9500\u3002\u6BCF\u6B21\u8D4B\u503C\u90FD\u9700\u8981\u66F4\u65B0\u8BA1\u6570\u5668\uFF0C\u4F34\u968F\u7740\u52A0\u6CD5\u548C\u51CF\u6CD5\u64CD\u4F5C\uFF0C\u8FD9\u589E\u52A0\u4E86\u65F6\u95F4\u5F00\u9500\u3002\u5F15\u7528\u8BA1\u6570\u5668\u6709\u4E00\u4E2A\u4E25\u91CD\u7684\u95EE\u9898\uFF0C\u5373\u65E0\u6CD5\u5904\u7406\u5FAA\u73AF\u5F15\u7528\u7684\u60C5\u51B5\u3002\u8FD9\u662F\u4E00\u6761\u81F4\u547D\u7F3A\u9677\uFF0C\u5BFC\u81F4\u5728Java\u7684\u5783\u573E\u56DE\u6536\u5668\u4E2D\u6CA1\u6709\u4F7F\u7528\u8FD9\u7C7B\u7B97\u6CD5\u3002</li></ul><h4 id="\u65B9\u5F0F\u4E8C-\u53EF\u8FBE\u6027\u5206\u6790-\u6216\u6839\u641C\u7D22\u7B97\u6CD5\u3001\u8FFD\u8E2A\u6027\u5783\u573E\u6536\u96C6" tabindex="-1"><a class="header-anchor" href="#\u65B9\u5F0F\u4E8C-\u53EF\u8FBE\u6027\u5206\u6790-\u6216\u6839\u641C\u7D22\u7B97\u6CD5\u3001\u8FFD\u8E2A\u6027\u5783\u573E\u6536\u96C6" aria-hidden="true">#</a> \u65B9\u5F0F\u4E8C\uFF1A\u53EF\u8FBE\u6027\u5206\u6790(\u6216\u6839\u641C\u7D22\u7B97\u6CD5\u3001\u8FFD\u8E2A\u6027\u5783\u573E\u6536\u96C6)</h4><ul><li>\u76F8\u5BF9\u4E8E\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5\u800C\u8A00\uFF0C\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\u4E0D\u4EC5\u540C\u6837\u5177\u5907\u5B9E\u73B0\u7B80\u5355\u548C\u6267\u884C\u9AD8\u6548\u7B49\u7279\u70B9\uFF0C\u66F4\u91CD\u8981\u7684\u662F\u8BE5\u7B97\u6CD5\u53EF\u4EE5\u6709\u6548\u5730\u89E3\u51B3\u5728\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5\u4E2D\u5FAA\u73AF\u5F15\u7528\u7684\u95EE\u9898\uFF0C\u9632\u6B62\u5185\u5B58\u6CC4\u6F0F\u7684\u53D1\u751F\u3002</li><li>\u76F8\u8F83\u4E8E\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5\uFF0C\u8FD9\u91CC\u7684\u53EF\u8FBE\u6027\u5206\u6790\u5C31\u662FJava\u3001C#\u9009\u62E9\u7684\u3002\u8FD9\u79CD\u7C7B\u578B\u7684\u5783\u573E\u6536\u96C6\u901A\u5E38\u4E5F\u53EB\u4F5C\u8FFD\u8E2A\u6027\u5783\u573E\u6536\u96C6\uFF08 Tracing Garbage Collection)\u3002</li></ul><p>\u6240\u8C13&quot; <strong>GC Roots</strong>&quot;\u6839\u96C6\u5408\u5C31\u662F<strong>\u4E00\u7EC4\u5FC5\u987B\u6D3B\u8DC3\u7684\u5F15\u7528</strong>\u3002 <strong>\u57FA\u672C\u601D\u8DEF\uFF1A</strong></p><ul><li><p>\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\u662F\u4EE5\u6839\u5BF9\u8C61\u96C6\u5408( GC Roots)\u4E3A\u8D77\u59CB\u70B9\uFF0C\u6309\u7167\u4ECE\u4E0A\u81F3\u4E0B\u7684\u65B9\u5F0F\u641C\u7D22\u88AB\u6839\u5BF9\u8C61\u96C6\u5408\u6240\u8FDE\u63A5\u7684\u76EE\u6807\u5BF9\u8C61\u662F\u5426\u53EF\u8FBE\u3002</p></li><li><p>\u4F7F\u7528\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\u540E\uFF0C\u5185\u5B58\u4E2D\u7684\u5B58\u6D3B\u5BF9\u8C61\u90FD\u4F1A\u88AB\u6839\u5BF9\u8C61\u96C6\u5408\u76F4\u63A5\u6216\u95F4\u63A5\u8FDE\u63A5\u7740\uFF0C\u641C\u7D22\u6240\u8D70\u8FC7\u7684\u8DEF\u5F84\u79F0\u4E3A<strong>\u5F15\u7528\u94FE( Reference Chain)</strong></p></li><li><p>\u5982\u679C\u76EE\u6807\u5BF9\u8C61\u6CA1\u6709\u4EFB\u4F55\u5F15\u7528\u94FE\u76F8\u8FDE\uFF0C\u5219\u662F\u4E0D\u53EF\u8FBE\u7684\uFF0C\u5C31\u610F\u5473\u7740\u8BE5\u5BF9\u8C61\u5DF1\u7ECF\u6B7B\u4EA1\uFF0C\u53EF\u4EE5\u6807\u8BB0\u4E3A\u5783\u573E\u5BF9\u8C61\u3002</p></li><li><p>\u5728\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\u4E2D\uFF0C\u53EA\u6709\u80FD\u591F\u88AB\u6839\u5BF9\u8C61\u96C6\u5408\u76F4\u63A5\u6216\u8005\u95F4\u63A5\u8FDE\u63A5\u7684\u5BF9\u8C61\u624D\u662F\u5B58\u6D3B\u5BF9\u8C61\u3002</p><p><img src="http://qnimg.gisfsde.com/work/image-20211213194458567.png" alt="image-20211213194458567" loading="lazy"></p></li></ul><h5 id="gc-root" tabindex="-1"><a class="header-anchor" href="#gc-root" aria-hidden="true">#</a> GC ROOT</h5><p>\u5728Java\u8BED\u8A00\u4E2D\uFF0C GC Roots\u5305\u62EC\u4EE5\u4E0B\u51E0\u7C7B\u5143\u7D20\uFF1A</p><ul><li><p>\u865A\u62DF\u673A\u6808\u4E2D\u5F15\u7528\u7684\u5BF9\u8C61\u3002\u6BD4\u5982\uFF1A\u5404\u4E2A\u7EBF\u7A0B\u88AB\u8C03\u7528\u7684\u65B9\u6CD5\u4E2D\u4F7F\u7528\u5230\u7684\u53C2\u6570\u3001\u5C40\u90E8\u53D8\u91CF\u7B49\u3002</p></li><li><p>\u672C\u5730\u65B9\u6CD5\u6808\u5185JNI\uFF08\u901A\u5E38\u8BF4\u7684\u672C\u5730\u65B9\u6CD5\uFF09\u5F15\u7528\u7684\u5BF9\u8C61</p></li><li><p>\u65B9\u6CD5\u533A\u4E2D\u7C7B\u9759\u6001\u5C5E\u6027\u5F15\u7528\u7684\u5BF9\u8C61&gt;\u6BD4\u5982\uFF1AJava\u7C7B\u7684\u5F15\u7528\u7C7B\u578B\u9759\u6001\u53D8\u91CF\u65B9\u6CD5\u533A\u4E2D\u5E38\u91CF\u5F15\u7528\u7684\u5BF9\u8C61\u3002\u6BD4\u5982\uFF1A\u5B57\u7B26\u4E32\u5E38\u91CF\u6C60( String Table)\u91CC\u7684\u5F15\u7528\u6240\u6709\u88AB\u540C\u6B65\u9501 synchronized\u6301\u6709\u7684\u5BF9\u8C61</p></li><li><p>Java\u865A\u62DF\u673A\u5185\u90E8\u7684\u5F15\u7528\u3002\u57FA\u672C\u6570\u636E\u7C7B\u578B\u5BF9\u5E94\u7684class\u5BF9\u8C61\uFF0C\u4E00\u4E9B\u5E38\u9A7B\u7684\u5F02\u5E38\u5BF9\u8C61\uFF08\u5982\uFF1ANull Pointerexception\u3001 OutOfMemoryError),\u7CFB\u7EDF\u7C7B\u52A0\u8F7D\u5668\u3002</p></li><li><p>\u53CD\u6620java\u865A\u62DF\u673A\u5185\u90E8\u60C5\u51B5\u7684 JMXbeam\u3001JVMTI\u4E2D\u6CE8\u518C\u7684\u56DE\u8C03\u3001\u672C\u5730\u4EE3\u7801\u7F13\u5B58\u7B49\u3002</p></li><li><p>\u9664\u4E86\u8FD9\u4E9B\u56FA\u5B9A\u7684 GC Roots\u96C6\u5408\u4EE5\u5916\uFF0C\u6839\u636E\u7528\u6237\u6240\u9009\u7528\u7684\u5783\u573E\u6536\u96C6\u5668\u4EE5\u53CA\u5F53\u524D\u56DE\u6536\u7684\u5185\u5B58\u533A\u57DF\u4E0D\u540C\uFF0C\u8FD8\u53EF\u4EE5\u6709\u5176\u4ED6\u5BF9\u8C61\u201C\u4E34\u65F6\u6027\u201D\u5730\u52A0\u5165\uFF0C\u5171\u540C\u6784\u6210\u5B8C\u6574 GC Roots\u96C6\u5408\u3002\u6BD4\u5982\uFF1A\u5206\u4EE3\u6536\u96C6\u548C\u5C40\u90E8\u56DE\u6536( Partial GC)\u3002\u5982\u679C\u53EA\u9488\u5BF9Java\u5806\u4E2D\u7684\u67D0\u4E00\u5757\u533A\u57DF\u8FDB\u884C\u5783\u573E\u56DE\u6536(\u6BD4\u5982\uFF1A\u5178\u578B\u7684\u53EA\u9488\u5BF9\u65B0\u751F\u4EE3)\uFF0C\u5FC5\u987B\u8003\u8651\u5230\u5185\u5B58\u533A\u57DF\u662F\u865A\u62DF\u673A\u81EA\u5DF1\u7684\u5B9E\u73B0\u7EC6\u8282\uFF0C\u66F4\u4E0D\u662F\u5B64\u7ACB\u5C01\u95ED\u7684\uFF0C\u8FD9\u4E2A\u533A\u57DF\u7684\u5BF9\u8C61\u5B8C\u5168\u6709\u53EF\u80FD\u88AB\u5176\u4ED6\u533A\u57DF\u7684\u5BF9\u8C61\u6240\u5F15\u7528\uFF0C\u8FD9\u65F6\u5019\u5C31\u9700\u8981\u4E00\u5E76\u5C06\u5173\u8054\u7684\u533A\u57DF\u5BF9\u8C61\u4E5F\u52A0\u5165 GC Roots \u96C6\u5408\u4E2D\u53BB\u8003\u8651\uFF0C\u624D\u80FD\u4FDD\u8BC1\u53EF\u8FBE\u6027\u5206\u6790\u7684\u51C6\u786E\u6027</p></li><li><p>\u5C0F\u6280\u5DE7\uFF1A\u7531\u4E8ERoot\u91C7\u7528\u6808\u65B9\u5F0F\u5B58\u653E\u53D8\u91CF\u548C\u6307\u9488\uFF0C\u6240\u4EE5\u5982\u679C\u4E00\u4E2A\u6307\u9488\uFF0C\u5B83\u4FDD\u5B58\u4E86\u5806\u5185\u5B58\u91CC\u9762\u7684\u5BF9\u8C61\uFF0C\u4F46\u662F\u81EA\u5DF1\u53C8\u4E0D\u5B58\u653E\u5728\u5806\u5185\u5B58\u91CC\u9762\uFF0C\u90A3\u5B83\u5C31\u662F\u4E00\u4E2ARoot</p></li><li><p>\u5982\u679C\u8981\u4F7F\u7528\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\u6765\u5224\u65AD\u5185\u5B58\u662F\u5426\u53EF\u56DE\u6536\uFF0C\u90A3\u4E48\u5206\u6790\u5DE5\u4F5C\u5FC5\u987B\u5728\u4E2A\u80FD\u4FDD\u969C\u4E00\u81F4\u6027\u7684\u5FEB\u7167\u4E2D\u8FDB\u884C\u3002\u8FD9\u70B9\u4E0D\u6EE1\u8DB3\u7684\u8BDD\u5206\u6790\u7ED3\u679C\u7684\u51C6\u786E\u6027\u5C31\u65E0\u6CD5\u4FDD\u8BC1\u3002</p></li><li><p>\u8FD9\u70B9\u4E5F\u662F\u5BFC\u81F4GC\u8FDB\u884C\u65F6\u5FC5\u987B \u201CStop The World&quot;\u7684\u4E00\u4E2A\u91CD\u8981\u539F\u56E0\u3002\u5373\u4F7F\u662F\u53F7\u79F0\uFF08\u51E0\u4E4E\uFF09\u4E0D\u4F1A\u53D1\u751F\u505C\u987F\u7684CMS\u6536\u96C6\u5668\u4E2D\uFF0C<strong>\u679A\u4E3E\u6839\u8282\u70B9\u65F6\u4E5F\u662F\u5FC5\u987B\u8981\u505C\u987F\u7684\u3002</strong></p></li></ul><h2 id="_2-\u5BF9\u8C61\u7684-finalization\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#_2-\u5BF9\u8C61\u7684-finalization\u673A\u5236" aria-hidden="true">#</a> 2.\u5BF9\u8C61\u7684 finalization\u673A\u5236</h2><ul><li><p>Java\u8BED\u8A00\u63D0\u4F9B\u4E86\u5BF9\u8C61\u7EC8\u6B62( finalization)\u673A\u5236\u6765\u5141\u8BB8\u5F00\u53D1\u4EBA\u5458\u63D0\u4F9B\u5BF9\u8C61\u88AB\u9500\u6BC1\u4E4B\u524D\u7684\u81EA\u5B9A\u4E49\u5904\u7406\u903B\u8F91\u3002</p></li><li><p>\u5F53\u5783\u573E\u56DE\u6536\u5668\u53D1\u73B0\u6CA1\u6709\u5F15\u7528\u6307\u5411\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u5373\uFF1A\u5783\u573E\u56DE\u6536\u6B64\u5BF9\u8C61\u4E4B\u524D\uFF0C\u603B\u4F1A\u5148\u8C03\u7528\u8FD9\u4E2A\u5BF9\u8C61\u7684 finallize\uFF08\uFF09\u65B9\u6CD5</p></li><li><p><strong>finalize()<strong>\u65B9\u6CD5\u5141\u8BB8\u5728\u5B50\u7C7B\u4E2D\u88AB\u91CD\u5199\uFF0C\u7528</strong>\u4E8E\u5728\u5BF9\u8C61\u88AB\u56DE\u6536\u65F6\u8FDB\u884C\u8D44\u6E90\u91CA\u653E</strong>\u3002\u901A\u5E38\u5728\u8FD9\u4E2A\u65B9\u6CD5\u4E2D\u8FDB\u884C\u4E00\u4E9B\u8D44\u6E90\u91CA\u653E\u548C\u6E05\u7406\u7684\u5DE5\u4F5C\uFF0C\u6BD4\u5982\u5173\u95ED\u6587\u4EF6\u3001\u5957\u63A5\u5B57\u548C\u6570\u636E\u5E93\u8FDE\u63A5\u7B49\u3002</p></li><li><p>\u6C38\u8FDC\u4E0D\u8981\u4E3B\u52A8\u8C03\u7528\u67D0\u4E2A\u5BF9\u8C61\u7684finalize()\u65B9\u6CD5\uFF0C\u5E94\u8BE5\u4EA4\u7ED9\u5783\u573E\u56DE\u6536\u673A\u5236\u8C03\u7528\u3002\u7406\u7531\u5305\u62EC\u4E0B\u9762\u4E09\u70B9\uFF1A</p><ul><li>finalize() \u65F6\u53EF\u80FD\u4F1A\u5BFC\u81F4\u5BF9\u8C61\u590D\u6D3B\u3002</li><li>finalize() \u65B9\u6CD5\u7684\u6267\u884C\u65F6\u95F4\u662F\u6CA1\u6709\u4FDD\u969C\u7684\uFF0C\u5B83\u5B8C\u5168\u7531GC\u7EBF\u7A0B\u51B3\u5B9A\uFF0C\u6781\u7AEF\u60C5\u51B5\u4E0B\uFF0C\u82E5\u4E0D\u53D1\u751FGC,\u5219finalize()\u65B9\u6CD5\u5C06\u6CA1\u6709\u6267\u884C\u673A\u4F1A\u3002</li><li>\u4E00\u4E2A\u7CDF\u7CD5\u7684 finalize() \u4F1A\u4E25\u91CD\u5F71\u54CDGC\u7684\u6027\u80FD</li></ul><p>\u4ECE\u529F\u80FD\u4E0A\u6765\u8BF4\uFF0C finalize() \u65B9\u6CD5\u4E0E C \u4E2D\u7684\u6790\u6784\u51FD\u6570\u6BD4\u8F83\u76F8\u4F3C\uFF0C\u4F46\u662FJava\u91C7\u7528\u7684\u662F\u57FA\u4E8E\u5783\u573E\u56DE\u6536\u5668\u7684\u81EA\u52A8\u5185\u5B58\u7BA1\u7406\u673A\u5236\uFF0C\u6240\u4EE5 finalize() \u65B9\u6CD5\u5728\u672C\u8D28\u4E0A\u4E0D\u540C\u4E8EC\u4E2D\u7684\u6790\u6784\u51FD\u6570\u3002\u7531\u4E8E finalize() \u65B9\u6CD5\u7684\u5B58\u5728\uFF0C\u865A\u62DF\u673A\u4E2D\u7684\u5BF9\u8C61\u4E00\u822C\u5904\u4E8E\u4E09\u79CD\u53EF\u80FD\u7684\u72B6\u6001\u3002</p></li><li><p>\u5982\u679C\u4ECE\u6240\u6709\u7684\u6839\u8282\u70B9\u90FD\u65E0\u6CD5\u8BBF\u95EE\u5230\u67D0\u4E2A\u5BF9\u8C61\uFF0C\u8BF4\u660E\u5BF9\u8C61\u5DF1\u7ECF\u4E0D\u518D\u4F7F\u7528\u4E86\u3002\u4E00\u822C\u6765\u8BF4\uFF0C\u6B64\u5BF9\u8C61\u9700\u8981\u88AB\u56DE\u6536\u3002\u4F46\u4E8B\u5B9E\u4E0A\uFF0C\u4E5F\u5E76\u975E\u662F\u201C\u975E\u6B7B\u4E0D\u53EF\u201D\u7684\uFF0C\u8FD9\u65F6\u5019\u5B83\u4EEC\u6682\u65F6\u5904\u4E8E\u201C\u7F13\u5211\u201D\u9636\u6BB5\u3002<strong>\u4E00\u4E2A\u65E0\u6CD5\u89E6\u53CA\u7684\u5BF9\u8C61\u6709\u53EF\u80FD\u5728\u67D0\u4E00\u4E2A\u6761\u4EF6\u4E0B\u201C\u590D\u6D3B\u201D\u81EA\u5DF1</strong>\uFF0C\u5982\u679C\u8FD9\u6837\uFF0C\u90A3\u4E48\u5BF9\u5B83\u7684\u56DE\u6536\u5C31\u662F\u4E0D\u5408\u7406\u7684\uFF0C\u4E3A\u6B64\uFF0C\u5B9A\u4E49\u865A\u62DF\u673A\u4E2D\u7684\u5BF9\u8C61\u53EF\u80FD\u7684\u4E09\u79CD\u72B6\u6001\u3002\u5982\u4E0B\uFF1A</p><ul><li>\u53EF\u89E6\u53CA\u7684\uFF1A\u4ECE\u6839\u8282\u70B9\u5F00\u59CB\uFF0C\u53EF\u4EE5\u5230\u8FBE\u8FD9\u4E2A\u5BF9\u8C61\u3002</li><li>\u53EF\u590D\u6D3B\u7684\uFF1A\u5BF9\u8C61\u7684\u6240\u6709\u5F15\u7528\u90FD\u88AB\u91CA\u653E\uFF0C\u4F46\u662F\u5BF9\u8C61\u6709\u53EF\u80FD finalize() \u4E2D\u590D\u6D3B\u3002</li><li>\u4E0D\u53EF\u89E6\u53CA\u7684\uFF1A\u5BF9\u8C61\u7684 finalize() \u88AB\u8C03\u7528\uFF0C\u5E76\u4E14\u6CA1\u6709\u590D\u6D3B\uFF0C\u90A3\u4E48\u5C31\u4F1A\u8FDB\u5165\u4E0D\u53EF\u89E6\u53CA\u72B6\u6001\u3002\u4E0D\u53EF\u89E6\u53CA\u7684\u5BF9\u8C61\u4E0D\u53EF\u80FD\u88AB\u590D\u6D3B\uFF0C\u56E0\u4E3A finalize() \u53EA\u4F1A\u88AB\u8C03\u7528\u4E00\u6B21\u3002</li></ul></li><li><p>\u4EE5\u4E0A3\u79CD\u72B6\u6001\u4E2D\uFF0C\u662F\u7531\u4E8Efina1ize\uFF08\uFF09\u65B9\u6CD5\u7684\u5B58\u5728\uFF0C\u8FDB\u884C\u7684\u533A\u5206\u3002\u53EA\u6709\u5728\u5BF9\u8C61\u4E0D\u53EF\u89E6\u53CA\u65F6\u624D\u53EF\u4EE5\u88AB\u56DE\u6536\u3002</p></li><li><p><strong>\u5177\u4F53\u8FC7\u7A0B\uFF1A</strong></p></li><li><p>\u5224\u5B9A\u4E00\u4E2A\u5BF9\u8C61 objA \u662F\u5426\u53EF\u56DE\u6536\uFF0C\u81F3\u5C11\u8981\u7ECF\u5386\u4E24\u6B21\u6807\u8BB0\u8FC7\u7A0B</p><ul><li>1.\u5982\u679C\u5BF9\u8C61\u3002objA\u5230 GC Roots\u6CA1\u6709\u5F15\u7528\u94FE\uFF0C\u5219\u8FDB\u884C\u7B2C\u4E00\u6B21\u6807\u8BB0\u3002</li><li>2.\u8FDB\u884C\u7B5B\u9009\uFF0C\u5224\u65AD\u6B64\u5BF9\u8C61\u662F\u5426\u6709\u5FC5\u8981\u6267\u884Cfinalize()\u65B9\u6CD5\u3002 <ul><li>\u2460\u5982\u679C\u5BF9\u8C61objA\u6CA1\u6709\u91CD\u5199 finalize()\u65B9\u6CD5\uFF0C\u6216\u8005 finalize() \u65B9\u6CD5\u5DF2\u7ECF\u88AB\u865A\u62DF\u673A\u8C03\u7528\u8FC7\uFF0C\u5219\u865A\u62DF\u673A\u89C6\u4E3A\u201C\u6CA1\u6709\u5FC5\u8981\u6267\u884C\u201D\uFF0CobjA\u88AB\u5224\u5B9A\u4E3A\u4E0D\u53EF\u89E6\u53CA\u7684\u3002</li><li>\u2461\u5982\u679C\u5BF9\u8C61objA\u91CD\u5199\u4E86finalize() \u65B9\u6CD5\uFF0C\u4E14\u8FD8\u672A\u6267\u884C\u8FC7\uFF0C\u90A3\u4E48objA\u4F1A\u88AB\u63D2\u5165\u5230F- Queue\u961F\u5217\u4E2D\uFF0C\u7531\u4E00\u4E2A\u865A\u62DF\u673A\u81EA\u52A8\u521B\u5EFA\u7684\u3001\u4F4E\u4F18\u5148\u7EA7\u7684Finalizer\u7EBF\u7A0B\u89E6\u53D1\u5176 finalize() \u65B9\u6CD5\u6267\u884C\u3002</li><li>\u2462 finalize() \u65B9\u6CD5\u662F\u5BF9\u8C61\u9003\u8131\u6B7B\u4EA1\u7684\u6700\u540E\u673A\u4F1A\uFF0C\u7A0D\u540EGC\u4F1A\u5BF9F- Queue\u961F\u5217\u4E2D\u7684\u5BF9\u8C61\u8FDB\u884C\u7B2C\u4E8C\u6B21\u6807\u8BB0\u3002\u5982\u679CobjA\u5728finalize() \u65B9\u6CD5\u4E2D\u4E0E\u5F15\u7528\u94FE\u4E0A\u7684\u4EFB\u4F55\u4E00\u4E2A\u5BF9\u8C61\u5EFA\u7ACB\u4E86\u8054\u7CFB\uFF0C\u90A3\u4E48\u5728\u7B2C\u4E8C\u6B21\u6807\u8BB0\u65F6\uFF0CobjA\u4F1A\u88AB\u79FB\u51FA\u201C\u5373\u5C06\u56DE\u6536\u201D\u96C6\u5408\u3002\u4E4B\u540E\uFF0C\u5BF9\u8C61\u4F1A\u518D\u6B21\u51FA\u73B0\u6CA1\u6709\u5F15\u7528\u5B58\u5728\u7684\u60C5\u51B5\u3002\u5728\u8FD9\u4E2A\u60C5\u51B5\u4E0B\uFF0Cfinalize\u65B9\u6CD5\u4E0D\u4F1A\u88AB\u518D\u6B21\u8C03\u7528\uFF0C\u5BF9\u8C61\u4F1A\u76F4\u63A5\u53D8\u6210\u4E0D\u53EF\u89E6\u53CA\u7684\u72B6\u6001\uFF0C\u4E5F\u5C31\u662F\u8BF4\uFF0C<strong>\u4E00\u4E2A\u5BF9\u8C61\u7684finalize\u65B9\u6CD5\u53EA\u4F1A\u88AB\u8C03\u7528\u4E00\u6B21\u3002</strong></li></ul></li></ul></li></ul><h2 id="_3-mat\u4E0E-jprofiler\u7684gc-roots\u6E56\u6E90" tabindex="-1"><a class="header-anchor" href="#_3-mat\u4E0E-jprofiler\u7684gc-roots\u6E56\u6E90" aria-hidden="true">#</a> 3.MAT\u4E0E Jprofiler\u7684GC Roots\u6E56\u6E90</h2><h3 id="mat" tabindex="-1"><a class="header-anchor" href="#mat" aria-hidden="true">#</a> MAT</h3>',19),Ma=n("MAT\u662F Memory Analyzer\u7684\u7B80\u79F0\uFF0C\u5B83\u662F\u4E00\u6B3E\u529F\u80FD\u5F3A\u5927\u7684Java\u5806\u5185\u5B58\u5206\u6790\u5668\u3002\u7528\u4E8E\u67FB\u627E\u5185\u5B58\u6CC4\u6F0F\u4EE5\u53CA\u67FB\u770B\u5185\u5B58\u6D88\u8017\u60C5\u51B5\u3002MAT\u662F\u57FA\u4E8E Eclipse\u5F00\u53D1\u7684\uFF0C\u662F\u4E00\u6B3E\u514D\u8D39\u7684\u6027\u80FD\u5206\u6790\u5DE5\u5177\u5927\u5BB6\u53EF\u4EE5\u5728"),wa={href:"https://www.eclipse.org/mat/%E4%B8%8B%E8%BD%BD%E5%B9%B6%E4%BD%BF%E7%94%A8MAT%E3%80%82",target:"_blank",rel:"noopener noreferrer"},Ja=n("https://www.eclipse.org/mat/\u4E0B\u8F7D\u5E76\u4F7F\u7528MAT\u3002"),xa=s('<p>\u200B <strong>\u83B7\u53D6 dump \u6587\u4EF6</strong></p><p><img src="http://qnimg.gisfsde.com/work/image-20211213202356234.png" alt="image-20211213202356234" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211213202420474.png" alt="image-20211213202420474" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211214182640190.png" alt="image-20211214182640190" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211214182749364.png" alt="image-20211214182749364" loading="lazy"></p><h3 id="jprofiler" tabindex="-1"><a class="header-anchor" href="#jprofiler" aria-hidden="true">#</a> Jprofiler</h3><img src="http://qnimg.gisfsde.com/work/image-20211214184140247.png" alt="image-20211214184140247" style="zoom:80%;"><h2 id="_4-\u5783\u573E\u6E05\u9664\u9636\u6BB5\u7B97\u6CD5\u4E4B\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#_4-\u5783\u573E\u6E05\u9664\u9636\u6BB5\u7B97\u6CD5\u4E4B\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5" aria-hidden="true">#</a> 4.\u5783\u573E\u6E05\u9664\u9636\u6BB5\u7B97\u6CD5\u4E4B\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5</h2><ul><li>\u5F53\u6210\u529F\u533A\u5206\u51FA\u5185\u5B58\u4E2D\u5B58\u6D3B\u5BF9\u8C61\u548C\u6B7B\u4EA1\u5BF9\u8C61\u540E\uFF0CGC\u63A5\u4E0B\u6765\u7684\u4EFB\u52A1\u5C31\u662F\u6267\u884C\u5783\u573E\u56DE\u6536\uFF0C\u91CA\u653E\u6389\u65E0\u7528\u5BF9\u8C61\u6240\u5360\u7528\u7684\u5185\u5B58\u7A7A\u95F4\uFF0C\u4EE5\u4FBF\u6709\u8DB3\u591F\u7684\u53EF\u7528\u5185\u5B58\u7A7A\u95F4\u4E3A\u65B0\u5BF9\u8C61\u5206\u914D\u5185\u5B58\u3002</li><li>\u76EE\u524D\u5728JVM\u4E2D\u6BD4\u8F83\u5E38\u89C1\u7684\u4E09\u79CD\u5783\u573E\u6536\u96C6\u7B97\u6CD5\u662F<strong>\u6807\u8BB0 - \u6E05\u9664\u7B97\u6CD5\uFF08Mark Sweep)\u3001\u590D\u5236\u7B97\u6CD5( Copying)\u3001\u6807\u8BB0 - \u538B\u7F29\u7B97\u6CD5\uFF08Mark Compact\uFF09</strong></li></ul><h3 id="\u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5-mark-sweep" tabindex="-1"><a class="header-anchor" href="#\u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5-mark-sweep" aria-hidden="true">#</a> \u6807\u8BB0 - \u6E05\u9664\u7B97\u6CD5\uFF08Mark Sweep)</h3><blockquote><p>\u505C\u6B62-\u6807\u8BB0-\u6E05\u9664</p></blockquote><p><strong>\u80CC\u666F</strong>\uFF1A\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5(Mark- Sweep)\u662F\u4E00\u79CD\u975E\u5E38\u57FA\u7840\u548C\u5E38\u89C1\u7684\u5783\u573E\u6536\u96C6\u7B97\u6CD5\uFF0C\u8BE5\u7B97\u6CD5\u88ABJ. Mccarthy\u7B49\u4EBA\u57281960\u5E74\u63D0\u51FA\u5E76\u5E76\u5E94\u7528\u4E8ELisp\u8BED\u8A00\u3002 <strong>\u6267\u884C\u8FC7\u7A0B</strong>\uFF1A\u5F53\u5806\u4E2D\u7684\u6709\u6548\u5185\u5B58\u7A7A\u95F4(avail able memory)\u88AB\u8017\u5C3D\u7684\u65F6\u5019\uFF0C\u5C31<strong>\u4F1A\u505C\u6B62</strong>\u6574\u4E2A\u7A0B\u5E8F(\u4E5F\u88AB\u79F0\u4E3A stop the world),\u7136\u540E\u8FDB\u884C\u4E24\u9879\u5DE5\u4F5C\uFF0C\u7B2C\u4E00\u9879\u5219\u662F\u6807\u8BB0\uFF0C\u7B2C\u4E8C\u9879\u5219\u662F\u6E05\u9664\u3002 <strong>\u6807\u8BB0</strong>\uFF1ACollector\u4ECE\u5F15\u7528\u6839\u8282\u70B9\u5F00\u59CB\u904D\u5386\uFF0C\u6807\u8BB0\u6240\u6709\u88AB\u5F15\u7528\u7684\u5BF9\u8C61\u3002\u4E00\u822C\u662F\u5728\u5BF9\u8C61\u7684 Header\u4E2D\u8BB0\u5F55\u4E3A\u53EF\u8FBE\u5BF9\u8C61\u3002 <strong>\u6E05\u9664</strong>\uFF1ACollector\u5BF9\u5806\u5185\u5B58\u4ECE\u5934\u5230\u5C3E\u8FDB\u884C\u7EBF\u6027\u7684\u904D\u5386\uFF0C\u5982\u679C\u53D1\u73B0\u67D0\u4E2A\u5BF9\u8C61\u5728\u5176 Headerl\u4E2D\u6CA1\u6709\u6807\u8BB0\u4E3A\u53EF\u8FBE\u5BF9\u8C61\uFF0C\u5219\u5C06\u5176\u56DE\u6536.</p><p><strong>\u7F3A\u70B9</strong> \u6548\u7387\u4E0D\u7B97\u9AD8 \u5728\u8FDB\u884CGC\u7684\u65F6\u5019\uFF0C\u9700\u8981\u505C\u6B62\u6574\u4E2A\u5E94\u7528\u7A0B\u5E8F\uFF0C\u5BFC\u81F4\u7528\u6237\u4F53\u9A8C\u5DEE\u3002 \u8FD9\u79CD\u65B9\u5F0F\u6E05\u7406\u51FA\u6765\u7684\u7A7A\u95F2\u5185\u5B58\u662F\u4E0D\u8FDE\u7EED\u7684\uFF0C\u4EA7\u751F\u5185\u5B58\u788E\u7247\u3002\u9700\u8981\u7EF4\u62A4\u4E00\u4E2A\u7A7A\u95F2\u5217\u8868\u6CE8\u610F\u3002 <strong>\u4F55\u4E3A\u6E05\u9664\uFF1F</strong> \u8FD9\u91CC\u6240\u8C13\u7684\u6E05\u9664\u5E76\u4E0D\u662F\u771F\u7684\u7F6E\u7A7A\uFF0C\u800C\u662F\u628A\u9700\u8981\u6E05\u9664\u7684\u5BF9\u8C61\u5730\u5740\u4FDD\u5B58\u5728\u7A7A\u95F2\u7684\u5730\u5740\u5217\u8868\u91CC\u3002\u4E0B\u6B21\u6709\u65B0\u5BF9\u8C61\u9700\u8981\u52A0\u8F7D\u65F6\uFF0C\u5224\u65AD\u5783\u573E\u7684\u4F4D\u7F6E\u7A7A\u95F4\u662F\u5426\u591F\u5982\u679C\u591F\uFF0C\u5C31\u5B58\u653E\u3002</p><h3 id="\u590D\u5236\u7B97\u6CD5-copying" tabindex="-1"><a class="header-anchor" href="#\u590D\u5236\u7B97\u6CD5-copying" aria-hidden="true">#</a> \u590D\u5236\u7B97\u6CD5( Copying)</h3><blockquote><p>\u4E24\u5757-\u6D3B\u8FDE\u7EED\u590D\u5236\u5230\u53E6\u4E00\u5757-\u6E05\u9664</p></blockquote><p><strong>\u80CC\u666F</strong> \u4E3A\u4E86\u89E3\u51B3\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5\u5728\u5783\u573E\u6536\u96C6\u6548\u7387\u65B9\u9762\u7684\u7F3A\u9677,M,\u5DE5. Minsky\u4E8E1963\u5E74\u53D1\u8868\u4E86\u8457\u540D\u7684\u8BBA\u6587,&quot;\u4F7F\u7528\u53CC\u5B58\u50A8\u533A\u7684<strong>Lisp\u8BED\u8A00</strong>\u5783\u573E\u6536\u96C6\u5668CALISP Garbage Collector Algorithm Using Serial Secondary Storage)&quot;\u3002M.L. Minsky\u5728\u8BE5\u8BBA\u6587\u4E2D\u63CF\u8FF0\u7684\u7B97\u6CD5\u88AB\u4EBA\u4EEC]\u79F0\u4E3A\u590D\u5236( Copying)\u7B97\u6CD5,\u5B83\u4E5F\u88ABM.L. Minsky\u672C\u4EBA\u6210\u529F\u5730\u5F15\u5165\u5230\u4E86Lisp\u8BED\u8A00\u7684\u4E00\u4E2A\u5B9E\u73B0\u7248\u672C\u4E2D\u3002 <strong>\u6267\u884C\u8FC7\u7A0B</strong> \u5C06\u6D3B\u7740\u7684\u5185\u5B58\u7A7A\u95F4\u5206\u4E3A\u4E24\u5757,\u6BCF\u6B21\u53EA\u4F7F\u7528\u5176\u4E2D\u4E00\u5757,\u5728\u5783\u573E\u56DE\u6536\u65F6\u5C06\u6B63\u5728\u4F7F\u7528\u7684\u5185\u5B58\u4E2D\u7684\u5B58\u6D3B\u5BF9\u8C61\u590D\u5236\u5230\u672A\u88AB\u4F7F\u7528\u7684\u5185\u5B58\u5757\u4E2D,\u4E4B\u540E\u6E05\u9664\u6B63\u5728\u4F7F\u7528\u7684\u5185\u5B58\u5757\u4E2D\u7684\u6240\u6709\u5BF9\u8C61,\u4EA4\u6362\u4E24\u4E2A\u5185\u5B58\u7684\u89D2\u8272,\u6700\u540E\u5B8C\u6210\u5783\u573E\u56DE\u6536.</p><p><strong>\u4F18\u70B9\uFF1A</strong> \u6CA1\u6709\u6807\u8BB0\u548C\u6E05\u9664\u8FC7\u7A0B\uFF0C\u5B9E\u73B0\u7B80\u5355\uFF0C\u8FD0\u884C\u9AD8\u6548 \u590D\u5236\u8FC7\u53BB\u4EE5\u540E\u4FDD\u8BC1\u7A7A\u95F4\u7684\u8FDE\u7EED\u6027\uFF0C\u4E0D\u4F1A\u51FA\u73B0\u201C\u788E\u7247\u201D\u95EE\u9898\u7F3A\u70B9 <strong>\u7F3A\u70B9</strong>\uFF1A\u9700\u8981\u4E24\u500D\u7684\u5185\u5B58\u7A7A\u95F4\u3002 \u5BF9\u4E8EG1\u8FD9\u79CD\u5206\u62C6\u6210\u4E3A\u5927\u91CF region\u7684GC,\u590D\u5236\u800C\u4E0D\u662F\u79FB\u52A8\uFF0C\u610F\u5473\u7740GC\u9700\u8981\u7EF4\u62A4 region\u4E4B\u95F4\u5BF9\u8C61\u5F15\u7528\u5173\u7CFB\uFF0C\u4E0D\u7BA1\u662F\u5185\u5B58\u5360\u7528\u6216\u8005\u65F6\u95F4\u5F00\u9500\u4E5F\u4E0D\u5C0F\u3002 <strong>\u7279\u522B\u7684</strong>\uFF1A\u5982\u679C\u7CFB\u7EDF\u4E2D\u7684\u5783\u573E\u5BF9\u8C61\u5F88\u591A\uFF0C\u590D\u5236\u7B97\u6CD5\u4E0D\u4F1A\u5F88\u7406\u60F3\uFF0C\u56E0\u4E3A\u590D\u5236\u7B97\u6CD5\u9700\u8981\u590D\u5236\u7684\u5B58\u6D3B\u5BF9\u8C61\u6570\u91CF\u5E76\u4E0D\u4F1A\u592A\u5927\u6216\u8005\u8BF4\u975E\u5E38\u4F4E\u624D\u884C\u3002</p><h3 id="\u6807\u8BB0-\u538B\u7F29\u7B97\u6CD5-mark-compact" tabindex="-1"><a class="header-anchor" href="#\u6807\u8BB0-\u538B\u7F29\u7B97\u6CD5-mark-compact" aria-hidden="true">#</a> \u6807\u8BB0 - \u538B\u7F29\u7B97\u6CD5\uFF08Mark Compact\uFF09</h3><blockquote><p>\u6807\u8BB0-\u5F15\u7528\u5BF9\u8C61\u538B\u7F29\u5230\u4E00\u7AEF-\u6E05\u9664</p></blockquote><p><strong>\u80CC\u666F</strong> \u590D\u5236\u7B97\u6CD5\u7684\u9AD8\u6548\u6027\u662F\u5EFA\u7ACB\u5728\u5B58\u6D3B\u5BF9\u8C61\u5C11\u3001\u5783\u573E\u5BF9\u8C61\u591A\u7684\u524D\u63D0\u4E0B\u7684\u3002\u8FD9\u79CD\u60C5\u51B5\u5728\u65B0\u751F\u4EE3\u7ECF\u5E38\u53D1\u751F\uFF0C\u4F46\u662F\u5728\u8001\u5E74\u4EE3\uFF0C\u66F4\u5E38\u89C1\u7684\u60C5\u51B5\u662F\u5927\u90E8\u5206\u5BF9\u8C61\u90FD\u662F\u5B58\u6D3B\u5BF9\u8C61\u3002\u5982\u679C\u4F9D\u7136\u4F7F\u7528\u590D\u5236\u7B97\u6CD5\uFF0C\u7531\u4E8E\u5B58\u6D3B\u5BF9\u8C61\u8F83\u591A\uFF0C\u590D\u5236\u7684\u6210\u672C\u4E5F\u5C06\u5F88\u9AD8\u3002\u56E0\u6B64\uFF0C\u57FA\u4E8E\u8001\u5E74\u4EE3\u5783\u573E\u56DE\u6536\u7684\u7279\u6027\uFF0C\u9700\u8981\u4F7F\u7528\u5176\u4ED6\u7684\u7B97\u6CD5\u3002 \u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5\u7684\u786E\u53EF\u4EE5\u5E94\u7528\u5728\u8001\u5E74\u4EE3\u4E2D\uFF0C\u4F46\u662F\u8BE5\u7B97\u6CD5\u4E0D\u4EC5\u6267\u884C\u6548\u7387\u4F4E\u4E0B\uFF0C\u800C\u4E14\u5728\u6267\u884C\u5B8C\u5185\u5B58\u56DE\u6536\u540E\u8FD8\u4F1A\u4EA7\u751F\u5185\u5B58\u788E\u7247\uFF0C\u6240\u4EE5JM\u7684\u8BBE\u8BA1\u8005\u9700\u8981\u5728\u6B64\u57FA\u7840\u4E4B\u4E0A\u8FDB\u884C\u6539\u8FDB\u3002\u6807\u8BB0\u538B\u7F29(Mark- Compact)\u7B97\u6CD5\u7531\u6B64\u8BDE\u751F\u3002 1970\u5E74\u524D\u540E\uFF0CG.L. Steele\u3001C.J. Chene\u548CD.S.Wise\u7B49\u7814\u7A76\u8005\u53D1\u5E03\u6807\u8BB0\u538B\u7F29\u7B97\u6CD5\u3002\u5728\u8BB8\u591A\u73B0\u4EE3\u7684\u5783\u573E\u6536\u96C6\u5668\u4E2D\uFF0C\u4EBA\u4EEC\u90FD\u4F7F\u7528\u4E86\u6807\u8BB0-\u538B\u7F29\u7B97\u6CD5\u6216\u5176\u6539\u8FDB\u7248\u672C\u3002</p><p><strong>\u6267\u884C\u8FC7\u7A0B</strong> \u7B2C\u4E00\u9636\u6BB5\u548C\u6807\u8BB0\u6E05\u9664\u7B97\u6CD5\u4E00\u6837\u4ECE\u6839\u8282\u70B9\u5F00\u59CB\u6807\u8BB0\u6240\u6709\u88AB\u5F15\u7528\u5BF9\u8C61 \u7B2C\u4E8C\u9636\u6BB5\u5C06\u6240\u6709\u7684\u5B58\u6D3B\u5BF9\u8C61\u538B\u7F29\u5230\u5185\u5B58\u7684\u4E00\u7AEF\uFF0C\u6309\u987A\u5E8F\u6392\u653E\u3002 \u4E4B\u540E\uFF0C\u6E05\u7406\u8FB9\u754C\u5916\u6240\u6709\u7684\u7A7A\u95F4\u3002</p><p>\u200B \u6807\u8BB0\u4E00\u538B\u7F29\u7B97\u6CD5\u7684\u6700\u7EC8\u6548\u679C\u7B49\u540C\u4E8E\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5\u6267\u884C\u5B8C\u6210\u540E\uFF0C\u518D\u8FDB\u884C\u4E00\u6B21\u5185\u5B58\u788E\u7247\u6574\u7406\uFF0C\u56E0\u6B64\uFF0C\u4E5F\u53EF\u4EE5\u628A\u5B83\u79F0\u4E3A\u6807\u8BB0\u4E00\u6E05\u9664\u4E00\u538B\u7F29\uFF08Mark- Sweep- Compact)\u7B97\u6CD5\u3002\u4E8C\u8005\u7684\u672C\u8D28\u5DEE\u5F02\u5728\u4E8E\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5\u662F\u4E00\u79CD\u975E\u79FB\u52A8\u5F0F\u7684\u56DE\u6536\u7B97\u6CD5\uFF0C\u6807\u8BB0-\u538B\u7F29\u662F\u79FB\u52A8\u5F0F\u7684\u3002\u662F\u5426\u79FB\u52A8\u56DE\u6536\u540E\u7684\u5B58\u6D3B\u5BF9\u8C61\u662F\u4E00\u9879\u4F18\u7F3A\u70B9\u5E76\u5B58\u7684\u98CE\u9669\u51B3\u7B56\u3002\u53EF\u4EE5\u770B\u5230\uFF0C\u6807\u8BB0\u7684\u5B58\u6D3B\u5BF9\u8C61\u5C06\u4F1A\u88AB\u6574\u7406\uFF0C\u6309\u7167\u5185\u5B58\u5730\u5740\u4F9D\u6B21\u6392\u5217\uFF0C\u800C\u672A\u88AB\u6807\u8BB0\u7684\u5185\u5B58\u4F1A\u88AB\u6E05\u7406\u6389\u3002\u5982\u6B64\u4E00\u6765\uFF0C\u5F53\u6211\u4EEC\u9700\u8981\u7ED9\u65B0\u5BF9\u8C61\u5206\u914D\u5185\u5B58\u65F6\uFF0CJVM\u53EA\u9700\u8981\u6301\u6709\u4E00\u4E2A\u5185\u5B58\u7684\u8D77\u59CB\u5730\u5740\u5373\u53EF\uFF0C\u8FD9\u6BD4\u7EF4\u62A4\u4E00\u4E2A\u7A7A\u95F2\u5217\u8868\u663E\u7136\u5C11\u4E86\u8BB8\u591A\u5F00\u9500\u3002</p><p><strong>\u4F18\u70B9\uFF1A</strong> \u6D88\u9664\u4E86\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5\u5F53\u4E2D\uFF0C\u5185\u5B58\u533A\u57DF\u5206\u6563\u7684\u7F3A\u70B9\uFF0C\u6211\u4EEC\u9700\u8981\u7ED9\u65B0\u5BF9\u8C61\u5206\u914D\u5185\u5B58\u65F6\uFF0CJVM\u53EA\u9700\u8981\u6301\u6709\u4E00\u4E2A\u5185\u5B58\u7684\u8D77\u59CB\u5730\u5740\u5373\u53EF\u3002\u6D88\u9664\u4E86\u590D\u5236\u7B97\u6CD5\u5F53\u4E2D\uFF0C\u5185\u5B58\u51CF\u534A\u7684\u9AD8\u989D\u4EE3\u4EF7 <strong>\u7F3A\u70B9\uFF1A</strong> \u4ECE\u6548\u7387\u4E0A\u6765\u8BF4\uFF0C\u6807\u8BB0\u4E00\u6574\u7406\u7B97\u6CD5\u8981\u4F4E\u4E8E\u590D\u5236\u7B97\u6CD5\u79FB\u52A8\u5BF9\u8C61\u7684\u540C\u65F6\uFF0C\u5982\u679C\u5BF9\u8C61\u88AB\u5176\u4ED6\u5BF9\u8C61\u5F15\u7528\uFF0C\u5219\u8FD8\u9700\u8981\u8C03\u6574\u5F15\u7528\u7684\u5730\u5740\u3002\u79FB\u52A8\u8FC7\u7A0B\u4E2D\uFF0C\u9700\u8981\u5168\u7A0B\u6682\u505C\u7528\u6237\u5E94\u7528\u7A0B\u5E8F\u3002\u5373\uFF1ASTW</p><h3 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h3><p><img src="http://qnimg.gisfsde.com/work/image-20211214190625627.png" alt="image-20211214190625627" loading="lazy"></p><p>\u200B \u6548\u7387\u4E0A\u6765\u8BF4\uFF0C\u590D\u5236\u7B97\u6CD5\u662F\u5F53\u4E4B\u65E0\u6127\u7684\u8001\u5927\uFF0C\u4F46\u662F\u5374\u6D6A\u8D39\u4E86\u592A\u591A\u5185\u5B58\u3002\u800C\u4E3A\u4E86\u5C3D\u91CF\u517C\u987E\u4E0A\u9762\u63D0\u5230\u7684\u4E09\u4E2A\u6307\u6807\uFF0C\u6807\u8BB0\u4E00\u6574\u7406\u7B97\u6CD5\u76F8\u5BF9\u6765\u8BF4\u66F4\u5E73\u6ED1\u4E00\u4E9B\uFF0C\u4F46\u662F\u6548\u7387\u4E0A\u4E0D\u5C3D\u5982\u4EBA\u610F\uFF0C\u5B83\u6BD4\u590D\u5236\u7B97\u6CD5\u591A\u4E86\u4E00\u4E2A\u6807\u8BB0\u7684\u9636\u6BB5\uFF0C\u6BD4\u6807\u8BB0\u4E00\u6E05\u9664\u591A\u4E86\u4E00\u4E2A\u6574\u7406\u5185\u5B58\u7684\u9636\u6BB5\u3002</p><ul><li>\u524D\u9762\u6240\u6709\u8FD9\u4E9B\u7B97\u6CD5\u4E2D\uFF0C\u5E76\u6CA1\u6709\u4E00\u79CD\u7B97\u6CD5\u53EF\u4EE5\u5B8C\u5168\u66FF\u4EE3\u5176\u4ED6\u7B97\u6CD5\uFF0C\u5B83\u4EEC\u90FD\u5177\u6709\u81EA\u5DF1\u72EC\u7279\u7684\u4F18\u52BF\u548C\u7279\u70B9\u3002\u5206\u4EE3\u6536\u96C6\u7B97\u6CD5\u5E94\u8FD0\u800C\u751F\u3002</li><li>\u5206\u4EE3\u6536\u96C6\u7B97\u6CD5\uFF0C\u662F\u57FA\u4E8E\u8FD9\u6837\u4E00\u4E2A\u4E8B\u5B9E\uFF1A\u4E0D\u540C\u7684\u5BF9\u8C61\u7684\u751F\u547D\u5468\u671F\u662F\u4E0D\u4E00\u6837\u7684\u3002\u56E0\u6B64\uFF0C\u4E0D\u540C\u751F\u547D\u5468\u671F\u7684\u5BF9\u8C61\u53EF\u4EE5\u91C7\u53D6\u4E0D\u540C\u7684\u6536\u96C6\u65B9\u5F0F\uFF0C\u4EE5\u4FBF\u63D0\u9AD8\u56DE\u6536\u6548\u7387\u3002\u4E00\u822C\u662F\u628AJava\u5806\u5206\u4E3A\u65B0\u751F\u4EE3\u548C\u8001\u5E74\u4EE3\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u6839\u636E\u5404\u4E2A\u5E74\u4EE3\u7684\u7279\u70B9\u4F7F\u7528\u4E0D\u540C\u7684\u56DE\u6536\u7B97\u6CD5\uFF0C\u4EE5\u63D0\u9AD8\u5783\u573E\u56DE\u6536\u7684\u6548\u7387</li><li>\u5728Java\u7A0B\u5E8F\u8FD0\u884C\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u4F1A\u4EA7\u751F\u5927\u91CF\u7684\u5BF9\u8C61\uFF0C\u5176\u4E2D\u6709\u4E9B\u5BF9\u8C61\u662F\u4E0E\u4E1A\u52A1\u4FE1\u606F\u76F8\u5173\uFF0C\u6BD4\u5982<strong>Http\u8BF7\u6C42\u4E2D\u7684 Session\u5BF9\u8C61\u3001\u7EBF\u7A0B\u3001 Socket\u8FDE\u63A5</strong>\uFF0C\u8FD9\u7C7B\u5BF9\u8C61\u8DDF\u4E1A\u52A1\u76F4\u63A5\u6302\u94A9\uFF0C\u56E0\u6B64\u751F\u547D\u5468\u671F\u6BD4\u8F83\u957F\u3002\u4F46\u662F\u8FD8\u6709\u4E00\u4E9B\u5BF9\u8C61\uFF0C\u4E3B\u8981\u662F\u7A0B\u5E8F\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u751F\u6210\u7684\u4E34\u65F6\u53D8\u91CF\uFF0C\u8FD9\u4E9B\u5BF9\u8C61\u751F\u547D\u5468\u671F\u4F1A\u6BD4\u8F83\u77ED\uFF0C\u6BD4\u5982\uFF1A string,\u5BF9\u8C61\uFF0C\u7531\u4E8E\u5176\u4E0D\u53D8\u7C7B\u7684\u7279\u6027\uFF0C\u7CFB\u7EDF\u4F1A\u4EA7\u751F\u5927\u91CF\u7684\u8FD9\u4E9B\u5BF9\u8C61\uFF0C\u6709\u4E9B\u5BF9\u8C61\u751A\u81F3\u53EA\u7528\u4E00\u6B21\u5373\u53EF\u56DE\u6536\u3002</li></ul><p>\u200B \u76EE\u524D\u51E0\u4E4E\u6240\u6709\u7684GC\u90FD\u662F\u91C7\u7528\u5206\u4EE3\u6536\u96C6( Generational Collecting)\u7B97\u6CD5\u6267\u884C\u5783\u573E\u56DE\u6536\u7684\u3002\u5728 Hotspot\u4E2D\uFF0C\u57FA\u4E8E\u5206\u4EE3\u7684\u6982\u5FF5\uFF0CGC\u6240\u4F7F\u7528\u7684\u5185\u5B58\u56DE\u6536\u7B97\u6CD5\u5FC5\u987B\u7ED3\u5408\u5E74\u8F7B\u4EE3\u548C\u8001\u5E74\u4EE3\u5404\u81EA\u7684\u7279\u70B9\u3002 <strong>\u5E74\u8F7B\u4EE3( Young Gen)</strong> \u200B \u5E74\u8F7B\u4EE3\u7279\u70B9\uFF1A\u533A\u57DF\u76F8\u5BF9\u8001\u5E74\u4EE3\u8F83\u5C0F\uFF0C\u5BF9\u8C61\u751F\u547D\u5468\u671F\u77ED\u3001\u5B58\u6D3B\u7387\u4F4E\uFF0C\u56DE\u6536\u9891\u7E41\u3002\u8FD9\u79CD\u60C5\u51B5<strong>\u590D\u5236\u7B97\u6CD5\u7684\u56DE\u6536\u6574\u7406\uFF0C\u901F\u5EA6\u662F\u6700\u5FEB</strong>\u7684\u3002\u590D\u5236\u7B97\u6CD5\u7684\u6548\u7387\u53EA\u548C\u5F53\u524D\u5B58\u6D3B\u5BF9\u8C61\u5927\u5C0F\u6709\u5173\uFF0C\u56E0\u6B64\u5F88\u9002\u7528\u4E8E\u5E74\u8F7B\u4EE3\u7684\u56DE\u6536\u3002\u800C\u590D\u5236\u7B97\u6CD5\u5185\u5B58\u5229\u7528\u7387\u4E0D\u9AD8\u7684\u95EE\u9898\uFF0C\u901A\u8FC7 hotspot\u4E2D\u7684\u4E24\u4E2A survivor\u7684\u8BBE\u8BA1\u5F97\u5230\u7F13\u89E3\u3002 <strong>\u8001\u5E74\u4EE3( Tensured Gen)</strong> \u200B \u8001\u5E74\u4EE3\u7279\u70B9\uFF1A\u533A\u57DF\u8F83\u5927\uFF0C\u5BF9\u8C61\u751F\u547D\u5468\u671F\u957F\u3001\u5B58\u6D3B\u7387\u9AD8\uFF0C\u56DE\u6536\u4E0D\u53CA\u5E74\u8F7B\u4EE3\u9891\u7E41\u3002\u8FD9\u79CD\u60C5\u51B5\u5B58\u5728\u5927\u91CF\u5B58\u6D3B\u7387\u9AD8\u7684\u5BF9\u8C61\uFF0C\u590D\u5236\u7B97\u6CD5\u660E\u663E\u53D8\u5F97\u4E0D\u5408\u9002\u3002\u4E00\u822C\u662F\u7531<strong>\u6807\u8BB0\u4E00\u6E05\u9664\u6216\u8005\u662F\u6807\u8BB0\u4E00\u6E05\u9664\u4E0E\u6807\u8BB0\u6574\u7406\u7684\u6DF7\u5408\u5B9E\u73B0</strong>\u3002Mark\u9636\u6BB5\u7684\u5F00\u9500\u4E0E<strong>\u5B58\u6D3B\u5BF9\u8C61\u7684\u6570\u91CF</strong>\u6210\u6B63\u6BD4\u3002Sweep\u9636\u6BB5\u7684\u5F00\u9500\u4E0E<strong>\u6240\u7BA1\u7406\u533A\u57DF\u7684\u5927\u5C0F</strong>\u6210\u6B63\u76F8\u5173\u3002Compact\u9636\u6BB5\u7684\u5F00\u9500\u4E0E<strong>\u5B58\u6D3B\u5BF9\u8C61\u7684\u6570\u636E</strong>\u6210\u6B63\u6BD4\u3002</p><p>\u200B \u4EE5 Hotspot\u4E2D\u7684CMS\u56DE\u6536\u5668\u4E3A\u4F8B\uFF0CCMS\u662F\u57FA\u4E8EMark- Sweep\u5B9E\u73B0\u7684\uFF0C\u5BF9\u4E8E\u5BF9\u8C61\u7684\u56DE\u6536\u6548\u7387\u5F88\u9AD8\u3002\u800C\u5BF9\u4E8E\u788E\u7247\u95EE\u9898\uFF0CCMS\u91C7\u7528\u57FA\u4E8EMark- Compact\u7B97\u6CD5\u7684 Serial old \u56DE\u6536\u5668\u4F5C\u4E3A\u8865\u507F\u63AA\u65BD\uFF1A\u5F53\u5185\u5B58\u56DE\u6536\u4E0D\u4F73\uFF08\u788E\u7247\u5BFC\u81F4\u7684 Concurrent Mode Failure\u65F6\uFF09\uFF0C\u5C06\u91C7\u7528 Seralold\u6267\u884CFullGC\u4EE5\u8FBE\u5230\u5BF9\u8001\u5E74\u4EE3\u5185\u5B58\u7684\u6574\u7406\u3002\u5206\u4EE3\u7684\u601D\u60F3\u88AB\u73B0\u6709\u7684\u865A\u62DF\u673A\u5E7F\u6CDB\u4F7F\u7528\u3002\u51E0\u4E4E\u6240\u6709\u7684\u5783\u573E\u56DE\u6536\u5668\u90FD\u533A\u5206\u65B0\u751F\u4EE3\u548C\u8001\u5E74\u4EE3\u3002</p><h2 id="\u5206\u533A\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u5206\u533A\u7B97\u6CD5" aria-hidden="true">#</a> \u5206\u533A\u7B97\u6CD5</h2><p>\u200B \u4E00\u822C\u6765\u8BF4\uFF0C\u5728\u76F8\u540C\u6761\u4EF6\u4E0B\uFF0C\u5806\u7A7A\u95F4\u8D8A\u5927\uFF0C\u4E00\u6B21GC\u65F6\u6240\u9700\u8981\u7684\u65F6\u95F4\u5C31\u8D8A\u957F\uFF0C\u6709\u5173GC\u4EA7\u751F\u7684\u505C\u987F\u4E5F\u8D8A\u957F\u3002\u4E3A\u4E86\u66F4\u597D\u5730\u63A7\u5236GC\u4EA7\u751F\u7684\u505C\u987F\u65F6\u95F4\uFF0C\u5C06\u4E00\u5757\u5927\u7684\u5185\u5B58\u533A\u57DF\u5206\u5272\u6210\u591A\u4E2A\u5C0F\u5757\uFF0C\u6839\u636E\u76EE\u6807\u7684\u505C\u987F\u65F6\u95F4\uFF0C\u6BCF\u6B21\u5408\u7406\u5730\u56DE\u6536\u82E5\u5E72\u4E2A\u5C0F\u533A\u95F4\uFF0C\u800C\u4E0D\u662F\u6574\u4E2A\u5806\u7A7A\u95F4\uFF0C\u4ECE\u800C\u51CF\u5C11\u30FC\u6B21GC\u6240\u4EA7\u751F\u7684\u505C\u987F\u3002\u5206\u4EE3\u7B97\u6CD5\u5C06\u6309\u7167\u5BF9\u8C61\u7684\u751F\u547D\u5468\u671F\u957F\u77ED\u5212\u5206\u6210\u4E24\u4E2A\u90E8\u5206\uFF0C\u5206\u533A\u7B97\u6CD5\u5C06\u6574\u4E2A\u5806\u7A7A\u95F4\u5212\u5206\u6210\u8FDE\u7EED\u7684\u4E0D\u540C\u5C0F\u533A\u95F4\u3002\u6BCF\u4E00\u4E2A\u5C0F\u533A\u95F4\u90FD\u72EC\u7ACB\u4F7F\u7528\uFF0C\u72EC\u7ACB\u56DE\u6536\u3002\u8FD9\u79CD\u7B97\u6CD5\u7684\u597D\u5904\u662F\u53EF\u4EE5\u63A7\u5236\u4E00\u6B21\u56DE\u6536\u591A\u5C11\u4E2A\u5C0F\u533A\u95F4\u3002</p><h3 id="\u589E\u91CF\u6536\u96C6\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u589E\u91CF\u6536\u96C6\u7B97\u6CD5" aria-hidden="true">#</a> \u589E\u91CF\u6536\u96C6\u7B97\u6CD5</h3><p>\u7F3A\u70B9 \u4F7F\u7528\u8FD9\u79CD\u65B9\u5F0F\uFF0C\u7531\u4E8E\u5728\u5783\u573E\u56DE\u6536\u8FC7\u7A0B\u4E2D\uFF0C\u95F4\u65AD\u6027\u5730\u8FD8\u6267\u884C\u4E86\u5E94\u7528\u7A0B\u5E8F\u4EE3\u7801\uFF0C\u6240\u4EE5\u80FD\u51CF\u5C11\u7CFB\u7EDF\u7684\u505C\u987F\u65F6\u95F4\u3002\u4F46\u662F\uFF0C\u56E0\u4E3A\u7EBF\u7A0B\u5207\u6362\u548C\u4E0A\u4E0B\u6587\u8F6C\u6362\u7684\u6D88\u8017\uFF0C\u4F1A\u4F7F\u5F97\u5783\u573E\u56DE\u6536\u7684\u603B\u4F53\u6210\u672C\u4E0A\u5347\uFF0C\u9020\u6210\u7CFB\u7EDF\u541E\u5410\u91CF\u7684\u4E0B\u964D\u3002</p><img src="http://qnimg.gisfsde.com/work/image-20211214191651601.png" alt="image-20211214191651601"><h1 id="\u5341\u516D\u3001\u5783\u573E\u56DE\u6536\u76F8\u5173\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#\u5341\u516D\u3001\u5783\u573E\u56DE\u6536\u76F8\u5173\u6982\u5FF5" aria-hidden="true">#</a> \u5341\u516D\u3001<em>\u5783\u573E\u56DE\u6536\u76F8\u5173\u6982\u5FF5</em></h1><h2 id="_1-system-gc-\u7684\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#_1-system-gc-\u7684\u7406\u89E3" aria-hidden="true">#</a> 1.System.GC()\u7684\u7406\u89E3</h2><ul><li>\u5728\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u901A\u8FC7 System.GC)\u6216\u8005 Runtime. getruntime\uFF08\uFF09.GC\uFF08\uFF09\u7684\u8C03\u7528\uFF0C<strong>\u4F1A\u663E\u5F0F\u89E6\u53D1Full GC</strong>,\u540C\u65F6\u5BF9\u8001\u5E74\u4EE3\u548C\u65B0\u751F\u4EE3\u8FDB\u884C\u56DE\u6536\uFF0C\u5C1D\u8BD5\u91CA\u653E\u88AB\u4E22\u5F03\u5BF9\u8C61\u5360\u7528\u7684\u5185\u5B58\u3002</li><li>\u7136\u800C system.GC\uFF08\uFF09\u8C03\u7528\u9644\u5E26\u4E00\u4E2A\u514D\u8D23\u58F0\u660E\uFF0C<strong>\u65E0\u6CD5\u4FDD\u8BC1\u5BF9\u5783\u573E\u6536\u96C6\u5668\u7684\u8C03\u7528\u3002</strong></li><li>JVM\u5B9E\u73B0\u8005\u53EF\u4EE5\u901A\u8FC7 System.GC\uFF08\uFF09\u8C03\u7528\u6765\u51B3\u5B9AJVM\u7684GC\u884C\u4E3A\u3002\u800C\u4E00\u822C\u60C5\u51B5\u4E0B\uFF0C\u5783\u573E\u56DE\u6536\u5E94\u8BE5\u662F\u81EA\u52A8\u8FDB\u884C\u7684\uFF0C\u65E0\u987B\u624B\u52A8\u89E6\u53D1\uFF0C\u5426\u5219\u5C31\u592A\u8FC7\u4E8E\u9EBB\u70E6\u4E86\u3002\u5728\u4E00\u4E9B\u7279\u6B8A\u60C5\u51B5\u4E0B\uFF0C\u5982\u6211\u4EEC\u6B63\u5728\u7F16\u5199\u4E00\u4E2A\u6027\u80FD\u57FA\u51C6\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728\u8FD0\u884C\u4E4B\u95F4\u8C03\u7528System.GC\uFF08\uFF09\u3002</li></ul><h2 id="_2-\u5185\u5B58\u6EA2\u51FA\u4E0E\u5185\u5B58\u6CC4\u6F0F" tabindex="-1"><a class="header-anchor" href="#_2-\u5185\u5B58\u6EA2\u51FA\u4E0E\u5185\u5B58\u6CC4\u6F0F" aria-hidden="true">#</a> 2.\u5185\u5B58\u6EA2\u51FA\u4E0E\u5185\u5B58\u6CC4\u6F0F</h2><h3 id="\u5185\u5B58\u6EA2\u51FA-\u6EE1\u4E86" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u6EA2\u51FA-\u6EE1\u4E86" aria-hidden="true">#</a> \u5185\u5B58\u6EA2\u51FA (\u6EE1\u4E86)</h3><ul><li>\u5185\u5B58\u6EA2\u51FA\u76F8\u5BF9\u4E8E\u5185\u5B58\u6CC4\u6F0F\u6765\u8BF4\uFF0C\u5C3D\u7BA1\u66F4\u5BB9\u6613\u88AB\u7406\u89E3\uFF0C\u4F46\u662F\u540C\u6837\u7684\uFF0C\u5185\u5B58\u6EA2\u51FA\u4E5F\u662F\u5F15\u53D1\u7A0B\u5E8F\u5D29\u6E83\u7684\u7F6A\u9B41\u7978\u9996\u4E4B\u4E00\u3002</li><li>\u7531\u4E8EGC\u4E00\u76F4\u5728\u53D1\u5C55\uFF0C\u6240\u6709\u4E00\u822C\u60C5\u6CC1\u4E0B\uFF0C\u9664\u975E\u5E94\u7528\u7A0B\u5E8F\u5360\u7528\u7684\u5185\u5B58\u589E\u957F\u901F\u5EA6\u975E\u5E38\u5FEB\uFF0C\u9020\u6210\u5783\u573E\u56DE\u6536\u5DF2\u7ECF\u8DDF\u4E0D\u4E0A\u5185\u5B58\u6D88\u8017\u7684\u901F\u5EA6\uFF0C\u5426\u5219\u4E0D\u592A\u5BB9\u6613\u51FA\u73B0OOM\u7684\u60C5\u51B5\u3002</li><li>\u5927\u591A\u6570\u60C5\u51B5\u4E0B\uFF0CGC\u4F1A\u8FDB\u884C\u5404\u79CD\u5E74\u9F84\u6BB5\u7684\u5783\u573E\u56DE\u6536\uFF0C\u5B9E\u5728\u4E0D\u884C\u4E86\u5C31\u653E\u5927\u62DB\uFF0C\u6765\u4E00\u6B21\u72EC\u5360\u5F0F\u7684Full GC\u64CD\u4F5C\uFF0C\u8FD9\u65F6\u5019\u4F1A\u56DE\u6536\u5927\u91CF\u7684\u5185\u5B58\uFF0C\u4F9B\u5E94\u7528\u7A0B\u5E8F\u7EE7\u7EED\u4F7F\u7528\u3002</li><li>javadoc\u4E2D\u5BF9 OutOfMemoryError\u7684\u89E3\u91CA\u662F\uFF0C<strong>\u6CA1\u6709\u7A7A\u95F2\u5185\u5B58\uFF0C\u5E76\u4E14\u5783\u573E\u6536\u96C6\u5668\u4E5F\u65E0\u6CD5\u63D0\u4F9B\u66F4\u591A\u5185\u5B58\u3002</strong></li></ul><p>\u30FB\u6CA1\u6709\u7A7A\u95F2\u5185\u5B58\u7684\u60C5\u51B5:\u8BF4\u660Ejava\u865A\u62DF\u673A\u7684\u5806\u5185\u5B58\u4E0D\u591F.\u539F\u56E0\u6709\u4E8C\uFF1A <strong>(1)Java\u865A\u62DF\u673A\u7684\u5806\u5185\u5B58\u8BBE\u7F6E\u4E0D\u591F</strong> \u6BD4\u5982:\u53EF\u80FD\u5B58\u5728\u5185\u5B58\u6CC4\u6F0F\u95EE\u9898:\u5730\u5F88\u6709\u53EF\u80FD\u5C31\u662F\u5806\u7684\u5927\u5C0F\u4E0D\u5408\u7406,\u6BD4\u5982\u6211\u4EEC\u8981\u5904\u7406\u6BD4\u8F83\u53EF\u89C2\u7684\u6570\u636E\u91CF,\u4F46\u662F\u6CA1\u6709\u663E\u5F0F\u6307\u5B9AJVM\u5806\u5927\u5C0F\u6216\u8005\u6307\u5B9A\u6570\u503C\u504F\u5C0F.\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u53C2\u6570-Xms\u3001Xmx\u6765\u8C03\u6574. <strong>(2)\u4EE3\u7801\u4E2D\u521B\u5EFA\u4E86\u5927\u91CF\u5927\u5BF9\u8C61,\u5E76\u4E14\u957F\u65F6\u95F4\u4E0D\u80FD\u88AB\u5783\u573E\u6536\u96C6\u5668\u6536\u96C6(\u5B58\u5728\u88AB\u5F15\u7528)</strong> s\u5BF9\u4E8E\u8001\u7248\u672C\u7684 Oracle JDK,\u56E0\u4E3A\u6C38\u4E45\u4EE3\u7684\u5927\u5C0F\u662F\u6709\u9650\u7684,\u5E76\u4E14JVM\u5BF9\u6C38\u4E45\u4EE3\u5783\u573E\u56DE\u6536(\u5982,\u5E38\u91CF\u6C60\u56DE\u6536\u3001\u5378\u8F7D\u4E0D\u518D\u9700\u8981\u7684\u7C7B\u578B)\u975E\u5E38\u4E0D\u79EF\u6781,\u6240\u4EE5\u5F53\u6211\u4EEC\u4E0D\u65AD\u6DFB\u52A0\u65B0\u7C7B\u578B\u7684\u65F6\u5019,\u6C38\u4E45\u4EE3\u51FA\u73B0 OutOfMemoryError\u4E5F\u975E\u5E38\u591A\u89C1,\u5C24\u5176\u662F\u5728\u8FD0\u884C\u65F6\u5B58\u5728\u5927\u91CF\u52A8\u6001\u7C7B\u578B\u751F\u6210\u7684\u573A\u5408;\u7C7B\u4F3C l tern\u5B57\u7B26\u4E32\u7F13\u5B58\u5360\u7528\u592A\u591A\u7A7A\u95F4,\u4E5F\u4F1A\u5BFC\u81F4OOM\u95EE\u9898.\u5BF9\u5E94\u7684\u5F02\u5E38\u4FE1\u606F,\u4F1A\u6807\u8BB0\u51FA\u6765\u548C\u6C38\u4E45\u4EE3\u76F8\u5173:&quot;java.lang.OutOfMemoryError: Permgen space&quot;. \u968F\u7740\u5143\u6570\u636E\u533A\u7684\u5F15\u5165,\u65B9\u6CD5\u533A\u5185\u5B58\u5DF2\u7ECF\u4E0D\u518D\u90A3\u4E48\u7A98\u8FEB,\u6240\u4EE5\u76F8\u5E94\u7684OOM\u6709\u6240\u6539\u89C2,\u51FA\u73B0OOM,\u5F02\u5E38\u4FE1\u606F\u5219\u53D8\u6210\u4E86:&quot;java.lang. OutOfMemoryError: Metaspace&quot;.\u76F4\u63A5\u5185\u5B58\u4E0D\u8DB3,\u4E5F\u4F1A\u5BFC\u81F4OOM.</p><p>\u200B \u8FD9\u91CC\u9762\u9690\u542B\u7740\u4E00\u5C42\u610F\u601D\u662F,\u5728\u629B\u51FA OutOfMemoryError\u4E4B\u524D,\u901A\u5E38\u5783\u573E\u6536\u96C6\u5668\u4F1A\u88AB\u89E6\u53D1,\u5C3D\u5176\u6240\u80FD\u53BB\u6E05\u7406\u51FA\u7A7A\u95F4\u3002\u4F8B\u5982:\u5728\u5F15\u7528\u673A\u5236\u5206\u6790\u4E2D,\u6D89\u53CA\u5230JVM\u4F1A\u53BB\u5C1D\u8BD5\u56DE\u6536\u8F6F\u5F15\u7528\u6307\u5411\u7684\u5BF9\u8C61\u7B49\u3002\u5728java.nio.BTts. reservememory()\u65B9\u6CD5\u4E2D,\u6211\u4EEC\u80FD\u6E05\u695A\u7684\u770B\u5230, System.GC()\u4F1A\u88AB\u8C03\u7528,\u4EE5\u6E05\u7406\u7A7A\u95F4. \u200B \u5F53\u7136,\u4E5F\u4E0D\u662F\u5728\u4EFB\u4F55\u60C5\u51B5\u4E0B\u5783\u573E\u6536\u96C6\u5668\u90FD\u4F1A\u88AB\u89E6\u53D1\u7684\u3002\u6BD4\u5982,\u6211\u4EEC\u53BB\u5206\u914D\u4E00\u4E2A\u8D85\u5927\u5BF9\u8C61,\u7C7B\u4F3C\u4E00\u4E2A\u8D85\u5927\u6570\u7EC4\u8D85\u8FC7\u5806\u7684\u6700\u5927\u503C,JVM\u53EF\u4EE5\u5224\u65AD\u51FA\u5783\u573E\u6536\u96C6\u5E76\u4E0D\u80FD\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898,\u6240\u4EE5\u76F4\u63A5\u629B\u51FA OutOfMemoryError.</p><h3 id="\u5185\u5B58\u6CC4\u6F0F-\u4E0D\u80FD\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u6CC4\u6F0F-\u4E0D\u80FD\u56DE\u6536" aria-hidden="true">#</a> \u5185\u5B58\u6CC4\u6F0F\uFF08\u4E0D\u80FD\u56DE\u6536\uFF09</h3><p>\u200B \u4E5F\u79F0\u4F5C\u201C\u5B58\u50A8\u6E17\u6F0F\u201D\u3002\u4E25\u683C\u6765\u8BF4\uFF0C\u53EA\u6709\u5BF9\u8C61\u4E0D\u4F1A\u518D\u88AB\u7A0B\u5E8F\u7528\u5230\u4E86\uFF0C\u4F46\u662FGC\u53C8\u4E0D\u80FD\u56DE\u6536\u4ED6\u4EEC\u7684\u60C5\u51B5\uFF0C\u624D\u53EB\u5185\u5B58\u6CC4\u6F0F\u3002\u4F46\u5B9E\u9645\u60C5\u51B5\u5F88\u591A\u65F6\u5019\u4E00\u4E9B\u4E0D\u592A\u597D\u7684\u5B9E\u8DF5\uFF08\u6216\u758F\u5FFD\uFF09\u4F1A\u5BFC\u81F4\u5BF9\u8C61\u7684\u751F\u547D\u5468\u671F\u53D8\u5F97\u5F88\u957F\u751A\u81F3\u5BFC\u81F4OOM,\u4E5F\u53EF\u4EE5\u53EB\u505A\u5BBD\u6CDB\u610F\u4E49\u4E0A\u7684\u201C\u5185\u5B58\u6CC4\u6F0F\u201D\u3002 \u200B \u5C3D\u7BA1\u5185\u5B58\u6CC4\u6F0F\u5E76\u4E0D\u4F1A\u7ACB\u523B\u5F15\u8D77\u7A0B\u5E8F\u5D29\u6E83\uFF0C\u4F46\u662F\u4E00\u65E6\u53D1\u751F\u5185\u5B58\u6CC4\u6F0F\uFF0C\u7A0B\u5E8F\u4E2D\u7684\u53EF\u7528\u5185\u5B58\u5C31\u4F1A\u88AB\u9010\u6B65\u8695\u98DF\uFF0C\u76F4\u81F3\u8017\u5C3D\u6240\u6709\u5185\u5B58\uFF0C\u6700\u7EC8\u51FA\u73B0 OutOfMemory\u5F02\u5E38\uFF0C\u5BFC\u81F4\u7A0B\u5E8F\u5D29\u6E83\u3002\u6CE8\u610F\uFF0C\u8FD9\u91CC\u7684\u5B58\u50A8\u7A7A\u95F4\u5E76\u4E0D\u662F\u6307\u7269\u7406\u5185\u5B58\uFF0C\u800C\u662F\u6307\u865A\u62DF\u5185\u5B58\u5927\u5C0F\uFF0C\u8FD9\u4E2A\u865A\u62DF\u5185\u5B58\u5927\u5C0F\u53D6\u51B3\u4E8E\u78C1\u76D8\u4EA4\u6362\u533A\u8BBE\u5B9A\u7684\u5927\u5C0F\u3002</p><p><strong>\u4E3E\u4F8B</strong> 1\u3001\u5355\u4F8B\u6A21\u5F0F \u5355\u4F8B\u7684\u751F\u547D\u5468\u671F\u548C\u5E94\u7528\u7A0B\u5E8F\u662F\u4E00\u6837\u957F\u7684\uFF0C\u6240\u4EE5\u5355\u4F8B\u7A0B\u5E8F\u4E2D\uFF0C\u5982\u679C\u6301\u6709\u5BF9\u5916\u90E8\u5BF9\u8C61\u7684\u5F15\u7528\u7684\u8BDD\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u5916\u90E8\u5BF9\u8C61\u662F\u4E0D\u80FD\u88AB\u56DE\u6536\u7684\uFF0C\u5219\u4F1A\u5BFC\u81F4\u5185\u5B58\u6CC4\u6F0F\u7684\u4EA7\u751F\u3002 2\u3001\u4E00\u4E9B\u63D0\u4F9Bclose\u7684\u8D44\u6E90\u672A\u5173\u95ED\u5BFC\u81F4\u5185\u5B58\u6CC4\u6F0F \u6570\u636E\u5E93\u8FDE\u63A5( datasource. getconnection\uFF08\uFF09),\u7F51\u7EDC\u8FDE\u63A5( socket)\u548Cio\u8FDE\u63A5\u5FC5\u987B\u624B\u52A8close,\u5426\u5219\u662F\u4E0D\u80FD\u88AB\u56DE\u6536\u7684\u3002</p><h2 id="_3-stop-the-world" tabindex="-1"><a class="header-anchor" href="#_3-stop-the-world" aria-hidden="true">#</a> 3.Stop The World</h2><ul><li><p>Stop-the-World,\u7B80\u79F0 STW,\u6307\u7684\u662FGC\u4E8B\u4EF6\u53D1\u751F\u8FC7\u7A0B\u4E2D\uFF0C\u4F1A\u4EA7\u751F\u5E94\u7528\u7A0B\u5E8F\u7684\u505C\u987F\u3002\u505C\u987F\u4EA7\u751F\u65F6\u6574\u4E2A\u5E94\u7528\u7A0B\u5E8F\u7EBF\u7A0B\u90FD\u4F1A\u88AB\u6682\u505C\uFF0C\u6CA1\u6709\u4EFB\u4F55\u54CD\u5E94\uFF0C\u6709\u70B9\u50CF\u5361\u6B7B\u7684\u611F\u89C9\uFF0C\u8FD9\u4E2A\u505C\u987F\u79F0\u4E3ASTW.</p></li><li><p>\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\u4E2D\u679A\u4E3E\u6839\u8282\u70B9( GC Roots)\u4F1A\u5BFC\u81F4\u6240\u6709Java\u6267\u884C\u7EBF\u7A0B\u505C\u987F\u3002\u5206\u6790\u5DE5\u4F5C\u5FC5\u987B\u5728\u4E00\u4E2A\u80FD\u786E\u4FDD\u4E00\u81F4\u6027\u7684\u5FEB\u7167\u4E2D\u8FDB\u884C\u3002\u4E00\u81F4\u6027\u6307\u6574\u4E2A\u5206\u6790\u671F\u95F4\u6574\u4E2A\u6267\u884C\u7CFB\u7EDF\u770B\u8D77\u6765\u50CF\u88AB\u51BB\u7ED3\u5728\u67D0\u4E2A\u65F6\u95F4\u70B9\u4E0A\u5982\u679C\u51FA\u73B0\u5206\u6790\u8FC7\u7A0B\u4E2D\u5BF9\u8C61\u5F15\u7528\u5173\u7CFB\u8FD8\u5728\u4E0D\u65AD\u53D8\u5316\uFF0C\u5219\u5206\u6790\u7ED3\u679C\u7684\u51C6\u786E\u6027\u65E0\u6CD5\u4FDD\u8BC1\u3002</p></li><li><p>\u88ABSTW\u4E2D\u65AD\u7684\u5E94\u7528\u7A0B\u5E8F\u7EBF\u7A0B\u4F1A\u5728\u5B8C\u6210GC\u4E4B\u540E\u6062\u590D\uFF0C\u9891\u7E41\u4E2D\u65AD\u4F1A\u8BA9\u7528\u6237\u611F\u89C9\u50CF\u662F\u7F51\u901F\u4E0D\u5FEB\u9020\u6210\u7535\u5F71\u5361\u5E26\u4E00\u6837\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u51CF\u5C11STW\u7684\u53D1\u751F</p></li><li><p>STW\u4E8B\u4EF6\u548C\u91C7\u7528\u54EA\u6B3EGC\u65E0\u5173\uFF0C\u6240\u6709\u7684GC\u90FD\u6709\u8FD9\u4E2A\u4E8B\u4EF6\u3002\u54EA\u6015\u662FG1\u4E5F\u4E0D\u80FD\u5B8C\u5168\u907F\u514DStop-the-world\u60C5\u51B5\u53D1\u751F\uFF0C\u53EA\u80FD\u8BF4\u5783\u573E\u56DE\u6536\u5668\u8D8A\u6765\u8D8A\u4F18\u79C0\uFF0C\u56DE\u6536\u6548\u7387\u8D8A\u6765\u8D8A\u9AD8\uFF0C\u5C3D\u53EF\u80FD\u5730\u7F29\u77ED\u4E86\u6682\u505C\u65F6\u95F4\u3002</p></li><li><p>STW\u662FJVM\u5728\u540E\u53F0\u81EA\u52A8\u53D1\u8D77\u548C\u81EA\u52A8\u5B8C\u6210\u7684\u3002\u5728\u7528\u6237\u4E0D\u53EF\u89C1\u7684\u60C5\u51B5\u4E0B\uFF0C\u628A\u7528\u6237\u6B63\u5E38\u7684\u5DE5\u4F5C\u7EBF\u7A0B\u5168\u90E8\u505C\u6389\u3002</p></li><li><p>\u5F00\u53D1\u4E2D\u4E0D\u8981\u7528 system.GC() \u4F1A\u5BFC\u81F4Stop-the- world\u7684\u53D1\u751F\u3002</p></li></ul><h2 id="_4-\u5783\u573E\u56DE\u6536\u7684\u5E76\u53D1\u4E0E\u5E76\u884C" tabindex="-1"><a class="header-anchor" href="#_4-\u5783\u573E\u56DE\u6536\u7684\u5E76\u53D1\u4E0E\u5E76\u884C" aria-hidden="true">#</a> 4.\u5783\u573E\u56DE\u6536\u7684\u5E76\u53D1\u4E0E\u5E76\u884C</h2><p>\u5E76\u53D1\u548C\u5E76\u884C\uFF0C\u5728\u8C08\u8BBA\u5783\u573E\u6536\u96C6\u5668\u7684\u4E0A\u4E0B\u6587\u8BED\u5883\u4E2D\uFF0C\u5B83\u4EEC\u53EF\u4EE5\u89E3\u91CA\u5982\u4E0B\uFF1A **\u5E76\u884C( Parallel)\u{1F617}*\u6307\u591A\u6761\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u5E76\u884C\u5DE5\u4F5C\uFF0C\u4F46\u6B64\u65F6\u7528\u6237\u7EBF\u7A0B\u4ECD\u5904\u4E8E\u7B49\u5F85\u72B6\u6001\u3002\u5982 Pardew\u3001 Parallel Scavenge\u3001 Parallel Old **\u4E32\u884C( Serial)\u{1F617}*\u76F8\u8F83\u4E8E\u5E76\u884C\u7684\u6982\u5FF5\uFF0C\u5355\u7EBF\u7A0B\u6267\u884C\u3002\u5982\u679C\u5185\u5B58\u4E0D\u591F\uFF0C\u5219\u7A0B\u5E8F\u6682\u505C\uFF0C\u542F\u52A8JVM\u5783\u573E\u56DE\u6536\u5668\u8FDB\u884C\u5783\u573E\u56DE\u6536\u3002\u56DE\u6536\u5B8C\uFF0C\u518D\u542F\u52A8\u7A0B\u5E8F\u7684\u7EBF\u7A0B\u3002 <strong>\u5E76\u53D1\u548C\u5E76\u884C,\u5728\u8C08\u8BBA\u5783\u573E\u6536\u96C6\u5668\u7684\u4E0A\u4E0B\u6587\u8BED\u5883\u4E2D,\u5B83\u4EEC\u53EF\u4EE5\u89E3\u91CA\u5982\u4E0B:</strong> \u5E76\u53D1( Concurrent):\u6307\u7528\u6237\u7EBF\u7A0B\u4E0E\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u540C\u65F6\u6267\u884C(\u4F46\u4E0D\u4E00\u5B9A\u662F\u5E76\u884C\u7684,\u53EF\u80FD\u4F1A\u4EA4\u66FF\u6267\u884C),\u5783\u573E\u56DE\u6536\u7EBF\u7A0B\u5728\u6267\u884C\u65F6\u4E0D\u4F1A\u505C\u987F\u7528\u6237\u7A0B\u5E8F\u7684\u8FD0\u884C\u3002\u7528\u6237\u7A0B\u5E8F\u5728\u7EE7\u7EED\u8FD0\u884C,\u800C\u5783\u573E\u6536\u96C6\u7A0B\u5E8F\u7EBF\u7A0B\u8FD0\u884C\u4E8E\u53E6\u30FC\u4E2ACPU\u4E0A\uFF0C\u5982:CMS\u3001G1\u3002</p><h2 id="_5-\u5B89\u5168\u70B9\u4E0E\u5B89\u5168\u533A\u57DF" tabindex="-1"><a class="header-anchor" href="#_5-\u5B89\u5168\u70B9\u4E0E\u5B89\u5168\u533A\u57DF" aria-hidden="true">#</a> 5.\u5B89\u5168\u70B9\u4E0E\u5B89\u5168\u533A\u57DF</h2><h4 id="\u5B89\u5168\u70B9" tabindex="-1"><a class="header-anchor" href="#\u5B89\u5168\u70B9" aria-hidden="true">#</a> \u5B89\u5168\u70B9</h4><ul><li>\u7A0B\u5E8F\u6267\u884C\u65F6\u5E76\u975E\u5728\u6240\u6709\u5730\u65B9\u90FD\u80FD\u505C\u987F\u4E0B\u6765\u5F00\u59CBGC,\u53EA\u6709\u5728\u7279\u5B9A\u7684\u4F4D\u7F6E\u624D\u80FD\u505C\u987F\u4E0B\u6765\u5F00\u59CBGC,\u8FD9\u4E9B\u4F4D\u7F6E\u79F0\u4E3A\u201C\u5B89\u5168\u70B9( Safepoint)\u201D\u3002</li><li>Safe Pointl\u7684\u9009\u62E9\u5F88\u91CD\u8981\uFF0C\u5982\u679C\u592A\u5C11\u53EF\u80FD\u5BFC\u81F4GC\u7B49\u5F85\u7684\u65F6\u95F4\u592A\u957F\uFF0C\u5982\u679C\u592A\u9891\u7E41\u53EF\u80FD\u5BFC\u81F4\u8FD0\u884C\u65F6\u7684\u6027\u80FD\u95EE\u9898\u3002\u5927\u90E8\u5206\u6307\u4EE4\u7684\u6267\u884C\u65F6\u95F4\u90FD\u975E\u5E38\u77ED\u6682\u901A\u5E38\u4F1A\u6839\u636E\u201C\u662F\u5426\u5177\u6709\u8BA9\u7A0B\u5E8F\u957F\u65F6\u95F4\u6267\u884C\u7684\u7279\u5F81\u201D\u4E3A\u6807\u51C6\u3002\u6BD4\u5982\uFF1A\u9009\u62E9\u4E9B\u6267\u884C\u65F6\u95F4\u8F83\u957F\u7684\u6307\u4EE4\u4F5C\u4E3A Safe Point,\u5982<strong>\u65B9\u6CD5\u8C03\u7528\u3001\u5FAA\u73AF\u8DF3\u8F6C\u548C\u5F02\u5E38\u8DF3\u8F6C</strong>\u7B49\u3002</li><li>\u5982\u4F55\u5728GC\u53D1\u751F\u65F6\uFF0C\u68C0\u67FB\u6240\u6709\u7EBF\u7A0B\u90FD\u8DD1\u5230\u6700\u8FD1\u7684\u5B89\u5168\u70B9\u505C\u987F\u4E0B\u6765\u5462\uFF1F</li><li>\u62A2\u5148\u5F0F\u4E2D\u65AD\uFF1A\uFF08\u76EE\u524D\u6CA1\u6709\u865A\u62DF\u673A\u91C7\u7528\u4E86) \u9996\u5148\u4E2D\u65AD\u6240\u6709\u7EBF\u7A0B\u3002\u5982\u679C\u8FD8\u6709\u7EBF\u7A0B\u4E0D\u5728\u5B89\u5168\u70B9\uFF0C\u5C31\u6062\u590D\u7EBF\u7A0B\uFF0C\u8BA9\u7EBF\u7A0B\u8DD1\u5230\u5B89\u5168\u70B9\u3002</li><li>\u4E3B\u52A8\u5F0F\u4E2D\u65AD \u8BBE\u7F6E\u4E00\u4E2A\u4E2D\u65AD\u6807\u5FD7\uFF0C\u5404\u4E2A\u7EBF\u7A0B\u8FD0\u884C\u5230 Safe Point\u7684\u65F6\u5019\u4E3B\u52A8\u8F6E\u8BE2\u8FD9\u4E2A\u6807\u5FD7\uFF0C\u5982\u679C\u4E2D\u65AD\u6807\u5FD7\u4E3A\u771F\uFF0C\u5219\u5C06\u81EA\u5DF1\u8FDB\u884C\u4E2D\u65AD\u6302\u8D77\u3002</li></ul><h4 id="\u5B89\u5168\u533A\u57DF" tabindex="-1"><a class="header-anchor" href="#\u5B89\u5168\u533A\u57DF" aria-hidden="true">#</a> \u5B89\u5168\u533A\u57DF</h4><ul><li>Safepoint\u673A\u5236\u4FDD\u8BC1\u4E86\u7A0B\u5E8F\u6267\u884C\u65F6\uFF0C\u5728\u4E0D\u592A\u957F\u7684\u65F6\u95F4\u5185\u5C31\u4F1A\u9047\u5230\u53EF\u8FDB\u5165GC\u7684 Safepoint\u3002\u4F46\u662F\uFF0C\u7A0B\u5E8F\u201C\u4E0D\u6267\u884C\u201D\u7684\u65F6\u5019\u5462\uFF1F\u4F8B\u5982\u7EBF\u7A0B\u5904\u4E8ESleep\u72B6\u6001\u6216Blocked\u72B6\u6001\uFF0C\u8FD9\u65F6\u5019\u7EBF\u7A0B\u65E0\u6CD5\u54CD\u5E94JVM\u7684\u4E2D\u65AD\u8BF7\u6C42\uFF0C\u201C\u8D70\u201D\u5230\u5B89\u5168\u70B9\u53BB\u4E2D\u65AD\u6302\u8D77\uFF0CJVM\u4E5F\u4E0D\u592A\u53EF\u80FD\u7B49\u5F85\u7EBF\u7A0B\u88AB\u5524\u9192\u3002\u5BF9\u4E8E\u8FD9\u79CD\u60C5\u51B5\uFF0C\u5C31\u9700\u8981\u5B89\u5168\u533A\u57DF( Safe Region)\u6765\u89E3\u51B3\u3002</li><li>\u5B89\u5168\u533A\u57DF\u662F\u6307\u5728\u4E00\u6BB5\u4EE3\u7801\u7247\u6BB5\u4E2D\uFF0C\u5BF9\u8C61\u7684\u5F15\u7528\u5173\u7CFB\u4E0D\u4F1A\u53D1\u751F\u53D8\u5316\uFF0C\u5728\u8FD9\u4E2A\u533A\u57DF\u4E2D\u7684\u4EFB\u4F55\u4F4D\u7F6E\u5F00\u59CBGC\u90FD\u662F\u5B89\u5168\u7684\u3002\u6211\u4EEC\u4E5F\u53EF\u4EE5\u628A Safe Region\u770B\u505A\u662F\u88AB\u6269\u5C55\u4E86\u7684 Safepoint\u3002</li></ul><p>\u5B9E\u9645\u6267\u884C\u65F6\uFF1A 1\u3001\u5F53\u7EBF\u7A0B\u8FD0\u884C\u5230 Safe Region\u7684\u4EE3\u7801\u65F6\uFF0C\u9996\u5148\u6807\u8BC6\u5DF2\u7ECF\u8FDB\u5165\u4E86 Safe Region,\u5982\u679C\u8FD9\u6BB5\u65F6\u95F4\u5185\u53D1\u751FGC,JVM\u4F1A\u5FFD\u7565\u6807\u8BC6\u4E3A Safe Region\u72B6\u6001\u7684\u7EBF\u7A0B 2\u3001\u5F53\u7EBF\u7A0B\u5373\u5C06\u79BB\u5F00 Safe Region\u65F6\uFF0C\u4F1A\u68C0\u67FBJVM\u662F\u5426\u5DF2\u7ECF\u5B8C\u6210GC,\u5982\u679C\u5B8C\u6210\u4E86\uFF0C\u5219\u7EE7\u7EED\u8FD0\u884C\uFF0C\u5426\u5219\u7EBF\u7A0B\u5FC5\u987B\u7B49\u5F85\u76F4\u5230\u6536\u5230\u53EF\u4EE5\u5B89\u5168\u79BB\u5F00 Safe Regiong\u7684\u4FE1\u53F7\u4E3A\u6B62\uFF1B</p><h2 id="_6-\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#_6-\u5F15\u7528" aria-hidden="true">#</a> 6.\u5F15\u7528</h2><p>\u200B \u6211\u4EEC\u5E0C\u671B\u80FD\u63CF\u8FF0\u8FD9\u6837\u4E00\u7C7B\u5BF9\u8C61\uFF1A\u5F53\u5185\u5B58\u7A7A\u95F4\u8FD8\u8DB3\u591F\u65F6\uFF0C\u5219\u80FD\u4FDD\u7559\u5728\u5185\u5B58\u4E2D\uFF1B\u5982\u679C\u5185\u5B58\u7A7A\u95F4\u5728\u8FDB\u884C\u5783\u573E\u6536\u96C6\u540E\u8FD8\u662F\u5F88\u7D27\u5F20\uFF0C\u5219\u53EF\u4EE5\u629B\u5F03\u8FD9\u4E9B\u5BF9\u8C61\u3002 \u3010\u65E2\u504F\u95E8\u53C8\u975E\u5E38\u9AD8\u9891\u7684\u9762\u8BD5\u9898\u3011\u5F3A\u5F15\u7528\u3001\u8F6F\u5F15\u7528\u3001\u5F31\u5F15\u7528\u3001\u865A\u5F15\u7528\u6709\u4EC0\u4E48\u533A\u522B\uFF1F\u5177\u4F53\u4F7F\u7528\u573A\u666F\u662F\u4EC0\u4E48\uFF1F \u200B \u5728JDK1.2\u7248\u4E4B\u540E\uFF0CJava\u5BF9\u5F15\u7528\u7684\u6982\u5FF5\u8FDB\u884C\u4E86\u6269\u5145\uFF0C\u5C06\u5F15\u7528\u5206\u4E3A\u5F3A\u5F15\u7528\uFF08 Strong Reference)\u3001\u8F6F\u5F15\u7528( Soft Reference)\u3001\u5F31\u5F15\u7528( Weak Reference)\u548C\u865A\u5F15\u7528(Phantom Reference)4\u79CD\uFF0C<strong>\u8FD94\u79CD\u5F15\u7528\u5F3A\u5EA6\u4F9D\u6B21\u9010\u6E10\u51CF\u5F31\u3002</strong> \u200B \u9664\u5F3A\u5F15\u7528\u5916\uFF0C\u5176\u4ED63\u79CD\u5F15\u7528\u5747\u53EF\u4EE5\u5728java.lang. ref\u5305\u4E2D\u627E\u5230\u5B83\u4EEC\u7684\u8EAB\u5F71\u3002\u5982\u4E0B\u56FE\uFF0C\u663E\u793A\u4E86\u8FD93\u79CD\u5F15\u7528\u7C7B\u578B\u5BF9\u5E94\u7684\u7C7B\uFF0C\u5F00\u53D1\u4EBA\u5458\u53EF\u4EE5\u5728\u5E94\u7528\u7A0B\u5E8F\u4E2D\u76F4\u63A5\u4F7F\u7528\u5B83\u4EEC\u3002</p><p><img src="http://qnimg.gisfsde.com/work/image-20211215135730045.png" alt="image-20211215135730045" loading="lazy"></p><p>Reference\u5B50\u7C7B\u4E2D\u53EA\u6709\u7EC8\u7ED3\u5668\u5F15\u7528\u662F\u5305\u5185\u53EF\u89C1\u7684\uFF0C\u5176\u4ED63\u79CD\u5F15\u7528\u7C7B\u578B\u5747\u4E3Apublic\u53EF\u4EE5\u5728\u5E94\u7528\u7A0B\u5E8F\u4E2D\u76F4\u63A5\u4F7F\u7528</p><ul><li>\u5F3A\u5F15\u7528( StrongReference)\u{1F617}*\u3010\u5F15\u7528\u5728\u5C31\u522B\u7BA1\u6211\u3011**\u6700\u4F20\u7EDF\u7684\u201C\u5F15\u7528\u201D\u7684\u5B9A\u4E49\uFF0C\u662F\u6307\u5728\u7A0B\u5E8F\u4EE3\u7801\u4E4B\u4E2D\u666E\u904D\u5B58\u5728\u7684\u5F15\u7528\u8D4B\u503C\uFF0C\u5373\u7C7B\u4F3C\u201C Object obj= new Object\uFF08\uFF09\u201D\u8FD9\u79CD\u5F15\u7528\u5173\u7CFB\u3002\u65E0\u8BBA\u4EFB\u4F55\u60C5\u51B5\u4E0B\uFF0C<strong>\u53EA\u8981\u5F3A\u5F15\u7528\u5173\u7CFB\u8FD8\u5B58\u5728\uFF0C\u5783\u573E\u6536\u96C6\u5668\u5C31\u6C38\u8FDC\u4E0D\u4F1A\u56DE\u6536\u6389\u88AB\u5F15\u7528\u7684\u5BF9\u8C61\u3002</strong></li><li>\u8F6F\u5F15\u7528( SoftReference)\u{1F617}*\u3010\u5FEB\u6EE1\u4E86\u56DE\u6536\u6211\u3011**\u5728\u7CFB\u7EDF\u5C06\u8981\u53D1\u751F\u5185\u5B58\u6EA2\u51FA\u4E4B\u524D\uFF0C\u5C06\u4F1A\u628A\u8FD9\u4E9B\u5BF9\u8C61\u5217\u5165\u56DE\u6536\u8303\u56F4\u4E4B\u4E2D\u8FDB\u884C\u7B2C\u4E8C\u6B21\u56DE\u6536\u3002\u5982\u679C\u8FD9\u6B21\u56DE\u6536\u540E\u8FD8\u6CA1\u6709\u8DB3\u591F\u7684\u5185\u5B58\uFF0C\u624D\u4F1A\u629B\u51FA\u5185\u5B58\u6EA2\u51FA\u5F02\u5E38\u3002</li><li>\u5F31\u5F15\u7528( WeakReference)\u{1F617}*\u3010\u770B\u5230\u5C31\u56DE\u6536\u6211\u3011**\u88AB\u5F31\u5F15\u7528\u5173\u8054\u7684\u5BF9\u8C61\u53EA\u80FD\u751F\u5B58\u5230\u4E0B\u4E00\u6B21\u5783\u573E\u6536\u96C6\u4E4B\u524D\u3002\u5F53\u5783\u573E\u6536\u96C6\u5668\u5DE5\u4F5C\u65F6\uFF0C\u65E0\u8BBA\u5185\u5B58\u7A7A\u95F4\u662F\u5426\u8DB3\u591F,\u90FD\u4F1A\u56DE\u6536\u6389\u88AB\u5F31\u5F15\u7528\u5173\u8054\u7684\u5BF9\u8C61.</li><li>\u865A\u5F15\u7528( PhantomReference)\u{1F617}*\u3010\u4E0D\u5F71\u54CD\u4F60\u3011**\u4E00\u4E2A\u5BF9\u8C61\u662F\u5426\u6709\u865A\u5F15\u7528\u7684\u5B58\u5728,\u5B8C\u5168\u4E0D\u4F1A\u5BF9\u5176\u751F\u5B58\u65F6\u95F4\u6784\u6210\u5F71\u54CD,\u4E5F\u65E0\u6CD5\u901A\u8FC7\u865A\u5F15\u7528\u6765\u83B7\u5F97\u4E00\u4E2A\u5BF9\u8C61\u7684\u5B9E\u4F8B.\u4E3A\u4E00\u4E2A\u5BF9\u8C61\u8BBE\u7F6E\u865A\u5F15\u7528\u5173\u8054\u7684\u552F\u4E00\u76EE\u7684\u5C31\u662F\u80FD\u5728\u8FD9\u4E2A\u5BF9\u8C61\u88AB\u6536\u96C6\u5668\u56DE\u6536\u65F6\u6536\u5230\u4E00\u4E2A\u7CFB\u7EDF\u901A\u77E5</li></ul><h3 id="\u5F3A\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#\u5F3A\u5F15\u7528" aria-hidden="true">#</a> \u5F3A\u5F15\u7528</h3><ul><li>\u5728Java\u7A0B\u5E8F\u4E2D\uFF0C\u6700\u5E38\u89C1\u7684\u5F15\u7528\u7C7B\u578B\u662F\u5F3A\u5F15\u7528(\u666E\u901A\u7CFB\u7EDF99%\u4EE5\u4E0A\u90FD\u662F\u5F3A\u5F15\u7528)\uFF0C\u4E5F\u5C31\u662F\u6211\u4EEC\u6700\u5E38\u89C1\u7684\u666E\u901A\u5BF9\u8C61\u5F15\u7528\uFF0C\u4E5F\u662F\u9ED8\u8BA4\u7684\u5F15\u7528\u7C7B\u578B\u3002</li><li>\u5F53\u5728JAVA\u8BED\u8A00\u4E2D\u4F7F\u7528new\u64CD\u4F5C\u7B26\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u5BF9\u8C61\uFF0C\u5E76\u5C06\u5176\u8D4B\u503C\u7ED9\u4E00\u4E2A\u53D8\u91CF\u7684\u65F6\u5019\uFF0C\u8FD9\u4E2A\u53D8\u91CF\u5C31\u6210\u4E3A\u6307\u5411\u8BE5\u5BF9\u8C61\u7684\u4E00\u4E2A\u5F3A\u5F15\u7528\u3002</li><li>\u5F3A\u5F15\u7528\u7684\u5BF9\u8C61\u662F\u53EF\u89E6\u53CA\u7684\uFF0C\u5783\u573E\u6536\u96C6\u5668\u5C31\u6C38\u8FDC\u4E0D\u4F1A\u56DE\u6536\u6389\u88AB\u5F15\u7528\u7684\u5BF9\u8C61</li><li>\u5BF9\u4E8E\u4E00\u4E2A\u666E\u901A\u7684\u5BF9\u8C61\uFF0C\u5982\u679C\u6CA1\u6709\u5176\u4ED6\u7684\u5F15\u7528\u5173\u7CFB\uFF0C\u53EA\u8981\u8D85\u8FC7\u4E86\u5F15\u7528\u7684\u4F5C\u7528\u57DF\u6216\u8005\u663E\u5F0F\u5730\u5C06\u76F8\u5E94\uFF08\u5F3A\uFF09\u5F15\u7528\u8D4B\u503C\u4E3Anull,\u5C31\u662F\u53EF\u4EE5\u5F53\u505A\u5783\u573E\u88AB\u6536\u96C6\u4E86\uFF0C\u5F53\u7136\u5177\u4F53\u56DE\u6536\u65F6\u673A\u8FD8\u662F\u8981\u770B\u5783\u573E\u6536\u96C6\u7B56\u7565\u3002</li><li>\u76F8\u5BF9\u7684\uFF0C\u8F6F\u5F15\u7528\u3001\u5F31\u5F15\u7528\u548C\u865A\u5F15\u7528\u7684\u5BF9\u8C61\u662F\u8F6F\u53EF\u89E6\u53CA\u3001\u5F31\u53EF\u89E6\u53CA\u548C\u865A\u53EF\u89E6\u53CA\u7684\uFF0C\u5728\u4E00\u5B9A\u6761\u4EF6\u4E0B\uFF0C\u90FD\u662F\u53EF\u4EE5\u88AB\u56DE\u6536\u7684\u3002\u6240\u4EE5\uFF0C\u5F3A\u5F15\u7528\u662F\u9020\u6210Java\u5185\u5B58\u6CC4\u6F0F\u7684\u4E3B\u8981\u539F\u56E0\u4E4B</li></ul><h3 id="\u8F6F\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#\u8F6F\u5F15\u7528" aria-hidden="true">#</a> \u8F6F\u5F15\u7528</h3><ul><li>\u8F6F\u5F15\u7528\u662F\u7528\u6765\u63CF\u8FF0\u4E00\u4E9B\u8FD8\u6709\u7528\uFF0C\u4F46\u975E\u5FC5\u9700\u7684\u5BF9\u8C61\u3002\u53EA\u88AB\u8F6F\u5F15\u7528\u5173\u8054\u7740\u7684\u5BF9\u8C61\uFF0C\u5728\u7CFB\u7EDF\u5C06\u8981\u53D1\u751F\u5185\u5B58\u6EA2\u51FA\u5F02\u5E38\u524D\uFF0C\u4F1A\u628A\u8FD9\u4E9B\u5BF9\u8C61\u5217\u8FDB\u56DE\u6536\u8303\u56F4\u4E4B\u4E2D\u8FDB\u884C\u7B2C\u4E8C\u6B21\u56DE\u6536\uFF0C\u5982\u679C\u8FD9\u6B21\u56DE\u6536\u8FD8\u6CA1\u6709\u8DB3\u591F\u7684\u5185\u5B58\uFF0C\u30AA\u4F1A\u629B\u51FA\u5185\u5B58\u6EA2\u51FA\u5F02\u5E38\u3002</li><li>\u8F6F\u5F15\u7528\u901A\u5E38\u7528\u6765\u5B9E\u73B0\u5185\u5B58\u654F\u611F\u7684\u7F13\u5B58\u3002\u6BD4\u5982\uFF1A\u9AD8\u901F\u7F13\u5B58\u5C31\u6709\u7528\u5230\u8F6F\u5F15\u7528\u3002\u5982\u679C\u8FD8\u6709\u7A7A\u95F2\u5185\u5B58\uFF0C\u5C31\u53EF\u4EE5\u6682\u65F6\u4FDD\u7559\u7F13\u5B58\uFF0C\u5F53\u5185\u5B58\u4E0D\u8DB3\u65F6\u6E05\u7406\u6389\uFF0C\u8FD9\u6837\u5C31\u4FDD\u8BC1\u4E86\u4F7F\u7528\u7F13\u5B58\u7684\u540C\u65F6\uFF0C\u4E0D\u4F1A\u8017\u5C3D\u5185\u5B58\u3002</li><li>\u5783\u573E\u56DE\u6536\u5668\u5728\u67D0\u4E2A\u65F6\u523B\u51B3\u5B9A\u56DE\u6536\u8F6F\u53EF\u8FBE\u7684\u5BF9\u8C61\u7684\u65F6\u5019\uFF0C\u4F1A\u6E05\u7406\u8F6F\u5F15\u7528\uFF0C\u5E76\u53EF\u9009\u5730\u628A\u5F15\u7528\u5B58\u653E\u5230\u4E00\u4E2A\u5F15\u7528\u961F\u5217( Reference Queue)\u3002</li><li>\u7C7B\u4F3C\u5F31\u5F15\u7528\uFF0C\u53EA\u4E0D\u8FC7Java\u865A\u62DF\u673A\u4F1A\u5C3D\u91CF\u8BA9\u8F6F\u5F15\u7528\u7684\u5B58\u6D3B\u65F6\u95F4\u957F\u4E00\u4E9B\uFF0C\u8FEB\u4E0D\u5F97\u5DF2\u624D\u6E05\u7406\u3002</li></ul><h3 id="\u5F31\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#\u5F31\u5F15\u7528" aria-hidden="true">#</a> \u5F31\u5F15\u7528</h3><ul><li>\u5F31\u5F15\u7528\u4E5F\u662F\u7528\u6765\u63CF\u8FF0\u90A3\u4E9B\u975E\u5FC5\u9700\u5BF9\u8C61\uFF0C\u88AB\u5F31\u5F15\u7528\u5173\u8054\u7684\u5BF9\u8C61\u53EA\u80FD\u751F\u5B58\u5230\u4E0B\u4E00\u6B21\u5783\u573E\u6536\u96C6\u53D1\u751F\u4E3A\u6B62\u3002\u5728\u7CFB\u7EDFGC\u65F6\uFF0C\u53EA\u8981\u53D1\u73B0\u5F31\u5F15\u7528\uFF0C\u4E0D\u7BA1\u7CFB\u7EDF\u5806\u7A7A\u95F4\u4F7F\u7528\u662F\u5426\u5145\u8DB3\uFF0C\u90FD\u4F1A\u56DE\u6536\u6389\u53EA\u88AB\u5F31\u5F15\u7528\u5173\u8054\u7684\u5BF9\u8C61</li><li>\u4F46\u662F\uFF0C\u7531\u4E8E\u5783\u573E\u56DE\u6536\u5668\u7684\u7EBF\u7A0B\u901A\u5E38\u4F18\u5148\u7EA7\u5F88\u4F4E\uFF0C\u56E0\u6B64\uFF0C\u5E76\u4E0D\u4E00\u5B9A\u80FD\u5F88\u5FEB\u5730\u53D1\u73B0\u6301\u6709\u5F31\u5F15\u7528\u7684\u5BF9\u8C61\u3002\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u5F31\u5F15\u7528\u5BF9\u8C61\u53EF\u4EE5\u5B58\u5728\u8F83\u957F\u7684\u65F6\u95F4\u3002</li><li>\u5F31\u5F15\u7528\u548C\u8F6F\u5F15\u7528\u4E00\u6837\uFF0C\u5728\u6784\u9020\u5F31\u5F15\u7528\u65F6\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u4E00\u4E2A\u5F15\u7528\u961F\u5217\uFF0C\u5F53\u5F31\u5F15\u7528\u5BF9\u8C61\u88AB\u56DE\u6536\u65F6\uFF0C\u5C31\u4F1A\u52A0\u5165\u6307\u5B9A\u7684\u5F15\u7528\u961F\u5217\uFF0C\u901A\u8FC7\u8FD9\u4E2A\u961F\u5217\u53EF\u4EE5\u8DDF\u8E2A\u5BF9\u8C61\u7684\u56DE\u6536\u60C5\u51B5\u3002</li><li>\u8F6F\u5F15\u7528\u3001\u5F31\u5F15\u7528\u90FD\u975E\u5E38\u9002\u5408\u6765\u4FDD\u5B58\u90A3\u4E9B\u53EF\u6709\u53EF\u65E0\u7684\u7F13\u5B58\u6570\u636E\u3002\u5982\u679C\u8FD9\u4E48\u505A\uFF0C\u5F53\u7CFB\u7EDF\u5185\u5B58\u4E0D\u8DB3\u65F6\uFF0C\u8FD9\u4E9B\u7F13\u5B58\u6570\u636E\u4F1A\u88AB\u56DE\u6536\uFF0C\u4E0D\u4F1A\u5BFC\u81F4\u5185\u5B58\u6EA2\u51FA\u3002\u800C\u5F53\u5185\u5B58\u8D44\u6E90\u5145\u8DB3\u65F6\uFF0C\u8FD9\u4E9B\u7F13\u5B58\u6570\u636E\u53C8\u53EF\u4EE5\u5B58\u5728\u76F8\u5F53\u957F\u7684\u65F6\u95F4\uFF0C\u4ECE\u800C\u8D77\u5230\u52A0\u901F\u7CFB\u7EDF\u7684\u4F5C\u7528\u3002</li><li>\u5F31\u5F15\u7528\u5BF9\u8C61\u4E0E\u8F6F\u5F15\u7528\u5BF9\u8C61\u7684\u6700\u5927\u4E0D\u540C\u5C31\u5728\u4E8E\uFF0C\u5F53GC\u5728\u8FDB\u884C\u56DE\u6536\u65F6\uFF0C\u9700\u8981\u901A\u8FC7\u7B97\u6CD5\u68C0\u67E5\u662F\u5426\u56DE\u6536\u8F6F\u5F15\u7528\u5BF9\u8C61\uFF0C\u800C\u5BF9\u4E8E\u5F31\u5F15\u7528\u5BF9\u8C61\uFF0CGC\u603B\u662F\u8FDB\u884C\u56DE\u6536\u3002\u5F31\u5F15\u7528\u5BF9\u8C61\u66F4\u5BB9\u6613\u3001\u66F4\u5FEB\u88ABGC\u56DE\u6536\u3002\u9762\u8BD5\u9898\uFF1A\u4F60\u5F00\u53D1\u4E2D\u4F7F\u7528\u8FC7 WeakHashMap\u5417\uFF1F</li></ul><h3 id="\u865A\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#\u865A\u5F15\u7528" aria-hidden="true">#</a> \u865A\u5F15\u7528</h3><p>\u200B \u4E5F\u79F0\u4E3A\u201C\u5E7D\u7075\u5F15\u7528\u201D\u6216\u8005\u201C\u5E7B\u5F71\u5F15\u7528\u201D\uFF0C\u662F\u6240\u6709\u5F15\u7528\u7C7B\u578B\u4E2D\u6700\u5F31\u7684\u4E00\u4E2A\u3002\u4E00\u4E2A\u5BF9\u8C61\u662F\u5426\u6709\u865A\u5F15\u7528\u7684\u5B58\u5728\uFF0C\u5B8C\u5168\u4E0D\u4F1A\u51B3\u5B9A\u5BF9\u8C61\u7684\u751F\u547D\u5468\u671F\u3002\u5982\u679C\u4E00\u4E2A\u5BF9\u8C61\u4EC5\u6301\u6709\u865A\u5F15\u7528\uFF0C\u90A3\u4E48\u5B83\u548C\u6CA1\u6709\u5F15\u7528\u51E0\u4E4E\u662F\u4E00\u6837\u7684\uFF0C\u968F\u65F6\u90FD\u53EF\u80FD\u88AB\u5783\u573E\u56DE\u6536\u5668\u56DE\u6536\u3002\u5B83\u4E0D\u80FD\u5355\u72EC\u4F7F\u7528\uFF0C\u4E5F\u65E0\u6CD5\u901A\u8FC7\u865A\u5F15\u7528\u6765\u83B7\u53D6\u88AB\u5F15\u7528\u7684\u5BF9\u8C61\u3002\u5F53\u8BD5\u56FE\u901A\u8FC7\u865A\u5F15\u7528\u7684get\uFF08\uFF09\u65B9\u6CD5\u53D6\u5F97\u5BF9\u8C61\u65F6\uFF0C\u603B\u662Fnull\u3002\u4E3A\u4E00\u4E2A\u5BF9\u8C61\u8BBE\u7F6E\u865A\u5F15\u7528\u5173\u8054\u7684\u552F\u4E00\u76EE\u7684\u5728\u4E8E\u8DDF\u8E2A\u5783\u573E\u56DE\u6536\u8FC7\u7A0B\u3002\u6BD4\u5982\uFF1A\u80FD\u5728\u8FD9\u4E2A\u5BF9\u8C61\u88AB\u6536\u96C6\u5668\u56DE\u6536\u65F6\u6536\u5230\u4E00\u4E2A\u7CFB\u7EDF\u901A\u77E5\u3002</p><p>\u200B \u865A\u5F15\u7528\u5FC5\u987B\u548C\u5F15\u7528\u961F\u5217\u4E00\u8D77\u4F7F\u7528\u3002\u865A\u5F15\u7528\u5728\u521B\u5EFA\u65F6\u5FC5\u987B\u63D0\u4F9B\u4E00\u4E2A\u5F15\u7528\u961F\u5217\u4F5C\u4E3A\u53C2\u6570\u3002\u5F53\u5783\u573E\u56DE\u6536\u5668\u51C6\u5907\u56DE\u6536\u4E00\u4E2A\u5BF9\u8C61\u65F6\uFF0C\u5982\u679C\u53D1\u73B0\u5B83\u8FD8\u6709\u865A\u5F15\u7528\uFF0C\u5C31\u4F1A\u5728\u56DE\u6536\u5BF9\u8C61\u540E\uFF0C\u5C06\u8FD9\u4E2A\u865A\u5F15\u7528\u52A0\u5165\u5F15\u7528\u961F\u5217\uFF0C\u4EE5\u901A\u77E5\u5E94\u7528\u7A0B\u5E8F\u5BF9\u8C61\u7684\u56DE\u6536\u60C5\u51B5\u3002\u7531\u4E8E\u865A\u5F15\u7528\u53EF\u4EE5\u8DDF\u8E2A\u5BF9\u8C61\u7684\u56DE\u6536\u65F6\u95F4\uFF0C\u56E0\u6B64\uFF0C\u4E5F\u53EF\u4EE5\u5C06\u4E00\u4E9B\u8D44\u6E90\u91CA\u653E\u64CD\u4F5C\u653E\u7F6E\u5728\u865A\u5F15\u7528\u4E2D\u6267\u884C\u548C\u8BB0\u5F55\u3002\u5728JDK1.2\u7248\u4E4B\u540E\u63D0\u4F9B\u4E86 PhantomReference\u7C7B\u6765\u5B9E\u73B0\u865A\u5F15\u7528\u3002</p><h3 id="\u7EC8\u7ED3\u5668\u5F15\u7528" tabindex="-1"><a class="header-anchor" href="#\u7EC8\u7ED3\u5668\u5F15\u7528" aria-hidden="true">#</a> \u7EC8\u7ED3\u5668\u5F15\u7528</h3><p>\u200B \u5B83\u7528\u4EE5\u5B9E\u73B0\u5BF9\u8C61\u7684finalize()\u65B9\u6CD5\uFF0C\u4E5F\u53EF\u4EE5\u79F0\u4E3A\u7EC8\u7ED3\u5668\u5F15\u7528\u3002\u65E0\u9700\u624B\u52A8\u7F16\u7801\uFF0C\u5176\u5185\u90E8\u914D\u5408\u5F15\u7528\u961F\u5217\u4F7F\u7528\u3002\u5728GC\u65F6\uFF0C\u7EC8\u7ED3\u5668\u5F15\u7528\u5165\u961F\u3002\u7531Finalizer\u7EBF\u7A0B\u901A\u8FC7\u7EC8\u7ED3\u5668\u5F15\u7528\u627E\u5230\u88AB\u5F15\u7528\u5BF9\u8C61\u5E76\u8C03\u7528\u5B83\u7684finalize()\u65B9\u6CD5\uFF0C\u7B2C\u4E8C\u6B21GC\u65F6\u624D\u80FD\u56DE\u6536\u88AB\u5F15\u7528\u5BF9\u8C61\u3002</p><h1 id="\u5341\u4E03\u3001\u5783\u573E\u56DE\u6536\u5668" tabindex="-1"><a class="header-anchor" href="#\u5341\u4E03\u3001\u5783\u573E\u56DE\u6536\u5668" aria-hidden="true">#</a> \u5341\u4E03\u3001\u5783\u573E\u56DE\u6536\u5668</h1><h2 id="_1-gc\u5206\u7C7B" tabindex="-1"><a class="header-anchor" href="#_1-gc\u5206\u7C7B" aria-hidden="true">#</a> 1.GC\u5206\u7C7B</h2><p>\u200B \u5783\u573E\u6536\u96C6\u5668\u6CA1\u6709\u5728\u89C4\u8303\u4E2D\u8FDB\u884C\u8FC7\u591A\u7684\u89C4\u5B9A\uFF0C\u53EF\u4EE5\u7531\u4E0D\u540C\u7684\u5382\u5546\u3001\u4E0D\u540C\u7248\u672C\u7684JVM\u6765\u5B9E\u73B0\u3002\u7531\u4E8EJDK\u7684\u7248\u672C\u5904\u4E8E\u9AD8\u901F\u9001\u4EE3\u8FC7\u7A0B\u4E2D\uFF0C\u56E0\u6B64Java\u53D1\u5C55\u81F3\u4ECA\u5DF2\u7ECF\u884D\u751F\u4E86\u4F17\u591A\u7684GC\u7248\u672C\u3002\u4ECE\u4E0D\u540C\u89D2\u5EA6\u5206\u6790\u5783\u573E\u6536\u96C6\u5668\uFF0C\u53EF\u4EE5\u5C06GC\u5206\u4E3A\u4E0D\u540C\u7684\u7C7B\u578B\u3002</p><p>\u200B <strong>\u6309\u7EBF\u7A0B\u6570\u5206</strong>\uFF0C\u53EF\u4EE5\u5206\u4E3A\u4E32\u884C\u5783\u573E\u56DE\u6536\u5668\u548C\u5E76\u884C\u5783\u573E\u56DE\u6536\u5668\u3002</p><p>\u200B \u4E32\u884C\u56DE\u6536\u6307\u7684\u662F\u5728\u540C\u4E00\u65F6\u95F4\u6BB5\u5185\u53EA\u5141\u8BB8\u6709\u4E00\u4E2ACPU\u7528\u4E8E\u6267\u884C\u5783\u573E\u56DE\u6536\u64CD\u4F5C\uFF0C\u6B64\u65F6\u5DE5\u4F5C\u7EBF\u7A0B\u88AB\u6682\u505C\uFF0C\u76F4\u81F3\u5783\u573E\u6536\u96C6\u5DE5\u4F5C\u7ED3\u675F\u3002\u5728\u8BF8\u5982\u5355CPU\u5904\u7406\u5668\u6216\u8005\u8F83\u5C0F\u7684\u5E94\u7528\u5185\u5B58\u7B49\u786C\u4EF6\u5E73\u53F0\u4E0D\u662F\u7279\u522B\u4F18\u8D8A\u7684\u573A\u5408\uFF0C\u4E32\u884C\u56DE\u6536\u5668\u7684\u6027\u80FD\u8868\u73B0\u53EF\u4EE5\u8D85\u8FC7\u5E76\u884C\u56DE\u6536\u5668\u548C\u5E76\u53D1\u56DE\u6536\u5668\u3002\u6240\u4EE5\uFF0C\u4E32\u884C\u56DE\u6536\u9ED8\u8BA4\u88AB\u5E94\u7528\u5728\u5BA2\u6237\u7AEF\u7684Client\u6A21\u5F0F\u4E0B\u7684JVM\u4E2D\u5728\u5E76\u53D1\u80FD\u529B\u6BD4\u8F83\u5F3A\u7684CPU\u4E0A\uFF0C\u5E76\u884C\u56DE\u6536\u5668\u4EA7\u751F\u7684\u505C\u987F\u65F6\u95F4\u8981\u77ED\u4E8E\u4E32\u884C\u56DE\u6536\u5668\u3002 \u200B \u548C\u4E32\u884C\u56DE\u6536\u76F8\u53CD\uFF0C\u5E76\u884C\u6536\u96C6\u53EF\u4EE5\u8FD0\u7528\u591A\u4E2ACPU\u540C\u65F6\u6267\u884C\u5783\u573E\u56DE\u6536\uFF0C\u56E0\u6B64\u63D0\u5347\u4E86\u5E94\u7528\u7684\u541E\u5410\u91CF\uFF0C\u4E0D\u8FC7\u5E76\u884C\u56DE\u6536\u4ECD\u7136\u4E0E\u4E32\u884C\u56DE\u6536\u4E00\u6837\uFF0C\u91C7\u7528\u72EC\u5360\u5F0F\uFF0C\u4F7F\u7528\u4E86\u201CStop-the- world\u201D\u673A\u5236\u3002</p><p>\u200B **\u6309\u7167\u5DE5\u4F5C\u6A21\u5F0F\u5206\uFF0C**\u53EF\u4EE5\u5206\u4E3A\u5E76\u53D1\u5F0F\u5783\u573E\u56DE\u6536\u5668\u548C\u72EC\u5360\u5F0F\u5783\u573E\u56DE\u6536\u5668\u3002</p><p>\u200B \u5E76\u53D1\u5F0F\u5783\u573E\u56DE\u6536\u5668\u4E0E\u5E94\u7528\u7A0B\u5E8F\u7EBF\u7A0B\u4EA4\u66FF\u5DE5\u4F5C\uFF0C\u4EE5\u5C3D\u53EF\u80FD\u51CF\u5C11\u5E94\u7528\u7A0B\u5E8F\u7684\u505C\u987F\u65F6\u95F4\u3002\u72EC\u5360\u5F0F\u5783\u573E\u56DE\u6536\u5668( Stop the world)\u4E00\u65E6\u8FD0\u884C\uFF0C\u5C31\u505C\u6B62\u5E94\u7528\u7A0B\u5E8F\u4E2D\u7684\u6240\u6709\u7528\u6237\u7EBF\u7A0B\uFF0C\u76F4\u5230\u5783\u573E\u56DE\u6536\u8FC7\u7A0B\u5B8C\u5168\u7ED3\u675F</p><p>\u200B <strong>\u6309\u788E\u7247\u5904\u7406\u65B9\u5F0F\u5206</strong>\uFF0C\u53EF\u5206\u4E3A\u538B\u7F29\u5F0F\u5783\u573E\u56DE\u6536\u5668\u548C\u975E\u538B\u7F29\u5F0F\u5783\u573E\u56DE\u6536\u5668 \u200B \u538B\u7F29\u5F0F\u5783\u573E\u56DE\u6536\u5668\u4F1A\u5728\u56DE\u6536\u5B8C\u6210\u540E\uFF0C\u5BF9\u5B58\u6D3B\u5BF9\u8C61\u8FDB\u884C\u538B\u7F29\u6574\u7406\uFF0C\u6D88\u9664\u56DE\u6536\u540E\u7684\u788E\u7247\u3002\u975E\u538B\u7F29\u5F0F\u7684\u5783\u573E\u56DE\u6536\u5668\u4E0D\u8FDB\u884C\u8FD9\u6B65\u64CD\u4F5C\u3002 \u200B <strong>\u6309\u5DE5\u4F5C\u7684\u5185\u5B58\u533A\u95F4\u5206</strong>\uFF0C\u53C8\u53EF\u5206\u4E3A\u5E74\u8F7B\u4EE3\u5783\u573E\u56DE\u6536\u5668\u548C\u8001\u5E74\u4EE3\u5783\u573E\u56DE\u6536\u5668\u3002</p><h2 id="_2-gc\u6027\u80FD\u8BC4\u4F30\u6307\u6807" tabindex="-1"><a class="header-anchor" href="#_2-gc\u6027\u80FD\u8BC4\u4F30\u6307\u6807" aria-hidden="true">#</a> 2.GC\u6027\u80FD\u8BC4\u4F30\u6307\u6807</h2><p>\u541E\u5410\u91CF\uFF1A\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u7684\u65F6\u95F4\u5360\u603B\u8FD0\u884C\u65F6\u95F4\u7684\u6BD4\u4F8B(\u603B\u8FD0\u884C\u65F6\u95F4\uFF1A\u7A0B\u5E8F\u7684\u8FD0\u884C\u65F6\u95F4\u5341\u5185\u5B58\u56DE\u6536\u7684\u65F6\u95F4) \u5783\u573E\u6536\u96C6\u5F00\u9500\uFF1A\u541E\u5410\u91CF\u7684\u8865\u6570\uFF0C\u5783\u573E\u6536\u96C6\u6240\u7528\u65F6\u95F4\u4E0E\u603B\u8FD0\u884C\u65F6\u95F4\u7684\u6BD4\u4F8B \u6682\u505C\u65F6\u95F4\uFF1A\u6267\u884C\u5783\u573E\u6536\u96C6\u65F6\uFF0C\u7A0B\u5E8F\u7684\u5DE5\u4F5C\u7EBF\u7A0B\u88AB\u6682\u505C\u7684\u65F6\u95F4 \u6536\u96C6\u9891\u7387\uFF1A\u76F8\u5BF9\u4E8E\u5E94\u7528\u7A0B\u5E8F\u7684\u6267\u884C\uFF0C\u6536\u96C6\u64CD\u4F5C\u53D1\u751F\u7684\u9891\u7387\u3002 \u5185\u5B58\u5360\u7528\uFF1AJAVA\u5806\u533A\u6240\u5360\u7684\u5185\u5B58\u5927\u5C0F\u3002 \u5FEB\u901F\uFF1A\u4E00\u4E2A\u5BF9\u8C61\u4ECE\u8BDE\u751F\u5230\u88AB\u56DE\u6536\u6240\u7ECF\u5386\u7684\u65F6\u95F4\u3002</p><p>\u200B \u8FD9\u4E09\u8005\u5171\u540C\u6784\u6210\u4E00\u4E2A\u201C\u4E0D\u53EF\u80FD\u4E09\u89D2\u201D\u3002\u4E09\u8005\u603B\u4F53\u7684\u8868\u73B0\u4F1A\u968F\u7740\u6280\u672F\u8FDB\u6B65\u800C\u8D8A\u6765\u8D8A\u597D\u3002\u4E00\u6B3E\u4F18\u79C0\u7684\u6536\u96C6\u5668\u901A\u5E38\u6700\u591A\u540C\u65F6\u6EE1\u8DB3\u5176\u4E2D\u7684\u4E24\u9879\u3002 \u200B \u8FD9\u4E09\u9879\u91CC\uFF0C\u6682\u505C\u65F6\u95F4\u7684\u91CD\u8981\u6027\u65E5\u76CA\u51F8\u663E\u3002\u56E0\u4E3A\u968F\u7740\u786C\u4EF6\u53D1\u5C55\uFF0C\u5185\u5B58\u5360\u7528\u591A\u4E9B\u8D8A\u6765\u8D8A\u80FD\u5BB9\u5FCD\uFF0C\u786C\u4EF6\u6027\u80FD\u7684\u63D0\u5347\u4E5F\u6709\u52A9\u4E8E\u964D\u4F4E\u6536\u96C6\u5668\u8FD0\u884C\u65F6\u5BF9\u5E94\u7528\u7A0B\u5E8F\u7684\u5F71\u54CD\uFF0C\u5373\u63D0\u9AD8\u4E86\u541E\u5410\u91CF\u3002\u800C\u5185\u5B58\u7684\u6269\u5927\uFF0C\u5BF9\u5EF6\u9000\u53CD\u800C\u5E26\u6765\u8D1F\u9762\u6548\u679C\u3002<strong>\u7B80\u5355\u6765\u8BF4\uFF0C\u4E3B\u8981\u6293\u4F4F\u4E24\u70B9\uFF1A\u541E\u5410\u91CF\u3001\u6682\u505C\u65F6\u95F4\u3002</strong></p><h2 id="_3-\u541E\u5410\u91CF\u4E0E\u6682\u505C\u65F6\u95F4" tabindex="-1"><a class="header-anchor" href="#_3-\u541E\u5410\u91CF\u4E0E\u6682\u505C\u65F6\u95F4" aria-hidden="true">#</a> 3.\u541E\u5410\u91CF\u4E0E\u6682\u505C\u65F6\u95F4</h2><p>\u200B \u541E\u5410\u91CF\u5C31\u662FCPU\u7528\u4E8E\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u7684\u65F6\u95F4\u4E0ECPU\u603B\u6D88\u8017\u65F6\u95F4\u7684\u6BD4\u503C\uFF0C\u5373<strong>\u541E\u5410\u91CF=\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u65F6\u95F4/(\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u65F6\u95F4+\u5783\u573E\u6536\u96C6\u65F6\u95F4)</strong>\u3002\u6BD4\u5982\uFF1A\u865A\u62DF\u673A\u603B\u5171\u8FD0\u884C\u4E86180\u5206\u949F\uFF0C\u5176\u4E2D\u5783\u573E\u6536\u96C6\u82B1\u63891\u5206\u949F\uFF0C\u90A3\u541E\u5410\u91CF\u5C31\u662F99%\u3002 \u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u5E94\u7528\u7A0B\u5E8F\u80FD\u5BB9\u5FCD\u8F83\u9AD8\u7684\u6682\u505C\u65F6\u95F4\uFF0C\u56E0\u6B64\uFF0C\u9AD8\u541E\u5410\u91CF\u7684\u5E94\u7528\u7A0B\u5E8F\u6709\u66F4\u957F\u7684\u65F6\u95F4\u57FA\u51C6\uFF0C\u5FEB\u901F\u54CD\u5E94\u662F\u4E0D\u5FC5\u8003\u8651\u7684\u541E\u5410\u91CF\u4F18\u5148\uFF0C\u610F\u5473\u7740\u5728\u5355\u4F4D\u65F6\u95F4\u5185\uFF0CSTW\u7684\u65F6\u95F4\u6700\u77ED\u3002</p><p>\u200B <strong>\u201C\u6682\u505C\u65F6\u95F4\u201D\u662F\u6307\u4E00\u4E2A\u65F6\u95F4\u6BB5\u5185\u5E94\u7528\u7A0B\u5E8F\u7EBF\u7A0B\u6682\u505C</strong>\uFF0C\u8BA9GC\u7EBF\u7A0B\u6267\u884C\u7684\u72B6\u6001\u3002\u4F8B\u5982\uFF0CGC\u671F\u95F4100\u6BEB\u79D2\u7684\u6682\u505C\u65F6\u95F4\u610F\u5473\u7740\u5728\u8FD9100\u6BEB\u79D2\u671F\u95F4\u5185\u6CA1\u6709\u5E94\u7528\u7A0B\u5E8F\u7EBF\u7A0B\u662F\u6D3B\u52A8\u7684\u3002\u6682\u505C\u65F6\u95F4\u4F18\u5148\uFF0C\u610F\u5473\u7740\u5C3D\u53EF\u80FD\u8BA9\u5355\u6B21STW\u7684\u65F6\u95F4\u6700\u77ED\u3002</p><p>\u200B \u9AD8\u541E\u5410\u91CF\u8F83\u597D\u56E0\u4E3A\u8FD9\u4F1A\u8BA9\u5E94\u7528\u7A0B\u5E8F\u7684\u6700\u7EC8\u7528\u6237\u611F\u89C9\u53EA\u6709\u5E94\u7528\u7A0B\u5E8F\u7EBF\u7A0B\u5728\u505A\u201C\u751F\u4EA7\u6027\u201D\u5DE5\u4F5C\u3002\u76F4\u89C9\u4E0A\uFF0C\u541E\u5410\u91CF\u8D8A\u9AD8\u7A0B\u5E8F\u8FD0\u884C\u8D8A\u5FEB\u3002 \u200B \u4F4E\u6682\u505C\u65F6\u95F4\uFF08\u4F4E\u5EF6\u8FDF\uFF09\u8F83\u597D\u56E0\u4E3A\u4ECE\u6700\u7EC8\u7528\u6237\u7684\u89D2\u5EA6\u6765\u770B\u4E0D\u7BA1\u662FGC\u8FD8\u662F\u5176\u4ED6\u539F\u56E0\u5BFC\u81F4\u4E00\u4E2A\u5E94\u7528\u88AB\u6302\u8D77\u59CB\u7EC8\u662F\u4E0D\u597D\u7684\u3002\u8FD9\u53D6\u51B3\u4E8E\u5E94\u7528\u7A0B\u5E8F\u7684\u7C7B\u578B\uFF0C\u6709\u65F6\u5019\u751A\u81F3\u77ED\u6682\u7684260\u6BEB\u79D2\u6682\u505C\u90FD\u53EF\u80FD\u6253\u65AD\u7EC8\u7AEF\u7528\u6237\u4F53\u9A8C\u3002\u56E0\u6B64\uFF0C\u5177\u6709\u4F4E\u7684\u8F83\u5927\u6682\u505C\u65F6\u95F4\u662F\u975E\u5E38\u91CD\u8981\u7684\uFF0C\u7279\u522B\u662F\u5BF9\u4E8E\u4E00\u4E2A\u4EA4\u4E92\u5F0F\u5E94\u7528\u7A0B\u5E8F\u3002 \u200B \u4E0D\u5E78\u7684\u662F\u201D\u9AD8\u541E\u5410\u91CF\u201D\u548C\u201D\u4F4E\u6682\u505C\u65F6\u95F4\u201D\u662F\u4E00\u5BF9\u76F8\u4E92\u7ADE\u4E89\u7684\u76EE\u6807\uFF08\u77DB\u76FE\uFF09\u56E0\u4E3A\u5982\u679C\u9009\u62E9\u4EE5\u541E\u5410\u91CF\u4F18\u5148\uFF0C\u90A3\u4E48\u5FC5\u7136\u9700\u8981\u964D\u4F4E\u5185\u5B58\u56DE\u6536\u7684\u6267\u884C\u9891\u7387\uFF0C\u4F46\u662F\u8FD9\u6837\u4F1A\u5BFC\u81F4GC\u9700\u8981\u66F4\u957F\u7684\u6682\u505C\u65F6\u95F4\u6765\u6267\u884C\u5185\u5B58\u56DE\u6536\u3002\u76F8\u53CD\u7684\uFF0C\u5982\u679C\u9009\u62E9\u4EE5\u4F4E\u5EF6\u8FDF\u4F18\u5148\u4E3A\u539F\u5219\uFF0C\u90A3\u4E48\u4E3A\u4E86\u964D\u4F4E\u6BCF\u6B21\u6267\u884C\u5185\u5B58\u56DE\u6536\u65F6\u7684\u6682\u505C\u65F6\u95F4\uFF0C\u4E5F\u53EA\u80FD\u9891\u7E41\u5730\u6267\u884C\u5185\u5B58\u56DE\u6536\uFF0C\u4F46\u8FD9\u53C8\u5F15\u8D77\u4E86\u5E74\u8F7B\u4EE3\u5185\u5B58\u7684\u7F29\u51CF\u548C\u5BFC\u81F4\u7A0B\u5E8F\u541E\u5410\u91CF\u7684\u4E0B\u964D\u3002</p><p>\u200B \u5728\u8BBE\u8BA1\uFF08\u6216\u4F7F\u7528\uFF09GC\u7B97\u6CD5\u65F6\uFF0C\u6211\u4EEC\u5FC5\u987B\u786E\u5B9A\u6211\u4EEC\u7684\u76EE\u6807\uFF1A\u4E00\u4E2AGC\u7B97\u6CD5\u53EA\u53EF\u80FD\u9488\u5BF9\u4E24\u4E2A\u76EE\u6807\u4E4B\u4E00\uFF08\u5373\u53EA\u4E13\u6CE8\u4E8E\u8F83\u5927\u541E\u5410\u91CF\u6216\u6700\u5C0F\u6682\u505C\u65F6\u95F4\uFF09\uFF0C\u6216\u5C1D\u8BD5\u627E\u5230\u4E00\u4E2A\u4E8C\u8005\u7684\u6298\u8877\u3002\u73B0\u5728\u6807\u51C6\uFF1A\u5728\u6700\u5927\u541E\u5410\u91CF\u4F18\u5148\u7684\u60C5\u51B5\u4E0B\uFF0C\u964D\u4F4E\u505C\u987F\u65F6\u95F4\u3002</p><h2 id="_4-\u5783\u573E\u56DE\u6536\u5668\u53D1\u5C55\u53F2" tabindex="-1"><a class="header-anchor" href="#_4-\u5783\u573E\u56DE\u6536\u5668\u53D1\u5C55\u53F2" aria-hidden="true">#</a> 4\uFF0C\u5783\u573E\u56DE\u6536\u5668\u53D1\u5C55\u53F2</h2><p>\u6709\u4E86\u865A\u62DF\u673A\uFF0C\u5C31\u4E00\u5B9A\u9700\u8981\u6536\u96C6\u5783\u573E\u7684\u673A\u5236\uFF0C\u8FD9\u5C31\u662F Garbage Collection,\u5BF9\u5E94\u7684\u4EA7\u54C1\u6211\u4EEC\u79F0\u4E3A Garbage Collector. \u30FB1999\u5E74\u968FJDK1.3.1\u4E00\u8D77\u6765\u7684\u662F\u4E32\u884C\u65B9\u5F0F\u7684 Serial GC,\u5B83\u662F\u7B2C\u4E00\u6B3EGC. Pardew\u5783\u573E\u6536\u96C6\u5668\u662F Seria\u6536\u96C6\u5668\u7684\u591A\u7EBF\u7A0B\u7248\u672C \u30FB2002\u5E742\u670826\u65E5\uFF0CParalle GC\u548C Concurrent Mark Sweep GC\u8DDF\u968FJDK1.4.2\u8D77\u53D1\u5E03Parallel GC\u5728JDK6\u4E4B\u540E\u6210\u4E3A Hotspot\u9ED8\u8BA4GC.2012\u5E74\uFF0C\u5728JDK1.7u4\u7248\u672C\u4E2D\uFF0CG1\u53EF\u7528\u3002 \u30FB2017\u5E74\uFF0CJDK9\u4E2DG1\u53D8\u6210\u9ED8\u8BA4\u7684\u5783\u573E\u6536\u96C6\u5668\uFF0C\u4EE5\u66FF\u4EE3CMS. \u30FB2018\u5E743\u6708\uFF0CJDK10\u4E2DG1\u5783\u573E\u56DE\u6536\u5668\u7684\u5E76\u884C\u5B8C\u6574\u5783\u573E\u56DE\u6536\uFF0C\u5B9E\u73B0\u5E76\u884C\u6027\u6765\u6539\u5584\u6700\u574F\u60C5\u51B5\u4E0B\u7684\u5EF6\u8FDF\u3002 \u30FB2018\u5E749\u6708\uFF0CJDK11\u53D1\u5E03\u3002\u5F15\u5165Bpsi1on\u5783\u573E\u56DE\u6536\u5668\uFF0C\u53C8\u88AB\u79F0\u4E3A&quot;No-Op\uFF08\u65E0\u64CD\u4F5C\uFF09\u56DE\u6536\u5668\u3002\u540C\u65F6\uFF0C\u5F15\u5165zGC:\u53EF\u4F38\u7F29\u7684\u4F4E\u5EF6\u8FDF\u5783\u573E\u56DE\u6536\u5668( Experimental). \u30FB2019\u5E743\u6708\uFF0CJDK12\u53D1\u5E03\u3002\u589E\u5F3AG1,\u81EA\u52A8\u8FD4\u56DE\u672A\u7528\u5806\u5185\u5B58\u7ED9\u64CD\u4F5C\u7CFB\u7EDF\u3002\u540C\u65F6\uFF0C\u5F15\u5165Sh. enandoah GC:\u4F4E\u505C\u987F\u65F6\u95F4\u7684GC( Experimenta1). \u30FB2019\u5E749\u6708\uFF0CJDK13\u53D1\u5E03\u3002\u589E\u5F3AZGC,\u81EA\u52A8\u8FD4\u56DE\u672A\u7528\u5806\u5185\u5B58\u7ED9\u64CD\u4F5C\u7CFB\u7EDF \u30FB2020\u5E743\u6708\uFF0CJDK14\u53D1\u5E03\u3002\u5220\u9664CMS\u5783\u573E\u56DE\u6536\u5668\u3002\u6269\u5C55zGC\u5728 macos,\u548C Windows\u4E0A\u7684\u5E94\u7528</p><blockquote><p>\u4E32\u884C\u56DE\u6536\u5668\uFF1A Serial\u3001 Serial Old \u5E76\u884C\u56DE\u6536\u5668\uFF1A Pa rnew\u3001Parallel Scavenge\u3001 Parallel Old \u5E76\u53D1\u56DE\u6536\u5668\uFF1ACMS\u3001G1</p></blockquote><h3 id="\u5783\u573E\u6536\u96C6\u5668\u7684\u7EC4\u5408\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u6536\u96C6\u5668\u7684\u7EC4\u5408\u5173\u7CFB" aria-hidden="true">#</a> \u5783\u573E\u6536\u96C6\u5668\u7684\u7EC4\u5408\u5173\u7CFB</h3><p>\u65B0\u751F\u4EE3\u6536\u96C6\u5668\uFF1A Serial\u3001 Pardew\u3001Parallel Scavenge \u8001\u5E74\u4EE3\u6536\u96C6\u5668\uFF1A Serial 0ld\u3001Parallel 0ld\u3001CMS \u6574\u5806\u6536\u96C6\u5668\uFF1AG1</p><p><img src="http://qnimg.gisfsde.com/work/\u7B2C17\u7AE0_\u7ECF\u5178\u76847\u79CDGC.jpg" alt="\u7B2C17\u7AE0_\u7ECF\u5178\u76847\u79CDGC" loading="lazy"></p><p>JDK 8\u2014&gt;JDK 9 \u5B9E\u7EBF----\u300B\u7EA2\u865A\u7EBF</p><p>\u2014&gt;JDK 14 \u5B9E\u7EBF----\u300B\u7EFF\u865A\u7EBF \u5E76\u5E9F\u5F03CMS \u9ED8\u8BA4G1</p><p>\u200B \u4E3A\u4EC0\u4E48\u8981\u6709\u5F88\u591A\u6536\u96C6\u5668\uFF0C\u4E00\u4E2A\u4E0D\u591F\u5417\uFF1F\u56E0\u4E3AJava\u7684\u4F7F\u7528\u573A\u666F\u5F88\u591A\uFF0C\u79FB\u52A8\u7AEF\uFF0C\u670D\u52A1\u5668\u7B49\u3002\u6240\u4EE5\u5C31\u9700\u8981\u9488\u5BF9\u4E0D\u540C\u7684\u573A\u666F\uFF0C\u63D0\u4F9B\u4E0D\u540C\u7684\u5783\u573E\u6536\u96C6\u5668\uFF0C\u63D0\u9AD8\u5783\u573E\u6536\u96C6\u7684\u6027\u80FD\u3002 \u200B \u867D\u7136\u6211\u4EEC\u4F1A\u5BF9\u5404\u4E2A\u6536\u96C6\u5668\u8FDB\u884C\u6BD4\u8F83\uFF0C\u4F46\u5E76\u975E\u4E3A\u4E86\u6311\u9009\u4E00\u4E2A\u6700\u597D\u7684\u6536\u96C6\u5668\u51FA\u6765\u3002\u6CA1\u6709\u4E00\u79CD\u653E\u4E4B\u56DB\u6D77\u7686\u51C6\u3001\u4EFB\u4F55\u573A\u666F\u4E0B\u90FD\u9002\u7528\u7684\u5B8C\u7F8E\u6536\u96C6\u5668\u5B58\u5728\u66F4\u52A0\u6CA1\u6709\u4E07\u80FD\u7684\u6536\u96C6\u5668\u3002\u6240\u4EE5\u6211\u4EEC\u9009\u62E9\u7684\u53EA\u662F\u5BF9\u5177\u4F53\u5E94\u7528\u6700\u5408\u9002\u7684\u6536\u96C6\u5668\u3002</p><p><img src="http://qnimg.gisfsde.com/work/\u7B2C17\u7AE0_\u5783\u573E\u6536\u96C6\u5668\u7EC4\u5408.jpg" alt="\u7B2C17\u7AE0_\u5783\u573E\u6536\u96C6\u5668\u7EC4\u5408" loading="lazy"></p><h2 id="_5-\u67E5\u770B\u9ED8\u8BA4\u5783\u573E\u56DE\u6536\u5668" tabindex="-1"><a class="header-anchor" href="#_5-\u67E5\u770B\u9ED8\u8BA4\u5783\u573E\u56DE\u6536\u5668" aria-hidden="true">#</a> 5.\u67E5\u770B\u9ED8\u8BA4\u5783\u573E\u56DE\u6536\u5668</h2><p>**-XX: PrintCommandLineFlags:**\u67E5\u770B\u547D\u4EE4\u884C\u76F8\u5173\u53C2\u6570\uFF08\u5305\u542B\u4F7F\u7528\u7684\u5783\u573E\u6536\u96C6\u5668\uFF09 \u4F7F\u7528\u547D\u4EE4\u884C\u6307\u4EE4\uFF1Ajinfo -flag \u76F8\u5173\u5783\u573E\u56DE\u6536\u5668\u53C2\u6570 \u8FDB\u7A0BID</p><p><img src="http://qnimg.gisfsde.com/work/image-20211216134714020.png" alt="image-20211216134714020" loading="lazy"></p><h2 id="serial-\u4E32\u884C\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#serial-\u4E32\u884C\u56DE\u6536" aria-hidden="true">#</a> Serial \u4E32\u884C\u56DE\u6536</h2><ul><li><p>Serial \u6536\u96C6\u5668\u662F\u6700\u57FA\u672C\u3001\u5386\u53F2\u6700\u60A0\u4E45\u7684\u5783\u573E\u6536\u96C6\u5668\u4E86\u3002JDK1.3\u4E4B\u524D\u56DE\u6536\u65B0\u751F\u4EE3\u552F\u4E00\u7684\u9009\u62E9\u3002</p></li><li><p>Serial \u6536\u96C6\u5668\u4F5C\u4E3A Hotspot\u4E2DClient\u6A21\u5F0F\u4E0B\u7684\u9ED8\u8BA4\u65B0\u751F\u4EE3\u5783\u573E\u6536\u96C6\u5668\u3002</p></li><li><p>Serial\u6536\u96C6\u5668\u91C7\u7528<strong>\u590D\u5236\u7B97\u6CD5</strong>\u3001\u4E32\u884C\u56DE\u6536\u548C&quot;Stop-the-World&quot;\u673A\u5236\u7684\u65B9\u5F0F\u6267\u884C\u5185\u5B58\u56DE\u6536\u3002</p></li><li><p>\u9664\u4E86\u5E74\u8F7B\u4EE3\u4E4B\u5916\uFF0C Serial \u6536\u96C6\u5668\u8FD8\u63D0\u4F9B\u7528\u4E8E\u6267\u884C\u8001\u5E74\u4EE3\u5783\u573E\u6536\u96C6\u7684 Serial Old\u6536\u96C6\u5668\u3002 Serial Old\u6536\u96C6\u5668\u540C\u6837\u4E5F\u91C7\u7528\u4E86\u4E32\u884C\u56DE\u6536\u548C&quot; Stop the World&quot;\u673A\u5236\uFF0C\u53EA\u4E0D\u8FC7\u5185\u5B58\u56DE\u6536\u7B97\u6CD5\u4F7F\u7528\u7684\u662F<strong>\u6807\u8BB0\u4E00\u538B\u7F29\u7B97\u6CD5</strong>\u3002</p></li><li><p>Serial Old\u662F\u8FD0\u884C\u5728Client \u6A21\u5F0F\u4E0B\u9ED8\u8BA4\u7684\u8001\u5E74\u4EE3\u7684\u5783\u573E\u56DE\u6536\u5668\u3002</p><ul><li>Serial Old\u5728 Server,\u6A21\u5F0F\u4E0B\u4E3B\u8981\u6709\u4E24\u4E2A\u7528\u9014\uFF1A\u2460\u4E0E\u65B0\u751F\u4EE3\u7684Parallel Scavenge\u914D\u5408\u4F7F\u7528\u3002\u2461\u4F5C\u4E3A\u8001\u5E74\u4EE3CMS\u6536\u96C6\u5668\u7684\u540E\u5907\u5783\u573E\u6536\u96C6\u65B9\u6848\u3002</li></ul></li><li><p><strong>\u4F18\u52BF</strong>\uFF1A\u7B80\u5355\u800C\u9AD8\u6548\uFF08\u4E0E\u5176\u4ED6\u6536\u96C6\u5668\u7684\u5355\u7EBF\u7A0B\u6BD4\uFF09\uFF0C\u5BF9\u4E8E\u9650\u5B9A\u5355\u4E2ACPU\u7684\u73AF\u5883\u6765\u8BF4\uFF0C Serial \u6536\u96C6\u5668\u7531\u4E8E\u6CA1\u6709\u7EBF\u7A0B\u4EA4\u4E92\u7684\u5F00\u9500\uFF0C\u4E13\u5FC3\u505A\u5783\u573E\u6536\u96C6\u81EA\u7136\u53EF\u4EE5\u83B7\u5F97\u6700\u9AD8\u7684\u5355\u7EBF\u7A0B\u6536\u96C6\u6548\u7387\u3002\u8FD0\u884C\u5728Client \u6A21\u5F0F\u4E0B\u7684\u865A\u62DF\u673A\u662F\u4E2A\u4E0D\u9519\u7684\u9009\u62E9\u3002</p></li><li><p>\u5728\u7528\u6237\u7684\u684C\u9762\u5E94\u7528\u573A\u666F\u4E2D\uFF0C\u53EF\u7528\u5185\u5B58\u4E00\u822C\u4E0D\u5927(\u51E0\u5341MB\u81F3\u4E00\u4E24\u767EMB),\u53EF\u4EE5\u5728\u8F83\u77ED\u65F6\u95F4\u5185\u5B8C\u6210\u5783\u573E\u6536\u96C6(\u51E0\u5341ms\u81F3\u4E00\u767E\u591Ams),\u53EA\u8981\u4E0D\u9891\u7E41\u53D1\u751F\u4F7F\u7528\u4E32\u884C\u56DE\u6536\u5668\u662F\u53EF\u4EE5\u63A5\u53D7\u7684\u3002</p></li><li><p>\u5728 Hotspot\u865A\u62DF\u673A\u4E2D\uFF0C\u4F7F\u7528 -XX: UseSerialGC\u53C2\u6570\u53EF\u4EE5\u6307\u5B9A\u5E74\u8F7B\u4EE3\u548C\u8001\u5E74\u4EE3\u90FD\u4F7F\u7528\u4E32\u884C\u6536\u96C6\u5668\u3002<strong>\u7B49\u4EF7\u4E8E\u65B0\u751F\u4EE3\u7528 Seral GC,\u4E14\u8001\u5E74\u4EE3\u7528 Serial Old GC</strong></p></li></ul><p>\u603B\u7ED3\uFF1A\u8FD9\u79CD\u5783\u573E\u6536\u96C6\u5668\u5927\u5BB6\u4E86\u89E3\uFF0C\u73B0\u5728\u5DF2\u7ECF\u4E0D\u7528\u4E32\u884C\u7684\u4E86\u3002\u800C\u4E14\u5728\u9650\u5B9A\u5355\u6838cpu\u30AA\u53EF\u4EE5\u7528\u3002\u73B0\u5728\u90FD\u4E0D\u662F\u5355\u6838\u7684\u4E86\u3002\u5BF9\u4E8E\u4EA4\u4E92\u8F83\u5F3A\u7684\u5E94\u7528\u800C\u8A00\uFF0C\u8FD9\u79CD\u5783\u573E\u6536\u96C6\u5668\u662F\u4E0D\u80FD\u63A5\u53D7\u7684\u3002\u4E00\u822C\u5728Java Web\u5E94\u7528\u7A0B\u5E8F\u4E2D\u662F\u4E0D\u4F1A\u91C7\u7528\u4E32\u884C\u5783\u573E\u6536\u96C6\u5668\u7684\u3002</p><h2 id="parnew-\u5E76\u884C\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#parnew-\u5E76\u884C\u56DE\u6536" aria-hidden="true">#</a> ParNew \u5E76\u884C\u56DE\u6536</h2><p>\u200B \u5982\u679C\u8BF4 Serial GC\u662F\u5E74\u8F7B\u4EE3\u4E2D\u7684\u5355\u7EBF\u7A0B\u5783\u573E\u6536\u96C6\u5668\uFF0C\u90A3\u4E48 ParNewl\u6536\u96C6\u5668\u5219\u662F <strong>Seral \u6536\u96C6\u5668\u7684\u591A\u7EBF\u7A0B\u7248\u672C</strong>\u3002Par\u662F Parallel \u7684\u7F29\u5199\uFF0CNew:\u53EA\u80FD\u5904\u7406\u7684\u662F\u65B0\u751F\u4EE3\u3002ParNew\u6536\u96C6\u5668\u9664\u4E86\u91C7\u7528\u5E76\u884C\u56DE\u6536\u7684\u65B9\u5F0F\u6267\u884C\u5185\u5B58\u56DE\u6536\u5916\uFF0C\u4E24\u6B3E\u5783\u573E\u6536\u96C6\u5668\u4E4B\u95F4\u51E0\u4E4E\u6CA1\u6709\u4EFB\u4F55\u533A\u522B\u3002 ParNew\u6536\u96C6\u5668\u5728\u5E74\u8F7B\u4EE3\u4E2D\u540C\u6837\u4E5F\u662F\u91C7\u7528<strong>\u590D\u5236\u7B97\u6CD5</strong>\u3001&quot;Stop-the-world&quot;\u673A\u5236\u3002ParNew\u662F\u5F88\u591AJVM\u8FD0\u884C\u5728 <strong>Server\u6A21\u5F0F\u4E0B\u65B0\u751F\u4EE3\u7684\u9ED8\u8BA4\u5783\u573E\u6536\u96C6\u5668</strong>\u3002</p><p>\u5BF9\u4E8E\u65B0\u751F\u4EE3\uFF0C\u56DE\u6536\u6B21\u6570\u9891\u7E41\uFF0C\u4F7F\u7528\u5E76\u884C\u65B9\u5F0F\u9AD8\u6548\u3002 \u5BF9\u4E8E\u8001\u5E74\u4EE3\uFF0C\u56DE\u6536\u6B21\u6570\u5C11\uFF0C\u4F7F\u7528\u4E32\u884C\u65B9\u5F0F\u8282\u7701\u8D44\u6E90\u3002\uFF08CPU\u5E76\u884C\u9700\u8981\u5207\u6362\u7EBF\u7A0B\uFF0C\u4E32\u884C\u53EF\u4EE5\u7701\u53BB\u5207\u6362\u7EBF\u7A0B\u7684\u8D44\u6E90\uFF09</p><p><img src="http://qnimg.gisfsde.com/work/image-20211216185521163.png" alt="image-20211216185521163" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/work/image-20211216185631103.png" alt="image-20211216185631103" loading="lazy"></p><ul><li>\u7531\u4E8E Pardew\u6536\u96C6\u5668\u662F\u57FA\u4E8E\u5E76\u884C\u56DE\u6536\uFF0C\u90A3\u4E48\u662F\u5426\u53EF\u4EE5\u65AD\u5B9A Parnewl\u6536\u96C6\u5668\u7684\u56DE\u6536\u6548\u7387\u5728\u4EFB\u4F55\u573A\u666F\u4E0B\u90FD\u4F1A\u6BD4 Seral \u6536\u96C6\u5668\u66F4\u9AD8\u6548\uFF1F <ul><li>Parnew\u6536\u96C6\u5668\u8FD0\u884C\u5728\u591ACPU\u7684\u73AF\u5883\u4E0B\uFF0C\u7531\u4E8E\u53EF\u4EE5\u5145\u5206\u5229\u7528\u591ACPU\u3001\u591A\u6838\u5FC3\u7B49\u7269\u7406\u786C\u4EF6\u8D44\u6E90\u4F18\u52BF\uFF0C\u53EF\u4EE5\u66F4\u5FEB\u901F\u5730\u5B8C\u6210\u5783\u573E\u6536\u96C6\uFF0C\u63D0\u5347\u7A0B\u5E8F\u7684\u541E\u5410\u91CF\u3002</li><li>\u4F46\u662F\u5728\u5355\u4E2ACPU\u7684\u73AF\u5883\u4E0B\uFF0C Parnewl\u6536\u96C6\u5668\u4E0D\u6BD4 Seral \u6536\u96C6\u5668\u66F4\u9AD8\u6548\u3002\u867D\u7136 Serlal\u6536\u96C6\u5668\u662F\u57FA\u4E8E\u4E32\u884C\u56DE\u6536\uFF0C\u4F46\u662F\u7531\u4E8ECPU\u4E0D\u9700\u8981\u9891\u7E41\u5730\u505A\u4EFB\u52A1\u5207\u6362\uFF0C\u56E0\u6B64\u53EF\u4EE5\u6709\u6548\u907F\u514D\u591A\u7EBF\u7A0B\u4EA4\u4E92\u8FC7\u7A0B\u4E2D\u4EA7\u751F\u7684\u4E00\u4E9B\u989D\u5916\u5F00\u9500\u3002</li></ul></li><li>\u56E0\u4E3A\u9664 Seral\u5916\uFF0C\u76EE\u524D\u53EA\u6709 PardNew GC\u80FD\u4E0ECMS\u6536\u96C6\u5668\u914D\u5408\u5DE5\u4F5C\u3002</li><li>\u5728\u7A0B\u5E8F\u4E2D\uFF0C\u5F00\u53D1\u4EBA\u5458\u53EF\u4EE5\u901A\u8FC7\u9009\u9879\u201D-XX: UseParNewGC&quot;\u624B\u52A8\u6307\u5B9A\u4F7F\u7528ParNewl\u6536\u96C6\u5668\u6267\u884C\u5185\u5B58\u56DE\u6536\u4EFB\u52A1\u3002\u5B83\u8868\u793A\u5E74\u8F7B\u4EE3\u4F7F\u7528\u5E76\u884C\u6536\u96C6\u5668\uFF0C\u4E0D\u5F71\u54CD\u8001\u5E74\u4EE3\u3002</li><li>-XX: ParallelGCThreads\u9650\u5236\u7EBF\u7A0B\u6570\u91CF\uFF0C\u9ED8\u8BA4\u5F00\u542F\u548CCPU\u6570\u636E\u76F8\u540C\u7684\u7EBF\u7A0B\u6570\u3002</li></ul><h2 id="parallel-scavenge-\u541E\u5410\u91CF\u4F18\u5148" tabindex="-1"><a class="header-anchor" href="#parallel-scavenge-\u541E\u5410\u91CF\u4F18\u5148" aria-hidden="true">#</a> Parallel Scavenge \u541E\u5410\u91CF\u4F18\u5148</h2><ul><li>HotSpot\u7684\u5E74\u8F7B\u4EE3\u4E2D\u9664\u4E86\u62E5\u6709 ParNew\u6536\u96C6\u5668\u662F\u57FA\u4E8E\u5E76\u884C\u56DE\u6536\u7684\u4EE5\u5916\uFF0CParallel Scavenge\u6536\u96C6\u5668\u540C\u6837\u4E5F\u91C7\u7528\u4E86\u590D\u5236\u7B97\u6CD5\u3001\u5E76\u884C\u56DE\u6536\u548C&quot;Stop The World&quot;\u673A\u5236\u3002</li><li>\u90A3\u4E48 Parallel \u6536\u96C6\u5668\u7684\u51FA\u73B0\u662F\u5426\u591A\u6B64\u4E00\u4E3E\uFF1F <ul><li>\u548C Pardew\u6536\u96C6\u5668\u4E0D\u540C\uFF0C Parallel Scavenge\u6536\u96C6\u5668\u7684\u76EE\u6807\u5219\u662F\u8FBE\u5230\u4E2A\u53EF\u63A7\u5236\u7684\u541E\u5410\u91CF( Throughput),\u5B83\u4E5F\u88AB\u79F0\u4E3A\u541E\u5410\u91CF\u4F18\u5148\u7684\u5783\u573E\u6536\u96C6\u5668\u3002 <ul><li>\u81EA\u9002\u5E94\u8C03\u8282\u7B56\u7565\u4E5F\u662F Parallel Scavenge\u4E0E ParNew\u4E00\u4E2A\u91CD\u8981\u533A\u522B\u3002</li></ul></li></ul></li></ul><p>\u9AD8\u541E\u5410\u91CF\u5219\u53EF\u4EE5\u9AD8\u6548\u7387\u5730\u5229\u7528CPU\u65F6\u95F4\uFF0C\u5C3D\u5FEB\u5B8C\u6210\u7A0B\u5E8F\u7684\u8FD0\u7B97\u4EFB\u52A1\uFF0C\u4E3B\u8981\u9002\u5408\u5728\u540E\u53F0\u8FD0\u7B97\u800C\u4E0D\u9700\u8981\u592A\u591A\u4EA4\u4E92\u7684\u4EFB\u52A1\u3002\u56E0\u6B64\uFF0C\u5E38\u89C1\u5728\u670D\u52A1\u5668\u73AF\u5883\u4E2D\u4F7F\u7528\u3002\u4F8B\u5982\uFF0C\u90A3\u4E9B\u6267\u884C\u6279\u91CF\u5904\u7406\u3001\u8BA2\u5355\u5904\u7406\u3001\u5DE5\u8D44\u652F\u4ED8\u3001\u79D1\u5B66\u8BA1\u7B97\u7684\u5E94\u7528\u7A0B\u5E8F\u3002 Parallel \u6536\u96C6\u5668\u5728JDK1.6\u65F6\u63D0\u4F9B\u4E86\u7528\u4E8E\u6267\u884C\u8001\u5E74\u4EE3\u5783\u573E\u6536\u96C6\u7684 Parallel Old \u6536\u96C6\u5668\uFF0C\u7528\u6765\u4EE3\u66FF\u8001\u5E74\u4EE3\u7684 Seral Old\u6536\u96C6\u5668\u3002 Parallel Old \u6536\u96C6\u5668\u91C7\u7528\u4E86<strong>\u6807\u8BB0-\u538B\u7F29</strong>\u7B97\u6CD5\uFF0C\u4F46\u540C\u6837\u4E5F\u662F\u57FA\u4E8E\u5E76\u884C\u56DE\u6536\u548C&quot;Stop-the- World&quot;\u673A\u5236\u3002</p><p>\u200B \u541E\u5410\u91CF\u5C31\u662FCPU\u7528\u4E8E\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u7684\u65F6\u95F4\u4E0ECPU\u603B\u6D88\u8017\u65F6\u95F4\u7684\u6BD4\u503C\uFF0C\u5373\u541E\u5410\u91CF=\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u65F6\u95F4/(\u8FD0\u884C\u7528\u6237\u4EE3\u7801\u65F6\u95F4 \u5783\u573E\u6536\u96C6\u65F6\u95F4)\u3002\u6BD4\u5982\uFF1A\u865A\u62DF\u673A\u603B\u5171\u8FD0\u884C\u4E86160\u5206\u949F\uFF0C\u5176\u4E2D\u5783\u573E\u6536\u96C6\u82B1\u63891\u5206\u949F\uFF0C\u90A3\u541E\u5410\u91CF\u5C31\u662F99%\u3002 \u200B \u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u5E94\u7528\u7A0B\u5E8F\u80FD\u5BB9\u5FCD\u8F83\u9AD8\u7684\u6682\u505C\u65F6\u95F4\uFF0C\u56E0\u6B64\uFF0C\u9AD8\u541E\u5410\u91CF\u7684\u5E94\u7528\u7A0B\u5E8F\u6709\u66F4\u957F\u7684\u65F6\u95F4\u57FA\u51C6\uFF0C\u5FEB\u901F\u54CD\u5E94\u662F\u4E0D\u5FC5\u8003\u8651\u7684\u3002\u541E\u5410\u91CF\u4F18\u5148\uFF0C\u610F\u5473\u7740\u5728\u5355\u4F4D\u65F6\u95F4\u5185\uFF0CST\u7684\u65F6\u95F4\u6700\u77ED\u3002\u5728\u7A0B\u5E8F\u541E\u5410\u91CF\u4F18\u5148\u7684\u5E94\u7528\u573A\u666F\u4E2D\uFF0CParallel \u6536\u96C6\u5668\u548C Parallel Old\u6536\u96C6\u5668\u7684\u7EC4\u5408\uFF0C\u5728 Server\u6A21\u5F0F\u4E0B\u7684\u5185\u5B58\u56DE\u6536\u6027\u80FD\u5F88\u4E0D\u9519\u3002\u5728Java8\u4E2D\uFF0C\u9ED8\u8BA4\u662F\u6B64\u5783\u573E\u6536\u96C6\u5668\u3002</p><p><strong>\u53C2\u6570\u8BBE\u7F6E:</strong> -XX: +UseParallelGC\u624B\u52A8\u6307\u5B9A\u5E74\u8F7B\u4EE3\u4F7F\u7528Para1le1\u5E76\u884C\u6536\u96C6\u5668\u6267\u884C\u5185\u5B58\u56DE\u6536\u4EFB\u52A1 -XX: +UseParallelOldGC\u624B\u52A8\u6307\u5B9A\u8001\u5E74\u4EE3\u90FD\u662F\u4F7F\u7528\u5E76\u884C\u56DE\u6536\u6536\u96C6\u5668\u3002\u5206\u522B\u9002\u7528\u4E8E\u65B0\u751F\u4EE3\u548C\u8001\u5E74\u4EE3\u3002\u9ED8\u8BA4jdk8\u662F\u5F00\u542F\u7684\u3002\u4E0A\u9762\u4E24\u4E2A\u53C2\u6570\uFF0C\u9ED8\u8BA4\u5F00\u542F\u4E00\u4E2A\uFF0C\u53E6\u4E00\u4E2A\u4E5F\u4F1A\u88AB\u5F00\u542F\u3002\uFF08\u4E92\u76F8\u6FC0\u6D3B\uFF09 -XX: +ParallelGCThreads\u8BBE\u7F6E\u5E74\u8F7B\u4EE3\u5E76\u884C\u6536\u96C6\u5668\u7684\u7EBF\u7A0B\u6570\u3002\u4E00\u822C\u5730\uFF0C\u6700\u597D\u4E0ECPU\u6570\u91CF\u76F8\u7B49\uFF0C\u4EE5\u907F\u514D\u8FC7\u591A\u7684\u7EBF\u7A0B\u6570\u5F71\u54CD\u5783\u573E\u6536\u96C6\u6027\u80FD\u3002\u5728\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5F53CPU\u6570\u91CF\u5C0F\u4E8E8\u4E2A\uFF0CParallelGCThreads\u7684\u503C\u7B49\u4E8ECPU\u6570\u91CF\u3002\u5F53CPU\u6570\u91CF\u5927\u4E8E8\u4E2A\uFF0CParallelGCThreads\u7684\u503C\u7B49\u4E8E<strong>3+[5*CPU_Count] / 8]</strong>\u3002</p><p>-XX: MaxGCPauseMillis \u8BBE\u7F6E\u5783\u573E\u6536\u96C6\u5668\u6700\u5927\u505C\u987F\u65F6\u95F4(\u5373STW\u7684\u65F6\u95F4)\u3002\u5355\u4F4D\u662F\u6BEB\u79D2\u3002 \u4E3A\u4E86\u5C3D\u53EF\u80FD\u5730\u628A\u505C\u987F\u65F6\u95F4\u63A7\u5236\u5728 MaxGCPauseMillis \u4EE5\u5185\uFF0C\u6536\u96C6\u5668\u5728\u5DE5\u4F5C\u65F6\u4F1A\u8C03\u6574Java\u5806\u5927\u5C0F\u6216\u8005\u5176\u4ED6\u4E00\u4E9B\u53C2\u6570\u3002\u5BF9\u4E8E\u7528\u6237\u6765\u8BB2\uFF0C\u505C\u987F\u65F6\u95F4\u8D8A\u77ED\u4F53\u9A8C\u8D8A\u597D\u3002\u4F46\u662F\u5728\u670D\u52A1\u5668\u7AEF\uFF0C\u6211\u4EEC\u6CE8\u91CD\u9AD8\u5E76\u53D1\uFF0C\u6574\u4F53\u7684\u541E\u5410\u91CF\u3002\u6240\u4EE5\u670D\u52A1\u5668\u7AEF\u9002\u5408 Paralle1,\u8FDB\u884C\u63A7\u5236\u3002\u8BE5\u53C2\u6570\u4F7F\u7528\u9700\u8C28\u614E\u3002 -XX: GCTimeRatio \u5783\u573E\u6536\u96C6\u65F6\u95F4\u5360\u603B\u65F6\u95F4\u7684\u6BD4\u4F8B (=1/(N+1))\u7528\u4E8E\u8861\u91CF\u541E\u5410\u91CF\u7684\u5927\u5C0F\u3002 \u53D6\u503C\u8303\u56F4(0,100)\u3002\u9ED8\u8BA4\u503C99,\u4E5F\u5C31\u662F\u5783\u573E\u56DE\u6536\u65F6\u95F4\u4E0D\u8D85\u8FC71%\u3002\u4E0E\u524D\u4E00\u4E2A -XX: MaxGCPauseMillis\u53C2\u6570\u6709\u4E00\u5B9A\u77DB\u76FE\u6027\u3002\u6682\u505C\u65F6\u95F4\u8D8A\u957F\uFF0C Radio\u53C2\u6570\u5C31\u5BB9\u6613\u8D85\u8FC7\u8BBE\u5B9A\u7684\u6BD4\u4F8B\u3002</p><p>-XX: UseAdaptiveSizePoltcy \u8BBE\u7F6E Parallel Scavenge\u6536\u96C6\u5668\u5177\u6709\u81EA\u9002\u5E94\u8C03\u8282\u7B56\u7565 \u5728\u8FD9\u79CD\u6A21\u5F0F\u4E0B\uFF0C\u5E74\u8F7B\u4EE3\u7684\u5927\u5C0F\u3001Eden\u548C Survivor\u7684\u6BD4\u4F8B\u3001\u664B\u5347\u8001\u5E74\u4EE3\u7684\u5BF9\u8C61\u5E74\u9F84\u7B49\u53C2\u6570\u4F1A\u88AB\u81EA\u52A8\u8C03\u6574\uFF0C\u5DF2\u8FBE\u5230\u5728\u5806\u5927\u5C0F\u3001\u541E\u5410\u91CF\u548C\u505C\u987F\u65F6\u95F4\u4E4B\u95F4\u7684\u5E73\u8861\u70B9\u3002\u5728\u624B\u52A8\u8C03\u4F18\u6BD4\u8F83\u56F0\u96BE\u7684\u573A\u5408\uFF0C\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528\u8FD9\u79CD\u81EA\u9002\u5E94\u7684\u65B9\u5F0F\uFF0C\u4EC5\u6307\u5B9A\u865A\u62DF\u673A\u7684\u6700\u5927\u5806\u3001\u65E5\u6807\u7684\u541E\u5410\u91CF( GCTimeRatio )\u548C\u505C\u987F\u65F6\u95F4( MaxGCPauseMillis ),\u8BA9\u865A\u62DF\u673A\u81EA\u5DF1\u5B8C\u6210\u8C03\u4F18\u5DE5\u4F5C\u3002</p><h2 id="cms-\u4F4E\u5EF6\u8FDF" tabindex="-1"><a class="header-anchor" href="#cms-\u4F4E\u5EF6\u8FDF" aria-hidden="true">#</a> CMS \u4F4E\u5EF6\u8FDF</h2><ul><li>\u5728JDK1.5\u65F6\u671F\uFF0C HotSpot\u63A8\u51FA\u4E86\u4E00\u6B3E\u5728\u5F3A\u4EA4\u4E92\u5E94\u7528\u4E2D\u51E0\u4E4E\u53EF\u8BA4\u4E3A\u6709\u5212\u65F6\u4EE3\u610F\u4E49\u7684\u5783\u573E\u6536\u96C6\u5668\uFF1ACMS( Concurrent - Mark - Sweep)\u6536\u96C6\u5668\uFF0C\u8FD9\u6B3E\u6536\u96C6\u5668\u662F HotSpot\u865A\u62DF\u673A\u4E2D<strong>\u7B2C\u4E00\u6B3E\u771F\u6B63\u610F\u4E49\u4E0A\u7684\u5E76\u53D1\u6536\u96C6\u5668\uFF0C\u5B83\u7B2C\u4E00\u6B21\u5B9E\u73B0\u4E86\u8BA9\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u4E0E\u7528\u6237\u7EBF\u7A0B\u540C\u65F6\u5DE5\u4F5C\u3002</strong></li><li>CMS\u6536\u96C6\u5668\u7684\u5173\u6CE8\u70B9\u662F\u5C3D\u53EF\u80FD\u7F29\u77ED\u5783\u573E\u6536\u96C6\u65F6\u7528\u6237\u7EBF\u7A0B\u7684\u505C\u987F\u65F6\u95F4\u3002\u505C\u987F\u65F6\u95F4\u8D8A\u77ED\uFF08\u4F4E\u5EF6\u8FDF\uFF09\u5C31\u8D8A\u9002\u5408\u4E0E\u7528\u6237\u4EA4\u4E92\u7684\u7A0B\u5E8F\uFF0C\u826F\u597D\u7684\u54CD\u5E94\u901F\u5EA6\u80FD\u63D0\u5347\u7528\u6237\u4F53\u9A8C\u3002\u76EE\u524D\u5F88\u5927\u4E00\u90E8\u5206\u7684Java\u5E94\u7528\u96C6\u4E2D\u5728\u4E92\u8054\u7F51\u7AD9\u6216\u8005B/S\u7CFB\u7EDF\u7684\u670D\u52A1\u7AEF\u4E0A\uFF0C\u8FD9\u7C7B\u5E94\u7528\u5C24\u5176\u91CD\u89C6\u670D\u52A1\u7684\u54CD\u5E94\u901F\u5EA6\uFF0C\u5E0C\u671B\u7CFB\u7EDF\u505C\u987F\u65F6\u95F4\u6700\u77ED\uFF0C\u4EE5\u7ED9\u7528\u6237\u5E26\u6765\u8F83\u597D\u7684\u4F53\u9A8C\u3002CMS\u6536\u96C6\u5668\u5C31\u975E\u5E38\u7B26\u5408\u8FD9\u7C7B\u5E94\u7528\u7684\u9700\u6C42\u3002</li><li>CMS\u7684\u5783\u573E\u6536\u96C6\u7B97\u6CD5\u91C7\u7528<strong>\u6807\u8BB0\u4E00\u6E05\u9664</strong>\u7B97\u6CD5\uFF0C\u5E76\u4E14\u4E5F\u4F1A&quot;Stop-the-world</li><li>\u4E0D\u5E78\u7684\u662F\uFF0CCMS\u4F5C\u4E3A\u8001\u5E74\u4EE3\u7684\u6536\u96C6\u5668\uFF0C\u5374\u65E0\u6CD5\u4E0EJDK1.4.8\u4E2D\u5DF2\u7ECF\u5B58\u5728\u7684\u65B0\u751F\u4EE3\u6536\u96C6\u5668Parallel Scavenge\u914D\u5408\u5DE5\u4F5C\uFF0C\u6240\u4EE5\u5728JDK1.5\u4E2D\u4F7F\u7528CMS\u6765\u6536\u96C6\u8001\u5E74\u4EE3\u7684\u65F6\u5019\uFF0C\u65B0\u751F\u4EE3\u53EA\u80FD\u9009\u62E9 Pardew\u6216\u8005 Sera1\u6536\u96C6\u5668\u4E2D\u7684\u4E00\u4E2A\u3002\u5728G1\u51FA\u73B0\u4E4B\u524D\uFF0CCMS\u4F7F\u7528\u8FD8\u662F\u975E\u5E38\u5E7F\u6CDB\u7684\u3002\u4E00\u76F4\u5230\u4ECA\u5929\uFF0C\u4ECD\u7136\u6709\u5F88\u591A\u7CFB\u7EDF\u4F7F\u7528 CMS GC\u3002</li></ul><p><strong>\u5DE5\u4F5C\u539F\u7406</strong></p><p><img src="http://qnimg.gisfsde.com/work/image-20211217133947237.png" alt="image-20211217133947237" loading="lazy"></p><ul><li>CMS\u6574\u4E2A\u8FC7\u7A0B\u6BD4\u4E4B\u524D\u7684\u6536\u96C6\u5668\u8981\u590D\u6742\uFF0C\u6574\u4E2A\u8FC7\u7A0B\u5206\u4E3A4\u4E2A\u4E3B\u8981\u9636\u6BB5\uFF0C\u5373\u521D\u59CB\u6807\u8BB0\u9636\u6BB5\u3001\u5E76\u53D1\u6807\u8BB0\u9636\u6BB5\u3001\u91CD\u65B0\u6807\u8BB0\u9636\u6BB5\u548C\u5E76\u53D1\u6E05\u9664\u9636\u6BB5\u3002</li><li>**\u521D\u59CB\u6807\u8BB0( Initial-Mark)\u9636\u6BB5\uFF1A**\u5728\u8FD9\u4E2A\u9636\u6BB5\u4E2D\uFF0C\u7A0B\u5E8F\u4E2D\u6240\u6709\u7684\u5DE5\u4F5C\u7EBF\u7A0B\u90FD\u5C06\u4F1A\u56E0\u4E3A\u201CStop-the-World\u201D\u673A\u5236\u800C\u51FA\u73B0\u77ED\u6682\u7684\u6682\u505C\uFF0C\u8FD9\u4E2A\u9636\u6BB5\u7684\u4E3B\u8981\u4EFB\u52A1\u4EC5\u4EC5\u53EA\u662F\u6807\u8BB0\u51FAGC Roots\u80FD\u76F4\u63A5\u5173\u8054\u5230\u7684\u5BF9\u8C61\u3002\u4E00\u65E6\u6807\u8BB0\u5B8C\u6210\u4E4B\u540E\u5C31\u4F1A\u6062\u590D\u4E4B\u524D\u88AB\u6682\u505C\u7684\u6240\u6709\u5E94\u7528\u7EBF\u7A0B\u3002\u7531\u4E8E\u76F4\u63A5\u5173\u8054\u5BF9\u8C61\u6BD4\u8F83\u5C0F\uFF0C\u6240\u4EE5\u8FD9\u91CC\u7684\u901F\u5EA6\u975E\u5E38\u5FEB\u3002</li><li>**\u5E76\u53D1\u6807\u8BB0( Concurrent-Mark)\u9636\u6BB5\uFF1A**\u4ECE GC Roots\u7684\u76F4\u63A5\u5173\u8054\u5BF9\u8C61\u5F00\u59CB\u904D\u5386\u6574\u4E2A\u5BF9\u8C61\u56FE\u7684\u8FC7\u7A0B\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u8017\u65F6\u8F83\u957F\u4F46\u662F\u4E0D\u9700\u8981\u505C\u987F\u7528\u6237\u7EBF\u7A0B\uFF0C\u53EF\u4EE5\u4E0E\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u4E00\u8D77\u5E76\u53D1\u8FD0\u884C\u3002</li><li>**\u91CD\u65B0\u6807\u8BB0( Remark)\u9636\u6BB5\uFF1A**\u7531\u4E8E\u5728\u5E76\u53D1\u6807\u8BB0\u9636\u6BB5\u4E2D\uFF0C\u7A0B\u5E8F\u7684\u5DE5\u4F5C\u7EBF\u7A0B\u4F1A\u548C\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u540C\u65F6\u8FD0\u884C\u6216\u8005\u4EA4\u53C9\u8FD0\u884C\uFF0C\u56E0\u6B64\u4E3A\u4E86\u4FEE\u6B63\u5E76\u53D1\u6807\u8BB0\u671F\u95F4\uFF0C\u56E0\u7528\u6237\u7A0B\u5E8F\u7EE7\u7EED\u8FD0\u4F5C\u800C\u5BFC\u81F4\u6807\u8BB0\u4EA7\u751F\u53D8\u52A8\u7684\u90A3\u4E00\u90E8\u5206\u5BF9\u8C61\u7684\u6807\u8BB0\u8BB0\u5F55\uFF0C\u8FD9\u4E2A\u9636\u6BB5\u7684\u505C\u987F\u65F6\u95F4\u901A\u5E38\u4F1A\u6BD4\u521D\u59CB\u6807\u8BB0\u9636\u6BB5\u7A0D\u957F\u4E00\u4E9B\uFF0C\u4F46\u4E5F\u8FDC\u6BD4\u5E76\u53D1\u6807\u8BB0\u9636\u6BB5\u7684\u65F6\u95F4\u77ED\u3002</li><li>**\u5E76\u53D1\u6E05\u9664( Concurrent- Sweep)\u9636\u6BB5\uFF1A**\u6B64\u9636\u6BB5\u6E05\u7406\u5220\u9664\u6389\u6807\u8BB0\u9636\u6BB5\u5224\u65AD\u7684\u5DF1\u7ECF\u6B7B\u4EA1\u7684\u5BF9\u8C61\uFF0C\u91CA\u653E\u5185\u5B58\u7A7A\u95F4\u3002\u7531\u4E8E\u4E0D\u9700\u8981\u79FB\u52A8\u5B58\u6D3B\u5BF9\u8C61\uFF0C\u6240\u4EE5\u8FD9\u4E2A\u9636\u6BB5\u4E5F\u662F\u53EF\u4EE5\u4E0E\u7528\u6237\u7EBF\u7A0B\u540C\u65F6\u5E76\u53D1\u7684\u3002</li></ul><p><strong>\u7279\u70B9\u4E0E\u5F0A\u7AEF</strong></p><ul><li><p>\u5C3D\u7BA1CMS\u6536\u96C6\u5668\u91C7\u7528\u7684\u662F\u5E76\u53D1\u56DE\u6536\uFF08\u975E\u72EC\u5360\u5F0F\uFF09\uFF0C\u4F46\u662F\u5728\u5176\u521D\u59CB\u5316\u6807\u8BB0\u548C\u518D\u6B21\u6807\u8BB0\u8FD9\u4E24\u4E2A\u9636\u6BB5\u4E2D\u4ECD\u7136\u9700\u8981\u6267\u884C\u201CStop-The-Wolrd\u201D\u673A\u5236\u6682\u505C\u7A0B\u5E8F\u4E2D\u7684\u5DE5\u4F5C\u7EBF\u7A0B\uFF0C\u4E0D\u8FC7\u6682\u505C\u65F6\u95F4\u5E76\u4E0D\u4F1A\u592A\u957F\uFF0C\u56E0\u6B64\u53EF\u4EE5\u8BF4\u660E\u76EE\u524D\u6240\u6709\u7684\u5783\u573E\u6536\u96C6\u5668\u90FD\u505A\u4E0D\u5230\u5B8C\u5168\u4E0D\u9700\u8981 \u201CStop-The-Wolrd\u201D\uFF0C\u53EA\u662F\u5C3D\u53EF\u80FD\u5730\u7F29\u77ED\u6682\u505C\u65F6\u95F4\u3002</p></li><li><p>\u7531\u4E8E\u6700\u8017\u8D39\u65F6\u95F4\u7684\u5E76\u53D1\u6807\u8BB0\u4E0E\u5E76\u53D1\u6E05\u9664\u9636\u6BB5\u90FD\u4E0D\u9700\u8981\u6682\u505C\u5DE5\u4F5C\uFF0C\u6240\u4EE5\u6574\u4F53\u7684\u56DE\u6536\u662F\u4F4E\u505C\u987F\u7684\u3002</p></li><li><p>\u53E6\u5916\uFF0C\u7531\u4E8E\u5728\u5783\u573E\u6536\u96C6\u9636\u6BB5\u7528\u6237\u7EBF\u7A0B\u6CA1\u6709\u4E2D\u65AD\uFF0C\u6240\u4EE5\u5728CMS\u56DE\u6536\u8FC7\u7A0B\u4E2D\uFF0C\u8FD8\u5E94\u8BE5\u786E\u4FDD\u5E94\u7528\u7A0B\u5E8F\u7528\u6237\u7EBF\u7A0B\u6709\u8DB3\u591F\u7684\u5185\u5B58\u53EF\u7528\u3002\u56E0\u6B64\uFF0CCMS\u6536\u96C6\u5668\u4E0D\u80FD\u50CF\u5176\u4ED6\u6536\u96C6\u5668\u90A3\u6837\u7B49\u5230\u8001\u5E74\u4EE3\u51E0\u4E4E\u5B8C\u5168\u88AB\u586B\u6EE1\u4E86\u518D\u8FDB\u884C\u6536\u96C6\uFF0C\u800C\u662F\u5F53\u5806\u5185\u5B58\u4F7F\u7528\u7387\u8FBE\u5230\u67D0\u4E00\u9608\u503C\u65F6\uFF0C\u4FBF\u5F00\u59CB\u8FDB\u884C\u56DE\u6536\uFF0C\u4EE5\u786E\u4FDD\u5E94\u7528\u7A0B\u5E8F\u5728CMS\u5DE5\u4F5C\u8FC7\u7A0B\u4E2D\u4F9D\u7136\u6709\u8DB3\u591F\u7684\u7A7A\u95F4\u652F\u6301\u5E94\u7528\u7A0B\u5E8F\u8FD0\u884C\u3002\u8981\u662FCMS\u8FD0\u884C\u671F\u95F4\u9884\u7559\u7684\u5185\u5B58\u65E0\u6CD5\u6EE1\u8DB3\u7A0B\u5E8F\u9700\u8981\uFF0C\u5C31\u4F1A\u51FA\u73B0\u4E00\u6B21\u201C Concurrent Mode Failure\u201D\u5931\u8D25\uFF0C\u8FD9\u65F6\u865A\u62DF\u673A\u5C06\u542F\u52A8\u540E\u5907\u9884\u6848\uFF1A\u4E34\u65F6\u542F\u7528 Seral Old\u6536\u96C6\u5668\u6765\u91CD\u65B0\u8FDB\u884C\u8001\u5E74\u4EE3\u7684\u5783\u573E\u6536\u96C6\uFF0C\u8FD9\u6837\u505C\u987F\u65F6\u95F4\u5C31\u5F88\u957F\u4E86\u3002</p></li><li><p>CMS\u6536\u96C6\u5668\u7684\u5783\u573E\u6536\u96C6\u7B97\u6CD5\u91C7\u7528\u7684\u662F\u6807\u8BB0\u4E00\u6E05\u9664\u7B97\u6CD5\uFF0C\u8FD9\u610F\u5473\u7740\u6BCF\u6B21\u6267\u884C\u5B8C\u5185\u5B58\u56DE\u6536\u540E\uFF0C\u7531\u4E8E\u88AB\u6267\u884C\u5185\u5B58\u56DE\u6536\u7684\u65E0\u7528\u5BF9\u8C61\u6240\u5360\u7528\u7684\u5185\u5B58\u7A7A\u95F4\u6781\u6709\u53EF\u80FD\u662F\u4E0D\u8FDE\u7EED\u7684\u4E00\u4E9B\u5185\u5B58\u5757\uFF0C\u4E0D\u53EF\u907F\u514D\u5730\u5C06\u4F1A\u4EA7\u751F\u4E00\u4E9B\u5185\u5B58\u788E\u7247\u3002\u90A3\u4E48CMS\u5728\u4E3A\u65B0\u5BF9\u8C61\u5206\u914D\u5185\u5B58\u7A7A\u95F4\u65F6\uFF0C\u5C06\u65E0\u6CD5\u4F7F\u7528\u6307\u9488\u78B0\u649E( Bump the Pointer)\u6280\u672F\uFF0C\u800C\u53EA\u80FD\u591F\u9009\u62E9\u7A7A\u95F2\u5217\u8868( Free List)\u6267\u884C\u5185\u5B58\u5206\u914D\u3002\u4E3A\u4EC0\u4E48\u4E0D\u4F7F\u7528Mark Compact\uFF1F\u56E0\u4E3A\u5F53\u5E76\u53D1\u6E05\u9664\u7684\u65F6\u5019\uFF0C\u7528 Compact \u6574\u7406\u5185\u5B58\u7684\u8BDD\uFF0C\u539F\u6765\u7684\u7528\u6237\u7EBF\u7A0B\u4F7F\u7528\u7684\u5185\u5B58\u8FD8\u600E\u4E48\u7528\u5462\uFF1F\u8981\u4FDD\u8BC1\u7528\u6237\u7EBF\u7A0B\u80FD\u7EE7\u7EED\u6267\u884C\uFF0C\u524D\u63D0\u662F\u5B83\u8FD0\u884C\u7684\u8D44\u6E90\u4E0D\u53D7\u5F71\u54CD\u3002 Mark Compact\u66F4\u9002\u5408\u201C Stop the World\u201D\u8FD9\u79CD\u573A\u666F\u4E0B\u4F7F\u7528\u3002</p></li><li><p>CMS\u7684\u4F18\u70B9\uFF1A</p><p>\u5E76\u53D1\u6536\u96C6\u3001\u4F4E\u5EF6\u8FDF</p></li><li><p>CMS\u7684\u5F0A\u7AEF\uFF1A **1)\u4F1A\u4EA7\u751F\u5185\u5B58\u788E\u7247\uFF0C**\u5BFC\u81F4\u5E76\u53D1\u6E05\u9664\u540E\uFF0C\u7528\u6237\u7EBF\u7A0B\u53EF\u7528\u7684\u7A7A\u95F4\u4E0D\u8DB3\u3002\u5728\u65E0\u6CD5\u5206\u914D\u5927\u5BF9\u8C61\u7684\u60C5\u51B5\u4E0B\uFF0C\u4E0D\u5F97\u4E0D\u63D0\u524D\u89E6\u53D1Full GC\u3002</p><p>**2)CMS\u6536\u96C6\u5668\u5BF9CPU\u8D44\u6E90\u975E\u5E38\u654F\u611F\u3002**\u5728\u5E76\u53D1\u9636\u6BB5\uFF0C\u5B83\u867D\u7136\u4E0D\u4F1A\u5BFC\u81F4\u7528\u6237\u505C\u987F\uFF0C\u4F46\u662F\u4F1A\u56E0\u4E3A\u5360\u7528\u4E86\u4E00\u90E8\u5206\u7EBF\u7A0B\u800C\u5BFC\u81F4\u5E94\u7528\u7A0B\u5E8F\u53D8\u6162\uFF0C\u603B\u541E\u5410\u91CF\u4F1A\u964D\u4F4E\u3002 **3)CMS\u6536\u96C6\u5668\u65E0\u6CD5\u5904\u7406\u6D6E\u52A8\u5783\u573E\u3002**\u53EF\u80FD\u51FA\u73B0\u201C Concurrent Mode Failure&quot;\u5931\u8D25\u800C\u5BFC\u81F4\u53E6\u4E00\u6B21Full GC\u7684\u4EA7\u751F\u3002\u5728\u5E76\u53D1\u6807\u8BB0\u9636\u6BB5\u7531\u4E8E\u7A0B\u5E8F\u7684\u5DE5\u4F5C\u7EBF\u7A0B\u548C\u5783\u573E\u6536\u96C6\u7EBF\u7A0B\u662F\u540C\u65F6\u8FD0\u884C\u6216\u8005\u4EA4\u53C9\u8FD0\u884C\u7684\uFF0C\u90A3\u4E48\u5728\u5E76\u53D1\u6807\u8BB0\u9636\u6BB5\u5982\u679C\u4EA7\u751F\u65B0\u7684\u5783\u573E\u5BF9\u8C61\uFF0CCMS\u5C06\u65E0\u6CD5\u5BF9\u8FD9\u4E9B\u5783\u573E\u5BF9\u8C61\u8FDB\u884C\u6807\u8BB0\uFF0C\u6700\u7EC8\u4F1A\u5BFC\u81F4\u8FD9\u4E9B\u65B0\u4EA7\u751F\u7684\u5783\u573E\u5BF9\u8C61\u6CA1\u6709\u88AB\u53CA\u65F6\u56DE\u6536\uFF0C\u4ECE\u800C\u53EA\u80FD\u5728\u4E0B\u4E00\u6B21\u6267\u884CGC\u65F6\u91CA\u653E\u8FD9\u4E9B\u4E4B\u524D\u672A\u88AB\u56DE\u6536\u7684\u5185\u5B58\u7A7A\u95F4\u3002</p></li></ul><p><strong>\u53C2\u6570\u8BBE\u7F6E</strong></p><ul><li>**-XX: UseConcMarkSweepGC **\u624B\u52A8\u6307\u5B9A\u4F7F\u7528CMS\u6536\u96C6\u5668\u6267\u884C\u5185\u5B58\u56DE\u6536\u4EFB\u52A1\u3002\u5F00\u542F\u8BE5\u53C2\u6570\u540E\u4F1A\u81EA\u52A8\u5C06 -XX: UseParNEWGC\u6253\u5F00\u3002\u5373\uFF1A ParNew( Young\u533A\u7528) +CMS(Old\u533A\u7528) Serial Old\u7684\u7EC4\u5408\u3002</li><li><strong>-XX: CMSLnitiatingOccupanyFraction</strong> \u8BBE\u7F6E\u5806\u5185\u5B58\u4F7F\u7528\u7387\u7684\u9608\u503C\uFF0C\u4E00\u65E6\u8FBE\u5230\u8BE5\u9608\u503C\uFF0C\u4FBF\u5F00\u59CB\u8FDB\u884C\u56DE\u6536\u3002JDK5\u53CA\u4EE5\u524D\u7248\u672C\u7684\u9ED8\u8BA4\u503C\u4E3A68,\u5373\u5F53\u8001\u5E74\u4EE3\u7684\u7A7A\u95F4\u4F7F\u7528\u7387\u8FBE\u523068%\u65F6\uFF0C\u4F1A\u6267\u884C\u4E00\u6B21CMS\u56DE\u6536\u3002JDK6\u53CA\u4EE5\u4E0A\u7248\u672C\u9ED8\u8BA4\u503C\u4E3A92%\u3002\u5982\u679C\u5185\u5B58\u589E\u957F\u7F13\u6162\uFF0C\u5219\u53EF\u4EE5\u8BBE\u7F6E\u4E00\u4E2A\u7A0D\u5927\u7684\u503C\uFF0C\u5927\u7684\u9608\u503C\u53EF\u4EE5\u6709\u6548\u964D\u4F4ECMS\u7684\u89E6\u53D1\u9891\u7387\uFF0C\u51CF\u5C11\u8001\u5E74\u4EE3\u56DE\u6536\u7684\u6B21\u6570\u53EF\u4EE5\u8F83\u4E3A\u660E\u663E\u5730\u6539\u5584\u5E94\u7528\u7A0B\u5E8F\u6027\u80FD\u3002\u53CD\u4E4B\uFF0C\u5982\u679C\u5E94\u7528\u7A0B\u5E8F\u5185\u5B58\u4F7F\u7528\u7387\u589E\u957F\u5F88\u5FEB\uFF0C\u5219\u5E94\u8BE5\u964D\u4F4E\u8FD9\u4E2A\u9608\u503C\uFF0C\u4EE5\u907F\u514D\u9891\u7E41\u89E6\u53D1\u8001\u5E74\u4EE3\u4E32\u884C\u6536\u96C6\u5668\u3002\u56E0\u6B64\u901A\u8FC7\u8BE5\u9009\u9879\u4FBF\u53EF\u4EE5\u6709\u6548\u964D\u4F4EFull GC\u7684\u6267\u884C\u6B21\u6570\u3002</li><li>**-XX: UseCMSCompactAtFullCollection **\u7528\u4E8E\u6307\u5B9A\u5728\u6267\u884C\u5B8CFull GC\u540E\u5BF9\u5185\u5B58\u7A7A\u95F4\u8FDB\u884C\u538B\u7F29\u6574\u7406\uFF0C\u4EE5\u6B64\u907F\u514D\u5185\u5B58\u788E\u7247\u7684\u4EA7\u751F\u3002\u4E0D\u8FC7\u7531\u4E8E\u5185\u5B58\u538B\u7F29\u6574\u7406\u8FC7\u7A0B\u65E0\u6CD5\u5E76\u53D1\u6267\u884C\uFF0C\u6240\u5E26\u6765\u7684\u95EE\u9898\u5C31\u662F\u505C\u987F\u65F6\u95F4\u53D8\u5F97\u66F4\u957F\u4E86\u3002</li><li><strong>-XX: CMSFullGCsBeforeCompaction</strong> \u8BBE\u7F6E\u5728\u6267\u884C\u591A\u5C11\u6B21Full GC\u540E\u5BF9\u5185\u5B58\u7A7A\u95F4\u8FDB\u884C\u538B\u7F29\u6574\u7406\u3002</li><li><strong>-XX: ParalellCMSThreads</strong> \u8BBE\u7F6ECMS\u7684\u7EBF\u7A0B\u6570\u91CF\u3002CMS\u9ED8\u8BA4\u542F\u52A8\u7684\u7EBF\u7A0B\u6570\u662F(ParalellCMSThreads+3)/4\u3002ParalellCMSThreads\u662F\u5E74\u8F7B\u4EE3\u5E76\u884C\u6536\u96C6\u5668\u7684\u7EBF\u7A0B\u6570\u3002\u5F53CPU\u8D44\u6E90\u6BD4\u8F83\u7D27\u5F20\u65F6\uFF0C\u53D7\u5230CMS\u6536\u96C6\u5668\u7EBF\u7A0B\u7684\u5F71\u54CD\uFF0C\u5E94\u7528\u7A0B\u5E8F\u7684\u6027\u80FD\u5728\u5783\u573E\u56DE\u6536\u9636\u6BB5\u53EF\u80FD\u4F1A\u975E\u5E38\u7CDF\u7CD5\u3002</li></ul><p><strong>\u603B\u7ED3</strong></p><p>\u5C0F\u7ED3\uFF1A HotSpot\u6709\u8FD9\u4E48\u591A\u7684\u5783\u573E\u56DE\u6536\u5668\uFF0C\u90A3\u4E48\u5982\u679C\u6709\u4EBA\u95EE\uFF0C Serial GC\u3001ParalleGC\u3001Concurrent Mark Sweep GC.\u8FD9\u4E09\u4E2AGC\u6709\u4EC0\u4E48\u4E0D\u540C\u5462\uFF1F \u8BF7\u8BB0\u4F4F\u4EE5\u4E0B\u53E3\u4EE4\uFF1A \u5982\u679C\u4F60\u60F3\u8981\u6700\u5C0F\u5316\u5730\u4F7F\u7528\u5185\u5B58\u548C\u5E76\u884C\u5F00\u9500\uFF0C\u8BF7\u9009 Serial GC; \u5982\u679C\u4F60\u60F3\u8981\u6700\u5927\u5316\u5E94\u7528\u7A0B\u5E8F\u7684\u541E\u5410\u91CF\uFF0C\u8BF7\u9009 Paralle GC; \u5982\u679C\u4F60\u60F3\u8981\u6700\u5C0F\u5316GC\u7684\u4E2D\u65AD\u6216\u505C\u987F\u65F6\u95F4\uFF0C\u8BF7\u9009 CMS GC\u3002</p><p>JDK9\u65B0\u7279\u6027\uFF1ACMS \u88AB\u6807\u8BB0\u4E3A Deprecate(JEP291)\u3002\u5982\u679C\u5BF9JDK9\u53CA\u4EE5\u4E0A\u7248\u672C\u7684 Hotspot,\u865A\u62DF\u673A\u4F7F\u7528\u53C2\u6570 -XX: UseConcMarkSweepGC \u6765\u5F00\u542FCMS\u6536\u96C6\u5668\u7684\u8BDD\uFF0C\u7528\u6237\u4F1A\u6536\u5230\u4E00\u4E2A\u8B66\u544A\u4FE1\u606F\uFF0C\u63D0\u793ACMS\u672A\u6765\u5C06\u4F1A\u88AB\u5E9F\u5F03\u3002 DK14\u65B0\u7279\u6027\uFF1A\u5220\u9664CMS\u5783\u573E\u56DE\u6536\u5668(JEP363)\u79FB\u9664\u4E86CMS\u5783\u573E\u6536\u96C6\u5668\uFF0C\u5982\u679C\u5728JDK14\u4E2D\u4F7F\u7528 -XX: UseConcMarkSweepGC\u7684\u8BDD\uFF0CJVM\u4E0D\u4F1A\u62A5\u9519\uFF0C\u53EA\u662F\u7ED9\u51FA\u4E00\u4E2Awarning\u4FE1\u606F\uFF0C\u4F46\u662F\u4E0D\u4F1Aexit\u3002JVM\u4F1A\u81EA\u52A8\u56DE\u9000\u4EE5\u9ED8\u8BA4GC\u65B9\u5F0F\u542F\u52A8JVM\u3002</p><h2 id="g1-\u533A\u57DF\u5206\u4EE3\u5316" tabindex="-1"><a class="header-anchor" href="#g1-\u533A\u57DF\u5206\u4EE3\u5316" aria-hidden="true">#</a> G1 \u533A\u57DF\u5206\u4EE3\u5316</h2><p>\u4E3A\u4EC0\u4E48\u540D\u5B57\u53EB\u505A Garbage First(G1)\u5462\uFF1F \u56E0\u4E3AG1\u662F\u4E00\u4E2A<strong>\u5E76\u884C\u56DE\u6536\u5668</strong>\uFF0C\u5B83<strong>\u628A\u5806\u5185\u5B58\u5206\u5272\u4E3A\u5F88\u591A\u4E0D\u76F8\u5173\u7684\u533A\u57DF( Region)\uFF08\u7269\u7406\u4E0A\u4E0D\u8FDE\u7EED\u7684\uFF09</strong>\u3002\u4F7F\u7528\u4E0D\u540C\u7684 Region\u6765\u8868\u793AEden\u3001\u5E78\u5B58\u80050\u533A\uFF0C\u5E78\u5B58\u80051\u533A\uFF0C\u8001\u5E74\u4EE3\u7B49\u3002 G1 GC\u6709\u8BA1\u5212\u5730\u907F\u514D\u5728\u6574\u4E2AJava\u5806\u4E2D\u8FDB\u884C\u5168\u533A\u57DF\u7684\u5783\u573E\u6536\u96C6\u3002G1\u8DDF\u8E2A\u5404\u4E2A Region\u91CC\u9762\u7684\u5783\u573E\u5806\u79EF\u7684\u4EF7\u503C\u5927\u5C0F\uFF08\u56DE\u6536\u6240\u83B7\u5F97\u7684\u7A7A\u95F4\u5927\u5C0F\u4EE5\u53CA\u56DE\u6536\u6240\u9700\u65F6\u95F4\u7684\u7ECF\u9A8C\u503C\uFF09\uFF0C\u5728\u540E\u53F0\u7EF4\u62A4\u4E00\u4E2A\u4F18\u5148\u5217\u8868\uFF0C\u6BCF\u6B21\u6839\u636E\u5141\u8BB8\u7684\u6536\u96C6\u65F6\u95F4\uFF0C\u4F18\u5148\u56DE\u6536\u4EF7\u503C\u6700\u5927\u7684 Region\u7531\u4E8E\u8FD9\u79CD\u65B9\u5F0F\u7684\u4FA7\u91CD\u70B9\u5728\u4E8E\u56DE\u6536\u5783\u573E\u6700\u5927\u91CF\u7684\u533A\u95F4( Region),\u6240\u4EE5\u6211\u4EEC\u7ED9G1\u4E00\u4E2A\u540D\u5B57\uFF1A\u5783\u573E\u4F18\u5148(Garbage First)\u3002</p><p>\u65E2\u7136\u6211\u4EEC\u5DF2\u7ECF\u6709\u4E86\u524D\u9762\u51E0\u4E2A\u5F3A\u5927\u7684GC,\u4E3A\u4EC0\u4E48\u8FD8\u8981\u53D1\u5E03 Garbage First(G1)GC? \u539F\u56E0\u5C31\u5728\u4E8E\u5E94\u7528\u7A0B\u5E8F\u6240\u5E94\u5BF9\u7684\u4E1A\u52A1\u8D8A\u6765\u8D8A\u5E9E\u5927\u3001\u590D\u6742\uFF0C\u7528\u6237\u8D8A\u6765\u8D8A\u591A\uFF0C\u6CA1\u6709GC\u5C31\u4E0D\u80FD\u4FDD\u8BC1\u5E94\u7528\u7A0B\u5E8F\u6B63\u5E38\u8FDB\u884C\uFF0C\u800C\u7ECF\u5E38\u9020\u6210STW\u7684GC\u53C8\u8DDF\u4E0D\u4E0A\u5B9E\u9645\u7684\u9700\u6C42\uFF0C\u6240\u4EE5\u624D\u4F1A\u4E0D\u65AD\u5730\u5C1D\u8BD5\u5BF9GC\u8FDB\u884C\u4F18\u5316\u3002G1( Garbage- First)\u5783\u573E\u56DE\u6536\u5668\u662F\u5728Java7 update4\u4E4B\u540E\u5F15\u5165\u7684\u4E00\u4E2A\u65B0\u7684\u5783\u573E\u56DE\u6536\u5668\uFF0C\u662F\u5F53\u4ECA\u6536\u96C6\u5668\u6280\u672F\u53D1\u5C55\u7684\u6700\u524D\u6CBF\u6210\u679C\u4E4B\u4E00\u3002 \u4E0E\u6B64\u540C\u65F6\uFF0C\u4E3A\u4E86\u9002\u5E94\u73B0\u5728\u4E0D\u65AD\u6269\u5927\u7684\u5185\u5B58\u548C\u4E0D\u65AD\u589E\u52A0\u7684\u5904\u7406\u5668\u6570\u91CF\uFF0C\u8FDB\u4E00\u6B65\u964D\u4F4E\u6682\u505C\u65F6\u95F4( pause time),\u540C\u65F6\u517C\u987E\u826F\u597D\u7684\u541E\u5410\u91CF\u3002\u5B98\u65B9\u7ED9G1\u8BBE\u5B9A\u7684\u76EE\u6807\u662F\u5728\u5EF6\u9000\u53EF\u63A7\u7684\u60C5\u51B5\u4E0B\u83B7\u5F97\u5C3D\u53EF\u80FD\u9AD8\u7684\u541E\u5410\u91CF\uFF0C\u6240\u4EE5\u624D\u62C5\u5F53\u8D77\u201C\u5168\u529F\u80FD\u6536\u96C6\u5668\u201D\u7684\u91CD\u4EFB\u4E0E\u671F\u671B\u3002</p><p>\u200B G1( Garbage- First)\u662F\u4E00\u6B3E\u9762\u5411\u670D\u52A1\u7AEF\u5E94\u7528\u7684\u5783\u573E\u6536\u96C6\u5668\uFF0C\u4E3B\u8981\u9488\u5BF9\u914D\u5907\u591A\u6838CPU\u53CA\u5927\u5BB9\u91CF\u5185\u5B58\u7684\u673A\u5668\uFF0C\u4EE5\u6781\u9AD8\u6982\u7387\u6EE1\u8DB3GC\u505C\u987F\u65F6\u95F4\u7684\u540C\u65F6\uFF0C\u8FD8\u517C\u5177\u9AD8\u541E\u5410\u91CF\u7684\u6027\u80FD\u7279\u5F81\u3002 \u200B \u5728JDK1.7\u7248\u672C\u6B63\u5F0F\u542F\u7528\uFF0C\u79FB\u9664\u4E86 Experimental\u7684\u6807\u8BC6\uFF0C\u662FJDK9\u4EE5\u540E\u7684\u9ED8\u8BA4\u5783\u573E\u56DE\u6536\u5668\uFF0C\u53D6\u4EE3\u4E86CMS\u56DE\u6536\u5668\u4EE5\u53CAParalel Parallel Old\u7EC4\u5408\u3002\u88AB Oracle\u5B98\u65B9\u79F0\u4E3A\u201C\u5168\u529F\u80FD\u7684\u5783\u573E\u6536\u96C6\u5668\u201D\u3002\u4E0E\u6B64\u540C\u65F6\uFF0CCMS\u5DF2\u7ECF\u5728JDK9\u4E2D\u88AB\u6807\u8BB0\u4E3A\u5E9F\u5F03( deprecated)\u3002\u5728jdk8\u4E2D\u8FD8\u4E0D\u662F\u9ED8\u8BA4\u7684\u5783\u573E\u56DE\u6536\u5668\uFF0C\u9700\u8981\u4F7F\u7528 -XX: UseG1GC\u6765\u542F\u7528\u3002</p><h3 id="\u4F18\u52BF" tabindex="-1"><a class="header-anchor" href="#\u4F18\u52BF" aria-hidden="true">#</a> \u4F18\u52BF</h3><p>\u4E0E\u5176\u4ED6GC\u6536\u96C6\u5668\u76F8\u6BD4\uFF0CG1\u4F7F\u7528\u4E86\u5168\u65B0\u7684\u5206\u533A\u7B97\u6CD5\uFF0C\u5176\u7279\u70B9\u5982\u4E0B\u6240\u793A\uFF1A</p><h3 id="\u5E76\u884C\u4E0E\u5E76\u53D1" tabindex="-1"><a class="header-anchor" href="#\u5E76\u884C\u4E0E\u5E76\u53D1" aria-hidden="true">#</a> <strong>\u5E76\u884C\u4E0E\u5E76\u53D1</strong></h3><p>\u5E76\u884C\u6027\uFF1AG1\u5728\u56DE\u6536\u671F\u95F4\uFF0C\u53EF\u4EE5\u6709\u591A\u4E2AGC\u7EBF\u7A0B\u540C\u65F6\u5DE5\u4F5C\uFF0C\u6709\u6548\u5229\u7528\u591A\u6838\u8BA1\u7B97\u80FD\u529B\u3002\u6B64\u65F6\u7528\u6237\u7EBF\u7A0BSTW \u5E76\u53D1\u6027\uFF1AG1\u62E5\u6709\u4E0E\u5E94\u7528\u7A0B\u5E8F\u4EA4\u66FF\u6267\u884C\u7684\u80FD\u529B\uFF0C\u90E8\u5206\u5DE5\u4F5C\u53EF\u4EE5\u548C\u5E94\u7528\u7A0B\u5E8F\u540C\u65F6\u6267\u884C\uFF0C\u56E0\u6B64\uFF0C\u4E00\u822C\u6765\u8BF4\uFF0C\u4E0D\u4F1A\u5728\u6574\u4E2A\u56DE\u6536\u9636\u6BB5\u53D1\u751F\u5B8C\u5168\u963B\u585E\u5E94\u7528\u7A0B\u5E8F\u7684\u60C5\u51B5\u3002</p><h3 id="\u5206\u4EE3\u6536\u96C6" tabindex="-1"><a class="header-anchor" href="#\u5206\u4EE3\u6536\u96C6" aria-hidden="true">#</a> <strong>\u5206\u4EE3\u6536\u96C6</strong></h3><p>\u4ECE\u5206\u4EE3\u4E0A\u770B\uFF0CG1\u4F9D\u7136\u5C5E\u4E8E\u5206\u4EE3\u578B\u5783\u573E\u56DE\u6536\u5668\uFF0C\u5B83\u4F1A\u533A\u5206\u5E74\u8F7B\u4EE3\u548C\u8001\u5E74\u4EE3\uFF0C\u5E74\u8F7B\u4EE3\u4F9D\u7136\u6709Eden\u533A\u548C Survivor\u533A\u3002\u4F46\u4ECE\u5806\u7684\u7ED3\u6784\u4E0A\u770B\uFF0C\u5B83\u4E0D\u8981\u6C42\u6574\u4E2AEden\u533A\u3001\u5E74\u8F7B\u4EE3\u6216\u8005\u8001\u5E74\u4EE3\u90FD\u662F\u8FDE\u7EED\u7684\uFF0C\u4E5F\u4E0D\u518D\u575A\u6301\u56FA\u5B9A\u5927\u5C0F\u548C\u56FA\u5B9A\u6570\u91CF\u3002\u5C06\u5806\u7A7A\u95F4\u5206\u4E3A\u82E5\u5E72\u4E2A\u533A\u57DF( Region),\u8FD9\u4E9B\u533A\u57DF\u4E2D\u5305\u542B\u4E86\u903B\u8F91\u4E0A\u7684\u5E74\u8F7B\u4EE3\u548C\u8001\u5E74\u4EE3\u3002\u548C\u4E4B\u524D\u7684\u5404\u7C7B\u56DE\u6536\u5668\u4E0D\u540C\uFF0C\u5B83\u540C\u65F6\u517C\u987E\u5E74\u8F7B\u4EE3\u548C\u8001\u5E74\u4EE3\u3002\u5BF9\u6BD4\u5176\u4ED6\u56DE\u6536\u5668\uFF0C\u6216\u8005\u5DE5\u4F5C\u5728\u5E74\u8F7B\u4EE3\uFF0C\u6216\u8005\u5DE5\u4F5C\u5728\u8001\u5E74\u4EE3\uFF1B</p><h3 id="\u7A7A\u95F4\u6574\u5408" tabindex="-1"><a class="header-anchor" href="#\u7A7A\u95F4\u6574\u5408" aria-hidden="true">#</a> <strong>\u7A7A\u95F4\u6574\u5408</strong></h3><p>\u200B CMS:\u201C\u6807\u8BB0-\u6E05\u9664\u201D\u7B97\u6CD5\u3001\u5185\u5B58\u788E\u7247\u3001\u82E5\u5E72\u6B21GC\u540E\u8FDB\u884C\u4E00\u6B21\u788E\u7247\u6574\u7406\u3002G1\u5C06\u5185\u5B58\u5212\u5206\u4E3A\u4E00\u4E2A\u4E2A\u7684 region\u3002\u5185\u5B58\u7684\u56DE\u6536\u662F\u4EE5 regiont\u4F5C\u4E3A\u57FA\u672C\u5355\u4F4D\u7684\u3002Region\u4E4B\u95F4\u662F\u590D\u5236\u7B97\u6CD5\uFF0C\u4F46\u6574\u4F53\u4E0A\u5B9E\u9645\u53EF\u770B\u4F5C\u662F\u6807\u8BB0\u4E00\u538B\u7F29\uFF08Mark- Compact\u7B97\u6CD5\uFF0C\u4E24\u79CD\u7B97\u6CD5\u90FD\u53EF\u4EE5\u907F\u514D\u5185\u5B58\u788E\u7247\u3002\u8FD9\u79CD\u7279\u6027\u6709\u5229\u4E8E\u7A0B\u5E8F\u957F\u65F6\u95F4\u8FD0\u884C\uFF0C\u5206\u914D\u5927\u5BF9\u8C61\u65F6\u4E0D\u4F1A\u56E0\u4E3A\u65E0\u6CD5\u627E\u5230\u8FDE\u7EED\u5185\u5B58\u7A7A\u95F4\u800C\u63D0\u524D\u89E6\u53D1\u4E0B\u4E00\u6B21GC\u3002\u5C24\u5176\u662F\u5F53Java\u5806\u975E\u5E38\u5927\u7684\u65F6\u5019\uFF0CG1\u7684\u4F18\u52BF\u66F4\u52A0\u660E\u663E\u3002</p><h3 id="\u53EF\u9884\u6D4B\u7684\u505C\u987F\u65F6\u95F4\u6A21\u578B-\u5373-\u8F6F\u5B9E\u65F6-soft-real-time" tabindex="-1"><a class="header-anchor" href="#\u53EF\u9884\u6D4B\u7684\u505C\u987F\u65F6\u95F4\u6A21\u578B-\u5373-\u8F6F\u5B9E\u65F6-soft-real-time" aria-hidden="true">#</a> <strong>\u53EF\u9884\u6D4B\u7684\u505C\u987F\u65F6\u95F4\u6A21\u578B(\u5373\uFF1A\u8F6F\u5B9E\u65F6 soft real-time)</strong></h3><p>\u200B \u8FD9\u662FG1\u76F8\u5BF9\u4E8ECMS\u7684\u53E6\u4E00\u5927\u4F18\u52BF\uFF0CG1\u9664\u4E86\u8FFD\u6C42\u4F4E\u505C\u987F\u5916\uFF0C\u8FD8\u80FD\u5EFA\u7ACB\u53EF\u9884\u6D4B\u7684\u505C\u987F\u65F6\u95F4\u6A21\u578B\uFF0C\u80FD\u8BA9\u4F7F\u7528\u8005\u660E\u786E\u6307\u5B9A\u5728\u4E00\u4E2A\u957F\u5EA6\u4E3AM\u6BEB\u79D2\u7684\u65F6\u95F4\u7247\u6BB5\u5185\uFF0C\u6D88\u8017\u5728\u5783\u573E\u6536\u96C6\u4E0A\u7684\u65F6\u95F4\u4E0D\u5F97\u8D85\u8FC7N\u6BEB\u79D2\u3002\u7531\u4E8E\u5206\u533A\u7684\u539F\u56E0\uFF0CG1\u53EF\u4EE5\u53EA\u9009\u53D6\u90E8\u5206\u533A\u57DF\u8FDB\u884C\u5185\u5B58\u56DE\u6536\uFF0C\u8FD9\u6837\u7F29\u5C0F\u4E86\u56DE\u6536\u7684\u8303\u56F4\uFF0C\u56E0\u6B64\u5BF9\u4E8E\u5168\u5C40\u505C\u987F\u60C5\u51B5\u7684\u53D1\u751F\u4E5F\u80FD\u5F97\u5230\u8F83\u597D\u7684\u63A7\u5236\u3002</p><p>\u200B G1\u8DDF\u8E2A\u5404\u4E2A Region \u91CC\u9762\u7684\u5783\u573E\u5806\u79EF\u7684\u4EF7\u503C\u5927\u5C0F\uFF08\u56DE\u6536\u6240\u83B7\u5F97\u7684\u7A7A\u95F4\u5927\u5C0F\u4EE5\u53CA\u56DE\u6536\u6240\u9700\u65F6\u95F4\u7684\u7ECF\u9A8C\u503C\uFF09\uFF0C\u5728\u540E\u53F0\u7EF4\u62A4\u4E00\u4E2A\u4F18\u5148\u5217\u8868\uFF0C\u6BCF\u6B21\u6839\u636E\u5141\u8BB8\u7684\u6536\u96C6\u65F6\u95F4\uFF0C\u4F18\u5148\u56DE\u6536\u4EF7\u503C\u6700\u5927\u7684 Region\u3002\u4FDD\u8BC1\u4E86G1\u6536\u96C6\u5668\u5728\u6709\u9650\u7684\u65F6\u95F4\u5185\u53EF\u4EE5\u83B7\u53D6\u5C3D\u53EF\u80FD\u9AD8\u7684\u6536\u96C6\u6548\u7387\u3002\u76F8\u6BD4\u4E8E CMS GC,G1\u672A\u5FC5\u80FD\u505A\u5230CMS\u5728\u6700\u597D\u60C5\u51B5\u4E0B\u7684\u5EF6\u65F6\u505C\u987F\uFF0C\u4F46\u662F\u6700\u5DEE\u60C5\u51B5\u8981\u597D\u5F88\u591A\u3002</p><p>\u200B \u76F8\u8F83\u4E8ECMS,G1\u8FD8\u4E0D\u5177\u5907\u5168\u65B9\u4F4D\u3001\u538B\u5012\u6027\u4F18\u52BF\u3002\u6BD4\u5982\u5728\u7528\u6237\u7A0B\u5E8F\u8FD0\u884C\u8FC7\u7A0B\u4E2D\uFF0CG1\u65E0\u8BBA\u662F\u4E3A\u4E86\u5783\u573E\u6536\u96C6\u4EA7\u751F\u7684\u5185\u5B58\u5360\u7528( Footprint)\u8FD8\u662F\u7A0B\u5E8F\u8FD0\u884C\u65F6\u7684\u989D\u5916\u6267\u884C\u8D1F\u8F7D( overload)\u90FD\u8981\u6BD4CMS\u8981\u9AD8\u3002\u4ECE\u7ECF\u9A8C\u4E0A\u6765\u8BF4\uFF0C\u5728\u5C0F\u5185\u5B58\u5E94\u7528\u4E0ACMS\u7684\u8868\u73B0\u5927\u6982\u7387\u4F1A\u4F18\u4E8EG1,\u800CG1\u5728\u5927\u5185\u5B58\u5E94\u7528\u4E0A\u5219\u53D1\u6325\u5176\u4F18\u52BF\u3002\u5E73\u8861\u70B9\u57286-8GB\u4E4B\u95F4\u3002</p><h3 id="\u53C2\u6570\u8BBE\u7F6E-1" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570\u8BBE\u7F6E-1" aria-hidden="true">#</a> <strong>\u53C2\u6570\u8BBE\u7F6E</strong></h3><p>-XX:+UseG1GC\u624B\u52A8\u6307\u5B9A\u4F7F\u7528G1\u6536\u96C6\u5668\u6267\u884C\u5185\u5B58\u56DE\u6536\u4EFB\u52A1 -XX:G1HeapRegionSize\u8BBE\u7F6E\u6BCF\u4E2A Regionl\u7684\u5927\u5C0F\u3002\u503C\u662F2\u7684\u5E42\uFF0C\u8303\u56F4\u662F1MB\u523032MB\u4E4B\u95F4\uFF0C\u76EE\u6807\u662F\u6839\u636E\u6700\u5C0F\u7684Java\u5806\u5927\u5C0F\u5212\u5206\u51FA\u7EA62048\u4E2A\u533A\u57DF\u3002\u9ED8\u8BA4\u662F\u5806\u5185\u5B58\u76841/2000 -XX: MaxGCPauseMilllis\u8BBE\u7F6E\u671F\u671B\u8FBE\u5230\u7684\u6700\u5927GC\u505C\u987F\u65F6\u95F4\u6307\u6807\uFF08JVM\u4F1A\u5C3D\u529B\u5B9E\u73B0\uFF0C\u4F46\u4E0D\u4FDD\u8BC1\u8FBE\u5230\uFF09,\u9ED8\u8BA4\u503C\u662F200ms\u3002 -XX:ParallelGCThreads\u8BBE\u7F6ESTW\u5DE5\u4F5C\u7EBF\u7A0B\u6570\u7684\u503C\u3002\u6700\u591A\u8BBE\u7F6E\u4E3A8\u3002 -XX:ConcGCThreads\u8BBE\u7F6E\u5E76\u53D1\u6807\u8BB0\u7684\u7EBF\u7A0B\u6570\u3002\u5C06n\u8BBE\u7F6E\u4E3A\u5E76\u884C\u5783\u573E\u56DE\u6536\u7EBF\u7A0B\u6570(ParallelGCThreadS)\u76841/4\u5DE6\u53F3\u3002 -XX: InitiatingHeapOccupancyPercent\u8BBE\u7F6E\u89E6\u53D1\u5E76\u53D1GC\u5468\u671F\u7684Java\u3002\u5806\u5360\u7528\u7387\u9608\u503C\u3002\u8D85\u8FC7\u6B64\u503C\uFF0C\u5C31\u89E6\u53D1GC\u3002\u9ED8\u8BA4\u503C\u662F45\u3002</p><h3 id="g1\u56DE\u6536\u5668\u5E38\u89C1\u6B65\u9AA4" tabindex="-1"><a class="header-anchor" href="#g1\u56DE\u6536\u5668\u5E38\u89C1\u6B65\u9AA4" aria-hidden="true">#</a> <strong>G1\u56DE\u6536\u5668\u5E38\u89C1\u6B65\u9AA4</strong></h3><p>G1\u7684\u8BBE\u8BA1\u539F\u5219\u5C31\u662F\u7B80\u5316JVM\u6027\u80FD\u8C03\u4F18\uFF0C\u5F00\u53D1\u4EBA\u5458\u53EA\u9700\u8981\u7B80\u5355\u7684\u4E09\u6B65\u5373\u53EF\u5B8C\u6210\u8C03\u4F18 \u7B2C\u4E00\u6B65\uFF1A\u5F00\u542FG1\u5783\u573E\u6536\u96C6\u5668 \u7B2C\u4E8C\u6B65\uFF1A\u8BBE\u7F6E\u5806\u7684\u6700\u5927\u5185\u5B58 \u7B2C\u4E09\u6B65\uFF1A\u8BBE\u7F6E\u6700\u5927\u7684\u505C\u987F\u65F6\u95F4 G1\u4E2D\u63D0\u4F9B\u4E86\u4E09\u79CD\u5783\u573E\u56DE\u6536\u6A21\u5F0F\uFF1A YoungGC\u3001 Mixed GC\u548CFullGC,\u5728\u4E0D\u540C\u7684\u6761\u4EF6\u4E0B\u88AB\u89E6\u53D1\u3002</p><h3 id="\u4F7F\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u573A\u666F" aria-hidden="true">#</a> <strong>\u4F7F\u7528\u573A\u666F</strong></h3><p>\u9762\u5411\u670D\u52A1\u7AEF\u5E94\u7528\uFF0C\u9488\u5BF9\u5177\u6709\u5927\u5185\u5B58\u3001\u591A\u5904\u7406\u5668\u7684\u673A\u5668\u3002\uFF08\u5728\u666E\u901A\u5927\u5C0F\u7684\u5806\u91CC\u8868\u73B0\u5E76\u4E0D\u60CA\u559C\uFF09 \u6700\u4E3B\u8981\u7684\u5E94\u7528\u662F\u9700\u8981\u4F4EGC\u5EF6\u8FDF\uFF0C\u5E76\u5177\u6709\u5927\u5806\u7684\u5E94\u7528\u7A0B\u5E8F\u63D0\u4F9B\u89E3\u51B3\u65B9\u6848\uFF1B\u5982\uFF1A\u5728\u5806\u5927\u5C0F\u7EA66GB\u6216\u66F4\u5927\u65F6\uFF0C\u53EF\u9884\u6D4B\u7684\u6682\u505C\u65F6\u95F4\u53EF\u4EE5\u4F4E\u4E8E8.5\u79D2\uFF1B\uFF08G1\u901A\u8FC7\u6BCF\u6B21\u53EA\u6E05\u7406\u4E00\u90E8\u5206\u800C\u4E0D\u662F\u5168\u90E8\u7684 Region\u7684\u589E\u91CF\u5F0F\u6E05\u7406\u6765\u4FDD\u8BC1\u6BCF\u6B21G\u505C\u987F\u65F6\u95F4\u4E0D\u4F1A\u8FC7\u957F\uFF09\u7528\u6765\u66FF\u6362\u6389JDK1.5\u4E2D\u7684CMS\u6536\u96C6\u5668 \u5728\u4E0B\u9762\u7684\u60C5\u51B5\u65F6\uFF0C\u4F7F\u7528G1\u53EF\u80FD\u6BD4CMS\u597D\uFF1A \u2460\u8D85\u8FC750%\u7684Java\u5806\u88AB\u6D3B\u52A8\u6570\u636E\u5360\u7528\uFF1B \u2461\u5BF9\u8C61\u5206\u914D\u9891\u7387\u6216\u5E74\u4EE3\u63D0\u5347\u9891\u7387\u53D8\u5316\u5F88\u5927\uFF1B \u2462GC\u505C\u987F\u65F6\u95F4\u8FC7\u957F(\u957F\u4E8E6.5\u81F31\u79D2)\uFF1B Hotspot\u5783\u573E\u6536\u96C6\u5668\u91CC\uFF0C\u9664\u4E86G1\u4EE5\u5916\uFF0C\u5176\u4ED6\u7684\u5783\u573E\u6536\u96C6\u5668\u4F7F\u7528\u5185\u7F6E\u7684JVM\u7EBF\u7A0B\u6267\u884C\u3002GC\u7684\u591A\u7EBF\u7A0B\u64CD\u4F5C\uFF0C\u800CG1GC\u53EF\u4EE5\u91C7\u7528\u5E94\u7528\u7EBF\u7A0B\u627F\u62C5\u540E\u53F0\u8FD0\u884C\u7684GC\u5DE5\u4F5C\uFF0C\u5373\u5F53JVM\u7684GC\u7EBF\u7A0B\u5904\u7406\u901F\u5EA6\u6162\u65F6\uFF0C\u7CFB\u7EDF\u4F1A\u8C03\u7528<strong>\u5E94\u7528\u7A0B\u5E8F\u7EBF\u7A0B</strong>\u5E2E\u52A9\u52A0\u901F\u5783\u573E\u56DE\u6536\u8FC7\u7A0B\u3002</p><h3 id="region" tabindex="-1"><a class="header-anchor" href="#region" aria-hidden="true">#</a> Region</h3><p>\u200B \u4F7F\u7528G1\u6536\u96C6\u5668\u65F6\uFF0C\u5B83\u5C06\u6574\u4E2AJava\u5806\u5212\u5206\u6210\u7EA62048\u4E2A\u5927\u5C0F\u76F8\u540C\u7684\u72EC\u7ACB Region\u5757\uFF0C\u6BCF\u4E2A Region\u5757\u5927\u5C0F\u6839\u636E\u5806\u7A7A\u95F4\u7684\u5B9E\u9645\u5927\u5C0F\u800C\u5B9A\uFF0C\u6574\u4F53\u88AB\u63A7\u5236\u57281MB\u523032MB\u4E4B\u95F4\uFF0C\u4E14\u4E3A2\u7684N\u6B21\u5E42\uFF0C\u53731MB,2MB,4MB,8MB,16MB,32MB\u3002\u53EF\u4EE5\u901A\u8FC7**-XX:G1HeapRegionSize**\u8BBE\u5B9A\u3002\u6240\u6709\u7684 Region\u5927\u5C0F\u76F8\u540C\uFF0C\u4E14\u5728JVM\u751F\u547D\u5468\u671F\u5185\u4E0D\u4F1A\u88AB\u6539\u53D8\u3002 \u200B \u867D\u7136\u8FD8\u4FDD\u7559\u6709\u65B0\u751F\u4EE3\u548C\u8001\u5E74\u4EE3\u7684\u6982\u5FF5\uFF0C\u4F46\u65B0\u751F\u4EE3\u548C\u8001\u5E74\u4EE3\u4E0D\u518D\u662F\u7269\u7406\u9694\u79BB\u7684\u4E86\uFF0C\u5B83\u4EEC\u90FD\u662F\u4E00\u90E8\u5206 Region\uFF08\u4E0D\u9700\u8981\u8FDE\u7EED\uFF09\u7684\u96C6\u5408\u3002\u901A\u8FC7 Region\u7684\u52A8\u6001\u5206\u914D\u65B9\u5F0F\u5B9E\u73B0\u903B\u8F91\u4E0A\u7684\u8FDE\u7EED\u3002</p><p><img src="http://qnimg.gisfsde.com/image-20211219174654066.png" alt="image-20211219174654066" loading="lazy"></p><p>\u200B \u4E00\u4E2A region\u6709\u53EF\u80FD\u5C5E\u4E8EEden, Survivor\u6216\u8005Old/ Tenured\u5185\u5B58\u533A\u57DF\u3002\u4F46\u662F \u4E00\u4E2A region\u53EA\u53EF\u80FD\u5C5E\u4E8E\u4E00\u4E2A\u89D2\u8272\u3002\u56FE\u4E2D\u7684E\u8868\u793A\u8BE5 region\u5C5E\u4E8EEden\u5185\u5B58\u533A\u57DF\uFF0CS\u8868\u793A\u5C5E\u4E8E Survivor\u5185\u5B58\u533A\u57DF\uFF0CO\u8868\u793A\u5C5E\u4E8EOld\u5185\u5B58\u533A\u57DF\u3002\u56FE\u4E2D\u7A7A\u767D\u7684\u8868\u793A\u672A\u4F7F\u7528\u7684\u5185\u5B58\u7A7A\u95F4\u3002 \u200B G1\u5783\u573E\u6536\u96C6\u5668\u8FD8\u589E\u52A0\u4E86\u4E00\u79CD\u65B0\u7684\u5185\u5B58\u533A\u57DF\uFF0C\u53EB\u505A Humongous\u5185\u5B58\u533A\u57DF\uFF0C\u5982\u56FE\u4E2D\u7684H\u5757\u3002\u4E3B\u8981\u7528\u4E8E\u5B58\u50A8\u5927\u5BF9\u8C61\uFF0C\u5982\u679C\u8D85\u8FC71.5\u4E2A region,\u5C31\u653E\u5230H\u3002</p><p>**\u8BBE\u7F6EH\u7684\u539F\u56E0\uFF1A**\u5BF9\u4E8E\u5806\u4E2D\u7684\u5927\u5BF9\u8C61\uFF0C\u9ED8\u8BA4\u76F4\u63A5\u4F1A\u88AB\u5206\u914D\u5230\u8001\u5E74\u4EE3\uFF0C\u4F46\u662F\u5982\u679C\u5B83\u662F\u4E00\u4E2A\u77ED\u671F\u5B58\u5728\u7684\u5927\u5BF9\u8C61\uFF0C\u5C31\u4F1A\u5BF9\u5783\u573E\u6536\u96C6\u5668\u9020\u6210\u8D1F\u9762\u5F71\u54CD\u3002\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0CG1\u5212\u5206\u4E86\u4E00\u4E2A Humongous\u533A\u3002\u5B83\u7528\u6765\u4E13\u95E8\u5B58\u653E\u5927\u5BF9\u8C61\u3002\u5982\u679C\u4E00\u4E2AH\u533A\u88C5\u4E0D\u4E0B\u30FC\u4E2A\u5927\u5BF9\u8C61\uFF0C\u90A3\u4E48G1\u4F1A\u5BFB\u627E\u8FDE\u7EED\u7684H\u533A\u6765\u5B58\u50A8\u3002\u4E3A\u4E86\u80FD\u627E\u5230\u8FDE\u7EED\u7684H\u533A\uFF0C\u6709\u65F6\u5019\u4E0D\u5F97\u4E0D\u542F\u52A8Full GC.G1\u7684\u5927\u591A\u6570\u884C\u4E3A\u90FD\u628AH\u533A\u4F5C\u4E3A\u8001\u5E74\u4EE3\u7684\u4E00\u90E8\u5206\u6765\u770B\u5F85\u3002</p><h3 id="g1-\u56DE\u6536\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#g1-\u56DE\u6536\u8FC7\u7A0B" aria-hidden="true">#</a> G1 \u56DE\u6536\u8FC7\u7A0B</h3><p>G1 GC\u7684\u5783\u573E\u56DE\u6536\u8FC7\u7A0B\u4E3B\u8981\u5305\u62EC\u5982\u4E0B\u4E09\u4E2A\u73AF\u8282 \u5E74\u8F7B\u4EE3GC( Young GC) \u8001\u5E74\u4EE3\u5E76\u53D1\u6807\u8BB0\u8FC7\u7A0B( Concurrent Marking) \u6DF7\u5408\u56DE\u6536( Mixed GC) (\u5982\u679C\u9700\u8981\uFF0C\u5355\u7EBF\u7A0B\u3001\u72EC\u5360\u5F0F\u3001\u9AD8\u5F3A\u5EA6\u7684FullGC\u8FD8\u662F\u7EE7\u7EED\u5B58\u5728\u7684\u3002\u5B83\u9488\u5BF9GC\u7684\u8BC4\u4F30\u5931\u8D25\u63D0\u4F9B\u4E86\u4E00\u79CD\u5931\u8D25\u4FDD\u62A4\u673A\u5236\uFF0C\u5373\u5F3A\u529B\u56DE\u6536\u3002\uFF09</p><p><img src="http://qnimg.gisfsde.com/image-20211219175120643.png" alt="image-20211219175120643" loading="lazy"></p><p>\u200B \u5E94\u7528\u7A0B\u5E8F\u5206\u914D\u5185\u5B58\uFF0C\u5F53\u5E74\u8F7B\u4EE3\u7684Eden\u533A\u7528\u5C3D\u65F6\u5F00\u59CB\u5E74\u8F7B\u4EE3\u56DE\u6536\u8FC7\u7A0B\uFF1BG1\u7684\u5E74\u8F7B\u4EE3\u6536\u96C6\u9636\u6BB5\u662F\u4E00\u4E2A\u5E76\u884C\u7684\u72EC\u5360\u5F0F\u6536\u96C6\u5668\u3002\u5728\u5E74\u8F7B\u4EE3\u56DE\u6536\u671F\uFF0CG1GC\u6682\u505C\u6240\u6709\u5E94\u7528\u7A0B\u5E8F\u7EBF\u7A0B\uFF0C\u542F\u52A8\u591A\u7EBF\u7A0B\u6267\u884C\u5E74\u8F7B\u4EE3\u56DE\u6536\u3002\u7136\u540E\u4ECE\u5E74\u8F7B\u4EE3\u533A\u95F4\u79FB\u52A8\u5B58\u6D3B\u5BF9\u8C61\u5230 Survivor\u533A\u95F4\u6216\u8005\u8001\u5E74\u533A\u95F4\uFF0C\u4E5F\u6709\u53EF\u80FD\u662F\u4E24\u4E2A\u533A\u95F4\u90FD\u4F1A\u6D89\u53CA\u3002 \u5F53\u5806\u5185\u5B58\u4F7F\u7528\u8FBE\u5230\u4E00\u5B9A\u503C(\u9ED8\u8BA445%)\u65F6\uFF0C\u5F00\u59CB\u8001\u5E74\u4EE3\u5E76\u53D1\u6807\u8BB0\u8FC7\u7A0B\u3002\u6807\u8BB0\u5B8C\u6210\u9A6C\u4E0A\u5F00\u59CB\u6DF7\u5408\u56DE\u6536\u8FC7\u7A0B\u3002\u5BF9\u4E8E\u4E00\u4E2A\u6DF7\u5408\u56DE\u6536\u671F\uFF0CG1GC\u4ECE\u8001\u5E74\u533A\u95F4\u79FB\u52A8\u5B58\u6D3B\u5BF9\u8C61\u5230\u7A7A\u95F2\u533A\u95F4\uFF0C\u8FD9\u4E9B\u7A7A\u95F2\u533A\u95F4\u4E5F\u5C31\u6210\u4E3A\u4E86\u8001\u5E74\u4EE3\u7684\u4E00\u90E8\u5206\u3002\u548C\u5E74\u8F7B\u4EE3\u4E0D\u540C\uFF0C\u8001\u5E74\u4EE3\u7684G1\u56DE\u6536\u5668\u548C\u5176\u4ED6GC\u4E0D\u540C\uFF0CG1\u7684\u8001\u5E74\u4EE3\u56DE\u6536\u5668\u4E0D\u9700\u8981\u6574\u4E2A\u8001\u5E74\u4EE3\u88AB\u56DE\u6536\uFF0C\u4E00\u6B21\u53EA\u9700\u8981\u626B\u63CF/\u56DE\u6536\u5C0F\u90E8\u5206\u8001\u5E74\u4EE3\u7684 Region\u5C31\u53EF\u4EE5\u4E86\u3002\u540C\u65F6\uFF0C\u8FD9\u4E2A\u8001\u5E74\u4EE3 Region\u662F\u548C\u5E74\u8F7B\u4EE3\u4E00\u8D77\u88AB\u56DE\u6536\u7684\u3002\u4E3E\u4E2A\u4F8B\u5B50\uFF1A\u4E00\u4E2AWeb\u670D\u52A1\u5668\uFF0CJava\u8FDB\u7A0B\u6700\u5927\u5806\u5185\u5B58\u4E3A4G,\u6BCF\u5206\u949F\u54CD\u5E941500\u4E2A\u8BF7\u6C42\uFF0C\u6BCF45\u79D2\u949F\u4F1A\u65B0\u5206\u914D\u5927\u7EA62G\u7684\u5185\u5B58\u3002G1\u4F1A\u6BCF45\u79D2\u949F\u8FDB\u884C\u4E00\u6B21\u5E74\u8F7B\u4EE3\u56DE\u6536\uFF0C\u6BCF31\u4E2A\u5C0F\u65F6\u6574\u4E2A\u5806\u7684\u4F7F\u7528\u7387\u4F1A\u8FBE\u523045%,\u4F1A\u5F00\u59CB\u8001\u5E74\u4EE3\u5E76\u53D1\u6807\u8BB0\u8FC7\u7A0B\uFF0C\u6807\u8BB0\u5B8C\u6210\u540E\u5F00\u59CB\u56DB\u5230\u4E94\u6B21\u7684\u6DF7\u5408\u56DE\u6536\u3002</p><h4 id="remembered-set" tabindex="-1"><a class="header-anchor" href="#remembered-set" aria-hidden="true">#</a> Remembered Set</h4><ul><li>\u4E00\u4E2A\u5BF9\u8C61\u88AB\u4E0D\u540C\u533A\u57DF\u5F15\u7528\u7684\u95EE\u9898\u3002\u4E00\u4E2A Region\u4E0D\u53EF\u80FD\u662F\u5B64\u7ACB\u7684\uFF0C\u4E00\u4E2A Region\u4E2D\u7684\u5BF9\u8C61\u53EF\u80FD\u88AB\u5176\u4ED6\u4EFB\u610F Region\u4E2D\u5BF9\u8C61\u5F15\u7528\uFF0C\u5224\u65AD\u5BF9\u8C61\u5B58\u6D3B\u65F6\uFF0C\u662F\u5426\u9700\u8981\u626B\u63CF\u6574\u4E2AJava\u5806\u624D\u80FD\u4FDD\u8BC1\u51C6\u786E\u3002\u5728\u5176\u4ED6\u7684\u5206\u4EE3\u6536\u96C6\u5668\uFF0C\u4E5F\u5B58\u5728\u8FD9\u6837\u7684\u95EE\u9898(\u800CG1\u66F4\u7A81\u51FA)\u3002\u56DE\u6536\u65B0\u751F\u4EE3\u4E5F\u4E0D\u5F97\u4E0D\u540C\u65F6\u626B\u63CF\u8001\u5E74\u4EE3\uFF1F\u8FD9\u6837\u7684\u8BDD\u4F1A\u964D\u4F4E Minor GC\u7684\u6548\u7387\u3002</li><li>\u89E3\u51B3\u65B9\u6CD5\uFF1A</li><li>\u65E0\u8BBAG1\u8FD8\u662F\u5176\u4ED6\u5206\u4EE3\u6536\u96C6\u5668\uFF0CJVM\u90FD\u662F\u4F7F\u7528 Remembered Set\u6765\u907F\u514D\u5168\u5C40\u626B\u63CF\uFF1A\u6BCF\u4E2A Region\u90FD\u6709\u4E00\u4E2A\u5BF9\u5E94\u7684 Remembered Set;\u6BCF\u6B21 Reference\u7C7B\u578B\u6570\u636E\u5199\u64CD\u4F5C\u65F6\uFF0C\u90FD\u4F1A\u4EA7\u751F\u4E00\u4E2A Write Barrier\u6682\u65F6\u4E2D\u65AD\u64CD\u4F5C\uFF1B\u7136\u540E\u68C0\u67E5\u5C06\u8981\u5199\u5165\u7684\u5F15\u7528\u6307\u5411\u7684\u5BF9\u8C61\u662F\u5426\u548C\u8BE5 Referencea\u7C7B\u578B\u6570\u636E\u5728\u4E0D\u540C\u7684 Region(\u5176\u4ED6\u6536\u96C6\u5668\uFF1A\u68C0\u67FB\u8001\u5E74\u4EE3\u5BF9\u8C61\u662F\u5426\u5F15\u7528\u4E86\u65B0\u751F\u4EE3\u5BF9\u8C61\uFF09\uFF1B\u5982\u679C\u4E0D\u540C\uFF0C\u901A\u8FC7 Cardtable\u628A\u76F8\u5173\u5F15\u7528\u4FE1\u606F\u8BB0\u5F55\u5230\u5F15\u7528\u6307\u5411\u5BF9\u8C61\u7684\u6240\u5728 Region\u5BF9\u5E94\u7684 Remembered Set\u4E2D\uFF1B\u5F53\u8FDB\u884C\u5783\u573E\u6536\u96C6\u65F6\uFF0C\u5728GC\u6839\u8282\u70B9\u7684\u679A\u4E3E\u8303\u56F4\u52A0\u5165 Remembered Set:\u5C31\u53EF\u4EE5\u4FDD\u8BC1\u4E0D\u8FDB\u884C\u5168\u5C40\u626B\u63CF\uFF0C\u4E5F\u4E0D\u4F1A\u6709\u9057\u6F0F\u3002</li></ul><h4 id="\u56DE\u6536\u8FC7\u7A0B\u4E00-\u5E74\u8F7B\u4EE3gc" tabindex="-1"><a class="header-anchor" href="#\u56DE\u6536\u8FC7\u7A0B\u4E00-\u5E74\u8F7B\u4EE3gc" aria-hidden="true">#</a> <strong>\u56DE\u6536\u8FC7\u7A0B\u4E00\uFF1A\u5E74\u8F7B\u4EE3GC</strong></h4><img src="http://qnimg.gisfsde.com/image-20211219180806808.png" alt="image-20211219180806808" style="zoom:50%;"><p>\u200B JVM\u542F\u52A8\u65F6\uFF0CG1\u5148\u51C6\u5907\u597DEden\u533A\uFF0C\u7A0B\u5E8F\u5728\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u4E0D\u65AD\u521B\u5EFA\u5BF9\u8C61\u5230Eden\u533A\uFF0C\u5F53Eden\u7A7A\u95F4\u8017\u5C3D\u65F6\uFF0CG1\u4F1A\u542F\u52A8\u4E00\u6B21\u5E74\u8F7B\u4EE3\u5783\u573E\u56DE\u6536\u8FC7\u7A0B\u3002\u5E74\u8F7B\u4EE3\u5783\u573E\u56DE\u6536\u53EA\u4F1A\u56DE\u6536Eden\u533A\u548C Survivor\u533A\u3002\u9996\u514861\u505C\u6B62\u5E94\u7528\u7A0B\u5E8F\u7684\u6267\u884C(Stop-The-World),G1\u521B\u5EFA\u56DE\u6536\u96C6(Collection Set),\u56DE\u6536\u96C6\u662F\u6307\u9700\u8981\u88AB\u56DE\u6536\u7684\u5185\u5B58\u5206\u6BB5\u7684\u96C6\u5408\uFF0C\u5E74\u8F7B\u4EE3\u56DE\u6536\u8FC7\u7A0B\u7684\u56DE\u6536\u96C6\u5305\u542B\u5E74\u8F7B\u4EE3Eden\u533A\u548C Survivor\u533A\u6240\u6709\u7684\u5185\u5B58\u5206\u6BB5\u3002</p><p>\u7136\u540E\u5F00\u59CB\u5982\u4E0B\u56DE\u6536\u8FC7\u7A0B\uFF1A \u7B2C\u4E00\u9636\u6BB5\uFF0C\u626B\u63CF\u6839\u3002 \u6839\u662F\u6307 static\u53D8\u91CF\u6307\u5411\u7684\u5BF9\u8C61\uFF0C\u6B63\u5728\u6267\u884C\u7684\u65B9\u6CD5\u8C03\u7528\u94FE\u6761\u4E0A\u7684\u5C40\u90E8\u53D8\u91CF\u7B49\u3002\u6839\u5F15\u7528\u8FDE\u540CRSet\u8BB0\u5F55\u7684\u5916\u90E8\u5F15\u7528\u4F5C\u4E3A\u626B\u63CF\u5B58\u6D3B\u5BF9\u8C61\u7684\u5165\u53E3 \u7B2C\u4E8C\u9636\u6BB5\uFF0C\u66F4\u65B0RSet. \u5904\u7406 dirty card queue\uFF08\u89C1\u5907\u6CE8\uFF09\u4E2D\u7684card,\u66F4\u65B0RSet\u3002\u6B64\u9636\u6BB5\u5B8C\u6210\u540E\uFF0CRSet\u53EF\u4EE5\u51C6\u786E\u7684\u53CD\u6620\u8001\u5E74\u4EE3\u5BF9\u6240\u5728\u7684\u5185\u5B58\u5206\u6BB5\u4E2D\u5BF9\u8C61\u7684\u5F15\u7528\u3002 \u7B2C\u4E09\u9636\u6BB5\uFF0C\u5904\u7406RSet. \u8BC6\u522B\u88AB\u8001\u5E74\u4EE3\u5BF9\u8C61\u6307\u5411\u7684Eden\u4E2D\u7684\u5BF9\u8C61\uFF0C\u8FD9\u4E9B\u88AB\u6307\u5411\u7684Eden\u4E2D\u7684\u5BF9\u8C61\u88AB\u8BA4\u4E3A\u662F\u5B58\u6D3B\u7684\u5BF9\u8C61\u3002 \u7B2C\u56DB\u9636\u6BB5\uFF0C\u590D\u5236\u5BF9\u8C61\u3002 \u6B64\u9636\u6BB5\uFF0C\u5BF9\u8C61\u6811\u88AB\u904D\u5386\uFF0CEden\u533A\u5185\u5B58\u6BB5\u4E2D\u5B58\u6D3B\u7684\u5BF9\u8C61\u4F1A\u88AB\u590D\u5236\u5230 Survivor\u533A\u4E2D\u7A7A\u7684\u5185\u5B58\u5206\u6BB5\uFF0CSurvivor\u533A\u5185\u5B58\u6BB5\u4E2D\u5B58\u6D3B\u7684\u5BF9\u8C61\u5982\u679C\u5E74\u9F84\u672A\u8FBE\u9608\u503C\uFF0C\u5E74\u9F84\u4F1A\u52A01,\u8FBE\u5230\u9600\u503C\u4F1A\u88AB\u4F1A\u88AB\u590D\u5236\u52300ld\u533A\u4E2D\u7A7A\u7684\u5185\u5B58\u5206\u6BB5\u3002\u5982\u679C Survivor\u7A7A\u95F4\u4E0D\u591F\uFF0CEden\u7A7A\u95F4\u7684\u90E8\u5206\u6570\u636E\u4F1A\u76F4\u63A5\u664B\u5347\u5230\u8001\u5E74\u4EE3\u7A7A\u95F4\u3002 \u7B2C\u4E94\u9636\u6BB5\uFF0C\u5904\u7406\u5F15\u7528\u3002 \u5904\u7406Soft,Weak, Phantom,Fina1, JNI Weak\u7B49\u5F15\u7528\u3002\u6700\u7EC8Eden\u7A7A\u95F4\u7684\u6570\u636E\u4E3A\u7A7A\uFF0CGC\u505C\u6B62\u5DE5\u4F5C\uFF0C\u800C\u76EE\u6807\u5185\u5B58\u4E2D\u7684\u5BF9\u8C61\u90FD\u662F\u8FDE\u7EED\u5B58\u50A8\u7684\uFF0C\u6CA1\u6709\u788E\u7247\uFF0C\u6240\u4EE5\u590D\u5236\u8FC7\u7A0B\u53EF\u4EE5\u8FBE\u5230\u5185\u5B58\u6574\u7406\u7684\u6548\u679C\uFF0C\u51CF\u5C11\u788E\u7247\u3002</p><h4 id="\u56DE\u6536\u8FC7\u7A0B\u4E8C-\u5E76\u53D1\u6807\u8BB0\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u56DE\u6536\u8FC7\u7A0B\u4E8C-\u5E76\u53D1\u6807\u8BB0\u8FC7\u7A0B" aria-hidden="true">#</a> \u56DE\u6536\u8FC7\u7A0B\u4E8C\uFF1A\u5E76\u53D1\u6807\u8BB0\u8FC7\u7A0B</h4><ul><li>\u521D\u59CB\u6807\u8BB0\u9636\u6BB5\uFF1A\u6807\u8BB0\u4ECE\u6839\u8282\u70B9\u76F4\u63A5\u53EF\u8FBE\u7684\u5BF9\u8C61\u3002\u8FD9\u4E2A\u9636\u6BB5\u662FSTW\u7684\uFF0C\u5E76\u4E14\u4F1A\u89E6\u53D1\u4E00\u6B21\u5E74\u8F7B\u4EE3GC.</li><li>\u6839\u533A\u57DF\u626B\u63CF( Root Region Scanning):G1 GC\u626B\u63CF Survivor\u533A\u76F4\u63A5\u53EF\u8FBE\u7684\u8001\u5E74\u4EE3\u533A\u57DF\u5BF9\u8C61\uFF0C\u5E76\u6807\u8BB0\u88AB\u5F15\u7528\u7684\u5BF9\u8C61\u3002\u8FD9\u4E00\u8FC7\u7A0B\u5FC5\u987B\u5728 young GC\u4E4B\u524D\u5B8C\u6210</li><li>\u5E76\u53D1\u6807\u8BB0( Concurrent Marking):\u5728\u6574\u4E2A\u5806\u4E2D\u8FDB\u884C\u5E76\u53D1\u6807\u8BB0\uFF08\u548C\u5E94\u7528\u7A0B\u5E8F\u5E76\u53D1\u6267\u884C\uFF09\uFF0C\u6B64\u8FC7\u7A0B\u53EF\u80FD\u88AB young GC\u4E2D\u65AD\u3002\u5728\u5E76\u53D1\u6807\u8BB0\u9636\u6BB5\uFF0C\u82E5\u53D1\u73B0\u533A\u57DF\u5BF9\u8C61\u4E2D\u7684\u6240\u6709\u5BF9\u8C61\u90FD\u662F\u5783\u573E\uFF0C\u90A3\u8FD9\u4E2A\u533A\u57DF\u4F1A\u88AB\u7ACB\u5373\u56DE\u6536\u3002\u540C\u65F6\uFF0C\u5E76\u53D1\u6807\u8BB0\u8FC7\u7A0B\u4E2D\uFF0C\u4F1A\u8BA1\u7B97\u6BCF\u4E2A\u533A\u57DF\u7684\u5BF9\u8C61\u6D3B\u6027\uFF08\u533A\u57DF\u4E2D\u5B58\u6D3B\u5BF9\u8C61\u7684\u6BD4\u4F8B\uFF09\u3002</li><li>\u518D\u6B21\u6807\u8BB0( Remark):\u7531\u4E8E\u5E94\u7528\u7A0B\u5E8F\u6301\u7EED\u8FDB\u884C\uFF0C\u9700\u8981\u4FEE\u6B63\u4E0A\u4E00\u6B21\u7684\u6807\u8BB0\u7ED3\u679C\u3002\u662FSTW\u7684\u3002G1\u4E2D\u91C7\u7528\u4E86\u6BD4CMS\u66F4\u5FEB\u7684\u521D\u59CB\u5FEB\u7167\u7B97\u6CD5\uFF1A snapshot-at-the- beginning(SATB)\u3002</li><li>\u72EC\u5360\u6E05\u7406(cleanup,STW):\u8BA1\u7B97\u5404\u4E2A\u533A\u57DF\u7684\u5B58\u6D3B\u5BF9\u8C61\u548CGC\u56DE\u6536\u6BD4\u4F8B\uFF0C\u5E76\u8FDB\u884C\u6392\u5E8F\uFF0C\u8BC6\u522B\u53EF\u4EE5\u6DF7\u5408\u56DE\u6536\u7684\u533A\u57DF\u3002\u4E3A\u4E0B\u9636\u6BB5\u505A\u94FA\u57AB\u3002\u662FST\u7684\u3002\u8FD9\u4E2A\u9636\u6BB5\u5E76\u4E0D\u4F1A\u5B9E\u9645\u4E0A\u53BB\u505A\u5783\u573E\u7684\u6536\u96C6\u5E76\u53D1\u6E05\u7406\u9636\u6BB5\uFF1A\u8BC6\u522B\u5E76\u6E05\u7406\u5B8C\u5168\u7A7A\u95F2\u7684\u533A\u57DF\u3002</li></ul><h4 id="\u56DE\u6536\u9636\u6BB5\u4E09-\u6DF7\u5408\u56DE\u6536" tabindex="-1"><a class="header-anchor" href="#\u56DE\u6536\u9636\u6BB5\u4E09-\u6DF7\u5408\u56DE\u6536" aria-hidden="true">#</a> \u56DE\u6536\u9636\u6BB5\u4E09\uFF1A\u6DF7\u5408\u56DE\u6536</h4><p>\u200B \u5F53\u8D8A\u6765\u8D8A\u591A\u7684\u5BF9\u8C61\u664B\u5347\u5230\u8001\u5E74\u4EE3\u3002old region\u65F6\uFF0C\u4E3A\u4E86\u907F\u514D\u5806\u5185\u5B58\u88AB\u8017\u5C3D\uFF0C\u865A\u62DF\u673A\u4F1A\u89E6\u53D1\u4E00\u4E2A\u6DF7\u5408\u7684\u5783\u573E\u6536\u96C6\u5668\uFF0C\u5373 Mixed GC,\u8BE5\u7B97\u6CD5\u5E76\u4E0D\u662F\u4E00\u4E2AOld GC,\u9664\u4E86\u56DE\u6536\u6574\u4E2A Young Region,\u8FD8\u4F1A\u56DE\u6536\u4E00\u90E8\u5206\u7684Old Region\u3002\u8FD9\u91CC\u9700\u8981\u6CE8\u610F\uFF1A\u662F\u4E00\u90E8\u5206\u8001\u5E74\u4EE3\uFF0C\u800C\u4E0D\u662F\u5168\u90E8\u8001\u5E74\u4EE3\u3002\u53EF\u4EE5\u9009\u62E9\u54EA\u4E9BOld Region\u8FDB\u884C\u6536\u96C6\uFF0C\u4ECE\u800C\u53EF\u4EE5\u5BF9\u5783\u573E\u56DE\u6536\u7684\u8017\u65F6\u65F6\u95F4\u8FDB\u884C\u63A7\u5236\u3002\u4E5F\u8981\u6CE8\u610F\u7684\u662F Mixed GC\u5E76\u4E0D\u662FFull GC\u3002</p><p><img src="http://qnimg.gisfsde.com/image-20211219181644860.png" alt="image-20211219181644860" loading="lazy"></p><ul><li><p>\u5E76\u53D1\u6807\u8BB0\u7ED3\u675F\u4EE5\u540E\uFF0C\u8001\u5E74\u4EE3\u4E2D\u767E\u5206\u767E\u4E3A\u5783\u573E\u7684\u5185\u5B58\u5206\u6BB5\u88AB\u56DE\u6536\u4E86\uFF0C\u90E8\u5206\u4E3A\u5783\u573E\u7684\u5185\u5B58\u5206\u6BB5\u88AB\u8BA1\u7B97\u4E86\u51FA\u6765\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u8FD9\u4E9B\u8001\u5E74\u4EE3\u7684\u5185\u5B58\u5206\u6BB5\u4F1A\u52068\u6B21(\u53EF\u4EE5\u901A\u8FC7XX:G1 MixedGCCountTarget\u8BBE\u7F6E)\u88AB\u56DE\u6536\u3002</p></li><li><p>\u6DF7\u5408\u56DE\u6536\u7684\u56DE\u6536\u96C6(Collection Set)\u5305\u62EC\u516B\u5206\u4E4B\u4E00\u7684\u8001\u5E74\u4EE3\u5185\u5B58\u5206\u6BB5\uFF0CEden\u533A\u5185\u5B58\u5206\u6BB5\uFF0C Survivor\u533A\u5185\u5B58\u5206\u6BB5\u3002\u6DF7\u5408\u56DE\u6536\u7684\u7B97\u6CD5\u548C\u5E74\u8F7B\u4EE3\u56DE\u6536\u7684\u7B97\u6CD5\u5B8C\u5168\u4E00\u6837\uFF0C\u53EA\u662F\u56DE\u6536\u96C6\u591A\u4E86\u8001\u5E74\u4EE3\u7684\u5185\u5B58\u5206\u6BB5\u3002\u5177\u4F53\u8FC7\u7A0B\u8BF7\u53C2\u8003\u4E0A\u9762\u7684\u5E74\u8F7B\u4EE3\u56DE\u6536\u8FC7\u7A0B\u3002</p></li><li><p>\u7531\u4E8E\u8001\u5E74\u4EE3\u4E2D\u7684\u5185\u5B58\u5206\u6BB5\u9ED8\u8BA4\u52068\u6B21\u56DE\u6536\uFF0CG1\u4F1A\u4F18\u5148\u56DE\u6536\u5783\u573E\u591A\u7684\u5185\u5B58\u5206\u6BB5\u3002\u5783\u573E\u5360\u5185\u5B58\u5206\u6BB5\u6BD4\u4F8B\u8D8A\u9AD8\u7684\uFF0C\u8D8A\u4F1A\u88AB\u5148\u56DE\u6536\u3002\u5E76\u4E14\u6709\u4E00\u4E2A\u9608\u503C\u4F1A\u51B3\u5B9A\u5185\u5B58\u5206\u6BB5\u662F\u5426\u88AB\u56DE\u6536\uFF0C-XX:G1 MixedGCliveThresholPercent,\u9ED8\u8BA4\u4E3A65%,\u610F\u601D\u662F\u5783\u573E\u5360\u5185\u5B58\u5206\u6BB5\u6BD4\u4F8B\u8981\u8FBE\u523065%\u624D\u4F1A\u88AB\u56DE\u6536\u3002\u5982\u679C\u5783\u573E\u5360\u6BD4\u592A\u4F4E\uFF0C\u610F\u5473\u7740\u5B58\u6D3B\u7684\u5BF9\u8C61\u5360\u6BD4\u9AD8\uFF0C\u5728\u590D\u5236\u7684\u65F6\u5019\u4F1A\u82B1\u8D39\u66F4\u591A\u7684\u65F6\u95F4\u3002</p></li><li><p>\u6DF7\u5408\u56DE\u6536\u5E76\u4E0D\u4E00\u5B9A\u8981\u8FDB\u884C8\u6B21\u3002\u6709\u4E00\u4E2A\u9608\u503C-XX:G1HeapWastePercent,\u9ED8\u8BA4\u503C\u4E3A10%,\u610F\u601D\u662F\u5141\u8BB8\u6574\u4E2A\u5806\u5185\u5B58\u4E2D\u670910%\u7684\u7A7A\u95F4\u88AB\u6D6A\u8D39\uFF0C\u610F\u5473\u7740\u5982\u679C\u53D1\u73B0\u53EF\u4EE5\u56DE\u6536\u7684\u5783\u573E\u5360\u5806\u5185\u5B58\u7684\u6BD4\u4F8B\u4F4E\u4E8E10%,\u5219\u4E0D\u518D\u8FDB\u884C\u6DF7\u5408\u56DE\u6536\u3002\u56E0\u4E3AGC\u4F1A\u82B1\u8D39\u5F88\u591A\u7684\u65F6\u95F4\u4F46\u662F\u56DE\u6536\u5230\u7684\u5185\u5B58\u5374\u5F88\u5C11\u3002</p><p><strong>\u603B\u7ED3</strong></p><p>G1\u7684\u521D\u8877\u5C31\u662F\u8981\u907F\u514DFull GC\u7684\u51FA\u73B0\u3002\u4F46\u662F\u5982\u679C\u4E0A\u8FF0\u65B9\u5F0F\u4E0D\u80FD\u6B63\u5E38\u5DE5\u4F5C\uFF0CG1\u4F1A\u505C\u6B62\u5E94\u7528\u7A0B\u5E8F\u7684\u6267\u884C(Stop-The-World),\u4F7F\u7528\u5355\u7EBF\u7A0B\u7684\u5185\u5B58\u56DE\u6536\u7B97\u6CD5\u8FDB\u884C\u5783\u573E\u56DE\u6536\uFF0C\u6027\u80FD\u4F1A\u975E\u5E38\u5DEE\uFF0C\u5E94\u7528\u7A0B\u5E8F\u505C\u987F\u65F6\u95F4\u4F1A\u5F88\u957F\u8981\u907F\u514DFull GC\u7684\u53D1\u751F\uFF0C\u4E00\u65E6\u53D1\u751F\u9700\u8981\u8FDB\u884C\u8C03\u6574\u3002\u4EC0\u4E48\u65F6\u5019\u4F1A\u53D1\u751FFull GC\u5462\uFF1F\u6BD4\u5982\u5806\u5185\u5B58\u592A\u5C0F\uFF0C\u5F53G1\u5728\u590D\u5236\u5B58\u6D3B\u5BF9\u8C61\u7684\u65F6\u5019\u6CA1\u6709\u7A7A\u7684\u5185\u5B58\u5206\u6BB5\u53EF\u7528\u5219\u4F1A\u56DE\u9000\u5230Full GC,\u8FD9\u79CD\u60C5\u51B5\u53EF\u4EE5\u901A\u8FC7\u5897\u5927\u5185\u5B58\u89E3\u51B3\u3002\u5BFC\u81F4G1 Full GC\u7684\u539F\u56E0\u53EF\u80FD\u6709\u4E24\u4E2A\uFF1AEvacuation\u7684\u65F6\u5019\u6CA1\u6709\u8DB3\u591F\u7684to- space\u6765\u5B58\u653E\u664B\u5347\u7684\u5BF9\u8C61\u3002\u5E76\u53D1\u5904\u7406\u8FC7\u7A0B\u5B8C\u6210\u4E4B\u524D\u7A7A\u95F4\u8017\u5C3D\u3002</p></li></ul><p>\u200B \u4ECE Oracle\u5B98\u65B9\u900F\u9732\u51FA\u6765\u7684\u4FE1\u606F\u53EF\u83B7\u77E5\uFF0C\u56DE\u6536\u9636\u6BB5( Evacuation)\u5176\u5B9E\u672C\u4E5F\u6709\u60F3\u8FC7\u8BBE\u8BA1\u6210\u4E0E\u7528\u6237\u7A0B\u5E8F\u4E00\u8D77\u5E76\u53D1\u6267\u884C\uFF0C\u4F46\u8FD9\u4EF6\u4E8B\u60C5\u505A\u8D77\u6765\u6BD4\u8F83\u590D\u6742\uFF0C\u8003\u8651\u5230G1\u53EA\u662F\u56DE\u6536\u4E00\u90E8\u5206 Reglon,\u505C\u987F\u65F6\u95F4\u662F\u7528\u6237\u53EF\u63A7\u5236\u7684\uFF0C\u6240\u4EE5\u5E76\u4E0D\u8FEB\u5207\u53BB\u5B9E\u73B0\uFF0C\u800C\u9009\u62E9\u628A\u8FD9\u4E2A\u7279\u6027\u653E\u5230\u4E86G1\u4E4B\u540E\u51FA\u73B0\u7684\u4F4E\u5EF6\u8FDF\u5783\u573E\u6536\u96C6\u5668(\u5373ZGC)\u4E2D\u3002\u53E6\u5916\uFF0C\u8FD8\u8003\u8651\u5230G1\u4E0D\u662F\u4EC5\u4EC5\u9762\u5411\u4F4E\u5EF6\u8FDF\uFF0C\u505C\u987F\u7528\u6237\u7EBF\u7A0B\u80FD\u591F\u6700\u5927\u5E45\u5EA6\u63D0\u9AD8\u5783\u573E\u6536\u96C6\u6548\u7387\uFF0C\u4E3A\u4E86\u4FDD\u8BC1\u541E\u5410\u91CF\u6240\u4EE5\u624D\u9009\u62E9\u4E86\u5B8C\u5168\u6682\u505C\u7528\u6237\u7EBF\u7A0B\u7684\u5B9E\u73B0\u65B9\u6848\u3002</p><p><strong>\u4F18\u5316\u5EFA\u8BAE</strong></p><p>\u5E74\u8F7B\u4EE3\u5927\u5C0F \u907F\u514D\u4F7F\u7528-Xmn\u6216-XX: NewRatio\u7B49\u76F8\u5173\u9009\u9879\u663E\u5F0F\u8BBE\u7F6E\u5E74\u8F7B\u4EE3\u5927\u5C0F\u3002\u56FA\u5B9A\u5E74\u8F7B\u4EE3\u7684\u5927\u5C0F\u4F1A\u8986\u76D6\u6682\u505C\u65F6\u95F4\u76EE\u6807\u6682\u505C\u65F6\u95F4\u76EE\u6807\u4E0D\u8981\u592A\u8FC7\u4E25\u82DB</p><p>G1 GC\u7684\u541E\u5410\u91CF\u76EE\u6807\u662F90%\u7684\u5E94\u7528\u7A0B\u5E8F\u65F6\u95F4\u548C1%\u7684\u5783\u573E\u56DE\u6536\u65F6\u95F4\u8BC4\u4F30G1GC\u7684\u541E\u5410\u91CF\u65F6\uFF0C\u6682\u505C\u65F6\u95F4\u76EE\u6807\u4E0D\u8981\u592A\u4E25\u82DB\u3002\u76EE\u6807\u592A\u8FC7\u4E25\u82DB\u8868 \u793A\u4F60\u613F\u610F\u627F\u53D7\u66F4\u591A\u7684\u5783\u573E\u56DE\u6536\u5F00\u9500\uFF0C\u800C\u8FD9\u4E9B\u4F1A\u76F4\u63A5\u5F71\u54CD\u5230\u541E\u5410\u91CF\u3002</p><h2 id="\u5783\u573E\u56DE\u6536\u5668\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u56DE\u6536\u5668\u603B\u7ED3" aria-hidden="true">#</a> \u5783\u573E\u56DE\u6536\u5668\u603B\u7ED3</h2><p><img src="http://qnimg.gisfsde.com/image-20211219210702749.png" alt="image-20211219210702749" loading="lazy"></p><p>Java\u5783\u573E\u6536\u96C6\u5668\u7684\u914D\u7F6E\u5BF9\u4E8E]W\uC368\u4F18\u5316\u6765\u8BF4\u662F\u4E00\u4E2A\u5F88\u91CD\u8981\u7684\u9009\u62E9\uFF0C\u9009\u62E9\u5408\u9002\u7684\u5783\u573E\u6536\u96C6\u5668\u53EF\u4EE5\u8BA9V\u7684\u6027\u80FD\u6709\u4E00\u4E2A\u5F88\u5927\u7684\u63D0\u5347\u3002 \u600E\u4E48\u9009\u62E9\u5783\u573E\u6536\u96C6\u5668\uFF1F</p><ul><li>\u4F18\u5148\u8C03\u6574\u5806\u7684\u5927\u5C0F\u8BA9JVM\u81EA\u9002\u5E94\u5B8C\u6210</li><li>\u5982\u679C\u5185\u5B58\u5C0F\u4E8E100M,\u4F7F\u7528\u4E32\u884C\u6536\u96C6\u5668</li><li>\u5982\u679C\u662F\u5355\u6838\u3001\u5355\u673A\u7A0B\u5E8F\uFF0C\u5E76\u4E14\u6CA1\u6709\u505C\u987F\u65F6\u95F4\u7684\u8981\u6C42\uFF0C\u4E32\u884C\u6536\u96C6\u5668</li><li>\u5982\u679C\u662F\u591ACPU\u3001\u9700\u8981\u9AD8\u541E\u5410\u91CF\u3001\u5141\u8BB8\u505C\u987F\u65F6\u95F4\u8D85\u8FC71\u79D2\uFF0C\u9009\u62E9\u5E76\u884C\u6216\u8005JVM\u81EA\u5DF1\u9009\u62E9</li><li>\u5982\u679C\u662F\u591ACPU\u3001\u8FFD\u6C42\u4F4E\u505C\u987F\u65F6\u95F4\uFF0C\u9700\u5FEB\u901F\u54CD\u5E94\uFF08\u6BD4\u5982\u5EF6\u8FDF\u4E0D\u80FD\u8D85\u8FC71\u79D2\uFF0C\u5982\u4E92\u8054\u7F51\u5E94\u7528\uFF09\uFF0C\u4F7F\u7528\u5E76\u53D1\u6536\u96C6\u5668</li><li>\u5B98\u65B9\u63A8\u8350G1,\u6027\u80FD\u9AD8\u3002<strong>\u73B0\u5728\u4E92\u8054\u7F51\u7684\u9879\u76EE\uFF0C\u57FA\u672C\u90FD\u662F\u4F7F\u7528G1\u3002</strong></li></ul><p>\u6700\u540E\u9700\u8981\u660E\u786E\u4E00\u4E2A\u89C2\u70B9 1.\u6CA1\u6709\u6700\u597D\u7684\u6536\u96C6\u5668\uFF0C\u66F4\u6CA1\u6709\u4E07\u80FD\u7684\u6536\u96C6\uFF1B 2.\u8C03\u4F18\u6C38\u8FDC\u662F\u9488\u5BF9\u7279\u5B9A\u573A\u666F\u3001\u7279\u5B9A\u9700\u6C42\uFF0C\u4E0D\u5B58\u5728\u4E00\u52B3\u6C38\u9038\u7684\u6536\u96C6\u5668</p><p>\u5BF9\u4E8E\u5783\u573E\u6536\u96C6\uFF0C\u9762\u8BD5\u5B98\u53EF\u4EE5\u5FAA\u5E8F\u6E10\u8FDB\u4ECE\u7406\u8BBA\u3001\u5B9E\u8DF5\u5404\u79CD\u89D2\u5EA6\u6DF1\u5165\uFF0C\u4E5F\u672A\u5FC5\u662F\u8981\u6C42\u9762\u8BD5\u8005\u4EC0\u4E48\u90FD\u61C2\u3002\u4F46\u5982\u679C\u4F60\u61C2\u5F97\u539F\u7406\uFF0C\u4E00\u5B9A\u4F1A\u6210\u4E3A\u9762\u8BD5\u4E2D\u7684\u52A0\u5206\u9879\u3002 \u8FD9\u91CC\u8F83\u901A\u7528\u3001\u57FA\u7840\u6027\u7684\u90E8\u5206\u5982\u4E0B \u5783\u573E\u6536\u96C6\u7684\u7B97\u6CD5\u6709\u54EA\u4E9B\uFF1F\u5982\u4F55\u5224\u65AD\u4E00\u4E2A\u5BF9\u8C61\u662F\u5426\u53EF\u4EE5\u56DE\u6536\uFF1F \u5783\u573E\u6536\u96C6\u5668\u5DE5\u4F5C\u7684\u57FA\u672C\u6D41\u7A0B\u3002 \u53E6\u5916\uFF0C\u5927\u5BB6\u9700\u8981\u591A\u5173\u6CE8\u5783\u573E\u56DE\u6536\u5668\u8FD9\u4E00\u7AE0\u7684\u5404\u79CD\u5E38\u7528\u7684\u53C2\u6570\u3002</p><h2 id="gc\u65E5\u5FD7\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#gc\u65E5\u5FD7\u5206\u6790" aria-hidden="true">#</a> GC\u65E5\u5FD7\u5206\u6790</h2><p>\u901A\u8FC7\u9605\u8BFBGC\u65E5\u5FD7\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4E86\u89E3Java\u865A\u62DF\u673A\u5185\u5B58\u5206\u914D\u4E0E\u56DE\u6536\u7B56\u7565\u3002 \u5185\u5B58\u5206\u914D\u4E0E\u5783\u573E\u56DE\u6536\u7684\u53C2\u6570\u5217\u8868 -XX:+PriintGC \u8F93\u51FAGC\u65E5\u5FD7\u3002\u7C7B\u4F3C\uFF1A- verbose:GC -XX:+ PrintGCDetails \u8F93\u51FAGC\u7684\u8BE6\u7EC6\u65E5\u5FD7 -XX:+PrintGCTimeStamps\u8F93\u51FAGC\u7684\u65F6\u95F4\u6233\uFF08\u4EE5\u57FA\u51C6\u65F6\u95F4\u7684\u5F62\u5F0F\uFF09 -XX:+ PrintGCDateStamps\u8F93\u51FAGC\u7684\u65F6\u95F4\u6233\uFF08\u4EE5\u65E5\u671F\u7684\u5F62\u5F0F\uFF0C\u59822013-05-04T21:53:59.234+0800) -XX:+PrintHeapAtGC \u5728\u8FDB\u884CGC\u7684\u524D\u540E\u6253\u5370\u51FA\u5806\u7684\u4FE1\u606F -XlogGC:../logs/GC.log\u65E5\u5FD7\u6587\u4EF6\u7684\u8F93\u51FA\u8DEF\u5F84</p><p><img src="http://qnimg.gisfsde.com/image-20211219211435931.png" alt="image-20211219211435931" loading="lazy"></p><ul><li>&quot;[GC&quot;\u548C&quot;[Full GC&quot;\u8BF4\u660E\u4E86\u8FD9\u6B21\u5783\u573E\u6536\u96C6\u7684\u505C\u987F\u7C7B\u578B,\u5982\u679C\u6709&quot;Full&quot;\u5219\u8BF4\u660EGC\u53D1\u751F\u4E86Stop The World</li><li>\u4F7F\u7528 Serial\u6536\u96C6\u5668\u5728\u65B0\u751F\u4EE3\u7684\u540D\u5B57\u662F Default New Generation,\u56E0\u6B64\u663E\u793A\u7684\u662F&quot;[ ParNew</li><li>\u4F7F\u7528 ParNew\u6536\u96C6\u5668\u5728\u65B0\u751F\u4EE3\u7684\u540D\u5B57\u4F1A\u53D8\u6210&quot;[Pardew&quot;,\u610F\u601D\u662F&quot; Parallel New Generation&quot;</li><li>\u4F7F\u7528Parallel Scavenge\u6536\u96C6\u5668\u5728\u65B0\u751F\u4EE3\u7684\u540D\u5B57\u662F&quot;Psyounggen&quot;</li><li>\u8001\u5E74\u4EE3\u7684\u6536\u96C6\u548C\u65B0\u751F\u4EE3\u9053\u7406\u4E00\u6837,\u540D\u5B57\u4E5F\u662F\u6536\u96C6\u5668\u51B3\u5B9A\u7684</li><li>\u4F7F\u7528G1\u6536\u96C6\u5668\u7684\u8BDD,\u4F1A\u663E\u793A\u4E3A&quot; garbage- first heap&quot;</li></ul><p><strong>Allocation Failure</strong> \u8868\u660E\u672C\u6B21\u5F15\u8D77GC\u7684\u539F\u56E0\u662F\u56E0\u4E3A\u5728\u5E74\u8F7B\u4EE3\u4E2D\u6CA1\u6709\u8DB3\u591F\u7684\u7A7A\u95F4\u80FD\u591F\u5B58\u50A8\u65B0\u7684\u6570\u636E\u4E86\u3002 <strong>[ PSZoungGen:5986K-&gt;696K(8704K)]5986K--704K(9216K)</strong> \u4E2D\u62EC\u53F7\u5185\uFF1AGC\u56DE\u6536\u524D\u5E74\u8F7B\u4EE3\u5927\u5C0F\uFF0C\u56DE\u6536\u540E\u5927\u5C0F\uFF0C\uFF08\u5E74\u8F7B\u4EE3\u603B\u5927\u5C0F\uFF09 \u62EC\u53F7\u5916\uFF1AGC\u56DE\u6536\u524D\u5E74\u8F7B\u4EE3\u548C\u8001\u5E74\u4EE3\u5927\u5C0F\uFF0C\u56DE\u6536\u540E\u5927\u5C0F\uFF0C\uFF08\u5E74\u8F7B\u4EE3\u548C\u8001\u5E74\u4EE3\u603B\u5927\u5C0F\uFF09 <strong>user</strong>\u4EE3\u8868\u7528\u6237\u6001\u56DE\u6536\u8017\u65F6\uFF0Csys\u5185\u6838\u6001\u56DE\u6536\u8017\u65F6\uFF0Crea\u5B9E\u9645\u8017\u65F6\u3002\u7531\u4E8E\u591A\u6838\u7684\u539F\u56E0\uFF0C\u65F6\u95F4\u603B\u548C\u53EF\u80FD\u4F1A\u8D85\u8FC7real\u65F6\u95F4</p><p><img src="http://qnimg.gisfsde.com/image-20211219212013261.png" alt="image-20211219212013261" loading="lazy"></p><p><img src="http://qnimg.gisfsde.com/image-20211219212033708.png" alt="image-20211219212033708" loading="lazy"></p><h2 id="\u65E5\u5FD7\u5206\u6790\u5DE5\u5177" tabindex="-1"><a class="header-anchor" href="#\u65E5\u5FD7\u5206\u6790\u5DE5\u5177" aria-hidden="true">#</a> \u65E5\u5FD7\u5206\u6790\u5DE5\u5177</h2><p>\u53EF\u4EE5\u7528\u4E00\u4E9B\u5DE5\u5177\u53BB\u5206\u6790\u8FD9\u4E9BGC\u65E5\u5FD7\u3002\u5E38\u7528\u7684\u65E5\u5FD7\u5206\u6790\u5DE5\u5177\u6709\uFF1A GCVlewer\u3001 GCEsay\u3001 GCHisto\u3001 GCCLogViewer\u3001Hpjmeter\u3001 garbagecat\u7B49\u3002</p><h2 id="\u5783\u573E\u56DE\u6536\u5668\u7684\u65B0\u65F6\u4EE3\u53D1\u5C55" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u56DE\u6536\u5668\u7684\u65B0\u65F6\u4EE3\u53D1\u5C55" aria-hidden="true">#</a> \u5783\u573E\u56DE\u6536\u5668\u7684\u65B0\u65F6\u4EE3\u53D1\u5C55</h2><p>GC\u4ECD\u7136\u5904\u4E8E\u98DE\u901F\u53D1\u5C55\u4E4B\u4E2D\uFF0C\u76EE\u524D\u7684\u9ED8\u8BA4\u9009\u9879G1GC\u5728\u4E0D\u65AD\u7684\u8FDB\u884C\u6539\u8FDB\uFF0C\u5F88\u591A\u6211\u4EEC\u539F\u6765\u8BA4\u4E3A\u7684\u7F3A\u70B9\uFF0C\u4F8B\u5982\u4E32\u884C\u7684FullGC\u3001 Card Table\u626B\u63CF\u7684\u4F4E\u6548\u7B49\uFF0C\u90FD\u5DF2\u7ECF\u88AB\u5927\u5E45\u6539\u8FDB\uFF0C\u4F8B\u5982\uFF0CJDK10\u4EE5\u540E\uFF0CFullGC\u5DF2\u7ECF\u662F\u5E76\u884C\u8FD0\u884C\uFF0C\u5728\u5F88\u591A\u573A\u666F\u4E0B\uFF0C\u5176\u8868\u73B0\u8FD8\u7565\u4F18\u4E8E ParallelGC\u7684\u5E76\u884CFullGC\u5B9E\u73B0\u3002\u5373\u4F7F\u662F SerialGC,\u867D\u7136\u6BD4\u8F83\u53E4\u8001\uFF0C\u4F46\u662F\u7B80\u5355\u7684\u8BBE\u8BA1\u548C\u5B9E\u73B0\u672A\u5FC5\u5C31\u662F\u8FC7\u65F6\u7684\uFF0C\u5B83\u672C\u8EAB\u7684\u5F00\u9500\uFF0C\u4E0D\u7BA1\u662FGC\u76F8\u5173\u6570\u636E\u7ED3\u6784\u7684\u5F00\u9500\uFF0C\u8FD8\u662F\u7EBF\u7A0B\u7684\u5F00\u9500\uFF0C\u90FD\u662F\u975E\u5E38\u5C0F\u7684\uFF0C\u6240\u4EE5\u968F\u7740\u4E91\u8BA1\u7B97\u7684\u5174\u8D77\uFF0C\u5728 Serverless:\u7B49\u65B0\u7684\u5E94\u7528\u573A\u666F\u4E0B\uFF0C SeralGC\u627E\u5230\u4E86\u65B0\u7684\u821E\u53F0\u3002\u6BD4\u8F83\u4E0D\u5E78\u7684\u662F CMS GC,\u56E0\u4E3A\u5176\u7B97\u6CD5\u7684\u7406\u8BBA\u7F3A\u9677\u7B49\u539F\u56E0\uFF0C\u867D\u7136\u73B0\u5728\u8FD8\u6709\u975E\u5E38\u5927\u7684\u7528\u6237\u7FA4\u4F53\uFF0C\u4F46\u57283DK9\u4E2D\u5DF2\u7ECF\u88AB\u6807\u8BB0\u4E3A\u5E9F\u5F03\uFF0C\u5E76\u5728JDK14\u7248\u672C\u4E2D\u79FB\u9664\u3002</p><p>Open JDK12\u7684 Shenandoah GC:\u4F4E\u505C\u98A0\u65F6\u95F4\u7684cc\uFF08\u5B9E\u9A8C\u6027\uFF09 Shenandoah,\u65E0\u7591\u662F\u4F17\u591AGC\u4E2D\u6700\u5B64\u72EC\u7684\u4E00\u4E2A\u3002\u662F\u7B2C\u4E00\u6B3E\u4E0D\u7531 Oracle\u516C\u53F8\u56E2\u961F\u9886\u5BFC\u5F00\u53D1\u7684 Hotspot\u5783\u573E\u6536\u96C6\u5668\u3002\u4E0D\u53EF\u907F\u514D\u7684\u53D7\u5230\u5B98\u65B9\u7684\u6392\u6324\u3002\u6BD4\u5982\u53F7\u79F0openJDK\u548CoracleJDK\u6CA1\u6709\u533A\u522B\u7684oracle\u516C\u53F8\u4ECD\u62D2\u7EDD\u5728oracleJDK12\u4E2D\u652F\u6301 Shenandoah\u3002Shenandoah\u5783\u573E\u56DE\u6536\u5668\u6700\u521D\u7531 Redhat\u8FDB\u884C\u7684\u4E00\u9879\u5783\u573E\u6536\u96C6\u5668\u7814\u7A76\u9879\u76EE Pauseless GC\u7684\u5B9E\u73B0\uFF0C\u65E8\u5728\u9488\u5BF9]WM\u4E0A\u7684\u5185\u5B58\u56DE\u6536\u5B9E\u73B0\u4F4E\u505C\u987F\u7684\u9700\u6C42\u3002\u57282014\u5E74\u8D21\u732E\u7ED9OPENJDK. Red Hat\u7814\u53D1 Shenandoah\u56E2\u961F\u5BF9\u5916\u5BA3\u79F0\uFF0C Shenandoah\u5783\u573E\u56DE\u6536\u5668\u7684\u6682\u505C\u65F6\u95F4\u4E0E\u5806\u5927\u5C0F\u65E0\u5173\uFF0C\u8FD9\u610F\u5473\u7740\u65E0\u8BBA\u5C06\u5806\u8BBE\u7F6E\u4E3A200MB\u8FD8\u662F200GB,99.9%\u7684\u76EE\u6807\u90FD\u53EF\u4EE5\u628A\u5783\u573E\u6536\u96C6\u7684\u505C\u987F\u65F6\u95F4\u9650\u5236\u5728\u5341\u6BEB\u79D2\u4EE5\u5185\u3002\u4E0D\u8FC7\u5B9E\u9645\u4F7F\u7528\u6027\u80FD\u5C06\u53D6\u51B3\u4E8E\u5B9E\u9645\u5DE5\u4F5C\u5806\u7684\u5927\u5C0F\u548C\u5DE5\u4F5C\u8D1F\u8F7D\u3002</p><p>\u603B\u7ED3\uFF1A Shenandoah GC\u7684\u5F31\u9879\uFF1A\u9AD8\u8FD0\u884C\u8D1F\u62C5\u4E0B\u7684\u541E\u5410\u91CF\u4E0B\u964D\u3002 Shenandoah GC\u7684\u5F3A\u9879\uFF1A\u4F4E\u5EF6\u8FDF\u65F6\u95F4\u3002 Shenandoah GC\u7684\u5DE5\u4F5C\u8FC7\u7A0B\u5927\u81F4\u5206\u4E3A\u4E5D\u4E2A\u9636\u6BB5\uFF0C\u8FD9\u91CC\u5C31\u4E0D\u518D\u8D58\u8FF0\u3002\u5728\u4E4B\u524D Java12\u65B0\u7279\u6027\u89C6\u9891\u91CC\u6709\u8FC7\u4ECB\u7ECD\u3002</p><h2 id="zgc" tabindex="-1"><a class="header-anchor" href="#zgc" aria-hidden="true">#</a> ZGC</h2><p>\u200B ZGC\u4E0E Shenandoah\u76EE\u6807\u9AD8\u5EA6\u76F8\u4F3C\uFF0C\u5728\u5C3D\u53EF\u80FD\u5BF9\u541E\u5410\u91CF\u5F71\u54CD\u4E0D\u5927\u7684\u524D\u63D0\u4E0B\u5B9E\u73B0\u5728\u4EFB\u610F\u5806\u5185\u5B58\u5927\u5C0F\u4E0B\u90FD\u53EF\u4EE5\u628A\u5783\u573E\u6536\u96C6\u7684\u505C\u987F\u65F6\u95F4\u9650\u5236\u5728\u5341\u6BEB\u79D2\u4EE5\u5185\u7684\u4F4E\u5EF6\u8FDF\u3002\u300A\u6DF1\u5165\u7406\u89E3Java\u865A\u62DF\u673A\u300B\u4E00\u4E66\u4E2D\u8FD9\u6837\u5B9A\u4E49zGC:2GC\u6536\u96C6\u5668\u662F\u4E00\u6B3E\u57FA\u4E8ERegion\u5185\u5B58\u5E03\u5C40\u7684\uFF0C\uFF08\u6682\u65F6\uFF09\u4E0D\u8BBE\u5206\u4EE3\u7684\uFF0C\u4F7F\u7528\u4E86\u8BFB\u5C4F\u969C\u3001\u67D3\u8272\u6307\u9488\u548C\u5185\u5B58\u591A\u91CD\u6620\u5C04\u7B49\u6280\u672F\u6765\u5B9E\u73B0\u53EF\u5E76\u53D1\u7684\u6807\u8BB0\u4E00\u538B\u7F29\u7B97\u6CD5\u7684\uFF0C\u4EE5\u4F4E\u5EF6\u8FDF\u4E3A\u9996\u8981\u76EE\u6807\u7684\u4E00\u6B3E\u5783\u573E\u6536\u96C6\u56682GC\u7684\u5DE5\u4F5C\u8FC7\u7A0B\u53EF\u4EE5\u5206\u4E3A4\u4E2A\u9636\u6BB5\uFF1A\u5E76\u53D1\u6807\u8BB0\u4E00\u5E76\u53D1\u9884\u5907\u91CD\u5206\u914D\u4E00\u5E76\u53D1\u91CD\u5206\u914D\u5E76\u53D1\u91CD\u6620\u5C04\u7B49\u3002ZGC\u51E0\u4E4E\u5728\u6240\u6709\u5730\u65B9\u5E76\u53D1\u6267\u884C\u7684\uFF0C\u9664\u4E86\u521D\u59CB\u6807\u8BB0\u7684\u662FSTW\u7684\u3002\u6240\u4EE5\u505C\u987F\u65F6\u95F4\u51E0\u4E4E\u5C31\u8017\u8D39\u5728\u521D\u59CB\u6807\u8BB0\u4E0A\uFF0C\u8FD9\u90E8\u5206\u7684\u5B9E\u9645\u65F6\u95F4\u662F\u975E\u5E38\u5C11\u7684\u3002</p><p>JBP364:ZGC\u5E94\u7528\u5728 macos\u4E0A JEP365:ZGC\u5E94\u7528\u5728 Windows\u4E0A JDK14\u4E4B\u524D\uFF0CZGC\u4EC5inux\u30AA\u652F\u6301\u3002 \u30FB\u5C3D\u7BA1\u8BB8\u591A\u4F7F\u7528ZGC\u7684\u7528\u6237\u90FD\u4F7F\u7528\u7C7B\u30A8inux\u7684\u73AF\u5883\uFF0C\u4F46\u5728 Windows\u548C macos\u4E0A\uFF0C\u4EBA\u4EEC\u4E5F\u9700\u8981ZGC\u8FDB\u884C\u5F00\u53D1\u90E8\u7F72\u548C\u6D4B\u8BD5\u3002\u8BB8\u591A\u684C\u9762\u5E94\u7528\u4E5F\u53EF\u4EE5\u4ECEZGC\u4E2D\u53D7\u76CA\u3002\u56E0\u6B64\uFF0CZGC\u7279\u6027\u88AB\u79FB\u690D\u5230\u4E86 Windows\u548C macos\u4E0A\u3002 \u30FB\u73B0\u5728mac\u6216 Windows\u4E0A\u4E5F\u80FD\u4F7F\u7528ZGC\u4E86\uFF0C\u793A\u4F8B\u5982\u4E0B\uFF1AXX: +UnlockExperimentalVMOptions -XX: +UseZGC</p>',197),ya={id:"\u590D\u4E60\u3010processon\u4F5C\u56FE-\u5B8C\u5584\u6D41\u7A0B\u8FC7\u7A0B\u4E2D\u518D\u6B21\u719F\u6089\u3011",tabindex:"-1"},Ga=a("a",{class:"header-anchor",href:"#\u590D\u4E60\u3010processon\u4F5C\u56FE-\u5B8C\u5584\u6D41\u7A0B\u8FC7\u7A0B\u4E2D\u518D\u6B21\u719F\u6089\u3011","aria-hidden":"true"},"#",-1),_a=n(" \u590D\u4E60\u3010"),ja={href:"https://www.processon.com/diagraming/61c016576376892b1df8091e",target:"_blank",rel:"noopener noreferrer"},qa=n("processon\u4F5C\u56FE\uFF0C\u5B8C\u5584\u6D41\u7A0B\u8FC7\u7A0B\u4E2D\u518D\u6B21\u719F\u6089"),Xa=n("\u3011"),Pa=n("\u5B8C\u6210\uFF1A"),Va={href:"https://www.processon.com/diagraming/61c016576376892b1df8091e",target:"_blank",rel:"noopener noreferrer"},Ta=n("JVM\u603B\u56FE - ProcessOn");function Aa(Oa,La){const e=p("ExternalLinkIcon");return l(),i("div",null,[c,a("blockquote",null,[d,a("p",null,[u,m,k,h,g,v,b,f,a("a",C,[S,t(e)]),M,w,J])]),x,a("h2",y,[G,_,a("a",j,[q,t(e)])]),X,a("h3",P,[V,T,a("a",A,[O,t(e)])]),L,z,E,B,D,R,U,I,H,K,F,N,W,Z,Y,$,Q,aa,na,sa,ea,a("p",null,[ta,oa,pa,la,ia,a("a",ra,[ca,t(e)])]),da,a("p",null,[ua,a("a",ma,[ka,t(e)]),ha]),ga,a("p",null,[va,a("a",ba,[fa,t(e)]),Ca]),Sa,a("p",null,[Ma,a("a",wa,[Ja,t(e)])]),xa,a("h1",ya,[Ga,_a,a("a",ja,[qa,t(e)]),Xa]),a("p",null,[Pa,a("a",Va,[Ta,t(e)])])])}var Ba=o(r,[["render",Aa],["__file","JVM.html.vue"]]);export{Ba as default};
